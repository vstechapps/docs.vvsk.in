var lS=Object.defineProperty,QF=Object.defineProperties;var XF=Object.getOwnPropertyDescriptors;var Ed=Object.getOwnPropertySymbols;var uS=Object.prototype.hasOwnProperty,dS=Object.prototype.propertyIsEnumerable;var cS=(n,e,t)=>e in n?lS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,L=(n,e)=>{for(var t in e||={})uS.call(e,t)&&cS(n,t,e[t]);if(Ed)for(var t of Ed(e))dS.call(e,t)&&cS(n,t,e[t]);return n},J=(n,e)=>QF(n,XF(e));var $c=(n,e)=>{var t={};for(var r in n)uS.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Ed)for(var r of Ed(n))e.indexOf(r)<0&&dS.call(n,r)&&(t[r]=n[r]);return t};var hS=(n,e)=>{for(var t in e)lS(n,t,{get:e[t],enumerable:!0})};var Wt=null,bd=!1,_y=1,JF=null,Ln=Symbol("SIGNAL");function ye(n){let e=Wt;return Wt=n,e}function Id(){return Wt}var Ad={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Td(n){if(bd)throw new Error("");if(Wt===null)return;Wt.consumerOnSignalRead(n);let e=Wt.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=Wt.recomputing;if(r&&(t=e!==void 0?e.nextProducer:Wt.producers,t!==void 0&&t.producer===n)){Wt.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===Wt&&(!r||eV(i,Wt)))return;let s=zo(Wt),o={producer:n,consumer:Wt,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};Wt.producersTail=o,e!==void 0?e.nextProducer=o:Wt.producers=o,s&&yS(n,o)}function fS(){_y++}function pS(n){if(!(zo(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===_y)){if(!n.producerMustRecompute(n)&&!Sd(n)){vy(n);return}n.producerRecomputeValue(n),vy(n)}}function wy(n){if(n.consumers===void 0)return;let e=bd;bd=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||ZF(r)}}finally{bd=e}}function Ey(){return Wt?.consumerAllowSignalWrites!==!1}function ZF(n){n.dirty=!0,wy(n),n.consumerMarkedDirty?.(n)}function vy(n){n.dirty=!1,n.lastCleanEpoch=_y}function Cd(n){return n&&gS(n),ye(n)}function gS(n){n.producersTail=void 0,n.recomputing=!0}function by(n,e){ye(e),n&&mS(n)}function mS(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(zo(n))do t=Iy(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function Sd(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(pS(t),r!==t.version))return!0}return!1}function zc(n){if(zo(n)){let e=n.producers;for(;e!==void 0;)e=Iy(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function yS(n,e){let t=n.consumersTail,r=zo(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)yS(i.producer,i)}function Iy(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!zo(e)){let s=e.producers;for(;s!==void 0;)s=Iy(s)}return t}function zo(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function vS(n){JF?.(n)}function eV(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function _S(n,e){return Object.is(n,e)}function tV(){throw new Error}var wS=tV;function ES(n){wS(n)}function Ay(n){wS=n}var nV=null;function Ty(n,e){let t=Object.create(Dd);t.value=n,e!==void 0&&(t.equal=e);let r=()=>bS(t);return r[Ln]=t,vS(t),[r,o=>Gc(t,o),o=>IS(t,o)]}function bS(n){return Td(n),n.value}function Gc(n,e){Ey()||ES(n),n.equal(n.value,e)||(n.value=e,rV(n))}function IS(n,e){Ey()||ES(n),Gc(n,e(n.value))}var Dd=J(L({},Ad),{equal:_S,value:void 0,kind:"signal"});function rV(n){n.version++,fS(),wy(n),nV?.(n)}function Cy(n){let e=ye(null);try{return n()}finally{ye(e)}}function ee(n){return typeof n=="function"}function Go(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var xd=Go(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ss(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var vt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ee(r))try{r()}catch(s){e=s instanceof xd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{AS(s)}catch(o){e=e??[],o instanceof xd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new xd(e)}}add(e){var t;if(e&&e!==this)if(this.closed)AS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ss(t,e)}remove(e){let{_finalizers:t}=this;t&&Ss(t,e),e instanceof n&&e._removeParent(this)}};vt.EMPTY=(()=>{let n=new vt;return n.closed=!0,n})();var Sy=vt.EMPTY;function Pd(n){return n instanceof vt||n&&"closed"in n&&ee(n.remove)&&ee(n.add)&&ee(n.unsubscribe)}function AS(n){ee(n)?n():n.unsubscribe()}var Xn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Wo={setTimeout(n,e,...t){let{delegate:r}=Wo;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Wo;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Md(n){Wo.setTimeout(()=>{let{onUnhandledError:e}=Xn;if(e)e(n);else throw n})}function Wc(){}var TS=Dy("C",void 0,void 0);function CS(n){return Dy("E",void 0,n)}function SS(n){return Dy("N",n,void 0)}function Dy(n,e,t){return{kind:n,value:e,error:t}}var Ds=null;function qo(n){if(Xn.useDeprecatedSynchronousErrorHandling){let e=!Ds;if(e&&(Ds={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Ds;if(Ds=null,t)throw r}}else n()}function DS(n){Xn.useDeprecatedSynchronousErrorHandling&&Ds&&(Ds.errorThrown=!0,Ds.error=n)}var xs=class extends vt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Pd(e)&&e.add(this)):this.destination=oV}static create(e,t,r){return new Ko(e,t,r)}next(e){this.isStopped?Py(SS(e),this):this._next(e)}error(e){this.isStopped?Py(CS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Py(TS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},iV=Function.prototype.bind;function xy(n,e){return iV.call(n,e)}var My=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Rd(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Rd(r)}else Rd(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Rd(t)}}},Ko=class extends xs{constructor(e,t,r){super();let i;if(ee(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Xn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&xy(e.next,s),error:e.error&&xy(e.error,s),complete:e.complete&&xy(e.complete,s)}):i=e}this.destination=new My(i)}};function Rd(n){Xn.useDeprecatedSynchronousErrorHandling?DS(n):Md(n)}function sV(n){throw n}function Py(n,e){let{onStoppedNotification:t}=Xn;t&&Wo.setTimeout(()=>t(n,e))}var oV={closed:!0,next:Wc,error:sV,complete:Wc};var Yo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Jn(n){return n}function Ry(...n){return Ny(n)}function Ny(n){return n.length===0?Jn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Ae=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=cV(t)?t:new Ko(t,r,i);return qo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=xS(r),new r((i,s)=>{let o=new Ko({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Yo](){return this}pipe(...t){return Ny(t)(this)}toPromise(t){return t=xS(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function xS(n){var e;return(e=n??Xn.Promise)!==null&&e!==void 0?e:Promise}function aV(n){return n&&ee(n.next)&&ee(n.error)&&ee(n.complete)}function cV(n){return n&&n instanceof xs||aV(n)&&Pd(n)}function lV(n){return ee(n?.lift)}function xe(n){return e=>{if(lV(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Me(n,e,t,r,i){return new Oy(n,e,t,r,i)}var Oy=class extends xs{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var PS=Go(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var _t=(()=>{class n extends Ae{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Nd(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new PS}next(t){qo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){qo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){qo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Sy:(this.currentObservers=null,s.push(t),new vt(()=>{this.currentObservers=null,Ss(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Ae;return t.source=this,t}}return n.create=(e,t)=>new Nd(e,t),n})(),Nd=class extends _t{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Sy}};var wt=class extends _t{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var ky={now(){return(ky.delegate||Date).now()},delegate:void 0};var Od=class extends vt{constructor(e,t){super()}schedule(e,t=0){return this}};var qc={setInterval(n,e,...t){let{delegate:r}=qc;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=qc;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var kd=class extends Od{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return qc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&qc.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ss(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Qo=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Qo.now=ky.now;var Ld=class extends Qo{constructor(e,t=Qo.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var MS=new Ld(kd);var hn=new Ae(n=>n.complete());function RS(n){return n&&ee(n.schedule)}function NS(n){return n[n.length-1]}function OS(n){return ee(NS(n))?n.pop():void 0}function Vi(n){return RS(NS(n))?n.pop():void 0}function LS(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(h){o(h)}}function c(u){try{l(r.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function kS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ps(n){return this instanceof Ps?(this.v=n,this):new Ps(n)}function FS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(p){return function(m){return Promise.resolve(m).then(p,h)}}function a(p,m){r[p]&&(i[p]=function(v){return new Promise(function(w,I){s.push([p,v,w,I])>1||c(p,v)})},m&&(i[p]=m(i[p])))}function c(p,m){try{l(r[p](m))}catch(v){f(s[0][3],v)}}function l(p){p.value instanceof Ps?Promise.resolve(p.value.v).then(u,h):f(s[0][2],p)}function u(p){c("next",p)}function h(p){c("throw",p)}function f(p,m){p(m),s.shift(),s.length&&c(s[0][0],s[0][1])}}function VS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof kS=="function"?kS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Xo=n=>n&&typeof n.length=="number"&&typeof n!="function";function Fd(n){return ee(n?.then)}function Vd(n){return ee(n[Yo])}function jd(n){return Symbol.asyncIterator&&ee(n?.[Symbol.asyncIterator])}function Bd(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function uV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Ud=uV();function Hd(n){return ee(n?.[Ud])}function $d(n){return FS(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Ps(t.read());if(i)return yield Ps(void 0);yield yield Ps(r)}}finally{t.releaseLock()}})}function zd(n){return ee(n?.getReader)}function ut(n){if(n instanceof Ae)return n;if(n!=null){if(Vd(n))return dV(n);if(Xo(n))return hV(n);if(Fd(n))return fV(n);if(jd(n))return jS(n);if(Hd(n))return pV(n);if(zd(n))return gV(n)}throw Bd(n)}function dV(n){return new Ae(e=>{let t=n[Yo]();if(ee(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function hV(n){return new Ae(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function fV(n){return new Ae(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Md)})}function pV(n){return new Ae(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function jS(n){return new Ae(e=>{mV(n,e).catch(t=>e.error(t))})}function gV(n){return jS($d(n))}function mV(n,e){var t,r,i,s;return LS(this,void 0,void 0,function*(){try{for(t=VS(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function fn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Gd(n,e=0){return xe((t,r)=>{t.subscribe(Me(r,i=>fn(r,n,()=>r.next(i),e),()=>fn(r,n,()=>r.complete(),e),i=>fn(r,n,()=>r.error(i),e)))})}function Wd(n,e=0){return xe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function BS(n,e){return ut(n).pipe(Wd(e),Gd(e))}function US(n,e){return ut(n).pipe(Wd(e),Gd(e))}function HS(n,e){return new Ae(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function $S(n,e){return new Ae(t=>{let r;return fn(t,e,()=>{r=n[Ud](),fn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>ee(r?.return)&&r.return()})}function qd(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ae(t=>{fn(t,e,()=>{let r=n[Symbol.asyncIterator]();fn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function zS(n,e){return qd($d(n),e)}function GS(n,e){if(n!=null){if(Vd(n))return BS(n,e);if(Xo(n))return HS(n,e);if(Fd(n))return US(n,e);if(jd(n))return qd(n,e);if(Hd(n))return $S(n,e);if(zd(n))return zS(n,e)}throw Bd(n)}function qe(n,e){return e?GS(n,e):ut(n)}function he(...n){let e=Vi(n);return qe(n,e)}function Ly(n,e){let t=ee(n)?n:()=>n,r=i=>i.error(t());return new Ae(e?i=>e.schedule(r,0,i):r)}function Kd(n){return!!n&&(n instanceof Ae||ee(n.lift)&&ee(n.subscribe))}var Ms=Go(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function ke(n,e){return xe((t,r)=>{let i=0;t.subscribe(Me(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:yV}=Array;function vV(n,e){return yV(e)?n(...e):n(e)}function Yd(n){return ke(e=>vV(n,e))}var{isArray:_V}=Array,{getPrototypeOf:wV,prototype:EV,keys:bV}=Object;function WS(n){if(n.length===1){let e=n[0];if(_V(e))return{args:e,keys:null};if(IV(e)){let t=bV(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function IV(n){return n&&typeof n=="object"&&wV(n)===EV}function qS(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Qd(...n){let e=Vi(n),t=OS(n),{args:r,keys:i}=WS(n);if(r.length===0)return qe([],e);let s=new Ae(AV(r,e,i?o=>qS(i,o):Jn));return t?s.pipe(Yd(t)):s}function AV(n,e,t=Jn){return r=>{KS(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)KS(e,()=>{let l=qe(n[c],e),u=!1;l.subscribe(Me(r,h=>{s[c]=h,u||(u=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function KS(n,e,t){n?fn(t,n,e):e()}function YS(n,e,t,r,i,s,o,a){let c=[],l=0,u=0,h=!1,f=()=>{h&&!c.length&&!l&&e.complete()},p=v=>l<r?m(v):c.push(v),m=v=>{s&&e.next(v),l++;let w=!1;ut(t(v,u++)).subscribe(Me(e,I=>{i?.(I),s?p(I):e.next(I)},()=>{w=!0},void 0,()=>{if(w)try{for(l--;c.length&&l<r;){let I=c.shift();o?fn(e,o,()=>m(I)):m(I)}f()}catch(I){e.error(I)}}))};return n.subscribe(Me(e,p,()=>{h=!0,f()})),()=>{a?.()}}function Et(n,e,t=1/0){return ee(e)?Et((r,i)=>ke((s,o)=>e(r,s,i,o))(ut(n(r,i))),t):(typeof e=="number"&&(t=e),xe((r,i)=>YS(r,i,n,t)))}function Jo(n=1/0){return Et(Jn,n)}function QS(){return Jo(1)}function Zo(...n){return QS()(qe(n,Vi(n)))}function Kc(n){return new Ae(e=>{ut(n()).subscribe(e)})}var TV=["addListener","removeListener"],CV=["addEventListener","removeEventListener"],SV=["on","off"];function Ke(n,e,t,r){if(ee(t)&&(r=t,t=void 0),r)return Ke(n,e,t).pipe(Yd(r));let[i,s]=PV(n)?CV.map(o=>a=>n[o](e,a,t)):DV(n)?TV.map(XS(n,e)):xV(n)?SV.map(XS(n,e)):[];if(!i&&Xo(n))return Et(o=>Ke(o,e,t))(ut(n));if(!i)throw new TypeError("Invalid event target");return new Ae(o=>{let a=(...c)=>o.next(1<c.length?c:c[0]);return i(a),()=>s(a)})}function XS(n,e){return t=>r=>n[t](e,r)}function DV(n){return ee(n.addListener)&&ee(n.removeListener)}function xV(n){return ee(n.on)&&ee(n.off)}function PV(n){return ee(n.addEventListener)&&ee(n.removeEventListener)}function qt(n,e){return xe((t,r)=>{let i=0;t.subscribe(Me(r,s=>n.call(e,s,i++)&&r.next(s)))})}function ea(n){return xe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(Me(t,void 0,void 0,o=>{s=ut(n(o,ea(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function ji(n,e){return ee(e)?Et(n,e,1):Et(n,1)}function Fy(n,e=MS){return xe((t,r)=>{let i=null,s=null,o=null,a=()=>{if(i){i.unsubscribe(),i=null;let l=s;s=null,r.next(l)}};function c(){let l=o+n,u=e.now();if(u<l){i=this.schedule(void 0,l-u),r.add(i);return}a()}t.subscribe(Me(r,l=>{s=l,o=e.now(),i||(i=e.schedule(c,n),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}function Vy(n){return xe((e,t)=>{let r=!1;e.subscribe(Me(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Xr(n){return n<=0?()=>hn:xe((e,t)=>{let r=0;e.subscribe(Me(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function JS(n=MV){return xe((e,t)=>{let r=!1;e.subscribe(Me(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function MV(){return new Ms}function ta(n){return xe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Jr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?qt((i,s)=>n(i,s,r)):Jn,Xr(1),t?Vy(e):JS(()=>new Ms))}function Xd(n){return n<=0?()=>hn:xe((e,t)=>{let r=[];e.subscribe(Me(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function jy(...n){let e=Vi(n);return xe((t,r)=>{(e?Zo(n,t,e):Zo(n,t)).subscribe(r)})}function bn(n,e){return xe((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(Me(r,c=>{i?.unsubscribe();let l=0,u=s++;ut(n(c,u)).subscribe(i=Me(r,h=>r.next(e?e(c,h,u,l++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Ve(n){return xe((e,t)=>{ut(n).subscribe(Me(t,()=>t.complete(),Wc)),!t.closed&&e.subscribe(t)})}function rn(n,e,t){let r=ee(n)||e||t?{next:n,error:e,complete:t}:n;return r?xe((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Me(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Jn}var By;function Jd(){return By}function wr(n){let e=By;return By=n,e}var ZS=Symbol("NotFound");function na(n){return n===ZS||n?.name==="\u0275NotFound"}var ih="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",$=class extends Error{code;constructor(e,t){super(ti(e,t)),this.code=e}};function kV(n){return`NG0${Math.abs(n)}`}function ti(n,e){return`${kV(n)}${e?": "+e:""}`}var Zn=globalThis;function Re(n){for(let e in n)if(n[e]===Re)return e;throw Error("")}function ei(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(ei).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function tv(n,e){return n?e?`${n} ${e}`:n:e||""}var LV=Re({__forward_ref__:Re});function sh(n){return n.__forward_ref__=sh,n.toString=function(){return ei(this())},n}function pn(n){return nv(n)?n():n}function nv(n){return typeof n=="function"&&n.hasOwnProperty(LV)&&n.__forward_ref__===sh}function H(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function xt(n){return{providers:n.providers||[],imports:n.imports||[]}}function el(n){return FV(n,oh)}function rv(n){return el(n)!==null}function FV(n,e){return n.hasOwnProperty(e)&&n[e]||null}function VV(n){let e=n?.[oh]??null;return e||null}function Hy(n){return n&&n.hasOwnProperty(eh)?n[eh]:null}var oh=Re({\u0275prov:Re}),eh=Re({\u0275inj:Re}),G=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=H({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function iv(n){return n&&!!n.\u0275providers}var sv=Re({\u0275cmp:Re}),ov=Re({\u0275dir:Re}),av=Re({\u0275pipe:Re}),cv=Re({\u0275mod:Re}),Qc=Re({\u0275fac:Re}),Ls=Re({__NG_ELEMENT_ID__:Re}),eD=Re({__NG_ENV_ID__:Re});function ah(n){return typeof n=="string"?n:n==null?"":String(n)}function iD(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():ah(n)}var sD=Re({ngErrorCode:Re}),jV=Re({ngErrorMessage:Re}),BV=Re({ngTokenPath:Re});function lv(n,e){return oD("",-200,e)}function ch(n,e){throw new $(-201,!1)}function oD(n,e,t){let r=new $(e,n);return r[sD]=e,r[jV]=n,t&&(r[BV]=t),r}function UV(n){return n[sD]}var $y;function aD(){return $y}function In(n){let e=$y;return $y=n,e}function uv(n,e,t){let r=el(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;ch(n,"Injector")}var HV={},Rs=HV,$V="__NG_DI_FLAG__",zy=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=Ns(t)||0;try{return this.injector.get(e,r&8?null:Rs,r)}catch(i){if(na(i))return i;throw i}}};function zV(n,e=0){let t=Jd();if(t===void 0)throw new $(-203,!1);if(t===null)return uv(n,void 0,e);{let r=GV(e),i=t.retrieve(n,r);if(na(i)){if(r.optional)return null;throw i}return i}}function W(n,e=0){return(aD()||zV)(pn(n),e)}function V(n,e){return W(n,Ns(e))}function Ns(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function GV(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Gy(n){let e=[];for(let t=0;t<n.length;t++){let r=pn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=0;for(let o=0;o<r.length;o++){let a=r[o],c=WV(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(W(i,s))}else e.push(W(r))}return e}function WV(n){return n[$V]}function Os(n,e){let t=n.hasOwnProperty(Qc);return t?n[Qc]:null}function cD(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],s=e[r];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}function lD(n){return n.flat(Number.POSITIVE_INFINITY)}function lh(n,e){n.forEach(t=>Array.isArray(t)?lh(t,e):e(t))}function dv(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function tl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function uD(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function dD(n,e,t){let r=ia(n,e);return r>=0?n[r|1]=t:(r=~r,uD(n,r,e,t)),r}function uh(n,e){let t=ia(n,e);if(t>=0)return n[t|1]}function ia(n,e){return qV(n,e,1)}function qV(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var Fs={},Fn=[],Vs=new G(""),hv=new G("",-1),fv=new G(""),Xc=class{get(e,t=Rs){if(t===Rs){let i=oD("",-201);throw i.name="\u0275NotFound",i}return t}};function pv(n){return n[cv]||null}function ni(n){return n[sv]||null}function gv(n){return n[ov]||null}function hD(n){return n[av]||null}function ri(n){return{\u0275providers:n}}function fD(n){return ri([{provide:Vs,multi:!0,useValue:n}])}function pD(...n){return{\u0275providers:mv(!0,n),\u0275fromNgModule:!0}}function mv(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return lh(e,o=>{let a=o;th(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&gD(i,s),t}function gD(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];yv(i,s=>{e(s,r)})}}function th(n,e,t,r){if(n=pn(n),!n)return!1;let i=null,s=Hy(n),o=!s&&ni(n);if(!s&&!o){let c=n.ngModule;if(s=Hy(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)th(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{lh(s.imports,u=>{th(u,e,t,r)&&(l||=[],l.push(u))})}finally{}l!==void 0&&gD(l,e)}if(!a){let l=Os(i)||(()=>new i);e({provide:i,useFactory:l,deps:Fn},i),e({provide:fv,useValue:i,multi:!0},i),e({provide:Vs,useValue:()=>W(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;yv(c,u=>{e(u,l)})}}else return!1;return i!==n&&n.providers!==void 0}function yv(n,e){for(let t of n)iv(t)&&(t=t.\u0275providers),Array.isArray(t)?yv(t,e):e(t)}var KV=Re({provide:String,useValue:Re});function mD(n){return n!==null&&typeof n=="object"&&KV in n}function YV(n){return!!(n&&n.useExisting)}function QV(n){return!!(n&&n.useFactory)}function nh(n){return typeof n=="function"}var nl=new G(""),Zd={},tD={},Uy;function rl(){return Uy===void 0&&(Uy=new Xc),Uy}var at=class{},ks=class extends at{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,qy(e,o=>this.processProvider(o)),this.records.set(hv,ra(void 0,this)),i.has("environment")&&this.records.set(at,ra(void 0,this));let s=this.records.get(nl);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(fv,Fn,{self:!0}))}retrieve(e,t){let r=Ns(t)||0;try{return this.get(e,Rs,r)}catch(i){if(na(i))return i;throw i}}destroy(){Yc(this),this._destroyed=!0;let e=ye(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ye(e)}}onDestroy(e){return Yc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Yc(this);let t=wr(this),r=In(void 0),i;try{return e()}finally{wr(t),In(r)}}get(e,t=Rs,r){if(Yc(this),e.hasOwnProperty(eD))return e[eD](this);let i=Ns(r),s,o=wr(this),a=In(void 0);try{if(!(i&4)){let l=this.records.get(e);if(l===void 0){let u=t2(e)&&el(e);u&&this.injectableDefInScope(u)?l=ra(Wy(e),Zd):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,i)}let c=i&2?rl():this.parent;return t=i&8&&t===Rs?null:t,c.get(e,t)}catch(c){let l=UV(c);throw l===-200||l===-201?new $(l,null):c}finally{In(a),wr(o)}}resolveInjectorInitializers(){let e=ye(null),t=wr(this),r=In(void 0),i;try{let s=this.get(Vs,Fn,{self:!0});for(let o of s)o()}finally{wr(t),In(r),ye(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(ei(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=pn(e);let t=nh(e)?e:pn(e&&e.provide),r=JV(e);if(!nh(e)&&e.multi===!0){let i=this.records.get(t);i||(i=ra(void 0,Zd,!0),i.factory=()=>Gy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=ye(null);try{if(t.value===tD)throw lv(ei(e));return t.value===Zd&&(t.value=tD,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&e2(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ye(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=pn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Wy(n){let e=el(n),t=e!==null?e.factory:Os(n);if(t!==null)return t;if(n instanceof G)throw new $(204,!1);if(n instanceof Function)return XV(n);throw new $(204,!1)}function XV(n){if(n.length>0)throw new $(204,!1);let t=VV(n);return t!==null?()=>t.factory(n):()=>new n}function JV(n){if(mD(n))return ra(void 0,n.useValue);{let e=yD(n);return ra(e,Zd)}}function yD(n,e,t){let r;if(nh(n)){let i=pn(n);return Os(i)||Wy(i)}else if(mD(n))r=()=>pn(n.useValue);else if(QV(n))r=()=>n.useFactory(...Gy(n.deps||[]));else if(YV(n))r=(i,s)=>W(pn(n.useExisting),s!==void 0&&s&8?8:void 0);else{let i=pn(n&&(n.useClass||n.provide));if(ZV(n))r=()=>new i(...Gy(n.deps));else return Os(i)||Wy(i)}return r}function Yc(n){if(n.destroyed)throw new $(205,!1)}function ra(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function ZV(n){return!!n.deps}function e2(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function t2(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function qy(n,e){for(let t of n)Array.isArray(t)?qy(t,e):t&&iv(t)?qy(t.\u0275providers,e):e(t)}function Pt(n,e){let t;n instanceof ks?(Yc(n),t=n):t=new zy(n);let r,i=wr(t),s=In(void 0);try{return e()}finally{wr(i),In(s)}}function vv(){return aD()!==void 0||Jd()!=null}var er=0,ie=1,oe=2,Dt=3,Vn=4,jn=5,il=6,sa=7,Kt=8,Hi=9,br=10,bt=11,oa=12,_v=13,js=14,Bn=15,$i=16,Bs=17,Ir=18,sl=19,wv=20,Zr=21,dh=22,ol=23,An=24,Us=25,al=26,gn=27,vD=1;var zi=7,cl=8,Hs=9,on=10;function ii(n){return Array.isArray(n)&&typeof n[vD]=="object"}function tr(n){return Array.isArray(n)&&n[vD]===!0}function Ev(n){return(n.flags&4)!==0}function Gi(n){return n.componentOffset>-1}function aa(n){return(n.flags&1)===1}function $s(n){return!!n.template}function ca(n){return(n[oe]&512)!==0}function zs(n){return(n[oe]&256)===256}var _D="svg",wD="math";function Un(n){for(;Array.isArray(n);)n=n[er];return n}function bv(n,e){return Un(e[n])}function Ar(n,e){return Un(e[n.index])}function hh(n,e){return n.data[e]}function nr(n,e){let t=e[n];return ii(t)?t:t[er]}function ED(n){return(n[oe]&4)===4}function fh(n){return(n[oe]&128)===128}function bD(n){return tr(n[Dt])}function ll(n,e){return e==null?null:n[e]}function Iv(n){n[Bs]=0}function Av(n){n[oe]&1024||(n[oe]|=1024,fh(n)&&la(n))}function ID(n,e){for(;n>0;)e=e[js],n--;return e}function ul(n){return!!(n[oe]&9216||n[An]?.dirty)}function ph(n){n[br].changeDetectionScheduler?.notify(8),n[oe]&64&&(n[oe]|=1024),ul(n)&&la(n)}function la(n){n[br].changeDetectionScheduler?.notify(0);let e=Bi(n);for(;e!==null&&!(e[oe]&8192||(e[oe]|=8192,!fh(e)));)e=Bi(e)}function Tv(n,e){if(zs(n))throw new $(911,!1);n[Zr]===null&&(n[Zr]=[]),n[Zr].push(e)}function AD(n,e){if(n[Zr]===null)return;let t=n[Zr].indexOf(e);t!==-1&&n[Zr].splice(t,1)}function Bi(n){let e=n[Dt];return tr(e)?e[Dt]:e}function Cv(n){return n[sa]??=[]}function Sv(n){return n.cleanup??=[]}function TD(n,e,t,r){let i=Cv(e);i.push(t),n.firstCreatePass&&Sv(n).push(r,i.length-1)}var we={lFrame:UD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Ky=!1;function CD(){return we.lFrame.elementDepthCount}function SD(){we.lFrame.elementDepthCount++}function DD(){we.lFrame.elementDepthCount--}function gh(){return we.bindingsEnabled}function xD(){return we.skipHydrationRootTNode!==null}function PD(n){return we.skipHydrationRootTNode===n}function MD(){we.skipHydrationRootTNode=null}function Ue(){return we.lFrame.lView}function rr(){return we.lFrame.tView}function Mt(n){return we.lFrame.contextLView=n,n[Kt]}function Rt(n){return we.lFrame.contextLView=null,n}function Hn(){let n=Dv();for(;n!==null&&n.type===64;)n=n.parent;return n}function Dv(){return we.lFrame.currentTNode}function RD(){let n=we.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function ua(n,e){let t=we.lFrame;t.currentTNode=n,t.isParent=e}function xv(){return we.lFrame.isParent}function ND(){we.lFrame.isParent=!1}function Pv(){return Ky}function Mv(n){let e=Ky;return Ky=n,e}function OD(n){return we.lFrame.bindingIndex=n}function Rv(){return we.lFrame.bindingIndex++}function kD(n){let e=we.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function LD(){return we.lFrame.inI18n}function FD(n,e){let t=we.lFrame;t.bindingIndex=t.bindingRootIndex=n,mh(e)}function VD(){return we.lFrame.currentDirectiveIndex}function mh(n){we.lFrame.currentDirectiveIndex=n}function jD(n){let e=we.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Nv(){return we.lFrame.currentQueryIndex}function yh(n){we.lFrame.currentQueryIndex=n}function n2(n){let e=n[ie];return e.type===2?e.declTNode:e.type===1?n[jn]:null}function Ov(n,e,t){if(t&4){let i=e,s=n;for(;i=i.parent,i===null&&!(t&1);)if(i=n2(s),i===null||(s=s[js],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=we.lFrame=BD();return r.currentTNode=e,r.lView=n,!0}function vh(n){let e=BD(),t=n[ie];we.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function BD(){let n=we.lFrame,e=n===null?null:n.child;return e===null?UD(n):e}function UD(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function HD(){let n=we.lFrame;return we.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var kv=HD;function _h(){let n=HD();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function $D(n){return(we.lFrame.contextLView=ID(n,we.lFrame.contextLView))[Kt]}function Gs(){return we.lFrame.selectedIndex}function Wi(n){we.lFrame.selectedIndex=n}function zD(){let n=we.lFrame;return hh(n.tView,n.selectedIndex)}function GD(){return we.lFrame.currentNamespace}var WD=!0;function wh(){return WD}function dl(n){WD=n}function Yy(n,e=null,t=null,r){let i=Lv(n,e,t,r);return i.resolveInjectorInitializers(),i}function Lv(n,e=null,t=null,r,i=new Set){let s=[t||Fn,pD(n)];return r=r||(typeof n=="object"?void 0:ei(n)),new ks(s,e||rl(),r||null,i)}var sn=class n{static THROW_IF_NOT_FOUND=Rs;static NULL=new Xc;static create(e,t){if(Array.isArray(e))return Yy({name:""},t,e,"");{let r=e.name??"";return Yy({name:r},e.parent,e.providers,r)}}static \u0275prov=H({token:n,providedIn:"any",factory:()=>W(hv)});static __NG_ELEMENT_ID__=-1},ct=new G(""),ir=(()=>{class n{static __NG_ELEMENT_ID__=r2;static __NG_ENV_ID__=t=>t}return n})(),Qy=class extends ir{_lView;constructor(e){super(),this._lView=e}get destroyed(){return zs(this._lView)}onDestroy(e){let t=this._lView;return Tv(t,e),()=>AD(t,e)}};function r2(){return new Qy(Ue())}var qD=!1,si=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new wt(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Ae(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}return n})(),Xy=class extends _t{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,vv()&&(this.destroyRef=V(ir,{optional:!0})??void 0,this.pendingTasks=V(si,{optional:!0})??void 0)}emit(e){let t=ye(null);try{super.next(e)}finally{ye(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof vt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},$e=Xy;function rh(...n){}function Fv(n){let e,t;function r(){n=rh;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function Vv(n){return queueMicrotask(()=>n()),()=>{n=rh}}var jv="isAngularZone",Jc=jv+"_ID",i2=0,dt=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new $e(!1);onMicrotaskEmpty=new $e(!1);onStable=new $e(!1);onError=new $e(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=qD}=e;if(typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,a2(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(jv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new $(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,s2,rh,rh);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},s2={};function Bv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function o2(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){Fv(()=>{n.callbackScheduled=!1,Jy(n),n.isCheckStableRunning=!0,Bv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Jy(n)}function a2(n){let e=()=>{o2(n)},t=i2++;n._inner=n._inner.fork({name:"angular",properties:{[jv]:!0,[Jc]:t,[Jc+t]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(c2(c))return r.invokeTask(s,o,a,c);try{return nD(n),r.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),rD(n)}},onInvoke:(r,i,s,o,a,c,l)=>{try{return nD(n),r.invoke(s,o,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!l2(c)&&e(),rD(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,Jy(n),Bv(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function Jy(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function nD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function rD(n){n._nesting--,Bv(n)}var Zc=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new $e;onMicrotaskEmpty=new $e;onStable=new $e;onError=new $e;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function c2(n){return KD(n,"__ignore_ng_zone__")}function l2(n){return KD(n,"__scheduler_tick__")}function KD(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var Er=class{_console=console;handleError(e){this._console.error("ERROR",e)}},$n=new G("",{factory:()=>{let n=V(dt),e=V(at),t;return r=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw r}):(t??=e.get(Er),t.handleError(r))})}}}),YD={provide:Vs,useValue:()=>{let n=V(Er,{optional:!0})},multi:!0},u2=new G("",{factory:()=>{let n=V(ct).defaultView;if(!n)return;let e=V($n),t=s=>{e(s.reason),s.preventDefault()},r=s=>{s.error?e(s.error):e(new Error(s.message,{cause:s})),s.preventDefault()},i=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",r)};typeof Zone<"u"?Zone.root.run(i):i(),V(ir).onDestroy(()=>{n.removeEventListener("error",r),n.removeEventListener("unhandledrejection",t)})}});function Uv(){return ri([fD(()=>void V(u2))])}function qi(n,e){let[t,r,i]=Ty(n,e?.equal),s=t,o=s[Ln];return s.set=r,s.update=i,s.asReadonly=QD.bind(s),s}function QD(){let n=this[Ln];if(n.readonlyFn===void 0){let e=()=>this();e[Ln]=n,n.readonlyFn=e}return n.readonlyFn}var Eh=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=d2}return n})();function d2(){return new Eh(Ue(),Hn())}var Ui=class{},hl=new G("",{factory:()=>!0});var Hv=new G(""),fl=(()=>{class n{internalPendingTasks=V(si);scheduler=V(Ui);errorHandler=V($n);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let r=this.add();t().catch(this.errorHandler).finally(r)}static \u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}return n})(),$v=(()=>{class n{static \u0275prov=H({token:n,providedIn:"root",factory:()=>new Zy})}return n})(),Zy=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}},ev=class{[Ln];constructor(e){this[Ln]=e}destroy(){this[Ln].destroy()}};function Tr(n){return Cy(n)}function El(n){return{toString:n}.toString()}function Tx(n){let e=Zn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function w2(n){return typeof n=="function"}function Cx(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var Dh=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}},Xs=(()=>{let n=()=>Sx;return n.ngInherit=!0,n})();function Sx(n){return n.type.prototype.ngOnChanges&&(n.setInput=b2),E2}function E2(){let n=xx(this),e=n?.current;if(e){let t=n.previous;if(t===Fs)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function b2(n,e,t,r,i){let s=this.declaredInputs[r],o=xx(n)||I2(n,{previous:Fs,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Dh(l&&l.currentValue,t,c===Fs),Cx(n,e,i,t)}var Dx="__ngSimpleChanges__";function xx(n){return n[Dx]||null}function I2(n,e){return n[Dx]=e}var XD=[];var Be=function(n,e=null,t){for(let r=0;r<XD.length;r++){let i=XD[r];i(n,e,t)}};function A2(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=Sx(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function Px(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),u!=null&&(n.destroyHooks??=[]).push(t,u)}}function Ah(n,e,t){Mx(n,e,3,t)}function Th(n,e,t,r){(n[oe]&3)===t&&Mx(n,e,t,r)}function zv(n,e){let t=n[oe];(t&3)===e&&(t&=16383,t+=1,n[oe]=t)}function Mx(n,e,t,r){let i=r!==void 0?n[Bs]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Bs]+=65536),(a<s||s==-1)&&(T2(n,t,e,c),n[Bs]=(n[Bs]&4294901760)+c+2),c++}function JD(n,e){Be(4,n,e);let t=ye(null);try{e.call(n)}finally{ye(t),Be(5,n,e)}}function T2(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[oe]>>14<n[Bs]>>16&&(n[oe]&3)===e&&(n[oe]+=16384,JD(a,s)):JD(a,s)}var ha=-1,ml=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function C2(n){return(n.flags&8)!==0}function S2(n){return(n.flags&16)!==0}function D2(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];P2(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function x2(n){return n===3||n===4||n===6}function P2(n){return n.charCodeAt(0)===64}function v_(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?ZD(n,t,i,null,e[++r]):ZD(n,t,i,null,null))}}return n}function ZD(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){i!==null&&(n[s+1]=i);return}s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),i!==null&&n.splice(s++,0,i)}function Rx(n){return n!==ha}function xh(n){return n&32767}function M2(n){return n>>16}function Ph(n,e){let t=M2(n),r=e;for(;t>0;)r=r[js],t--;return r}var Xv=!0;function ex(n){let e=Xv;return Xv=n,e}var R2=256,Nx=R2-1,Ox=5,N2=0,Cr={};function O2(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Ls)&&(r=t[Ls]),r==null&&(r=t[Ls]=N2++);let i=r&Nx,s=1<<i;e.data[n+(i>>Ox)]|=s}function kx(n,e){let t=Lx(n,e);if(t!==-1)return t;let r=e[ie];r.firstCreatePass&&(n.injectorIndex=e.length,Gv(r.data,n),Gv(e,null),Gv(r.blueprint,null));let i=__(n,e),s=n.injectorIndex;if(Rx(i)){let o=xh(i),a=Ph(i,e),c=a[ie].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Gv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Lx(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function __(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=Ux(i),r===null)return ha;if(t++,i=i[js],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return ha}function k2(n,e,t){O2(n,e,t)}function Fx(n,e,t){if(t&8||n!==void 0)return n;ch(e,"NodeInjector")}function Vx(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[Hi],s=In(void 0);try{return i?i.get(e,r,t&8):uv(e,r,t&8)}finally{In(s)}}return Fx(r,e,t)}function jx(n,e,t,r=0,i){if(n!==null){if(e[oe]&2048&&!(r&2)){let o=j2(n,e,t,r,Cr);if(o!==Cr)return o}let s=Bx(n,e,t,r,Cr);if(s!==Cr)return s}return Vx(e,t,r,i)}function Bx(n,e,t,r,i){let s=F2(t);if(typeof s=="function"){if(!Ov(e,n,r))return r&1?Fx(i,t,r):Vx(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&8))ch(t);else return o}finally{kv()}}else if(typeof s=="number"){let o=null,a=Lx(n,e),c=ha,l=r&1?e[Bn][jn]:null;for((a===-1||r&4)&&(c=a===-1?__(n,e):e[a+8],c===ha||!nx(r,!1)?a=-1:(o=e[ie],a=xh(c),e=Ph(c,e)));a!==-1;){let u=e[ie];if(tx(s,a,u.data)){let h=L2(a,e,t,o,r,l);if(h!==Cr)return h}c=e[a+8],c!==ha&&nx(r,e[ie].data[a+8]===l)&&tx(s,a,e)?(o=u,a=xh(c),e=Ph(c,e)):a=-1}}return i}function L2(n,e,t,r,i,s){let o=e[ie],a=o.data[n+8],c=r==null?Gi(a)&&Xv:r!=o&&(a.type&3)!==0,l=i&1&&s===a,u=Ch(a,o,t,c,l);return u!==null?Mh(e,o,u,a,i):Cr}function Ch(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,u=s>>20,h=r?a:a+u,f=i?a+u:l;for(let p=h;p<f;p++){let m=o[p];if(p<c&&t===m||p>=c&&m.type===t)return p}if(i){let p=o[c];if(p&&$s(p)&&p.type===t)return c}return null}function Mh(n,e,t,r,i){let s=n[t],o=e.data;if(s instanceof ml){let a=s;if(a.resolving){let p=iD(o[t]);throw lv(p)}let c=ex(a.canSeeViewProviders);a.resolving=!0;let l=o[t].type||o[t],u,h=a.injectImpl?In(a.injectImpl):null,f=Ov(n,r,0);try{s=n[t]=a.factory(void 0,i,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&A2(t,o[t],e)}finally{h!==null&&In(h),ex(c),a.resolving=!1,kv()}}return s}function F2(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Ls)?n[Ls]:void 0;return typeof e=="number"?e>=0?e&Nx:V2:e}function tx(n,e,t){let r=1<<n;return!!(t[e+(n>>Ox)]&r)}function nx(n,e){return!(n&2)&&!(n&1&&e)}var Ws=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return jx(this._tNode,this._lView,e,Ns(r),t)}};function V2(){return new Ws(Hn(),Ue())}function bl(n){return El(()=>{let e=n.prototype.constructor,t=e[Qc]||Jv(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Qc]||Jv(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Jv(n){return nv(n)?()=>{let e=Jv(pn(n));return e&&e()}:Os(n)}function j2(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[oe]&2048&&!ca(o);){let a=Bx(s,o,t,r|2,Cr);if(a!==Cr)return a;let c=s.parent;if(!c){let l=o[wv];if(l){let u=l.get(t,Cr,r);if(u!==Cr)return u}c=Ux(o),o=o[js]}s=c}return i}function Ux(n){let e=n[ie],t=e.type;return t===2?e.declTNode:t===1?n[jn]:null}function B2(){return ma(Hn(),Ue())}function ma(n,e){return new Dr(Ar(n,e))}var Dr=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=B2}return n})();function U2(n){return n instanceof Dr?n.nativeElement:n}function H2(){return this._results[Symbol.iterator]()}var Rh=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new _t}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let r=lD(e);(this._changesDetected=!cD(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=H2};function Hx(n){return(n.flags&128)===128}var w_=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(w_||{}),$x=new Map,$2=0;function z2(){return $2++}function G2(n){$x.set(n[sl],n)}function Zv(n){$x.delete(n[sl])}var rx="__ngContext__";function fa(n,e){ii(e)?(n[rx]=e[sl],G2(e)):n[rx]=e}function zx(n){return Wx(n[oa])}function Gx(n){return Wx(n[Vn])}function Wx(n){for(;n!==null&&!tr(n);)n=n[Vn];return n}var e_;function E_(n){e_=n}function qx(){if(e_!==void 0)return e_;if(typeof document<"u")return document;throw new $(210,!1)}var Uh=new G("",{factory:()=>W2}),W2="ng";var Hh=new G(""),Il=new G("",{providedIn:"platform",factory:()=>"unknown"});var $h=new G("",{factory:()=>qx().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Kx=!1,Yx=new G("",{factory:()=>Kx});var b_=new G("");var q2=(n,e,t,r)=>{};function K2(n,e,t,r){q2(n,e,t,r)}function I_(n){return(n.flags&32)===32}var Y2=()=>null;function Qx(n,e,t=!1){return Y2(n,e,t)}function Xx(n,e){let t=n.contentQueries;if(t!==null){let r=ye(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];yh(s),a.contentQueries(2,e[o],o)}}}finally{ye(r)}}}function t_(n,e,t){yh(0);let r=ye(null);try{e(n,t)}finally{ye(r)}}function A_(n,e,t){if(Ev(e)){let r=ye(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{ye(r)}}}var or=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(or||{});var Nh=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ih})`}};function zh(n){return n instanceof Nh?n.changingThisBreaksApplicationSecurity:n}function Jx(n,e){let t=Zx(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${ih})`)}return t===e}function Zx(n){return n instanceof Nh&&n.getTypeName()||null}var Q2=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function eP(n){return n=String(n),n.match(Q2)?n:"unsafe:"+n}var T_=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(T_||{});function Js(n){let e=X2();return e?e.sanitize(T_.URL,n)||"":Jx(n,"URL")?zh(n):eP(ah(n))}function X2(){let n=Ue();return n&&n[br].sanitizer}var J2=/^>|^->|<!--|-->|--!>|<!-$/g,Z2=/(<|>)/g,ej="\u200B$1\u200B";function tj(n){return n.replace(J2,e=>e.replace(Z2,ej))}function tP(n){return n instanceof Function?n():n}function nj(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}var nP="ng-template";function rj(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&nj(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(C_(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function C_(n){return n.type===4&&n.value!==nP}function ij(n,e,t){let r=n.type===4&&!t?nP:n.value;return e===r}function sj(n,e,t){let r=4,i=n.attrs,s=i!==null?cj(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!sr(r)&&!sr(c))return!1;if(o&&sr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!ij(n,c,t)||c===""&&e.length===1){if(sr(r))return!1;o=!0}}else if(r&8){if(i===null||!rj(n,i,c,t)){if(sr(r))return!1;o=!0}}else{let l=e[++a],u=oj(c,i,C_(n),t);if(u===-1){if(sr(r))return!1;o=!0;continue}if(l!==""){let h;if(u>s?h="":h=i[u+1].toLowerCase(),r&2&&l!==h){if(sr(r))return!1;o=!0}}}}return sr(r)||o}function sr(n){return(n&1)===0}function oj(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return lj(e,n)}function aj(n,e,t=!1){for(let r=0;r<e.length;r++)if(sj(n,e[r],t))return!0;return!1}function cj(n){for(let e=0;e<n.length;e++){let t=n[e];if(x2(t))return e}return n.length}function lj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function ix(n,e){return n?":not("+e.trim()+")":e}function uj(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!sr(o)&&(e+=ix(s,i),i=""),r=o,s=s||!sr(r);t++}return i!==""&&(e+=ix(s,i)),e}function dj(n){return n.map(uj).join(",")}function hj(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!sr(i))break;i=s}r++}return t.length&&e.push(1,...t),e}var Qi={};function fj(n,e){return n.createText(e)}function pj(n,e,t){n.setValue(e,t)}function gj(n,e){return n.createComment(tj(e))}function rP(n,e,t){return n.createElement(e,t)}function Oh(n,e,t,r,i){n.insertBefore(e,t,r,i)}function iP(n,e,t){n.appendChild(e,t)}function sx(n,e,t,r,i){r!==null?Oh(n,e,t,r,i):iP(n,e,t)}function mj(n,e,t,r){n.removeChild(null,e,t,r)}function yj(n,e,t){n.setAttribute(e,"style",t)}function vj(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function sP(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&D2(n,e,r),i!==null&&vj(n,e,i),s!==null&&yj(n,e,s)}function S_(n,e,t,r,i,s,o,a,c,l,u){let h=gn+r,f=h+i,p=_j(h,f),m=typeof l=="function"?l():l;return p[ie]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:m,incompleteFirstPass:!1,ssrId:u}}function _j(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Qi);return t}function wj(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=S_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function D_(n,e,t,r,i,s,o,a,c,l,u){let h=e.blueprint.slice();return h[er]=i,h[oe]=r|4|128|8|64|1024,(l!==null||n&&n[oe]&2048)&&(h[oe]|=2048),Iv(h),h[Dt]=h[js]=n,h[Kt]=t,h[br]=o||n&&n[br],h[bt]=a||n&&n[bt],h[Hi]=c||n&&n[Hi]||null,h[jn]=s,h[sl]=z2(),h[il]=u,h[wv]=l,h[Bn]=e.type==2?n[Bn]:h,h}function Ej(n,e,t){let r=Ar(e,n),i=wj(t),s=n[br].rendererFactory,o=x_(n,D_(n,i,null,oP(t),r,e,null,s.createRenderer(r,t),null,null,null));return n[e.index]=o}function oP(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function aP(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function x_(n,e){return n[oa]?n[_v][Vn]=e:n[oa]=e,n[_v]=e,e}function fe(n=1){cP(rr(),Ue(),Gs()+n,!1)}function cP(n,e,t,r){if(!r)if((e[oe]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Ah(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Th(e,s,0,t)}Wi(t)}var Gh=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Gh||{});function n_(n,e,t,r){let i=ye(null);try{let[s,o,a]=n.inputs[t],c=null;(o&Gh.SignalBased)!==0&&(c=e[s][Ln]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,s):Cx(e,c,s,r)}finally{ye(i)}}var Sr=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Sr||{}),bj;function P_(n,e){return bj(n,e)}var pa=new Set,Wh=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Wh||{}),oi=new G(""),ox=new Set;function ya(n){ox.has(n)||(ox.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var M_=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}return n})(),lP=[0,1,2,3],uP=(()=>{class n{ngZone=V(dt);scheduler=V(Ui);errorHandler=V(Er,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){V(oi,{optional:!0})}execute(){let t=this.sequences.size>0;t&&Be(16),this.executing=!0;for(let r of lP)for(let i of this.sequences)if(!(i.erroredOrDestroyed||!i.hooks[r]))try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let s=i.hooks[r];return s(i.pipelinedValue)},i.snapshot))}catch(s){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(s)}this.executing=!1;for(let r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(let r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&Be(17)}register(t){let{view:r}=t;r!==void 0?((r[Us]??=[]).push(t),la(r),r[oe]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,r){return r?r.run(Wh.AFTER_NEXT_RENDER,t):t()}static \u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}return n})(),kh=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,r,i,s,o=null){this.impl=e,this.hooks=t,this.view=r,this.once=i,this.snapshot=o,this.unregisterOnDestroy=s?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Us];e&&(this.view[Us]=e.filter(t=>t!==this))}};function R_(n,e){let t=e?.injector??V(sn);return ya("NgAfterNextRender"),Aj(n,t,e,!0)}function Ij(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function Aj(n,e,t,r){let i=e.get(M_);i.impl??=e.get(uP);let s=e.get(oi,null,{optional:!0}),o=t?.manualCleanup!==!0?e.get(ir):null,a=e.get(Eh,null,{optional:!0}),c=new kh(i.impl,Ij(n),a?.view,r,o,s?.snapshot(null));return i.impl.register(c),c}var Tj=new G("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function dP(n,e,t){let r=n.get(Tj);if(Array.isArray(e))for(let i of e)r.queue.add(i),t?.detachedLeaveAnimationFns?.push(i);else r.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(n)}function Cj(n,e){for(let[t,r]of e)dP(n,r.animateFns)}function ax(n,e,t,r){let i=n?.[al]?.enter;e!==null&&i&&i.has(t.index)&&Cj(r,i)}function da(n,e,t,r,i,s,o,a){if(i!=null){let c,l=!1;tr(i)?c=i:ii(i)&&(l=!0,i=i[er]);let u=Un(i);n===0&&r!==null?(ax(a,r,s,t),o==null?iP(e,r,u):Oh(e,r,u,o||null,!0)):n===1&&r!==null?(ax(a,r,s,t),Oh(e,r,u,o||null,!0)):n===2?cx(a,s,t,h=>{mj(e,u,l,h)}):n===3&&cx(a,s,t,()=>{e.destroyNode(u)}),c!=null&&jj(e,n,t,c,s,r,o)}}function Sj(n,e){hP(n,e),e[er]=null,e[jn]=null}function Dj(n,e,t,r,i,s){r[er]=i,r[jn]=e,qh(n,r,t,1,i,s)}function hP(n,e){e[br].changeDetectionScheduler?.notify(9),qh(n,e,e[bt],2,null,null)}function xj(n){let e=n[oa];if(!e)return Wv(n[ie],n);for(;e;){let t=null;if(ii(e))t=e[oa];else{let r=e[on];r&&(t=r)}if(!t){for(;e&&!e[Vn]&&e!==n;)ii(e)&&Wv(e[ie],e),e=e[Dt];e===null&&(e=n),ii(e)&&Wv(e[ie],e),t=e&&e[Vn]}e=t}}function N_(n,e){let t=n[Hs],r=t.indexOf(e);t.splice(r,1)}function fP(n,e){if(zs(e))return;let t=e[bt];t.destroyNode&&qh(n,e,t,3,null,null),xj(e)}function Wv(n,e){if(zs(e))return;let t=ye(null);try{e[oe]&=-129,e[oe]|=256,e[An]&&zc(e[An]),Rj(n,e),Mj(n,e),e[ie].type===1&&e[bt].destroy();let r=e[$i];if(r!==null&&tr(e[Dt])){r!==e[Dt]&&N_(r,e);let i=e[Ir];i!==null&&i.detachView(n)}Zv(e)}finally{ye(t)}}function cx(n,e,t,r){let i=n?.[al];if(i==null||i.leave==null||!i.leave.has(e.index))return r(!1);n&&pa.add(n),dP(t,()=>{if(i.leave&&i.leave.has(e.index)){let o=i.leave.get(e.index),a=[];if(o){for(let c=0;c<o.animateFns.length;c++){let l=o.animateFns[c],{promise:u}=l();a.push(u)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(a),Pj(n,r)}else n&&pa.delete(n),r(!1)},i)}function Pj(n,e){let t=n[al]?.running;if(t){t.then(()=>{n[al].running=void 0,pa.delete(n),e(!0)});return}e(!1)}function Mj(n,e){let t=n.cleanup,r=e[sa];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let a=t[o+3];a>=0?r[a]():r[-a].unsubscribe(),o+=2}else{let a=r[t[o+1]];t[o].call(a)}r!==null&&(e[sa]=null);let i=e[Zr];if(i!==null){e[Zr]=null;for(let o=0;o<i.length;o++){let a=i[o];a()}}let s=e[ol];if(s!==null){e[ol]=null;for(let o of s)o.destroy()}}function Rj(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ml)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Be(4,a,c);try{c.call(a)}finally{Be(5,a,c)}}else{Be(4,i,s);try{s.call(i)}finally{Be(5,i,s)}}}}}function Nj(n,e,t){return Oj(n,e.parent,t)}function Oj(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[er];if(Gi(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===or.None||i===or.Emulated)return null}return Ar(r,t)}function kj(n,e,t){return Fj(n,e,t)}function Lj(n,e,t){return n.type&40?Ar(n,t):null}var Fj=Lj,lx;function O_(n,e,t,r){let i=Nj(n,r,e),s=e[bt],o=r.parent||e[jn],a=kj(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)sx(s,i,t[c],a,!1);else sx(s,i,t,a,!1);lx!==void 0&&lx(s,r,e,t,i)}function pl(n,e){if(e!==null){let t=e.type;if(t&3)return Ar(e,n);if(t&4)return r_(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return pl(n,r);{let i=n[e.index];return tr(i)?r_(-1,i):Un(i)}}else{if(t&128)return pl(n,e.next);if(t&32)return P_(e,n)()||Un(n[e.index]);{let r=pP(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Bi(n[Bn]);return pl(i,r)}else return pl(n,e.next)}}}return null}function pP(n,e){if(e!==null){let r=n[Bn][jn],i=e.projection;return r.projection[i]}return null}function r_(n,e){let t=on+n+1;if(t<e.length){let r=e[t],i=r[ie].firstChild;if(i!==null)return pl(r,i)}return e[zi]}function k_(n,e,t,r,i,s,o){for(;t!=null;){let a=r[Hi];if(t.type===128){t=t.next;continue}let c=r[t.index],l=t.type;if(o&&e===0&&(c&&fa(Un(c),r),t.flags|=2),!I_(t))if(l&8)k_(n,e,t.child,r,i,s,!1),da(e,n,a,i,c,t,s,r);else if(l&32){let u=P_(t,r),h;for(;h=u();)da(e,n,a,i,h,t,s,r);da(e,n,a,i,c,t,s,r)}else l&16?Vj(n,e,r,t,i,s):da(e,n,a,i,c,t,s,r);t=o?t.projectionNext:t.next}}function qh(n,e,t,r,i,s){k_(t,r,n.firstChild,e,i,s,!1)}function Vj(n,e,t,r,i,s){let o=t[Bn],c=o[jn].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];da(e,n,t[Hi],i,u,r,s,t)}else{let l=c,u=o[Dt];Hx(r)&&(l.flags|=128),k_(n,e,l,u,i,s,!0)}}function jj(n,e,t,r,i,s,o){let a=r[zi],c=Un(r);a!==c&&da(e,n,t,s,a,i,o);for(let l=on;l<r.length;l++){let u=r[l];qh(u[ie],u,n,e,s,a)}}function Bj(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Sr.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Sr.Important),n.setStyle(t,r,i,s))}}function gP(n,e,t,r,i){let s=Gs(),o=r&2;try{Wi(-1),o&&e.length>gn&&cP(n,e,gn,!1),Be(o?2:0,i,t),t(r,i)}finally{Wi(s),Be(o?3:1,i,t)}}function Kh(n,e,t){Kj(n,e,t),(t.flags&64)===64&&Yj(n,e,t)}function L_(n,e,t=Ar){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function Uj(n,e,t,r){let s=r.get(Yx,Kx)||t===or.ShadowDom||t===or.ExperimentalIsolatedShadowDom,o=n.selectRootElement(e,s);return Hj(o),o}function Hj(n){$j(n)}var $j=()=>null;function zj(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function Gj(n,e,t,r,i,s){let o=e[ie];if(V_(n,o,e,t,r)){Gi(n)&&qj(e,n.index);return}n.type&3&&(t=zj(t)),Wj(n,e,t,r,i,s)}function Wj(n,e,t,r,i,s){if(n.type&3){let o=Ar(n,e);r=s!=null?s(r,n.value||"",t):r,i.setProperty(o,t,r)}else n.type&12}function qj(n,e){let t=nr(e,n);t[oe]&16||(t[oe]|=64)}function Kj(n,e,t){let r=t.directiveStart,i=t.directiveEnd;Gi(t)&&Ej(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||kx(t,e);let s=t.initialInputs;for(let o=r;o<i;o++){let a=n.data[o],c=Mh(e,n,o,t);if(fa(c,e),s!==null&&Xj(e,o-r,c,a,t,s),$s(a)){let l=nr(t.index,e);l[Kt]=Mh(e,n,o,t)}}}function Yj(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=VD();try{Wi(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];mh(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&Qj(c,l)}}finally{Wi(-1),mh(o)}}function Qj(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function F_(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let s=t[i];aj(e,s.selectors,!1)&&(r??=[],$s(s)?r.unshift(s):r.push(s))}return r}function Xj(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;a+=2){let c=o[a],l=o[a+1];n_(r,t,c,l)}}function mP(n,e,t,r,i){let s=gn+t,o=e[ie],a=i(o,e,n,r,t);e[s]=a,ua(n,!0);let c=n.type===2;return c?(sP(e[bt],a,n),(CD()===0||aa(n))&&fa(a,e),SD()):fa(a,e),wh()&&(!c||!I_(n))&&O_(o,e,a,n),n}function yP(n){let e=n;return xv()?ND():(e=e.parent,ua(e,!1)),e}function Jj(n,e){let t=n[Hi];if(!t)return;let r;try{r=t.get($n,null)}catch{r=null}r?.(e)}function V_(n,e,t,r,i){let s=n.inputs?.[r],o=n.hostDirectiveInputs?.[r],a=!1;if(o)for(let c=0;c<o.length;c+=2){let l=o[c],u=o[c+1],h=e.data[l];n_(h,t[l],u,i),a=!0}if(s)for(let c of s){let l=t[c],u=e.data[c];n_(u,l,r,i),a=!0}return a}function Zj(n,e){let t=nr(e,n),r=t[ie];eB(r,t);let i=t[er];i!==null&&t[il]===null&&(t[il]=Qx(i,t[Hi])),Be(18),j_(r,t,t[Kt]),Be(19,t[Kt])}function eB(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function j_(n,e,t){vh(e);try{let r=n.viewQuery;r!==null&&t_(1,r,t);let i=n.template;i!==null&&gP(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ir]?.finishViewCreation(n),n.staticContentQueries&&Xx(n,e),n.staticViewQueries&&t_(2,n.viewQuery,t);let s=n.components;s!==null&&tB(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[oe]&=-5,_h()}}function tB(n,e){for(let t=0;t<e.length;t++)Zj(n,e[t])}function nB(n,e,t,r){let i=ye(null);try{let s=e.tView,a=n[oe]&4096?4096:16,c=D_(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[$i]=l;let u=n[Ir];return u!==null&&(c[Ir]=u.createEmbeddedView(s)),j_(s,c,t),c}finally{ye(i)}}function ux(n,e){return!e||e.firstChild===null||Hx(n)}function yl(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&r.push(Un(s)),tr(s)&&vP(s,r);let o=t.type;if(o&8)yl(n,e,t.child,r);else if(o&32){let a=P_(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=pP(e,t);if(Array.isArray(a))r.push(...a);else{let c=Bi(e[Bn]);yl(c[ie],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function vP(n,e){for(let t=on;t<n.length;t++){let r=n[t],i=r[ie].firstChild;i!==null&&yl(r[ie],r,i,e)}n[zi]!==n[er]&&e.push(n[zi])}function _P(n){if(n[Us]!==null){for(let e of n[Us])e.impl.addSequence(e);n[Us].length=0}}var wP=[];function rB(n){return n[An]??iB(n)}function iB(n){let e=wP.pop()??Object.create(oB);return e.lView=n,e}function sB(n){n.lView[An]!==n&&(n.lView=null,wP.push(n))}var oB=J(L({},Ad),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{la(n.lView)},consumerOnSignalRead(){this.lView[An]=this}});function aB(n){let e=n[An]??Object.create(cB);return e.lView=n,e}var cB=J(L({},Ad),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Bi(n.lView);for(;e&&!EP(e[ie]);)e=Bi(e);e&&Av(e)},consumerOnSignalRead(){this.lView[An]=this}});function EP(n){return n.type!==2}function bP(n){if(n[ol]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[ol])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[oe]&8192)}}var lB=100;function IP(n,e=0){let r=n[br].rendererFactory,i=!1;i||r.begin?.();try{uB(n,e)}finally{i||r.end?.()}}function uB(n,e){let t=Pv();try{Mv(!0),i_(n,e);let r=0;for(;ul(n);){if(r===lB)throw new $(103,!1);r++,i_(n,1)}}finally{Mv(t)}}function dB(n,e,t,r){if(zs(e))return;let i=e[oe],s=!1,o=!1;vh(e);let a=!0,c=null,l=null;s||(EP(n)?(l=rB(e),c=Cd(l)):Id()===null?(a=!1,l=aB(e),c=Cd(l)):e[An]&&(zc(e[An]),e[An]=null));try{Iv(e),OD(n.bindingStartIndex),t!==null&&gP(n,e,t,2,r);let u=(i&3)===3;if(!s)if(u){let p=n.preOrderCheckHooks;p!==null&&Ah(e,p,null)}else{let p=n.preOrderHooks;p!==null&&Th(e,p,0,null),zv(e,0)}if(o||hB(e),bP(e),AP(e,0),n.contentQueries!==null&&Xx(n,e),!s)if(u){let p=n.contentCheckHooks;p!==null&&Ah(e,p)}else{let p=n.contentHooks;p!==null&&Th(e,p,1),zv(e,1)}pB(n,e);let h=n.components;h!==null&&CP(e,h,0);let f=n.viewQuery;if(f!==null&&t_(2,f,r),!s)if(u){let p=n.viewCheckHooks;p!==null&&Ah(e,p)}else{let p=n.viewHooks;p!==null&&Th(e,p,2),zv(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[dh]){for(let p of e[dh])p();e[dh]=null}s||(_P(e),e[oe]&=-73)}catch(u){throw s||la(e),u}finally{l!==null&&(by(l,c),a&&sB(l)),_h()}}function AP(n,e){for(let t=zx(n);t!==null;t=Gx(t))for(let r=on;r<t.length;r++){let i=t[r];TP(i,e)}}function hB(n){for(let e=zx(n);e!==null;e=Gx(e)){if(!(e[oe]&2))continue;let t=e[Hs];for(let r=0;r<t.length;r++){let i=t[r];Av(i)}}}function fB(n,e,t){Be(18);let r=nr(e,n);TP(r,t),Be(19,r[Kt])}function TP(n,e){fh(n)&&i_(n,e)}function i_(n,e){let r=n[ie],i=n[oe],s=n[An],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Sd(s)),o||=!1,s&&(s.dirty=!1),n[oe]&=-9217,o)dB(r,n,r.template,n[Kt]);else if(i&8192){let a=ye(null);try{bP(n),AP(n,1);let c=r.components;c!==null&&CP(n,c,1),_P(n)}finally{ye(a)}}}function CP(n,e,t){for(let r=0;r<e.length;r++)fB(n,e[r],t)}function pB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Wi(~i);else{let s=i,o=t[++r],a=t[++r];FD(o,s);let c=e[s];Be(24,c),a(2,c),Be(25,c)}}}finally{Wi(-1)}}function B_(n,e){let t=Pv()?64:1088;for(n[br].changeDetectionScheduler?.notify(e);n;){n[oe]|=t;let r=Bi(n);if(ca(n)&&!r)return n;n=r}return null}function SP(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function gB(n,e,t,r=!0){let i=e[ie];if(mB(i,e,n,t),r){let o=r_(t,n),a=e[bt],c=a.parentNode(n[zi]);c!==null&&Dj(i,n[jn],a,e,c,o)}let s=e[il];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function s_(n,e){if(n.length<=on)return;let t=on+e,r=n[t];if(r){let i=r[$i];i!==null&&i!==n&&N_(i,r),e>0&&(n[t-1][Vn]=r[Vn]);let s=tl(n,on+e);Sj(r[ie],r);let o=s[Ir];o!==null&&o.detachView(s[ie]),r[Dt]=null,r[Vn]=null,r[oe]&=-129}return r}function mB(n,e,t,r){let i=on+r,s=t.length;r>0&&(t[i-1][Vn]=e),r<s-on?(e[Vn]=t[i],dv(t,on+r,e)):(t.push(e),e[Vn]=null),e[Dt]=t;let o=e[$i];o!==null&&t!==o&&DP(o,e);let a=e[Ir];a!==null&&a.insertView(n),ph(e),e[oe]|=128}function DP(n,e){let t=n[Hs],r=e[Dt];if(ii(r))n[oe]|=2;else{let i=r[Dt][Bn];e[Bn]!==i&&(n[oe]|=2)}t===null?n[Hs]=[e]:t.push(e)}var Ki=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[ie];return yl(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Kt]}set context(e){this._lView[Kt]=e}get destroyed(){return zs(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Dt];if(tr(e)){let t=e[cl],r=t?t.indexOf(this):-1;r>-1&&(s_(e,r),tl(t,r))}this._attachedToViewContainer=!1}fP(this._lView[ie],this._lView)}onDestroy(e){Tv(this._lView,e)}markForCheck(){B_(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[oe]&=-129}reattach(){ph(this._lView),this._lView[oe]|=128}detectChanges(){this._lView[oe]|=1024,IP(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=ca(this._lView),t=this._lView[$i];t!==null&&!e&&N_(t,this._lView),hP(this._lView[ie],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e;let t=ca(this._lView),r=this._lView[$i];r!==null&&!t&&DP(r,this._lView),ph(this._lView)}};var Yi=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=yB;constructor(t,r,i){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,i){let s=nB(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:i});return new Ki(s)}}return n})();function yB(){return U_(Hn(),Ue())}function U_(n,e){return n.type&4?new Yi(e,n,ma(n,e)):null}function H_(n,e,t,r,i){let s=n.data[e];if(s===null)s=vB(n,e,t,r,i),LD()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=RD();s.injectorIndex=o===null?-1:o.injectorIndex}return ua(s,!0),s}function vB(n,e,t,r,i){let s=Dv(),o=xv(),a=o?s:s&&s.parent,c=n.data[e]=wB(n,a,t,e,r,i);return _B(n,c,s,o),c}function _B(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function wB(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return xD()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var EB=()=>null;function dx(n,e){return EB(n,e)}var xP=class{},Yh=class{},o_=class{resolveComponentFactory(e){throw new $(917,!1)}},Al=class{static NULL=new o_},qs=class{};var PP=(()=>{class n{static \u0275prov=H({token:n,providedIn:"root",factory:()=>null})}return n})();var Sh={},a_=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,Sh,r);return i!==Sh||t===Sh?i:this.parentInjector.get(e,t,r)}};function hx(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=tv(i,a);else if(s==2){let c=a,l=e[++o];r=tv(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function tt(n,e=0){let t=Ue();if(t===null)return W(n,e);let r=Hn();return jx(r,t,pn(n),e)}function $_(){let n="invalid";throw new Error(n)}function MP(n,e,t,r,i){let s=r===null?null:{"":-1},o=i(n,t);if(o!==null){let a=o,c=null,l=null;for(let u of o)if(u.resolveHostDirectives!==null){[a,c,l]=u.resolveHostDirectives(o);break}AB(n,e,t,a,s,c,l)}s!==null&&r!==null&&bB(t,r,s)}function bB(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}function IB(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function AB(n,e,t,r,i,s,o){let a=r.length,c=!1;for(let f=0;f<a;f++){let p=r[f];!c&&$s(p)&&(c=!0,IB(n,t,f)),k2(kx(t,e),n,p.type)}PB(t,n.data.length,a);for(let f=0;f<a;f++){let p=r[f];p.providersResolver&&p.providersResolver(p)}let l=!1,u=!1,h=aP(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let f=0;f<a;f++){let p=r[f];if(t.mergedAttrs=v_(t.mergedAttrs,p.hostAttrs),CB(n,t,e,h,p),xB(h,p,i),o!==null&&o.has(p)){let[v,w]=o.get(p);t.directiveToIndex.set(p.type,[h,v+t.directiveStart,w+t.directiveStart])}else(s===null||!s.has(p))&&t.directiveToIndex.set(p.type,h);p.contentQueries!==null&&(t.flags|=4),(p.hostBindings!==null||p.hostAttrs!==null||p.hostVars!==0)&&(t.flags|=64);let m=p.type.prototype;!l&&(m.ngOnChanges||m.ngOnInit||m.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!u&&(m.ngOnChanges||m.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),u=!0),h++}TB(n,t,s)}function TB(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))fx(0,e,i,r),fx(1,e,i,r),gx(e,r,!1);else{let s=t.get(i);px(0,e,s,r),px(1,e,s,r),gx(e,r,!0)}}}function fx(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o;n===0?o=e.inputs??={}:o=e.outputs??={},o[s]??=[],o[s].push(r),RP(e,s)}}function px(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o=i[s],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[o]??=[],a[o].push(r,s),RP(e,o)}}function RP(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function gx(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:s}=n;if(r===null||!t&&i===null||t&&s===null||C_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let o=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let l=i[c];for(let u of l)if(u===e){o??=[],o.push(c,r[a+1]);break}}else if(t&&s.hasOwnProperty(c)){let l=s[c];for(let u=0;u<l.length;u+=2)if(l[u]===e){o??=[],o.push(l[u+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(o)}function CB(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Os(i.type,!0)),o=new ml(s,$s(i),tt,null);n.blueprint[r]=o,t[r]=o,SB(n,e,r,aP(n,t,i.hostVars,Qi),i)}function SB(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;DB(o)!=a&&o.push(a),o.push(t,r,s)}}function DB(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function xB(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;$s(e)&&(t[""]=n)}}function PB(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function z_(n,e,t,r,i,s,o,a){let c=e[ie],l=c.consts,u=ll(l,o),h=H_(c,n,t,r,u);return s&&MP(c,e,h,ll(l,a),i),h.mergedAttrs=v_(h.mergedAttrs,h.attrs),h.attrs!==null&&hx(h,h.attrs,!1),h.mergedAttrs!==null&&hx(h,h.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,h),h}function G_(n,e){Px(n,e),Ev(e)&&n.queries.elementEnd(e)}function W_(n){return OP(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function NP(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function OP(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function q_(n,e,t){if(t===Qi)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function qv(n,e,t){return function r(i){let s=Gi(n)?nr(n.index,e):e;B_(s,5);let o=e[Kt],a=mx(e,o,t,i),c=r.__ngNextListenerFn__;for(;c;)a=mx(e,o,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function mx(n,e,t,r){let i=ye(null);try{return Be(6,e,t),t(r)!==!1}catch(s){return Jj(n,s),!1}finally{Be(7,e,t),ye(i)}}function MB(n,e,t,r,i,s,o,a){let c=aa(n),l=!1,u=null;if(!r&&c&&(u=NB(e,t,s,n.index)),u!==null){let h=u.__ngLastListenerFn__||u;h.__ngNextListenerFn__=o,u.__ngLastListenerFn__=o,l=!0}else{let h=Ar(n,t),f=r?r(h):h;K2(t,f,s,a);let p=i.listen(f,s,a);if(!RB(s)){let m=r?v=>r(Un(v[n.index])):n.index;kP(m,e,t,s,a,p,!1)}}return l}function RB(n){return n.startsWith("animation")||n.startsWith("transition")}function NB(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[sa],c=i[s+2];return a&&a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function kP(n,e,t,r,i,s,o){let a=e.firstCreatePass?Sv(e):null,c=Cv(t),l=c.length;c.push(i,s),a&&a.push(r,n,l,(l+1)*(o?-1:1))}function yx(n,e,t,r,i,s){let o=e[t],a=e[ie],l=a.data[t].outputs[r],h=o[l].subscribe(s);kP(n.index,a,e,i,s,h,!0)}var c_=Symbol("BINDING");var Lh=class extends Al{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ni(e);return new Ks(t,this.ngModule)}};function OB(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],s={propName:t,templateName:e,isSignal:(r&Gh.SignalBased)!==0};return i&&(s.transform=i),s})}function kB(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function LB(n,e,t){let r=e instanceof at?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new a_(t,r):t}function FB(n){let e=n.get(qs,null);if(e===null)throw new $(407,!1);let t=n.get(PP,null),r=n.get(Ui,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function VB(n,e){let t=LP(n);return rP(e,t,t==="svg"?_D:t==="math"?wD:null)}function LP(n){return(n.selectors[0][0]||"div").toLowerCase()}var Ks=class extends Yh{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=OB(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=kB(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=dj(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,s,o){Be(22);let a=ye(null);try{let c=this.componentDef,l=jB(r,c,o,s),u=LB(c,i||this.ngModule,e),h=FB(u),f=h.rendererFactory.createRenderer(null,c),p=r?Uj(f,r,c.encapsulation,u):VB(c,f),m=o?.some(vx)||s?.some(I=>typeof I!="function"&&I.bindings.some(vx)),v=D_(null,l,null,512|oP(c),null,null,h,f,u,null,Qx(p,u,!0));v[gn]=p,vh(v);let w=null;try{let I=z_(gn,v,2,"#host",()=>l.directiveRegistry,!0,0);sP(f,p,I),fa(p,v),Kh(l,v,I),A_(l,I,v),G_(l,I),t!==void 0&&UB(I,this.ngContentSelectors,t),w=nr(I.index,v),v[Kt]=w[Kt],j_(l,v,null)}catch(I){throw w!==null&&Zv(w),Zv(v),I}finally{Be(23),_h()}return new Fh(this.componentType,v,!!m)}finally{ye(a)}}};function jB(n,e,t,r){let i=n?["ng-version","21.0.0"]:hj(e.selectors[0]),s=null,o=null,a=0;if(t)for(let u of t)a+=u[c_].requiredVars,u.create&&(u.targetIdx=0,(s??=[]).push(u)),u.update&&(u.targetIdx=0,(o??=[]).push(u));if(r)for(let u=0;u<r.length;u++){let h=r[u];if(typeof h!="function")for(let f of h.bindings){a+=f[c_].requiredVars;let p=u+1;f.create&&(f.targetIdx=p,(s??=[]).push(f)),f.update&&(f.targetIdx=p,(o??=[]).push(f))}}let c=[e];if(r)for(let u of r){let h=typeof u=="function"?u:u.type,f=gv(h);c.push(f)}return S_(0,null,BB(s,o),1,a,c,null,null,null,[i],null)}function BB(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function vx(n){let e=n[c_].kind;return e==="input"||e==="twoWay"}var Fh=class extends xP{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=hh(t[ie],gn),this.location=ma(this._tNode,t),this.instance=nr(this._tNode.index,t)[Kt],this.hostView=this.changeDetectorRef=new Ki(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,s=V_(r,i[ie],i,e,t);this.previousInputValues.set(e,t);let o=nr(r.index,i);B_(o,1)}get injector(){return new Ws(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function UB(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null&&s.length?Array.from(s):null)}}var ai=(()=>{class n{static __NG_ELEMENT_ID__=HB}return n})();function HB(){let n=Hn();return VP(n,Ue())}var $B=ai,FP=class extends $B{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return ma(this._hostTNode,this._hostLView)}get injector(){return new Ws(this._hostTNode,this._hostLView)}get parentInjector(){let e=__(this._hostTNode,this._hostLView);if(Rx(e)){let t=Ph(e,this._hostLView),r=xh(e),i=t[ie].data[r+8];return new Ws(i,t)}else return new Ws(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=_x(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-on}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=dx(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,ux(this._hostTNode,o)),a}createComponent(e,t,r,i,s,o,a){let c=e&&!w2(e),l;if(c)l=t;else{let w=t||{};l=w.index,r=w.injector,i=w.projectableNodes,s=w.environmentInjector||w.ngModuleRef,o=w.directives,a=w.bindings}let u=c?e:new Ks(ni(e)),h=r||this.parentInjector;if(!s&&u.ngModule==null){let I=(c?h:this.parentInjector).get(at,null);I&&(s=I)}let f=ni(u.componentType??{}),p=dx(this._lContainer,f?.id??null),m=p?.firstChild??null,v=u.create(h,i,m,s,o,a);return this.insertImpl(v.hostView,l,ux(this._hostTNode,p)),v}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(bD(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Dt],l=new FP(c,c[jn],c[Dt]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return gB(o,i,s,r),e.attachToViewContainerRef(),dv(Kv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=_x(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=s_(this._lContainer,t);r&&(tl(Kv(this._lContainer),t),fP(r[ie],r))}detach(e){let t=this._adjustIndex(e,-1),r=s_(this._lContainer,t);return r&&tl(Kv(this._lContainer),t)!=null?new Ki(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function _x(n){return n[cl]}function Kv(n){return n[cl]||(n[cl]=[])}function VP(n,e){let t,r=e[n.index];return tr(r)?t=r:(t=SP(r,e,null,n),e[n.index]=t,x_(e,t)),GB(t,e,n,r),new FP(t,n,e)}function zB(n,e){let t=n[bt],r=t.createComment(""),i=Ar(e,n),s=t.parentNode(i);return Oh(t,s,r,t.nextSibling(i),!1),r}var GB=KB,WB=()=>!1;function qB(n,e,t){return WB(n,e,t)}function KB(n,e,t,r){if(n[zi])return;let i;t.type&8?i=Un(r):i=zB(e,t),n[zi]=i}var l_=class n{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},u_=class n{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let r=e.contentQueries!==null?e.contentQueries[0]:t.length,i=[];for(let s=0;s<r;s++){let o=t.getByIndex(s),a=this.queries[o.indexInDeclarationView];i.push(a.clone())}return new n(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)K_(e,t).matches!==null&&this.queries[t].setDirty()}},d_=class{flags;read;predicate;constructor(e,t,r=null){this.flags=t,this.read=r,typeof e=="string"?this.predicate=nU(e):this.predicate=e}},h_=class n{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){let i=t!==null?t.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,t!==null?t.push(s):t=[s])}return t!==null?new n(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},f_=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==t;)r=r.parent;return t===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let s=r[i];this.matchTNodeWithReadOption(e,t,YB(t,s)),this.matchTNodeWithReadOption(e,t,Ch(t,e,s,!1,!1))}else r===Yi?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Ch(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===Dr||i===ai||i===Yi&&t.type&4)this.addMatch(t.index,-2);else{let s=Ch(t,e,i,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,r)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function YB(n,e){let t=n.localNames;if(t!==null){for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1]}return null}function QB(n,e){return n.type&11?ma(n,e):n.type&4?U_(n,e):null}function XB(n,e,t,r){return t===-1?QB(e,n):t===-2?JB(n,e,r):Mh(n,n[ie],t,e)}function JB(n,e,t){if(t===Dr)return ma(e,n);if(t===Yi)return U_(e,n);if(t===ai)return VP(e,n)}function jP(n,e,t,r){let i=e[Ir].queries[r];if(i.matches===null){let s=n.data,o=t.matches,a=[];for(let c=0;o!==null&&c<o.length;c+=2){let l=o[c];if(l<0)a.push(null);else{let u=s[l];a.push(XB(e,u,o[c+1],t.metadata.read))}}i.matches=a}return i.matches}function p_(n,e,t,r){let i=n.queries.getByIndex(t),s=i.matches;if(s!==null){let o=jP(n,e,i,t);for(let a=0;a<s.length;a+=2){let c=s[a];if(c>0)r.push(o[a/2]);else{let l=s[a+1],u=e[-c];for(let h=on;h<u.length;h++){let f=u[h];f[$i]===f[Dt]&&p_(f[ie],f,l,r)}if(u[Hs]!==null){let h=u[Hs];for(let f=0;f<h.length;f++){let p=h[f];p_(p[ie],p,l,r)}}}}}return r}function ZB(n,e){return n[Ir].queries[e].queryList}function eU(n,e,t){let r=new Rh((t&4)===4);return TD(n,e,r,r.destroy),(e[Ir]??=new u_).queries.push(new l_(r))-1}function tU(n,e,t){let r=rr();return r.firstCreatePass&&(rU(r,new d_(n,e,t),-1),(e&2)===2&&(r.staticViewQueries=!0)),eU(r,Ue(),e)}function nU(n){return n.split(",").map(e=>e.trim())}function rU(n,e,t){n.queries===null&&(n.queries=new h_),n.queries.track(new f_(e,t))}function K_(n,e){return n.queries.getByIndex(e)}function iU(n,e){let t=n[ie],r=K_(t,e);return r.crossesNgTemplate?p_(t,n,e,[]):jP(t,n,r,e)}var g_=new Map,sU=new Set;async function BP(n){let e=g_;g_=new Map;let t=new Map;function r(s){let o=t.get(s);if(o)return o;let a=n(s).then(c=>oU(s,c));return t.set(s,a),a}let i=Array.from(e).map(async([s,o])=>{if(o.styleUrl&&o.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");let a=[];o.templateUrl&&a.push(r(o.templateUrl).then(h=>{o.template=h}));let c=typeof o.styles=="string"?[o.styles]:o.styles??[];o.styles=c;let{styleUrl:l,styleUrls:u}=o;if(l&&(u=[l],o.styleUrl=void 0),u?.length){let h=Promise.all(u.map(f=>r(f))).then(f=>{c.push(...f),o.styleUrls=void 0});a.push(h)}await Promise.all(a),sU.delete(s)});await Promise.all(i)}function UP(){return g_.size===0}async function oU(n,e){if(typeof e=="string")return e;if(e.status!==void 0&&e.status!==200)throw new $(918,!1);return e.text()}var Ys=class{},Qh=class{};var vl=class extends Ys{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Lh(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let s=pv(e);this._bootstrapComponents=tP(s.bootstrap),this._r3Injector=Lv(e,t,[{provide:Ys,useValue:this},{provide:Al,useValue:this.componentFactoryResolver},...r],ei(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},_l=class extends Qh{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new vl(this.moduleType,e,[])}};function HP(n,e,t){return new vl(n,e,t,!1)}var Vh=class extends Ys{injector;componentFactoryResolver=new Lh(this);instance=null;constructor(e){super();let t=new ks([...e.providers,{provide:Ys,useValue:this},{provide:Al,useValue:this.componentFactoryResolver}],e.parent||rl(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function va(n,e,t=null){return new Vh({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var aU=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=mv(!1,t.type),i=r.length>0?va([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=H({token:n,providedIn:"environment",factory:()=>new n(W(at))})}return n})();function Tn(n){return El(()=>{let e=$P(n),t=J(L({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===w_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(aU).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||or.Emulated,styles:n.styles||Fn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&ya("NgStandalone"),zP(t);let r=n.dependencies;return t.directiveDefs=wx(r,cU),t.pipeDefs=wx(r,hD),t.id=dU(t),t})}function cU(n){return ni(n)||gv(n)}function jt(n){return El(()=>({type:n.type,bootstrap:n.bootstrap||Fn,declarations:n.declarations||Fn,imports:n.imports||Fn,exports:n.exports||Fn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function lU(n,e){if(n==null)return Fs;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a,c;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s,c=i[3]||null):(s=i,o=i,a=Gh.None,c=null),t[s]=[r,a,c],e[s]=o}return t}function uU(n){if(n==null)return Fs;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Zs(n){return El(()=>{let e=$P(n);return zP(e),e})}function $P(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Fs,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Fn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:lU(n.inputs,e),outputs:uU(n.outputs),debugInfo:null}}function zP(n){n.features?.forEach(e=>e(n))}function wx(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let s=e(i);s!==null&&r.push(s)}return r}:null}function dU(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let s of r.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function hU(n,e,t,r,i,s,o,a){if(t.firstCreatePass){n.mergedAttrs=v_(n.mergedAttrs,n.attrs);let u=n.tView=S_(2,n,i,s,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),u.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),ua(n,!1);let c=pU(t,e,n,r);wh()&&O_(t,e,c,n),fa(c,e);let l=SP(c,e,c,n);e[r+gn]=l,x_(e,l),qB(l,n,e)}function fU(n,e,t,r,i,s,o,a,c,l,u){let h=t+gn,f;return e.firstCreatePass?(f=H_(e,h,4,o||null,a||null),gh()&&MP(e,n,f,ll(e.consts,l),F_),Px(e,f)):f=e.data[h],hU(f,n,e,t,r,i,s,c),aa(f)&&Kh(e,n,f),l!=null&&L_(n,f,u),f}function Nt(n,e,t,r,i,s,o,a){let c=Ue(),l=rr(),u=ll(l.consts,s);return fU(c,l,n,e,t,r,i,u,void 0,o,a),Nt}var pU=gU;function gU(n,e,t,r){return dl(!0),e[bt].createComment("")}var Y_=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var Xh=new G(""),Jh=new G(""),Tl=(()=>{class n{_ngZone;registry;_isZoneStable=!0;_callbacks=[];_taskTrackingZone=null;_destroyRef;constructor(t,r,i){this._ngZone=t,this.registry=r,vv()&&(this._destroyRef=V(ir,{optional:!0})??void 0),Q_||(WP(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this._taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){let t=this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),r=this._ngZone.runOutsideAngular(()=>this._ngZone.onStable.subscribe({next:()=>{dt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}}));this._destroyRef?.onDestroy(()=>{t.unsubscribe(),r.unsubscribe()})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(t)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this._taskTrackingZone?this._taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},r)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,r,i){if(i&&!this._taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static \u0275fac=function(r){return new(r||n)(W(dt),W(GP),W(Jh))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),GP=(()=>{class n{_applications=new Map;registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return Q_?.findTestabilityInTree(this,t,r)??null}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function WP(n){Q_=n}var Q_;function _a(n){return!!n&&typeof n.then=="function"}function X_(n){return!!n&&typeof n.subscribe=="function"}var J_=new G("");function Zh(n){return ri([{provide:J_,multi:!0,useValue:n}])}var Z_=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=V(J_,{optional:!0})??[];injector=V(sn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=Pt(this.injector,i);if(_a(s))t.push(s);else if(X_(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ef=new G("");function qP(){Ay(()=>{let n="";throw new $(600,n)})}function KP(n){return n.isBoundToModule}var mU=10;function ew(n,e){return Array.isArray(e)?e.reduce(ew,n):L(L({},n),e)}var Xi=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=V($n);afterRenderManager=V(M_);zonelessEnabled=V(hl);rootEffectScheduler=V($v);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new _t;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=V(si);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(ke(t=>!t))}constructor(){V(oi,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=V(at);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=sn.NULL){return this._injector.get(dt).run(()=>{Be(10);let o=t instanceof Yh;if(!this._injector.get(Z_).done){let m="";throw new $(405,m)}let c;o?c=t:c=this._injector.get(Al).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let l=KP(c)?void 0:this._injector.get(Ys),u=r||c.selector,h=c.create(i,[],u,l),f=h.location.nativeElement,p=h.injector.get(Xh,null);return p?.registerApplication(f),h.onDestroy(()=>{this.detachView(h.hostView),gl(this.components,h),p?.unregisterApplication(f)}),this._loadComponent(h),Be(11,h),h})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Be(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Wh.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new $(101,!1);let t=ye(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,ye(t),this.afterTick.next(),Be(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(qs,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<mU;)Be(14),this.synchronizeOnce(),Be(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!ul(i))continue;let s=r&&!this.zonelessEnabled?0:1;IP(i,s),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>ul(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;gl(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(ef,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>gl(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new $(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gl(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var dne=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function me(n,e,t){let r=Ue(),i=Rv();if(q_(r,i,e)){let s=rr(),o=zD();Gj(o,r,n,e,r[bt],t)}return me}function Ex(n,e,t,r,i){V_(e,n,t,i?"class":"style",r)}function Y(n,e,t,r){let i=Ue(),s=i[ie],o=n+gn,a=s.firstCreatePass?z_(o,i,2,e,F_,gh(),t,r):s.data[o];if(mP(a,i,n,e,yU),aa(a)){let c=i[ie];Kh(c,i,a),A_(c,a,i)}return r!=null&&L_(i,a),Y}function Q(){let n=rr(),e=Hn(),t=yP(e);return n.firstCreatePass&&G_(n,t),PD(t)&&MD(),DD(),t.classesWithoutHost!=null&&C2(t)&&Ex(n,t,Ue(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&S2(t)&&Ex(n,t,Ue(),t.stylesWithoutHost,!1),Q}function Ot(n,e,t,r){return Y(n,e,t,r),Q(),Ot}var yU=(n,e,t,r,i)=>(dl(!0),rP(e[bt],r,GD()));function Ji(n,e,t){let r=Ue(),i=r[ie],s=n+gn,o=i.firstCreatePass?z_(s,r,8,"ng-container",F_,gh(),e,t):i.data[s];if(mP(o,r,n,"ng-container",vU),aa(o)){let a=r[ie];Kh(a,r,o),A_(a,o,r)}return t!=null&&L_(r,o),Ji}function Zi(){let n=rr(),e=Hn(),t=yP(e);return n.firstCreatePass&&G_(n,t),Zi}var vU=(n,e,t,r,i)=>(dl(!0),gj(e[bt],""));function an(){return Ue()}var Cl="en-US";var _U=Cl;function YP(n){typeof n=="string"&&(_U=n.toLowerCase().replace(/_/g,"-"))}function ze(n,e,t){let r=Ue(),i=rr(),s=Hn();return wU(i,r,r[bt],s,n,e,t),ze}function wU(n,e,t,r,i,s,o){let a=!0,c=null;if((r.type&3||o)&&(c??=qv(r,e,s),MB(r,n,e,o,t,i,s,c)&&(a=!1)),a){let l=r.outputs?.[i],u=r.hostDirectiveOutputs?.[i];if(u&&u.length)for(let h=0;h<u.length;h+=2){let f=u[h],p=u[h+1];c??=qv(r,e,s),yx(r,e,f,p,i,c)}if(l&&l.length)for(let h of l)c??=qv(r,e,s),yx(r,e,h,i,i,c)}}function Ne(n=1){return $D(n)}function tw(n,e,t){tU(n,e,t)}function tf(n){let e=Ue(),t=rr(),r=Nv();yh(r+1);let i=K_(t,r);if(n.dirty&&ED(e)===((i.metadata.flags&2)===2)){if(i.matches===null)n.reset([]);else{let s=iU(e,r);n.reset(s,U2),n.notifyOnChanges()}return!0}return!1}function nf(){return ZB(Ue(),Nv())}function bh(n,e){return n<<17|e<<2}function Qs(n){return n>>17&32767}function EU(n){return(n&2)==2}function bU(n,e){return n&131071|e<<17}function m_(n){return n|2}function ga(n){return(n&131068)>>2}function Yv(n,e){return n&-131069|e<<2}function IU(n){return(n&1)===1}function y_(n){return n|1}function AU(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Qs(o),c=ga(o);n[r]=t;let l=!1,u;if(Array.isArray(t)){let h=t;u=h[1],(u===null||ia(h,u)>0)&&(l=!0)}else u=t;if(i)if(c!==0){let f=Qs(n[a+1]);n[r+1]=bh(f,a),f!==0&&(n[f+1]=Yv(n[f+1],r)),n[a+1]=bU(n[a+1],r)}else n[r+1]=bh(a,0),a!==0&&(n[a+1]=Yv(n[a+1],r)),a=r;else n[r+1]=bh(c,0),a===0?a=r:n[c+1]=Yv(n[c+1],r),c=r;l&&(n[r+1]=m_(n[r+1])),bx(n,u,r,!0),bx(n,u,r,!1),TU(e,u,n,r,s),o=bh(a,c),s?e.classBindings=o:e.styleBindings=o}function TU(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&ia(s,e)>=0&&(t[r+1]=y_(t[r+1]))}function bx(n,e,t,r){let i=n[t+1],s=e===null,o=r?Qs(i):ga(i),a=!1;for(;o!==0&&(a===!1||s);){let c=n[o],l=n[o+1];CU(c,e)&&(a=!0,n[o+1]=r?y_(l):m_(l)),o=r?Qs(l):ga(l)}a&&(n[t+1]=r?m_(i):y_(i))}function CU(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?ia(n,e)>=0:!1}function rf(n,e){return SU(n,e,null,!0),rf}function SU(n,e,t,r){let i=Ue(),s=rr(),o=kD(2);if(s.firstUpdatePass&&xU(s,n,o,r),e!==Qi&&q_(i,o,e)){let a=s.data[Gs()];OU(s,a,i,i[bt],n,i[o+1]=kU(e,t),r,o)}}function DU(n,e){return e>=n.expandoStartIndex}function xU(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[Gs()],o=DU(n,t);LU(s,r)&&e===null&&!o&&(e=!1),e=PU(i,s,e,r),AU(i,s,e,t,o,r)}}function PU(n,e,t,r){let i=jD(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Qv(null,n,e,t,r),t=wl(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=Qv(i,n,e,t,r),s===null){let c=MU(n,e,r);c!==void 0&&Array.isArray(c)&&(c=Qv(null,n,e,c[1],r),c=wl(c,e.attrs,r),RU(n,e,r,c))}else s=NU(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function MU(n,e,t){let r=t?e.classBindings:e.styleBindings;if(ga(r)!==0)return n[Qs(r)]}function RU(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Qs(i)]=r}function NU(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=wl(r,o,t)}return wl(r,e.attrs,t)}function Qv(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=wl(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function wl(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),dD(n,o,t?!0:e[++s]))}return n===void 0?null:n}function OU(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let c=n.data,l=c[a+1],u=IU(l)?Ix(c,e,t,i,ga(l),o):void 0;if(!jh(u)){jh(s)||EU(l)&&(s=Ix(c,null,t,i,a,o));let h=bv(Gs(),t);Bj(r,o,h,i,s)}}function Ix(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let c=n[i],l=Array.isArray(c),u=l?c[1]:c,h=u===null,f=t[i+1];f===Qi&&(f=h?Fn:void 0);let p=h?uh(f,r):u===r?f:void 0;if(l&&!jh(p)&&(p=uh(c,r)),jh(p)&&(a=p,o))return a;let m=n[i+1];i=o?Qs(m):ga(m)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=uh(c,r))}return a}function jh(n){return n!==void 0}function kU(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=ei(zh(n)))),n}function LU(n,e){return(n.flags&(e?8:16))!==0}function Ce(n,e=""){let t=Ue(),r=rr(),i=n+gn,s=r.firstCreatePass?H_(r,i,1,e,null):r.data[i],o=FU(r,t,s,e,n);t[i]=o,wh()&&O_(r,t,o,s),ua(s,!1)}var FU=(n,e,t,r,i)=>(dl(!0),fj(e[bt],r));function VU(n,e,t,r=""){return q_(n,Rv(),t)?e+ah(t)+r:Qi}function zn(n){return Sl("",n),zn}function Sl(n,e,t){let r=Ue(),i=VU(r,n,e,t);return i!==Qi&&jU(r,Gs(),i),Sl}function jU(n,e,t){let r=bv(e,n);pj(n[bt],r,t)}var Ih=null;function QP(n){Ih!==null&&(n.defaultEncapsulation!==Ih.defaultEncapsulation||n.preserveWhitespaces!==Ih.preserveWhitespaces)||(Ih=n)}var Bh=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},nw=(()=>{class n{compileModuleSync(t){return new _l(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=pv(t),s=tP(i.declarations).reduce((o,a)=>{let c=ni(a);return c&&o.push(new Ks(c)),o},[]);return new Bh(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),XP=new G("");var JP=(()=>{class n{applicationErrorHandler=V($n);appRef=V(Xi);taskService=V(si);ngZone=V(dt);zonelessEnabled=V(hl);tracing=V(oi,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new vt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Jc):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(V(Hv,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?Vv:Fv;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Jc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Vv(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ZP(){return[{provide:Ui,useExisting:JP},{provide:dt,useClass:Zc},{provide:hl,useValue:!0}]}function BU(){return typeof $localize<"u"&&$localize.locale||Cl}var sf=new G("",{factory:()=>V(sf,{optional:!0,skipSelf:!0})||BU()});var aM=Symbol("InputSignalNode#UNSET"),nH=J(L({},Dd),{transformFn:void 0,applyValueToInputSignal(n,e){Gc(n,e)}});function cM(n,e){let t=Object.create(nH);t.value=n,t.transformFn=e?.transform;function r(){if(Td(t),t.value===aM){let i=null;throw new $(-950,i)}return t.value}return r[Ln]=t,r}function eM(n,e){return cM(n,e)}function rH(n){return cM(aM,n)}var lM=(eM.required=rH,eM);function iH(n,e,t){let r=new _l(t);return Promise.resolve(r)}function tM(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var of=new G(""),sH=new G("");function Dl(n){return!n.moduleRef}function oH(n){let e=Dl(n)?n.r3Injector:n.moduleRef.injector,t=e.get(dt);return t.run(()=>{Dl(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get($n),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),Dl(n)){let s=()=>e.destroy(),o=n.platformInjector.get(of);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(of);o.add(s),n.moduleRef.onDestroy(()=>{gl(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return cH(r,t,()=>{let s=e.get(si),o=s.add(),a=e.get(Z_);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(sf,Cl);if(YP(c||Cl),!e.get(sH,!0))return Dl(n)?e.get(Xi):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Dl(n)){let u=e.get(Xi);return n.rootComponent!==void 0&&u.bootstrap(n.rootComponent),u}else return uM?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void s.remove(o))})})}var uM;function nM(){uM=aH}function aH(n,e){let t=n.injector.get(Xi);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new $(-403,!1);e.push(n)}function cH(n,e,t){try{let r=t();return _a(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var dM=(()=>{class n{_injector;_modules=[];_destroyListeners=[];_destroyed=!1;constructor(t){this._injector=t}bootstrapModuleFactory(t,r){let i=[],s=[ZP(),...i,...r?.applicationProviders??[],YD],o=HP(t.moduleType,this.injector,s);return nM(),oH({moduleRef:o,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(t,r=[]){let i=ew({},r);return nM(),iH(this.injector,i,t).then(s=>this.bootstrapModuleFactory(s,i))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new $(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let t=this._injector.get(of,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static \u0275fac=function(r){return new(r||n)(W(sn))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),cw=null;function lH(n){if(uw())throw new $(400,!1);qP(),cw=n;let e=n.get(dM);return hH(n),e}function lw(n,e,t=[]){let r=`Platform: ${e}`,i=new G(r);return(s=[])=>{let o=uw();if(!o){let a=[...t,...s,{provide:i,useValue:!0}];o=n?.(a)??lH(uH(a,r))}return dH(i)}}function uH(n=[],e){return sn.create({name:e,providers:[{provide:nl,useValue:"platform"},{provide:of,useValue:new Set([()=>cw=null])},...n]})}function dH(n){let e=uw();if(!e)throw new $(-401,!1);return e}function uw(){return cw?.get(dM)??null}function hH(n){let e=n.get(Hh,null);Pt(n,()=>{e?.forEach(t=>t())})}var ar=(()=>{class n{static __NG_ELEMENT_ID__=fH}return n})();function fH(n){return pH(Hn(),Ue(),(n&16)===16)}function pH(n,e,t){if(Gi(n)&&!t){let r=nr(n.index,e);return new Ki(r,r)}else if(n.type&175){let r=e[Bn];return new Ki(r,e)}return null}var rw=class{constructor(){}supports(e){return W_(e)}create(e){return new iw(e)}},gH=(n,e)=>e,iw=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||gH}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<rM(r,i,s)?t:r,a=rM(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,u=c-i;if(l!=u){for(let f=0;f<l;f++){let p=f<s.length?s[f]:s[f]=0,m=p+f;u<=m&&m<l&&(s[f]=p+1)}let h=o.previousIndex;s[h]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!W_(e))throw new $(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,NP(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new sw(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new af),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new af),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},sw=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},ow=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},af=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new ow,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function rM(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function iM(){return new dw([new rw])}var dw=(()=>{class n{factories;static \u0275prov=H({token:n,providedIn:"root",factory:iM});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let r=V(n,{optional:!0,skipSelf:!0});return n.create(t,r||iM())}}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new $(901,!1)}}return n})();var hM=lw(null,"core",[]),fM=(()=>{class n{constructor(t){}static \u0275fac=function(r){return new(r||n)(W(Xi))};static \u0275mod=jt({type:n});static \u0275inj=xt({})}return n})();function pM(n){let e=ni(n);if(!e)return null;let t=new Ks(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var yM=null;function xr(){return yM}function hw(n){yM??=n}var xl=class{},Pl=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>V(vM),providedIn:"platform"})}return n})(),fw=new G(""),vM=(()=>{class n extends Pl{_location;_history;_doc=V(ct);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return xr().getBaseHref(this._doc)}onPopState(t){let r=xr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=xr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function lf(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function gM(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function cr(n){return n&&n[0]!=="?"?`?${n}`:n}var ci=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>V(df),providedIn:"root"})}return n})(),uf=new G(""),df=(()=>{class n extends ci{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??V(ct).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return lf(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+cr(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+cr(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+cr(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(W(Pl),W(uf,8))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),es=(()=>{class n{_subject=new _t;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=vH(gM(mM(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+cr(r))}normalize(t){return n.stripTrailingSlash(yH(this._basePath,mM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+cr(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+cr(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=cr;static joinWithSlash=lf;static stripTrailingSlash=gM;static \u0275fac=function(r){return new(r||n)(W(ci))};static \u0275prov=H({token:n,factory:()=>mH(),providedIn:"root"})}return n})();function mH(){return new es(W(ci))}function yH(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function mM(n){return n.replace(/\/index.html$/,"")}function vH(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var pw=(()=>{class n extends ci{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=lf(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+cr(s))||this._platformLocation.pathname;this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+cr(s))||this._platformLocation.pathname;this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(W(Pl),W(uf,8))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();var hf=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},pf=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new hf(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,o),_M(a,i)}});for(let i=0,s=r.length;i<s;i++){let a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);_M(s,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(tt(ai),tt(Yi),tt(dw))};static \u0275dir=Zs({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function _M(n,e){n.context.$implicit=e.item}var eo=(()=>{class n{_viewContainer;_context=new ff;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){wM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){wM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(tt(ai),tt(Yi))};static \u0275dir=Zs({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),ff=class{$implicit=null;ngIf=null};function wM(n,e){if(n&&!n.createEmbeddedView)throw new $(2020,!1)}var gw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=jt({type:n});static \u0275inj=xt({})}return n})();function Ml(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var to=class{};var EM="browser";var bM=(()=>{class n{static \u0275prov=H({token:n,providedIn:"root",factory:()=>new mw(V(ct),window)})}return n})(),mw=class{document;window;offset=()=>[0,0];constructor(e,t){this.document=e,this.window=t}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e,t){this.window.scrollTo(J(L({},t),{left:e[0],top:e[1]}))}scrollToAnchor(e,t){let r=wH(this.document,e);r&&(this.scrollToElement(r,t),r.focus())}setHistoryScrollRestoration(e){try{this.window.history.scrollRestoration=e}catch{console.warn(ti(2400,!1))}}scrollToElement(e,t){let r=e.getBoundingClientRect(),i=r.left+this.window.pageXOffset,s=r.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(J(L({},t),{left:i-o[0],top:s-o[1]}))}};function wH(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Rl=class{_doc;constructor(e){this._doc=e}manager},gf=(()=>{class n extends Rl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(W(ct))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),vf=new G(""),Ew=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(o=>{o.manager=this});let i=t.filter(o=>!(o instanceof gf));this._plugins=i.slice().reverse();let s=t.find(o=>o instanceof gf);s&&this._plugins.push(s)}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new $(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(W(vf),W(dt))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),vw="ng-app-id";function IM(n){for(let e of n)e.remove()}function AM(n,e){let t=e.createElement("style");return t.textContent=n,t}function EH(n,e,t,r){let i=n.head?.querySelectorAll(`style[${vw}="${e}"],link[${vw}="${e}"]`);if(i)for(let s of i)s.removeAttribute(vw),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function ww(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var bw=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,EH(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,AM);r?.forEach(i=>this.addUsage(i,this.external,ww))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(IM(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])IM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,AM(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,ww(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(W(ct),W(Uh),W($h,8),W(Il))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),_w={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Iw=/%COMP%/g;var CM="%COMP%",bH=`_nghost-${CM}`,IH=`_ngcontent-${CM}`,AH=!0,TH=new G("",{factory:()=>AH});function CH(n){return IH.replace(Iw,n)}function SH(n){return bH.replace(Iw,n)}function SM(n,e){return e.map(t=>t.replace(Iw,n))}var Aw=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,a,c=null,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=a,this.nonce=c,this.tracingService=l,this.platformIsServer=!1,this.defaultRenderer=new Nl(t,o,a,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof yf?i.applyToHost(t):i instanceof Ol&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,h=this.platformIsServer,f=this.tracingService;switch(r.encapsulation){case or.Emulated:s=new yf(c,l,r,this.appId,u,o,a,h,f);break;case or.ShadowDom:return new mf(c,t,r,o,a,this.nonce,h,f,l);case or.ExperimentalIsolatedShadowDom:return new mf(c,t,r,o,a,this.nonce,h,f);default:s=new Ol(c,l,r,u,o,a,h,f);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(W(Ew),W(bw),W(Uh),W(TH),W(ct),W(dt),W($h),W(oi,8))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),Nl=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(_w[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(TM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(TM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=_w[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=_w[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Sr.DashCase|Sr.Important)?e.style.setProperty(t,r,i&Sr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Sr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=xr().getGlobalEventTarget(this.doc,e),!e))throw new $(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function TM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var mf=class extends Nl{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,s,o,a,c,l){super(e,i,s,a,c),this.hostEl=t,this.sharedStylesHost=l,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let u=r.styles;u=SM(r.id,u);for(let f of u){let p=document.createElement("style");o&&p.setAttribute("nonce",o),p.textContent=f,this.shadowRoot.appendChild(p)}let h=r.getExternalStyles?.();if(h)for(let f of h){let p=ww(f,i);o&&p.setAttribute("nonce",o),this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Ol=class extends Nl{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,a,c,l){super(e,s,o,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let u=r.styles;this.styles=l?SM(l,u):u,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&pa.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},yf=class extends Ol{contentAttr;hostAttr;constructor(e,t,r,i,s,o,a,c,l){let u=i+"-"+r.id;super(e,t,r,s,o,a,c,l,u),this.contentAttr=CH(u),this.hostAttr=SH(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var _f=class n extends xl{supportsDOMEvents=!0;static makeCurrent(){hw(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=DH();return t==null?null:xH(t)}resetBaseElement(){kl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Ml(document.cookie,e)}},kl=null;function DH(){return kl=kl||document.head.querySelector("base"),kl?kl.getAttribute("href"):null}function xH(n){return new URL(n,document.baseURI).pathname}var wf=class{addToWindow(e){Zn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new $(5103,!1);return s},Zn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Zn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=Zn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Zn.frameworkStabilizers||(Zn.frameworkStabilizers=[]),Zn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?xr().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},PH=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),DM=["alt","control","meta","shift"],MH={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},RH={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},xM=(()=>{class n extends Rl{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>xr().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),DM.forEach(l=>{let u=r.indexOf(l);u>-1&&(r.splice(u,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=MH[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),DM.forEach(o=>{if(o!==i){let a=RH[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(W(ct))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();function NH(){_f.makeCurrent()}function OH(){return new Er}function kH(){return E_(document),document}var LH=[{provide:Il,useValue:EM},{provide:Hh,useValue:NH,multi:!0},{provide:ct,useFactory:kH}],Tw=lw(hM,"browser",LH);var FH=[{provide:Jh,useClass:wf},{provide:Xh,useClass:Tl},{provide:Tl,useClass:Tl}],VH=[{provide:nl,useValue:"root"},{provide:Er,useFactory:OH},{provide:vf,useClass:gf,multi:!0},{provide:vf,useClass:xM,multi:!0},Aw,bw,Ew,{provide:qs,useExisting:Aw},{provide:to,useClass:PH},[]],Cw=(()=>{class n{constructor(){}static \u0275fac=function(r){return new(r||n)};static \u0275mod=jt({type:n});static \u0275inj=xt({providers:[...VH,...FH],imports:[gw,fM]})}return n})();var ts=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=t.slice(r+1).trim();this.addHeaderEntry(i,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var bf=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}},If=class{encodeKey(e){return PM(e)}encodeValue(e){return PM(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function jH(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}var BH=/%(\d[a-f0-9])/gi,UH={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function PM(n){return encodeURIComponent(n).replace(BH,(e,t)=>UH[t]??e)}function Ef(n){return`${n}`}var li=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new If,e.fromString){if(e.fromObject)throw new $(2805,!1);this.map=jH(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(Ef):[Ef(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Ef(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(Ef(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};function HH(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function MM(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function RM(n){return typeof Blob<"u"&&n instanceof Blob}function NM(n){return typeof FormData<"u"&&n instanceof FormData}function $H(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var OM="Content-Type",kM="Accept",FM="text/plain",VM="application/json",zH=`${VM}, ${FM}, */*`,wa=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,r,i){this.url=t,this.method=e.toUpperCase();let s;if(HH(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s){if(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,this.keepalive=!!s.keepalive,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),s.priority&&(this.priority=s.priority),s.cache&&(this.cache=s.cache),s.credentials&&(this.credentials=s.credentials),typeof s.timeout=="number"){if(s.timeout<1||!Number.isInteger(s.timeout))throw new $(2822,"");this.timeout=s.timeout}s.mode&&(this.mode=s.mode),s.redirect&&(this.redirect=s.redirect),s.integrity&&(this.integrity=s.integrity),s.referrer&&(this.referrer=s.referrer),s.referrerPolicy&&(this.referrerPolicy=s.referrerPolicy),this.transferCache=s.transferCache}if(this.headers??=new ts,this.context??=new bf,!this.params)this.params=new li,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||MM(this.body)||RM(this.body)||NM(this.body)||$H(this.body)?this.body:this.body instanceof li?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||NM(this.body)?null:RM(this.body)?this.body.type||null:MM(this.body)?null:typeof this.body=="string"?FM:this.body instanceof li?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?VM:null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.keepalive??this.keepalive,o=e.priority||this.priority,a=e.cache||this.cache,c=e.mode||this.mode,l=e.redirect||this.redirect,u=e.credentials||this.credentials,h=e.referrer||this.referrer,f=e.integrity||this.integrity,p=e.referrerPolicy||this.referrerPolicy,m=e.transferCache??this.transferCache,v=e.timeout??this.timeout,w=e.body!==void 0?e.body:this.body,I=e.withCredentials??this.withCredentials,D=e.reportProgress??this.reportProgress,P=e.headers||this.headers,x=e.params||this.params,N=e.context??this.context;return e.setHeaders!==void 0&&(P=Object.keys(e.setHeaders).reduce((k,T)=>k.set(T,e.setHeaders[T]),P)),e.setParams&&(x=Object.keys(e.setParams).reduce((k,T)=>k.set(T,e.setParams[T]),x)),new n(t,r,w,{params:x,headers:P,context:N,reportProgress:D,responseType:i,withCredentials:I,transferCache:m,keepalive:s,cache:a,priority:o,timeout:v,mode:c,redirect:l,credentials:u,referrer:h,integrity:f,referrerPolicy:p})}},no=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(no||{}),ba=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,r="OK"){this.headers=e.headers||new ts,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}},Af=class n extends ba{constructor(e={}){super(e)}type=no.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Ll=class n extends ba{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=no.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}},Ea=class extends ba{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},GH=200,WH=204;var qH=new G("");var KH=/^\)\]\}',?\n/;var Dw=(()=>{class n{xhrFactory;tracingService=V(oi,{optional:!0});constructor(t){this.xhrFactory=t}maybePropagateTrace(t){return this.tracingService?.propagate?this.tracingService.propagate(t):t}handle(t){if(t.method==="JSONP")throw new $(-2800,!1);let r=this.xhrFactory;return he(null).pipe(bn(()=>new Ae(s=>{let o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((w,I)=>o.setRequestHeader(w,I.join(","))),t.headers.has(kM)||o.setRequestHeader(kM,zH),!t.headers.has(OM)){let w=t.detectContentTypeHeader();w!==null&&o.setRequestHeader(OM,w)}if(t.timeout&&(o.timeout=t.timeout),t.responseType){let w=t.responseType.toLowerCase();o.responseType=w!=="json"?w:"text"}let a=t.serializeBody(),c=null,l=()=>{if(c!==null)return c;let w=o.statusText||"OK",I=new ts(o.getAllResponseHeaders()),D=o.responseURL||t.url;return c=new Af({headers:I,status:o.status,statusText:w,url:D}),c},u=this.maybePropagateTrace(()=>{let{headers:w,status:I,statusText:D,url:P}=l(),x=null;I!==WH&&(x=typeof o.response>"u"?o.responseText:o.response),I===0&&(I=x?GH:0);let N=I>=200&&I<300;if(t.responseType==="json"&&typeof x=="string"){let k=x;x=x.replace(KH,"");try{x=x!==""?JSON.parse(x):null}catch(T){x=k,N&&(N=!1,x={error:T,text:x})}}N?(s.next(new Ll({body:x,headers:w,status:I,statusText:D,url:P||void 0})),s.complete()):s.error(new Ea({error:x,headers:w,status:I,statusText:D,url:P||void 0}))}),h=this.maybePropagateTrace(w=>{let{url:I}=l(),D=new Ea({error:w,status:o.status||0,statusText:o.statusText||"Unknown Error",url:I||void 0});s.error(D)}),f=h;t.timeout&&(f=this.maybePropagateTrace(w=>{let{url:I}=l(),D=new Ea({error:new DOMException("Request timed out","TimeoutError"),status:o.status||0,statusText:o.statusText||"Request timeout",url:I||void 0});s.error(D)}));let p=!1,m=this.maybePropagateTrace(w=>{p||(s.next(l()),p=!0);let I={type:no.DownloadProgress,loaded:w.loaded};w.lengthComputable&&(I.total=w.total),t.responseType==="text"&&o.responseText&&(I.partialText=o.responseText),s.next(I)}),v=this.maybePropagateTrace(w=>{let I={type:no.UploadProgress,loaded:w.loaded};w.lengthComputable&&(I.total=w.total),s.next(I)});return o.addEventListener("load",u),o.addEventListener("error",h),o.addEventListener("timeout",f),o.addEventListener("abort",h),t.reportProgress&&(o.addEventListener("progress",m),a!==null&&o.upload&&o.upload.addEventListener("progress",v)),o.send(a),s.next({type:no.Sent}),()=>{o.removeEventListener("error",h),o.removeEventListener("abort",h),o.removeEventListener("load",u),o.removeEventListener("timeout",f),t.reportProgress&&(o.removeEventListener("progress",m),a!==null&&o.upload&&o.upload.removeEventListener("progress",v)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(r){return new(r||n)(W(to))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function jM(n,e){return e(n)}function YH(n,e){return(t,r)=>e.intercept(t,{handle:i=>n(i,r)})}function QH(n,e,t){return(r,i)=>Pt(t,()=>e(r,s=>n(s,i)))}var BM=new G(""),xw=new G("",{factory:()=>[]}),UM=new G(""),Pw=new G("",{providedIn:"root",factory:()=>!0});function XH(){let n=null;return(e,t)=>{n===null&&(n=(V(BM,{optional:!0})??[]).reduceRight(YH,jM));let r=V(fl);if(V(Pw)){let s=r.add();return n(e,t).pipe(ta(s))}else return n(e,t)}}var Mw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=W(Dw),i},providedIn:"root"})}return n})();var Tf=(()=>{class n{backend;injector;chain=null;pendingTasks=V(fl);contributeToStability=V(Pw);constructor(t,r){this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(xw),...this.injector.get(UM,[])]));this.chain=r.reduceRight((i,s)=>QH(i,s,this.injector),jM)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(ta(r))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(W(Mw),W(at))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Rw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=W(Tf),i},providedIn:"root"})}return n})();function Sw(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer,referrerPolicy:n.referrerPolicy}}var Cf=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof wa)s=t;else{let c;i.headers instanceof ts?c=i.headers:c=new ts(i.headers);let l;i.params&&(i.params instanceof li?l=i.params:l=new li({fromObject:i.params})),s=new wa(t,r,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache,keepalive:i.keepalive,priority:i.priority,cache:i.cache,mode:i.mode,redirect:i.redirect,credentials:i.credentials,referrer:i.referrer,referrerPolicy:i.referrerPolicy,integrity:i.integrity,timeout:i.timeout})}let o=he(s).pipe(ji(c=>this.handler.handle(c)));if(t instanceof wa||i.observe==="events")return o;let a=o.pipe(qt(c=>c instanceof Ll));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(ke(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new $(2806,!1);return c.body}));case"blob":return a.pipe(ke(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new $(2807,!1);return c.body}));case"text":return a.pipe(ke(c=>{if(c.body!==null&&typeof c.body!="string")throw new $(2808,!1);return c.body}));case"json":default:return a.pipe(ke(c=>c.body))}case"response":return a;default:throw new $(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new li().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,Sw(i,r))}post(t,r,i={}){return this.request("POST",t,Sw(i,r))}put(t,r,i={}){return this.request("PUT",t,Sw(i,r))}static \u0275fac=function(r){return new(r||n)(W(Rw))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var JH=new G("",{factory:()=>!0}),ZH="XSRF-TOKEN",e$=new G("",{providedIn:"root",factory:()=>ZH}),t$="X-XSRF-TOKEN",n$=new G("",{providedIn:"root",factory:()=>t$}),r$=(()=>{class n{cookieName=V(e$);doc=V(ct);lastCookieString="";lastToken=null;parseCount=0;getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ml(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),HM=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=W(r$),i},providedIn:"root"})}return n})();function i$(n,e){let t=n.url.toLowerCase();if(!V(JH)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=V(HM).getToken(),i=V(n$);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var Nw=(function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n})(Nw||{});function s$(n,e){return{\u0275kind:n,\u0275providers:e}}function $M(...n){let e=[Cf,Tf,{provide:Rw,useExisting:Tf},{provide:Mw,useFactory:()=>V(qH,{optional:!0})??V(Dw)},{provide:xw,useValue:i$,multi:!0}];for(let t of n)e.push(...t.\u0275providers);return ri(e)}var LM=new G("");function zM(){return s$(Nw.LegacyInterceptors,[{provide:LM,useFactory:XH},{provide:xw,useExisting:LM,multi:!0}])}var Ow=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=jt({type:n});static \u0275inj=xt({providers:[$M(zM())]})}return n})();var GM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(W(ct))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Sa={};hS(Sa,{AbortException:()=>sz,AnnotationEditorLayer:()=>oz,AnnotationEditorParamsType:()=>az,AnnotationEditorType:()=>db,AnnotationEditorUIManager:()=>cz,AnnotationLayer:()=>lz,AnnotationMode:()=>uz,ColorPicker:()=>dz,DOMSVGFactory:()=>hz,DrawLayer:()=>fz,FeatureTest:()=>pz,GlobalWorkerOptions:()=>hb,ImageKind:()=>gz,InvalidPDFException:()=>mz,MissingPDFException:()=>yz,OPS:()=>vz,OutputScale:()=>_z,PDFDataRangeTransport:()=>wz,PDFDateString:()=>Ez,PDFWorker:()=>bz,PasswordResponses:()=>Iz,PermissionFlag:()=>Az,PixelsPerInch:()=>Tz,RenderingCancelledException:()=>Cz,TextLayer:()=>Sz,UnexpectedResponseException:()=>Dz,Util:()=>xz,VerbosityLevel:()=>fb,XfaLayer:()=>Pz,build:()=>Mz,createValidAbsoluteUrl:()=>Rz,fetchData:()=>Nz,getDocument:()=>pb,getFilenameFromUrl:()=>Oz,getPdfFilenameFromUrl:()=>kz,getXfaPageViewport:()=>Lz,isDataScheme:()=>Fz,isPdfFile:()=>Vz,noContextMenu:()=>jz,normalizeUnicode:()=>Bz,setLayerDimensions:()=>Uz,shadow:()=>Hz,version:()=>ru});var Ul={};Ul.d=(n,e)=>{for(var t in e)Ul.o(e,t)&&!Ul.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};Ul.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var ce=globalThis.pdfjsLib={};Ul.d(ce,{AbortException:()=>gi,AnnotationEditorLayer:()=>iz,AnnotationEditorParamsType:()=>ae,AnnotationEditorType:()=>pe,AnnotationEditorUIManager:()=>ql,AnnotationLayer:()=>XE,AnnotationMode:()=>ns,ColorPicker:()=>hp,DOMSVGFactory:()=>Jl,DrawLayer:()=>rb,FeatureTest:()=>Ut,GlobalWorkerOptions:()=>io,ImageKind:()=>Nf,InvalidPDFException:()=>Lf,MissingPDFException:()=>pi,OPS:()=>lr,OutputScale:()=>Wl,PDFDataRangeTransport:()=>Jf,PDFDateString:()=>Vf,PDFWorker:()=>Ta,PasswordResponses:()=>h$,PermissionFlag:()=>d$,PixelsPerInch:()=>rs,RenderingCancelledException:()=>Gl,TextLayer:()=>Ql,UnexpectedResponseException:()=>Ca,Util:()=>K,VerbosityLevel:()=>pp,XfaLayer:()=>tp,build:()=>nz,createValidAbsoluteUrl:()=>m$,fetchData:()=>vp,getDocument:()=>J$,getFilenameFromUrl:()=>A$,getPdfFilenameFromUrl:()=>T$,getXfaPageViewport:()=>C$,isDataScheme:()=>_p,isPdfFile:()=>ob,noContextMenu:()=>Wn,normalizeUnicode:()=>E$,setLayerDimensions:()=>so,shadow:()=>Te,version:()=>tz});var Qt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),aR=[1,0,0,1,0,0],Bw=[.001,0,0,.001,0,0],c$=1e7,Rf=1.35,l$=.35,ide=l$/Rf,Sn={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ns={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},u$="pdfjs_internal_editor_",pe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},ae={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},d$={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Yt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Nf={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},It={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};var Fl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};var pp={ERRORS:0,WARNINGS:1,INFOS:5},lr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},h$={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},gp=pp.WARNINGS;function f$(n){Number.isInteger(n)&&(gp=n)}function p$(){return gp}function mp(n){gp>=pp.INFOS&&console.log(`Info: ${n}`)}function ve(n){gp>=pp.WARNINGS&&console.log(`Warning: ${n}`)}function Ge(n){throw new Error(n)}function At(n,e){n||Ge(e)}function g$(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function m$(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=w$(n)}catch{}let r=e?new URL(n,e):new URL(n);if(g$(r))return r}catch{}return null}function Te(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}var is=(function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e})(),Hl=class extends is{constructor(e,t){super(e,"PasswordException"),this.code=t}},$l=class extends is{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},Lf=class extends is{constructor(e){super(e,"InvalidPDFException")}},pi=class extends is{constructor(e){super(e,"MissingPDFException")}},Ca=class extends is{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},Uw=class extends is{constructor(e){super(e,"FormatError")}},gi=class extends is{constructor(e){super(e,"AbortException")}};function cR(n){(typeof n!="object"||n?.length===void 0)&&Ge("Invalid argument for bytesToString");let e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);let r=[];for(let i=0;i<e;i+=t){let s=Math.min(i+t,e),o=n.subarray(i,s);r.push(String.fromCharCode.apply(null,o))}return r.join("")}function yp(n){typeof n!="string"&&Ge("Invalid argument for stringToBytes");let e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function y$(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function ib(n){let e=Object.create(null);for(let[t,r]of n)e[t]=r;return e}function v$(){let n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function _$(){try{return new Function(""),!0}catch{return!1}}var Ut=class{static get isLittleEndian(){return Te(this,"isLittleEndian",v$())}static get isEvalSupported(){return Te(this,"isEvalSupported",_$())}static get isOffscreenCanvasSupported(){return Te(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Te(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Te(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Te(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}},kw=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0")),K=class{static makeHexColor(e,t,r){return`#${kw[e]}${kw[t]}${kw[r]}`}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){let r=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[r,i]}static applyInverseTransform(e,t){let r=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/r,s=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/r;return[i,s]}static getAxialAlignedBoundingBox(e,t){let r=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),s=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}static inverseTransform(e){let t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){let t=[e[0],e[2],e[1],e[3]],r=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],s=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(r+o)/2,c=Math.sqrt((r+o)**2-4*(r*o-s*i))/2,l=a+c||1,u=a-c||1;return[Math.sqrt(l),Math.sqrt(u)]}static normalizeRect(e){let t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){let r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>i)return null;let s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>o?null:[r,s,i,o]}static#e(e,t,r,i,s,o,a,c,l,u){if(l<=0||l>=1)return;let h=1-l,f=l*l,p=f*l,m=h*(h*(h*e+3*l*t)+3*f*r)+p*i,v=h*(h*(h*s+3*l*o)+3*f*a)+p*c;u[0]=Math.min(u[0],m),u[1]=Math.min(u[1],v),u[2]=Math.max(u[2],m),u[3]=Math.max(u[3],v)}static#t(e,t,r,i,s,o,a,c,l,u,h,f){if(Math.abs(l)<1e-12){Math.abs(u)>=1e-12&&this.#e(e,t,r,i,s,o,a,c,-h/u,f);return}let p=u**2-4*h*l;if(p<0)return;let m=Math.sqrt(p),v=2*l;this.#e(e,t,r,i,s,o,a,c,(-u+m)/v,f),this.#e(e,t,r,i,s,o,a,c,(-u-m)/v,f)}static bezierBoundingBox(e,t,r,i,s,o,a,c,l){return l?(l[0]=Math.min(l[0],e,a),l[1]=Math.min(l[1],t,c),l[2]=Math.max(l[2],e,a),l[3]=Math.max(l[3],t,c)):l=[Math.min(e,a),Math.min(t,c),Math.max(e,a),Math.max(t,c)],this.#t(e,r,s,a,t,i,o,c,3*(-e+3*(r-s)+a),6*(e-2*r+s),3*(r-e),l),this.#t(e,r,s,a,t,i,o,c,3*(-t+3*(i-o)+c),6*(t-2*i+o),3*(i-t),l),l}};function w$(n){return decodeURIComponent(escape(n))}var Lw=null,WM=null;function E$(n){return Lw||(Lw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,WM=new Map([["\uFB05","\u017Ft"]])),n.replaceAll(Lw,(e,t,r)=>t?t.normalize("NFKC"):WM.get(r))}function b$(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();let n=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(n);else for(let e=0;e<32;e++)n[e]=Math.floor(Math.random()*255);return cR(n)}var sb="pdfjs_internal_id_",ui={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function I$(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(cR(n))}var hi="http://www.w3.org/2000/svg",rs=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};async function vp(n,e="text"){if(Bl(n,document.baseURI)){let t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{let i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}var zl=class n{constructor({viewBox:e,scale:t,rotation:r,offsetX:i=0,offsetY:s=0,dontFlip:o=!1}){this.viewBox=e,this.scale=t,this.rotation=r,this.offsetX=i,this.offsetY=s;let a=(e[2]+e[0])/2,c=(e[3]+e[1])/2,l,u,h,f;switch(r%=360,r<0&&(r+=360),r){case 180:l=-1,u=0,h=0,f=1;break;case 90:l=0,u=1,h=1,f=0;break;case 270:l=0,u=-1,h=-1,f=0;break;case 0:l=1,u=0,h=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(h=-h,f=-f);let p,m,v,w;l===0?(p=Math.abs(c-e[1])*t+i,m=Math.abs(a-e[0])*t+s,v=(e[3]-e[1])*t,w=(e[2]-e[0])*t):(p=Math.abs(a-e[0])*t+i,m=Math.abs(c-e[1])*t+s,v=(e[2]-e[0])*t,w=(e[3]-e[1])*t),this.transform=[l*t,u*t,h*t,f*t,p-l*t*a-h*t*c,m-u*t*a-f*t*c],this.width=v,this.height=w}get rawDims(){let{viewBox:e}=this;return Te(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new n({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){return K.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){let t=K.applyTransform([e[0],e[1]],this.transform),r=K.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){return K.applyInverseTransform([e,t],this.transform)}},Gl=class extends is{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}};function _p(n){let e=n.length,t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function ob(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function A$(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function T$(n,e="document.pdf"){if(typeof n!="string")return e;if(_p(n))return ve('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;let t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n),s=r.exec(i[1])||r.exec(i[2])||r.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=r.exec(decodeURIComponent(s))[0]}catch{}return s||e}var Ff=class{started=Object.create(null);times=[];time(e){e in this.started&&ve(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ve(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){let e=[],t=0;for(let{name:r}of this.times)t=Math.max(r.length,t);for(let{name:r,start:i,end:s}of this.times)e.push(`${r.padEnd(t)} ${s-i}ms
`);return e.join("")}};function Bl(n,e){try{let{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Wn(n){n.preventDefault()}function qM(n){console.log("Deprecated API usage: "+n)}var Vf=class{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let t=this.#e.exec(e);if(!t)return null;let r=parseInt(t[1],10),i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;let l=t[7]||"Z",u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,l==="-"?(o+=u,a+=h):l==="+"&&(o-=u,a-=h),new Date(Date.UTC(r,i,s,o,a,c))}};function C$(n,{scale:e=1,rotation:t=0}){let{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new zl({viewBox:s,scale:e,rotation:t})}function ab(n){if(n.startsWith("#")){let e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ve(`Not a valid color format: "${n}"`),[0,0,0])}function S$(n){let e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(let t of n.keys()){e.style.color=t;let r=window.getComputedStyle(e).color;n.set(t,ab(r))}e.remove()}function Xe(n){let{a:e,b:t,c:r,d:i,e:s,f:o}=n.getTransform();return[e,t,r,i,s,o]}function di(n){let{a:e,b:t,c:r,d:i,e:s,f:o}=n.getTransform().invertSelf();return[e,t,r,i,s,o]}function so(n,e,t=!1,r=!0){if(e instanceof zl){let{pageWidth:i,pageHeight:s}=e.rawDims,{style:o}=n,a=Ut.isCSSRoundSupported,c=`var(--scale-factor) * ${i}px`,l=`var(--scale-factor) * ${s}px`,u=a?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,h=a?`round(down, ${l}, var(--scale-round-y, 1px))`:`calc(${l})`;!t||e.rotation%180===0?(o.width=u,o.height=h):(o.width=h,o.height=u)}r&&n.setAttribute("data-main-rotation",e.rotation)}var Wl=class{constructor(){let e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}},Hw=class n{#e=null;#t=null;#n;#r=null;#i=null;static#s=null;constructor(e){this.#n=e,n.#s||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){let e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");let t=this.#n._uiManager._signal;e.addEventListener("contextmenu",Wn,{signal:t}),e.addEventListener("pointerdown",n.#c,{signal:t});let r=this.#r=document.createElement("div");r.className="buttons",e.append(r);let i=this.#n.toolbarPosition;if(i){let{style:s}=e,o=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),e}get div(){return this.#e}static#c(e){e.stopPropagation()}#l(e){this.#n._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()}#u(e){this.#n._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()}#a(e){let t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#l.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Wn,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#i?.shown()}#d(){let{editorType:e,_uiManager:t}=this.#n,r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",n.#s[e]),this.#a(r),r.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#r.append(r)}get#o(){let e=document.createElement("div");return e.className="divider",e}async addAltText(e){let t=await e.render();this.#a(t),this.#r.prepend(t,this.#o),this.#i=e}addColorPicker(e){this.#t=e;let t=e.renderButton();this.#a(t),this.#r.prepend(t,this.#o)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}},$w=class{#e=null;#t=null;#n;constructor(e){this.#n=e}#r(){let e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Wn,{signal:this.#n._signal});let t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#s(),e}#i(e,t){let r=0,i=0;for(let s of e){let o=s.y+s.height;if(o<r)continue;let a=s.x+(t?s.width:0);if(o>r){i=a,r=o;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,r]}show(e,t,r){let[i,s]=this.#i(t,r),{style:o}=this.#t||=this.#r();e.append(this.#t),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(){let e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");let t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");let r=this.#n._signal;e.addEventListener("contextmenu",Wn,{signal:r}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:r}),this.#e.append(e)}};function jf(n,e,t){for(let r of t)e.addEventListener(r,n[r].bind(n))}function D$(n){return Math.round(Math.min(255,Math.max(1,255*n))).toString(16).padStart(2,"0")}var zw=class{#e=0;get id(){return`${u$}${this.#e++}`}},Gw=class n{#e=b$();#t=0;#n=null;static get _isSVGFittingCanvas(){let e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;let s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Te(this,"_isSVGFittingCanvas",s)}async#r(e,t){this.#n||=new Map;let r=this.#n.get(e);if(r===null)return null;if(r?.bitmap)return r.refCounter+=1,r;try{r||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(r.url=t,i=await vp(t,"blob")):t instanceof File?i=r.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){let s=n._isSVGFittingCanvas,o=new FileReader,a=new Image,c=new Promise((l,u)=>{a.onload=()=>{r.bitmap=a,r.isSvg=!0,l()},o.onload=async()=>{let h=r.svgUrl=o.result;a.src=await s?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=o.onerror=u});o.readAsDataURL(i),await c}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){console.error(i),r=null}return this.#n.set(e,r),r&&this.#n.set(r.id,r),r}async getFromFile(e){let{lastModified:t,name:r,size:i,type:s}=e;return this.#r(`${t}_${r}_${i}_${s}`,e)}async getFromUrl(e){return this.#r(e,e)}async getFromBlob(e,t){let r=await t;return this.#r(e,r)}async getFromId(e){this.#n||=new Map;let t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){let{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let r=this.#n.get(e);if(r?.bitmap)return r.refCounter+=1,r;let i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,r),this.#n.set(r.id,r),r}getSvgUrl(e){let t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;let t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;let{bitmap:r}=t;if(!t.url&&!t.file){let i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=i.convertToBlob()}r.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}},Ww=class{#e=[];#t=!1;#n;#r=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&e(),this.#t)return;let c={cmd:e,undo:t,post:r,type:s};if(this.#r===-1){this.#e.length>0&&(this.#e.length=0),this.#r=0,this.#e.push(c);return}if(o&&this.#e[this.#r].type===s){a&&(c.undo=this.#e[this.#r].undo),this.#e[this.#r]=c;return}let l=this.#r+1;l===this.#n?this.#e.splice(0,1):(this.#r=l,l<this.#e.length&&this.#e.splice(l)),this.#e.push(c)}undo(){if(this.#r===-1)return;this.#t=!0;let{undo:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1,this.#r-=1}redo(){if(this.#r<this.#e.length-1){this.#r+=1,this.#t=!0;let{cmd:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#e.length-1}destroy(){this.#e=null}},oo=class{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:t}=Ut.platform;for(let[r,i,s={}]of e)for(let o of r){let a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);let t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;let r=this.callbacks.get(this.#e(t));if(!r)return;let{callback:i,options:{bubbles:s=!1,args:o=[],checker:a=null}}=r;a&&!a(e,t)||(i.bind(e,...o,t)(),s||(t.stopPropagation(),t.preventDefault()))}},qw=class n{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let e=new Map([["CanvasText",null],["Canvas",null]]);return S$(e),Te(this,"_colors",e)}convert(e){let t=ab(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(let[r,i]of this._colors)if(i.every((s,o)=>s===t[o]))return n._colorsMapping.get(r);return t}getHexCode(e){let t=this._colors.get(e);return t?K.makeHexColor(...t):e}},ql=(()=>{class n{#e=new AbortController;#t=null;#n=new Map;#r=new Map;#i=null;#s=null;#c=null;#l=new Ww;#u=null;#a=0;#d=new Set;#o=null;#h=null;#p=new Set;#f=!1;#g=!1;#y=!1;#m=null;#v=null;#w=null;#I=null;#E=!1;#b=null;#P=new zw;#S=!1;#A=!1;#D=null;#C=null;#M=null;#N=null;#T=pe.NONE;#_=new Set;#x=null;#R=null;#F=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#B=[0,0];#L=null;#V=null;#j=null;#O=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let t=n.prototype,r=a=>a.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:c})=>{if(c instanceof HTMLInputElement){let{type:l}=c;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Te(this,"_keyboardManager",new oo([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:c})=>!(c instanceof HTMLButtonElement)&&a.#V.contains(c)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:c})=>!(c instanceof HTMLButtonElement)&&a.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:r}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:r}]]))}constructor(t,r,i,s,o,a,c,l,u,h,f){let p=this._signal=this.#e.signal;this.#V=t,this.#j=r,this.#i=i,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:p}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:p}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:p}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:p}),s._on("setpreference",this.onSetPreference.bind(this),{signal:p}),s._on("switchannotationeditorparams",m=>this.updateParams(m.type,m.value),{signal:p}),this.#ee(),this.#ie(),this.#q(),this.#s=o.annotationStorage,this.#m=o.filterFactory,this.#R=a,this.#I=c||null,this.#f=l,this.#g=u,this.#y=h,this.#N=f||null,this.viewParameters={realScale:rs.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#O?.resolve(),this.#O=null,this.#e?.abort(),this.#e=null,this._signal=null;for(let t of this.#r.values())t.destroy();this.#r.clear(),this.#n.clear(),this.#p.clear(),this.#t=null,this.#_.clear(),this.#l.destroy(),this.#i?.destroy(),this.#b?.hide(),this.#b=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#L&&(clearTimeout(this.#L),this.#L=null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#N}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return Te(this,"hcmFilter",this.#R?this.#m.addHCMFilter(this.#R.foreground,this.#R.background):"none")}get direction(){return Te(this,"direction",getComputedStyle(this.#V).direction)}get highlightColors(){return Te(this,"highlightColors",this.#I?new Map(this.#I.split(",").map(t=>t.split("=").map(r=>r.trim()))):null)}get highlightColorNames(){return Te(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){this.#M=t}editAltText(t,r=!1){this.#i?.editAltText(this,t,r)}switchToMode(t,r){this._eventBus.on("annotationeditormodechanged",r,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,r){this._eventBus.dispatch("setpreference",{source:this,name:t,value:r})}onSetPreference({name:t,value:r}){switch(t){case"enableNewAltTextWhenAddingImage":this.#y=r;break}}onPageChanging({pageNumber:t}){this.#a=t-1}focusMainContainer(){this.#V.focus()}findParent(t,r){for(let i of this.#r.values()){let{x:s,y:o,width:a,height:c}=i.div.getBoundingClientRect();if(t>=s&&t<=s+a&&r>=o&&r<=o+c)return i}return null}disableUserSelect(t=!1){this.#j.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*rs.PDF_TO_CSS_UNITS;for(let r of this.#p)r.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#z({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#W(t){let{currentLayer:r}=this;if(r.hasTextLayer(t))return r;for(let i of this.#r.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t=""){let r=document.getSelection();if(!r||r.isCollapsed)return;let{anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a}=r,c=r.toString(),u=this.#z(r).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;r.empty();let f=this.#W(u),p=this.#T===pe.NONE,m=()=>{f?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a,text:c}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(pe.HIGHLIGHT,m);return}m()}#J(){let t=document.getSelection();if(!t||t.isCollapsed)return;let i=this.#z(t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(this.#b||=new $w(this),this.#b.show(i,s,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}#Z(){let t=document.getSelection();if(!t||t.isCollapsed){this.#x&&(this.#b?.hide(),this.#x=null,this.#k({hasSelectedText:!1}));return}let{anchorNode:r}=t;if(r===this.#x)return;let s=this.#z(t).closest(".textLayer");if(!s){this.#x&&(this.#b?.hide(),this.#x=null,this.#k({hasSelectedText:!1}));return}if(this.#b?.hide(),this.#x=r,this.#k({hasSelectedText:!0}),!(this.#T!==pe.HIGHLIGHT&&this.#T!==pe.NONE)&&(this.#T===pe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#E=this.isShiftKeyDown,!this.isShiftKeyDown)){let o=this.#T===pe.HIGHLIGHT?this.#W(s):null;o?.toggleDrawing();let a=new AbortController,c=this.combinedSignal(a),l=u=>{u.type==="pointerup"&&u.button!==0||(a.abort(),o?.toggleDrawing(!0),u.type==="pointerup"&&this.#G("main_toolbar"))};window.addEventListener("pointerup",l,{signal:c}),window.addEventListener("blur",l,{signal:c})}}#G(t=""){this.#T===pe.HIGHLIGHT?this.highlightSelection(t):this.#f&&this.#J()}#ee(){document.addEventListener("selectionchange",this.#Z.bind(this),{signal:this._signal})}#te(){if(this.#w)return;this.#w=new AbortController;let t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ne(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#G("main_toolbar")),!this.hasSelection)return;let{activeElement:t}=document;for(let r of this.#_)if(r.div.contains(t)){this.#C=[r,t],r._focusEventsAllowed=!1;break}}focus(){if(!this.#C)return;let[t,r]=this.#C;this.#C=null,r.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),r.focus()}#q(){if(this.#D)return;this.#D=new AbortController;let t=this.combinedSignal(this.#D);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#re(){this.#D?.abort(),this.#D=null}#K(){if(this.#u)return;this.#u=new AbortController;let t=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#Y(){this.#u?.abort(),this.#u=null}#ie(){let t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#q(),this.#K()}removeEditListeners(){this.#re(),this.#Y()}dragOver(t){for(let{type:r}of t.dataTransfer.items)for(let i of this.#h)if(i.isHandlingMimeForPasting(r)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(let r of t.dataTransfer.items)for(let i of this.#h)if(i.isHandlingMimeForPasting(r.type)){i.paste(r,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;let r=[];for(let i of this.#_){let s=i.serialize(!0);s&&r.push(s)}r.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(r))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();let{clipboardData:r}=t;for(let o of r.items)for(let a of this.#h)if(a.isHandlingMimeForPasting(o.type)){a.paste(o,this.currentLayer);return}let i=r.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(o){ve(`paste: "${o.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();let s=this.currentLayer;try{let o=[];for(let l of i){let u=await s.deserialize(l);if(!u)return;o.push(u)}let a=()=>{for(let l of o)this.#Q(l);this.#X(o)},c=()=>{for(let l of o)l.remove()};this.addCommands({cmd:a,undo:c,mustExec:!0})}catch(o){ve(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==pe.NONE&&!this.isEditorHandlingKeyboard&&n._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#G("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#k(t){Object.entries(t).some(([i,s])=>this.#U[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,t)}),this.#T===pe.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#H([[ae.HIGHLIGHT_FREE,!0]]))}#H(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#te(),this.#K(),this.#k({isEditing:this.#T!==pe.NONE,isEmpty:this.#$(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#Y(),this.#k({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(let r of this.#h)this.#H(r.defaultPropertiesToUpdate)}}getId(){return this.#P.id}get currentLayer(){return this.#r.get(this.#a)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#a}addLayer(t){this.#r.set(t.pageIndex,t),this.#S?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,r=null,i=!1){if(this.#T!==t&&!(this.#O&&(await this.#O.promise,!this.#O))){if(this.#O=Promise.withResolvers(),this.#T=t,t===pe.NONE){this.setEditingState(!1),this.#oe(),this.#O.resolve();return}this.setEditingState(!0),await this.#se(),this.unselectAll();for(let s of this.#r.values())s.updateMode(t);if(!r){i&&this.addNewEditorFromKeyboard(),this.#O.resolve();return}for(let s of this.#n.values())s.annotationElementId===r?(this.setSelected(s),s.enterInEditMode()):s.unselect();this.#O.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,r){if(this.#h){switch(t){case ae.CREATE:this.currentLayer.addNewEditor();return;case ae.HIGHLIGHT_DEFAULT_COLOR:this.#M?.updateColor(r);break;case ae.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#F||=new Map).set(t,r),this.showAllEditors("highlight",r);break}for(let i of this.#_)i.updateParams(t,r);for(let i of this.#h)i.updateDefaultParams(t,r)}}showAllEditors(t,r,i=!1){for(let o of this.#n.values())o.editorType===t&&o.show(r);(this.#F?.get(ae.HIGHLIGHT_SHOW_ALL)??!0)!==r&&this.#H([[ae.HIGHLIGHT_SHOW_ALL,r]])}enableWaiting(t=!1){if(this.#A!==t){this.#A=t;for(let r of this.#r.values())t?r.disableClick():r.enableClick(),r.div.classList.toggle("waiting",t)}}async#se(){if(!this.#S){this.#S=!0;let t=[];for(let r of this.#r.values())t.push(r.enable());await Promise.all(t);for(let r of this.#n.values())r.enable()}}#oe(){if(this.unselectAll(),this.#S){this.#S=!1;for(let t of this.#r.values())t.disable();for(let t of this.#n.values())t.disable()}}getEditors(t){let r=[];for(let i of this.#n.values())i.pageIndex===t&&r.push(i);return r}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#n.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#d.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#d.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#d.has(t)}removeDeletedAnnotationElement(t){this.#d.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Q(t){let r=this.#r.get(t.pageIndex);r?r.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#t!==t&&(this.#t=t,t&&this.#H(t.propertiesToUpdate))}get#ae(){let t=null;for(t of this.#_);return t}updateUI(t){this.#ae===t&&this.#H(t.propertiesToUpdate)}toggleSelected(t){if(this.#_.has(t)){this.#_.delete(t),t.unselect(),this.#k({hasSelectedEditor:this.hasSelection});return}this.#_.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}setSelected(t){for(let r of this.#_)r!==t&&r.unselect();this.#_.clear(),this.#_.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}isSelected(t){return this.#_.has(t)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(t){t.unselect(),this.#_.delete(t),this.#k({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#k({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#$()})}redo(){this.#l.redo(),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#$()})}addCommands(t){this.#l.add(t),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#$()})}#$(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(let t of this.#n.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let t=[...this.#_],r=()=>{for(let s of t)s.remove()},i=()=>{for(let s of t)this.#Q(s)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#X(t){for(let r of this.#_)r.unselect();this.#_.clear();for(let r of t)r.isEmpty()||(this.#_.add(r),r.select());this.#k({hasSelectedEditor:this.hasSelection})}selectAll(){for(let t of this.#_)t.commit();this.#X(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#T!==pe.NONE))&&this.hasSelection){for(let t of this.#_)t.unselect();this.#_.clear(),this.#k({hasSelectedEditor:!1})}}translateSelectedEditors(t,r,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#B[0]+=t,this.#B[1]+=r;let[s,o]=this.#B,a=[...this.#_],c=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#B[0]=this.#B[1]=0,this.addCommands({cmd:()=>{for(let l of a)this.#n.has(l.id)&&l.translateInPage(s,o)},undo:()=>{for(let l of a)this.#n.has(l.id)&&l.translateInPage(-s,-o)},mustExec:!1})},c);for(let l of a)l.translateInPage(t,r)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#o=new Map;for(let t of this.#_)this.#o.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#o)return!1;this.disableUserSelect(!1);let t=this.#o;this.#o=null;let r=!1;for(let[{x:s,y:o,pageIndex:a},c]of t)c.newX=s,c.newY=o,c.newPageIndex=a,r||=s!==c.savedX||o!==c.savedY||a!==c.savedPageIndex;if(!r)return!1;let i=(s,o,a,c)=>{if(this.#n.has(s.id)){let l=this.#r.get(c);l?s._setParentAndPosition(l,o,a):(s.pageIndex=c,s.x=o,s.y=a)}};return this.addCommands({cmd:()=>{for(let[s,{newX:o,newY:a,newPageIndex:c}]of t)i(s,o,a,c)},undo:()=>{for(let[s,{savedX:o,savedY:a,savedPageIndex:c}]of t)i(s,o,a,c)},mustExec:!0}),!0}dragSelectedEditors(t,r){if(this.#o)for(let i of this.#o.keys())i.drag(t,r)}rebuild(t){if(t.parent===null){let r=this.getLayer(t.pageIndex);r?(r.changeParent(t),r.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#t===t}getActive(){return this.#t}getMode(){return this.#T}get imageManager(){return Te(this,"imageManager",new Gw)}getSelectionBoxes(t){if(!t)return null;let r=document.getSelection();for(let u=0,h=r.rangeCount;u<h;u++)if(!t.contains(r.getRangeAt(u).commonAncestorContainer))return null;let{x:i,y:s,width:o,height:a}=t.getBoundingClientRect(),c;switch(t.getAttribute("data-main-rotation")){case"90":c=(u,h,f,p)=>({x:(h-s)/a,y:1-(u+f-i)/o,width:p/a,height:f/o});break;case"180":c=(u,h,f,p)=>({x:1-(u+f-i)/o,y:1-(h+p-s)/a,width:f/o,height:p/a});break;case"270":c=(u,h,f,p)=>({x:1-(h+p-s)/a,y:(u-i)/o,width:p/a,height:f/o});break;default:c=(u,h,f,p)=>({x:(u-i)/o,y:(h-s)/a,width:f/o,height:p/a});break}let l=[];for(let u=0,h=r.rangeCount;u<h;u++){let f=r.getRangeAt(u);if(!f.collapsed)for(let{x:p,y:m,width:v,height:w}of f.getClientRects())v===0||w===0||l.push(c(p,m,v,w))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:r}){(this.#c||=new Map).set(t,r)}removeChangedExistingAnnotation({annotationElementId:t}){this.#c?.delete(t)}renderAnnotationElement(t){let r=this.#c?.get(t.data.id);if(!r)return;let i=this.#s.getRawValue(r);i&&(this.#T===pe.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}}return n})(),KM=(()=>{class n{#e=null;#t=!1;#n=null;#r=null;#i=null;#s=null;#c=!1;#l=null;#u=null;#a=null;#d=null;#o=!1;static#h=null;static _l10n=null;constructor(t){this.#u=t,this.#o=t._uiManager.useNewAltTextFlow,n.#h||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){n._l10n??=t}async render(){let t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";let r=this.#r=document.createElement("span");t.append(r),this.#o?(t.classList.add("new"),t.setAttribute("data-l10n-id",n.#h.missing),r.setAttribute("data-l10n-id",n.#h["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),r.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));let i=this.#u._uiManager._signal;t.addEventListener("contextmenu",Wn,{signal:i}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:i});let s=o=>{o.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#o&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#c=!0,s(o))},{signal:i}),await this.#f(),t}get#p(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#c}),this.#c=!1)}isEmpty(){return this.#o?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#o?this.#e!==null||!!this.#a:this.isEmpty()}get guessedText(){return this.#a}async setGuessedText(t){this.#e===null&&(this.#a=t,this.#d=await n._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#f())}toggleAltTextBadge(t=!1){if(!this.#o||this.#e){this.#l?.remove(),this.#l=null;return}if(!this.#l){let r=this.#l=document.createElement("div");r.className="noAltTextBadge",this.#u.div.append(r)}this.#l.classList.toggle("hidden",!t)}serialize(t){let r=this.#e;return!t&&this.#a===r&&(r=this.#d),{altText:r,decorative:this.#t,guessedText:this.#a,textWithDisclaimer:this.#d}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:t,decorative:r,guessedText:i,textWithDisclaimer:s,cancel:o=!1}){i&&(this.#a=i,this.#d=s),!(this.#e===t&&this.#t===r)&&(o||(this.#e=t,this.#t=r),this.#f())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#n?.remove(),this.#n=null,this.#r=null,this.#i=null,this.#l?.remove(),this.#l=null}async#f(){let t=this.#n;if(!t)return;if(this.#o){if(t.classList.toggle("done",!!this.#e),t.setAttribute("data-l10n-id",n.#h[this.#p]),this.#r?.setAttribute("data-l10n-id",n.#h[`${this.#p}-label`]),!this.#e){this.#i?.remove();return}}else{if(!this.#e&&!this.#t){t.classList.remove("done"),this.#i?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let r=this.#i;if(!r){this.#i=r=document.createElement("span"),r.className="tooltip",r.setAttribute("role","tooltip"),r.id=`alt-text-tooltip-${this.#u.id}`;let s=100,o=this.#u._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#i.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#i?.classList.remove("show")},{signal:o})}this.#t?r.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(r.removeAttribute("data-l10n-id"),r.textContent=this.#e),r.parentNode||t.append(r),this.#u.getImageForAltText()?.setAttribute("aria-describedby",r.id)}}return n})(),Le=class n{#e=null;#t=null;#n=null;#r=!1;#i=!1;#s=null;#c=null;#l=null;#u="";#a=!1;#d=null;#o=!1;#h=!1;#p=!1;#f=null;#g=0;#y=0;#m=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#v=!1;#w=n._zIndex++;static _borderLineWidth=-1;static _colorManager=new qw;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){let e=n.prototype._resizeWithKeyboard,t=ql.TRANSLATE_SMALL,r=ql.TRANSLATE_BIG;return Te(this,"_resizerKeyboardManager",new oo([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],n.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;let{rotation:t,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,o];let[a,c]=this.parentDimensions;this.x=e.x/a,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Te(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){let t=new Kw({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(n._l10n??=e,n._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),n._borderLineWidth!==-1)return;let r=getComputedStyle(document.documentElement);n._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ge("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#v}set _isDraggable(e){this.#v=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){let[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#w}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#F(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#a?this.#a=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,i){let[s,o]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/s,this.y=(t+i)/o,this.fixAndSetPosition()}#I([e,t],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/t,this.fixAndSetPosition()}translate(e,t){this.#I(this.parentDimensions,e,t)}translateInPage(e,t){this.#d||=[this.x,this.y],this.#I(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#d||=[this.x,this.y];let[r,i]=this.parentDimensions;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:l,y:u}=this.div.getBoundingClientRect();this.parent.findNewParent(this,l,u)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:o}=this,[a,c]=this.getBaseTranslation();s+=a,o+=c,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*o).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#d&&(this.#d[0]!==this.x||this.#d[1]!==this.y)}getBaseTranslation(){let[e,t]=this.parentDimensions,{_borderLineWidth:r}=n,i=r/e,s=r/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){let[t,r]=this.pageDimensions,{x:i,y:s,width:o,height:a}=this;if(o*=t,a*=r,i*=t,s*=r,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(t-o,i)),s=Math.max(0,Math.min(r-a,s));break;case 90:i=Math.max(0,Math.min(t-a,i)),s=Math.min(r,Math.max(o,s));break;case 180:i=Math.min(t,Math.max(o,i)),s=Math.min(r,Math.max(a,s));break;case 270:i=Math.min(t,Math.max(a,i)),s=Math.max(0,Math.min(r-o,s));break}this.x=i/=t,this.y=s/=r;let[c,l]=this.getBaseTranslation();i+=c,s+=l;let{style:u}=this.div;u.left=`${(100*i).toFixed(2)}%`,u.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#E(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return n.#E(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return n.#E(e,t,360-this.parentRotation)}#b(e){switch(e){case 90:{let[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{let[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(e,t){let[r,i]=this.parentDimensions;this.div.style.width=`${(100*e/r).toFixed(2)}%`,this.#i||(this.div.style.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){let{style:e}=this.div,{height:t,width:r}=e,i=r.endsWith("%"),s=!this.#i&&t.endsWith("%");if(i&&s)return;let[o,a]=this.parentDimensions;i||(e.width=`${(100*parseFloat(r)/o).toFixed(2)}%`),!this.#i&&!s&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#P(){if(this.#s)return;this.#s=document.createElement("div"),this.#s.classList.add("resizers");let e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(let r of e){let i=document.createElement("div");this.#s.append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",this.#S.bind(this,r),{signal:t}),i.addEventListener("contextmenu",Wn,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#s)}#S(e,t){t.preventDefault();let{isMac:r}=Ut.platform;if(t.button!==0||t.ctrlKey&&r)return;this.#n?.toggle(!1);let i=this._isDraggable;this._isDraggable=!1;let s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#D.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("contextmenu",Wn,{signal:o});let a=this.x,c=this.y,l=this.width,u=this.height,h=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;let p=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=h,this.div.style.cursor=f,this.#A(a,c,l,u)};window.addEventListener("pointerup",p,{signal:o}),window.addEventListener("blur",p,{signal:o})}#A(e,t,r,i){let s=this.x,o=this.y,a=this.width,c=this.height;s===e&&o===t&&a===r&&c===i||this.addCommands({cmd:()=>{this.width=a,this.height=c,this.x=s,this.y=o;let[l,u]=this.parentDimensions;this.setDims(l*a,u*c),this.fixAndSetPosition()},undo:()=>{this.width=r,this.height=i,this.x=e,this.y=t;let[l,u]=this.parentDimensions;this.setDims(l*r,u*i),this.fixAndSetPosition()},mustExec:!0})}#D(e,t){let[r,i]=this.parentDimensions,s=this.x,o=this.y,a=this.width,c=this.height,l=n.MIN_SIZE/r,u=n.MIN_SIZE/i,h=X=>Math.round(X*1e4)/1e4,f=this.#b(this.rotation),p=(X,se)=>[f[0]*X+f[2]*se,f[1]*X+f[3]*se],m=this.#b(360-this.rotation),v=(X,se)=>[m[0]*X+m[2]*se,m[1]*X+m[3]*se],w,I,D=!1,P=!1;switch(e){case"topLeft":D=!0,w=(X,se)=>[0,0],I=(X,se)=>[X,se];break;case"topMiddle":w=(X,se)=>[X/2,0],I=(X,se)=>[X/2,se];break;case"topRight":D=!0,w=(X,se)=>[X,0],I=(X,se)=>[0,se];break;case"middleRight":P=!0,w=(X,se)=>[X,se/2],I=(X,se)=>[0,se/2];break;case"bottomRight":D=!0,w=(X,se)=>[X,se],I=(X,se)=>[0,0];break;case"bottomMiddle":w=(X,se)=>[X/2,se],I=(X,se)=>[X/2,0];break;case"bottomLeft":D=!0,w=(X,se)=>[0,se],I=(X,se)=>[X,0];break;case"middleLeft":P=!0,w=(X,se)=>[0,se/2],I=(X,se)=>[X,se/2];break}let x=w(a,c),N=I(a,c),k=p(...N),T=h(s+k[0]),E=h(o+k[1]),_=1,A=1,[C,M]=this.screenToPageTranslation(t.movementX,t.movementY);if([C,M]=v(C/r,M/i),D){let X=Math.hypot(a,c);_=A=Math.max(Math.min(Math.hypot(N[0]-x[0]-C,N[1]-x[1]-M)/X,1/a,1/c),l/a,u/c)}else P?_=Math.max(l,Math.min(1,Math.abs(N[0]-x[0]-C)))/a:A=Math.max(u,Math.min(1,Math.abs(N[1]-x[1]-M)))/c;let S=h(a*_),Z=h(c*A);k=p(...I(S,Z));let _e=T-k[0],We=E-k[1];this.width=S,this.height=Z,this.x=_e,this.y=We,this.setDims(r*S,i*Z),this.fixAndSetPosition()}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#h?this._editToolbar:(this._editToolbar=new Hw(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){let t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(KM.initialize(n._l10n),this.#n=new KM(this),this.#e&&(this.#n.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#r?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#N();let[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);let[r,i]=this.getInitialTranslation();return this.translate(r,i),jf(this,this.div,["pointerdown"]),this.div}pointerdown(e){let{isMac:t}=Ut.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#a=!0,this._isDraggable){this.#M(e);return}this.#C(e)}get isSelected(){return this._uiManager.isSelected(this)}#C(e){let{isMac:t}=Ut.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#M(e){let{isSelected:t}=this;this._uiManager.setUpDragSession();let r=new AbortController,i=this._uiManager.combinedSignal(r);if(t){this.div.classList.add("moving"),this.#g=e.clientX,this.#y=e.clientY;let o=a=>{let{clientX:c,clientY:l}=a,[u,h]=this.screenToPageTranslation(c-this.#g,l-this.#y);this.#g=c,this.#y=l,this._uiManager.dragSelectedEditors(u,h)};window.addEventListener("pointermove",o,{passive:!0,capture:!0,signal:i})}let s=()=>{r.abort(),t&&this.div.classList.remove("moving"),this.#a=!1,this._uiManager.endDragSession()||this.#C(e)};window.addEventListener("pointerup",s,{signal:i}),window.addEventListener("blur",s,{signal:i})}moveInDOM(){this.#f&&clearTimeout(this.#f),this.#f=setTimeout(()=>{this.#f=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition()}getRect(e,t,r=this.rotation){let i=this.parentScale,[s,o]=this.pageDimensions,[a,c]=this.pageTranslation,l=e/i,u=t/i,h=this.x*s,f=this.y*o,p=this.width*s,m=this.height*o;switch(r){case 0:return[h+l+a,o-f-u-m+c,h+l+p+a,o-f-u+c];case 90:return[h+u+a,o-f+l+c,h+u+m+a,o-f+l+p+c];case 180:return[h-l-p+a,o-f+u+c,h-l+a,o-f+u+m+c];case 270:return[h-u-m+a,o-f-l-p+c,h-u+a,o-f-l+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){let[r,i,s,o]=e,a=s-r,c=o-i;switch(this.rotation){case 0:return[r,t-o,a,c];case 90:return[r,t-i,c,a];case 180:return[s,t-i,a,c];case 270:return[s,t-o,c,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#h=!0}disableEditMode(){this.#h=!1}isInEditMode(){return this.#h}shouldGetKeyboardEvents(){return this.#p}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}#N(){if(this.#l||!this.div)return;this.#l=new AbortController;let e=this._uiManager.combinedSignal(this.#l);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#N()}rotate(e){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){Ge("An editor must be serializable")}static async deserialize(e,t,r){let i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r});i.rotation=e.rotation,i.#e=e.accessibilityData;let[s,o]=i.pageDimensions,[a,c,l,u]=i.getRectInCurrentCoords(e.rect,o);return i.x=a/s,i.y=c/o,i.width=l/s,i.height=u/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#l?.abort(),this.#l=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#f&&(clearTimeout(this.#f),this.#f=null),this.#F(),this.removeEditToolbar(),this.#m){for(let e of this.#m.values())clearTimeout(e);this.#m=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#s.classList.remove("hidden"),jf(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let t=this.#s.children;if(!this.#t){this.#t=Array.from(t);let o=this.#T.bind(this),a=this.#_.bind(this),c=this._uiManager._signal;for(let l of this.#t){let u=l.getAttribute("data-resizer-name");l.setAttribute("role","spinbutton"),l.addEventListener("keydown",o,{signal:c}),l.addEventListener("blur",a,{signal:c}),l.addEventListener("focus",this.#x.bind(this,u),{signal:c}),l.setAttribute("data-l10n-id",n._l10nResizer[u])}}let r=this.#t[0],i=0;for(let o of t){if(o===r)break;i++}let s=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(s!==i){if(s<i)for(let a=0;a<i-s;a++)this.#s.append(this.#s.firstChild);else if(s>i)for(let a=0;a<s-i;a++)this.#s.firstChild.before(this.#s.lastChild);let o=0;for(let a of t){let l=this.#t[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",n._l10nResizer[l])}}this.#R(0),this.#p=!0,this.#s.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#T(e){n._resizerKeyboardManager.exec(this,e)}#_(e){this.#p&&e.relatedTarget?.parentNode!==this.#s&&this.#F()}#x(e){this.#u=this.#p?e:""}#R(e){if(this.#t)for(let t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#p&&this.#D(this.#u,{movementX:e,movementY:t})}#F(){if(this.#p=!1,this.#R(-1),this.#c){let{savedX:e,savedY:t,savedWidth:r,savedHeight:i}=this.#c;this.#A(e,t,r,i),this.#c=null}}_stopResizingWithKeyboard(){this.#F(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#s?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#o}set isEditing(e){this.#o=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#i=!0;let r=e/t,{style:i}=this.div;i.aspectRatio=r,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#m||=new Map;let{action:r}=e,i=this.#m.get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#m.delete(r),this.#m.size===0&&(this.#m=null)},n._telemetryTimeout),this.#m.set(r,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){let r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){let{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}},Kw=class extends Le{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}},YM=3285377520,Gn=4294901760,Pr=65535,Bf=class{constructor(e){this.h1=e?e&4294967295:YM,this.h2=e?e&4294967295:YM}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let v=0,w=e.length;v<w;v++){let I=e.charCodeAt(v);I<=255?t[r++]=I:(t[r++]=I>>>8,t[r++]=I&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");let i=r>>2,s=r-i*4,o=new Uint32Array(t.buffer,0,i),a=0,c=0,l=this.h1,u=this.h2,h=3432918353,f=461845907,p=h&Pr,m=f&Pr;for(let v=0;v<i;v++)v&1?(a=o[v],a=a*h&Gn|a*p&Pr,a=a<<15|a>>>17,a=a*f&Gn|a*m&Pr,l^=a,l=l<<13|l>>>19,l=l*5+3864292196):(c=o[v],c=c*h&Gn|c*p&Pr,c=c<<15|c>>>17,c=c*f&Gn|c*m&Pr,u^=c,u=u<<13|u>>>19,u=u*5+3864292196);switch(a=0,s){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*h&Gn|a*p&Pr,a=a<<15|a>>>17,a=a*f&Gn|a*m&Pr,i&1?l^=a:u^=a}this.h1=l,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Gn|e*36045&Pr,t=t*4283543511&Gn|((t<<16|e>>>16)*2950163797&Gn)>>>16,e^=t>>>1,e=e*444984403&Gn|e*60499&Pr,t=t*3301882366&Gn|((t<<16|e>>>16)*3120437893&Gn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}},Yw=Object.freeze({map:null,hash:"",transfer:void 0}),Kl=class{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){let r=this.#n.get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let t of this.#n.values())if(t instanceof Le)return;this.onAnnotationEditor(null)}}setValue(e,t){let r=this.#n.get(e),i=!1;if(r!==void 0)for(let[s,o]of Object.entries(t))r[s]!==o&&(i=!0,r[s]=o);else i=!0,this.#n.set(e,t);i&&this.#r(),t instanceof Le&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?ib(this.#n):null}setAll(e){for(let[t,r]of Object.entries(e))this.setValue(t,r)}get size(){return this.#n.size}#r(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Uf(this)}get serializable(){if(this.#n.size===0)return Yw;let e=new Map,t=new Bf,r=[],i=Object.create(null),s=!1;for(let[o,a]of this.#n){let c=a instanceof Le?a.serialize(!1,i):a;c&&(e.set(o,c),t.update(`${o}:${JSON.stringify(c)}`),s||=!!c.bitmap)}if(s)for(let o of e.values())o.bitmap&&r.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:Yw}get editorStats(){let e=null,t=new Map;for(let r of this.#n.values()){if(!(r instanceof Le))continue;let i=r.telemetryFinalData;if(!i)continue;let{type:s}=i;t.has(s)||t.set(s,Object.getPrototypeOf(r).constructor),e||=Object.create(null);let o=e[s]||=new Map;for(let[a,c]of Object.entries(i)){if(a==="type")continue;let l=o.get(a);l||(l=new Map,o.set(a,l));let u=l.get(c)??0;l.set(c,u+1)}}for(let[r,i]of t)e[r]=i.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;let e=[];for(let t of this.#n.values())!(t instanceof Le)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}},Uf=class extends Kl{#e;constructor(e){super();let{map:t,hash:r,transfer:i}=e.serializable,s=structuredClone(t,i?{transfer:i}:null);this.#e={map:s,hash:r,transfer:i}}get print(){Ge("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Te(this,"modifiedIds",{ids:new Set,hash:""})}},Qw=class{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(let e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(At(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:r,src:i,style:s}=e,o=new FontFace(r,i,s);this.addNativeFontFace(o);try{await o.load(),this.#e.add(r),t?.(e)}catch{ve(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Ge("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){let r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw ve(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}let t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{let i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){let e=!!this._document?.fonts;return Te(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Qt||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Te(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(At(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){let s=r.shift();setTimeout(s.callback,0)}}let{loadingRequests:r}=this,i={done:!1,complete:t,callback:e};return r.push(i),i}get _loadTestFont(){let e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Te(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(x,N){return x.charCodeAt(N)<<24|x.charCodeAt(N+1)<<16|x.charCodeAt(N+2)<<8|x.charCodeAt(N+3)&255}function i(x,N,k,T){let E=x.substring(0,N),_=x.substring(N+k);return E+T+_}let s,o,a=this._document.createElement("canvas");a.width=1,a.height=1;let c=a.getContext("2d"),l=0;function u(x,N){if(++l>30){ve("Load test font never loaded."),N();return}if(c.font="30px "+x,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){N();return}setTimeout(u.bind(null,x,N))}let h=`lt${Date.now()}${this.loadTestFontId++}`,f=this._loadTestFont;f=i(f,976,h.length,h);let m=16,v=1482184792,w=r(f,m);for(s=0,o=h.length-3;s<o;s+=4)w=w-v+r(h,s)|0;s<h.length&&(w=w-v+r(h+"XXX",s)|0),f=i(f,m,4,y$(w));let I=`url(data:font/opentype;base64,${btoa(f)});`,D=`@font-face {font-family:"${h}";src:${I}}`;this.insertRule(D);let P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(let x of[e.loadedName,h]){let N=this._document.createElement("span");N.textContent="Hi",N.style.fontFamily=x,P.append(N)}this._document.body.append(P),u(h,()=>{P.remove(),t.complete()})}},Xw=class{constructor(e,{disableFontFace:t=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(let i in e)this[i]=e[i];this.disableFontFace=t===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{let t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let e=`url(data:${this.mimetype};base64,${I$(this.data)});`,t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let r;try{r=e.get(this.loadedName+"_path_"+t)}catch(s){ve(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(r)||r.length===0)return this.compiledGlyphs[t]=function(s,o){};let i=[];for(let s=0,o=r.length;s<o;)switch(r[s++]){case ui.BEZIER_CURVE_TO:{let[a,c,l,u,h,f]=r.slice(s,s+6);i.push(p=>p.bezierCurveTo(a,c,l,u,h,f)),s+=6}break;case ui.MOVE_TO:{let[a,c]=r.slice(s,s+2);i.push(l=>l.moveTo(a,c)),s+=2}break;case ui.LINE_TO:{let[a,c]=r.slice(s,s+2);i.push(l=>l.lineTo(a,c)),s+=2}break;case ui.QUADRATIC_CURVE_TO:{let[a,c,l,u]=r.slice(s,s+4);i.push(h=>h.quadraticCurveTo(a,c,l,u)),s+=4}break;case ui.RESTORE:i.push(a=>a.restore());break;case ui.SAVE:i.push(a=>a.save());break;case ui.SCALE:At(i.length===2,"Scale command is only valid at the third position.");break;case ui.TRANSFORM:{let[a,c,l,u,h,f]=r.slice(s,s+6);i.push(p=>p.transform(a,c,l,u,h,f)),s+=6}break;case ui.TRANSLATE:{let[a,c]=r.slice(s,s+2);i.push(l=>l.translate(a,c)),s+=2}break}return this.compiledGlyphs[t]=function(o,a){i[0](o),i[1](o),o.scale(a,-a);for(let c=2,l=i.length;c<l;c++)i[c](o)}}},Hf=class{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");let r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ge("Abstract method `_createCanvas` called.")}},Jw=class extends Hf{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){let r=this._document.createElement("canvas");return r.width=e,r.height=t,r}},$f=class{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");let t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ge("Abstract method `_fetch` called.")}},zf=class extends $f{async _fetch(e){let t=await vp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):yp(t)}},Gf=class{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,i,s){return"none"}destroy(e=!1){}},Zw=class extends Gf{#e;#t;#n;#r;#i;#s;#c=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#r=e,this.#i=t}get#l(){return this.#t||=new Map}get#u(){return this.#s||=new Map}get#a(){if(!this.#n){let e=this.#i.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;let r=this.#i.createElementNS(hi,"svg");r.setAttribute("width",0),r.setAttribute("height",0),this.#n=this.#i.createElementNS(hi,"defs"),e.append(r),r.append(this.#n),this.#i.body.append(e)}return this.#n}#d(e){if(e.length===1){let c=e[0],l=new Array(256);for(let h=0;h<256;h++)l[h]=c[h]/255;let u=l.join(",");return[u,u,u]}let[t,r,i]=e,s=new Array(256),o=new Array(256),a=new Array(256);for(let c=0;c<256;c++)s[c]=t[c]/255,o[c]=r[c]/255,a[c]=i[c]/255;return[s.join(","),o.join(","),a.join(",")]}#o(e){if(this.#e===void 0){this.#e="";let t=this.#i.URL;t!==this.#i.baseURI&&(_p(t)?ve('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#l.get(e);if(t)return t;let[r,i,s]=this.#d(e),o=e.length===1?r:`${r}${i}${s}`;if(t=this.#l.get(o),t)return this.#l.set(e,t),t;let a=`g_${this.#r}_transfer_map_${this.#c++}`,c=this.#o(a);this.#l.set(e,c),this.#l.set(o,c);let l=this.#f(a);return this.#y(r,i,s,l),c}addHCMFilter(e,t){let r=`${e}-${t}`,i="base",s=this.#u.get(i);if(s?.key===r||(s?(s.filter?.remove(),s.key=r,s.url="none",s.filter=null):(s={key:r,url:"none",filter:null},this.#u.set(i,s)),!e||!t))return s.url;let o=this.#v(e);e=K.makeHexColor(...o);let a=this.#v(t);if(t=K.makeHexColor(...a),this.#a.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return s.url;let c=new Array(256);for(let p=0;p<=255;p++){let m=p/255;c[p]=m<=.03928?m/12.92:((m+.055)/1.055)**2.4}let l=c.join(","),u=`g_${this.#r}_hcm_filter`,h=s.filter=this.#f(u);this.#y(l,l,l,h),this.#p(h);let f=(p,m)=>{let v=o[p]/255,w=a[p]/255,I=new Array(m+1);for(let D=0;D<=m;D++)I[D]=v+D/m*(w-v);return I.join(",")};return this.#y(f(0,5),f(1,5),f(2,5),h),s.url=this.#o(u),s.url}addAlphaFilter(e){let t=this.#l.get(e);if(t)return t;let[r]=this.#d([e]),i=`alpha_${r}`;if(t=this.#l.get(i),t)return this.#l.set(e,t),t;let s=`g_${this.#r}_alpha_map_${this.#c++}`,o=this.#o(s);this.#l.set(e,o),this.#l.set(i,o);let a=this.#f(s);return this.#m(r,a),o}addLuminosityFilter(e){let t=this.#l.get(e||"luminosity");if(t)return t;let r,i;if(e?([r]=this.#d([e]),i=`luminosity_${r}`):i="luminosity",t=this.#l.get(i),t)return this.#l.set(e,t),t;let s=`g_${this.#r}_luminosity_map_${this.#c++}`,o=this.#o(s);this.#l.set(e,o),this.#l.set(i,o);let a=this.#f(s);return this.#h(a),e&&this.#m(r,a),o}addHighlightHCMFilter(e,t,r,i,s){let o=`${t}-${r}-${i}-${s}`,a=this.#u.get(e);if(a?.key===o||(a?(a.filter?.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},this.#u.set(e,a)),!t||!r))return a.url;let[c,l]=[t,r].map(this.#v.bind(this)),u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),h=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[f,p]=[i,s].map(this.#v.bind(this));h<u&&([u,h,f,p]=[h,u,p,f]),this.#a.style.color="";let m=(I,D,P)=>{let x=new Array(256),N=(h-u)/P,k=I/255,T=(D-I)/(255*P),E=0;for(let _=0;_<=P;_++){let A=Math.round(u+_*N),C=k+_*T;for(let M=E;M<=A;M++)x[M]=C;E=A+1}for(let _=E;_<256;_++)x[_]=x[E-1];return x.join(",")},v=`g_${this.#r}_hcm_${e}_filter`,w=a.filter=this.#f(v);return this.#p(w),this.#y(m(f[0],p[0],5),m(f[1],p[1],5),m(f[2],p[2],5),w),a.url=this.#o(v),a.url}destroy(e=!1){e&&this.#u.size!==0||(this.#n&&(this.#n.parentNode.parentNode.remove(),this.#n=null),this.#t&&(this.#t.clear(),this.#t=null),this.#c=0)}#h(e){let t=this.#i.createElementNS(hi,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){let t=this.#i.createElementNS(hi,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#f(e){let t=this.#i.createElementNS(hi,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#a.append(t),t}#g(e,t,r){let i=this.#i.createElementNS(hi,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),e.append(i)}#y(e,t,r,i){let s=this.#i.createElementNS(hi,"feComponentTransfer");i.append(s),this.#g(s,"feFuncR",e),this.#g(s,"feFuncG",t),this.#g(s,"feFuncB",r)}#m(e,t){let r=this.#i.createElementNS(hi,"feComponentTransfer");t.append(r),this.#g(r,"feFuncA",e)}#v(e){return this.#a.style.color=e,ab(getComputedStyle(this.#a).getPropertyValue("color"))}},Wf=class{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");let t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ge("Abstract method `_fetch` called.")}},qf=class extends Wf{async _fetch(e){let t=await vp(e,"arraybuffer");return new Uint8Array(t)}};Qt&&(Of=Promise.withResolvers(),kf=null,(async()=>{let e=await import("./chunk-L2HEV66R.js"),t=await import("./chunk-BMBYILCS.js"),r=await import("./chunk-ALIQTIYY.js"),i=await import("./chunk-NYZOWURK.js"),s,o;return new Map(Object.entries({fs:e,http:t,https:r,url:i,canvas:s,path2d:o}))})().then(e=>{kf=e,Of.resolve()},e=>{ve(`loadPackages: ${e}`),kf=new Map,Of.resolve()}));var Of,kf,Mr=class{static get promise(){return Of.promise}static get(e){return kf?.get(e)}};async function lR(n){let t=await Mr.get("fs").promises.readFile(n);return new Uint8Array(t)}var eE=class extends Gf{},tE=class extends Hf{_createCanvas(e,t){return Mr.get("canvas").createCanvas(e,t)}},nE=class extends $f{async _fetch(e){return lR(e)}},rE=class extends Wf{async _fetch(e){return lR(e)}},cn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function iE(n,e){if(!e)return;let t=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,r),n.clip(i)}var Yl=class{getPattern(){Ge("Abstract method `getPattern` called.")}},sE=class extends Yl{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,i){let s;if(i===cn.STROKE||i===cn.FILL){let o=t.current.getClippedPathBoundingBox(i,Xe(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,l=t.cachedCanvases.getCanvas("pattern",a,c),u=l.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-o[0],-o[1]),r=K.transform(r,[1,0,0,1,o[0],o[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),iE(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),s=e.createPattern(l.canvas,"no-repeat");let h=new DOMMatrix(r);s.setTransform(h)}else iE(e,this._bbox),s=this._createGradient(e);return s}};function Fw(n,e,t,r,i,s,o,a){let c=e.coords,l=e.colors,u=n.data,h=n.width*4,f;c[t+1]>c[r+1]&&(f=t,t=r,r=f,f=s,s=o,o=f),c[r+1]>c[i+1]&&(f=r,r=i,i=f,f=o,o=a,a=f),c[t+1]>c[r+1]&&(f=t,t=r,r=f,f=s,s=o,o=f);let p=(c[t]+e.offsetX)*e.scaleX,m=(c[t+1]+e.offsetY)*e.scaleY,v=(c[r]+e.offsetX)*e.scaleX,w=(c[r+1]+e.offsetY)*e.scaleY,I=(c[i]+e.offsetX)*e.scaleX,D=(c[i+1]+e.offsetY)*e.scaleY;if(m>=D)return;let P=l[s],x=l[s+1],N=l[s+2],k=l[o],T=l[o+1],E=l[o+2],_=l[a],A=l[a+1],C=l[a+2],M=Math.round(m),S=Math.round(D),Z,_e,We,X,se,_n,Yr,en;for(let ot=M;ot<=S;ot++){if(ot<w){let Fe=ot<m?0:(m-ot)/(m-w);Z=p-(p-v)*Fe,_e=P-(P-k)*Fe,We=x-(x-T)*Fe,X=N-(N-E)*Fe}else{let Fe;ot>D?Fe=1:w===D?Fe=0:Fe=(w-ot)/(w-D),Z=v-(v-I)*Fe,_e=k-(k-_)*Fe,We=T-(T-A)*Fe,X=E-(E-C)*Fe}let Qe;ot<m?Qe=0:ot>D?Qe=1:Qe=(m-ot)/(m-D),se=p-(p-I)*Qe,_n=P-(P-_)*Qe,Yr=x-(x-A)*Qe,en=N-(N-C)*Qe;let Qn=Math.round(Math.min(Z,se)),Qr=Math.round(Math.max(Z,se)),zt=h*ot+Qn*4;for(let Fe=Qn;Fe<=Qr;Fe++)Qe=(Z-Fe)/(Z-se),Qe<0?Qe=0:Qe>1&&(Qe=1),u[zt++]=_e-(_e-_n)*Qe|0,u[zt++]=We-(We-Yr)*Qe|0,u[zt++]=X-(X-en)*Qe|0,u[zt++]=255}}function x$(n,e,t){let r=e.coords,i=e.colors,s,o;switch(e.type){case"lattice":let a=e.verticesPerRow,c=Math.floor(r.length/a)-1,l=a-1;for(s=0;s<c;s++){let u=s*a;for(let h=0;h<l;h++,u++)Fw(n,t,r[u],r[u+1],r[u+a],i[u],i[u+1],i[u+a]),Fw(n,t,r[u+a+1],r[u+1],r[u+a],i[u+a+1],i[u+1],i[u+a])}break;case"triangles":for(s=0,o=r.length;s<o;s+=3)Fw(n,t,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}var oE=class extends Yl{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,r){let a=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),l=Math.ceil(this._bounds[2])-a,u=Math.ceil(this._bounds[3])-c,h=Math.min(Math.ceil(Math.abs(l*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),p=l/h,m=u/f,v={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-c,scaleX:1/p,scaleY:1/m},w=h+4,I=f+4,D=r.getCanvas("mesh",w,I),P=D.context,x=P.createImageData(h,f);if(t){let k=x.data;for(let T=0,E=k.length;T<E;T+=4)k[T]=t[0],k[T+1]=t[1],k[T+2]=t[2],k[T+3]=255}for(let k of this._figures)x$(x,k,v);return P.putImageData(x,2,2),{canvas:D.canvas,offsetX:a-2*p,offsetY:c-2*m,scaleX:p,scaleY:m}}getPattern(e,t,r,i){iE(e,this._bbox);let s;if(i===cn.SHADING)s=K.singularValueDecompose2dScale(Xe(e));else if(s=K.singularValueDecompose2dScale(t.baseTransform),this.matrix){let a=K.singularValueDecompose2dScale(this.matrix);s=[s[0]*a[0],s[1]*a[1]]}let o=this._createMeshCanvas(s,i===cn.SHADING?null:this._background,t.cachedCanvases);return i!==cn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}},aE=class extends Yl{getPattern(){return"hotpink"}};function P$(n){switch(n[0]){case"RadialAxial":return new sE(n);case"Mesh":return new oE(n);case"Dummy":return new aE}throw new Error(`Unknown IR type: ${n[0]}`)}var QM={COLORED:1,UNCOLORED:2},M$=(()=>{class n{static MAX_PATTERN_SIZE=3e3;constructor(t,r,i,s,o){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=r,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=o}createPatternCanvas(t){let{bbox:r,operatorList:i,paintType:s,tilingType:o,color:a,canvasGraphicsFactory:c}=this,{xstep:l,ystep:u}=this;l=Math.abs(l),u=Math.abs(u),mp("TilingType: "+o);let h=r[0],f=r[1],p=r[2],m=r[3],v=p-h,w=m-f,I=K.singularValueDecompose2dScale(this.matrix),D=K.singularValueDecompose2dScale(this.baseTransform),P=I[0]*D[0],x=I[1]*D[1],N=v,k=w,T=!1,E=!1,_=Math.ceil(l*P),A=Math.ceil(u*x),C=Math.ceil(v*P),M=Math.ceil(w*x);_>=C?N=l:T=!0,A>=M?k=u:E=!0;let S=this.getSizeAndScale(N,this.ctx.canvas.width,P),Z=this.getSizeAndScale(k,this.ctx.canvas.height,x),_e=t.cachedCanvases.getCanvas("pattern",S.size,Z.size),We=_e.context,X=c.createCanvasGraphics(We);if(X.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(X,s,a),We.translate(-S.scale*h,-Z.scale*f),X.transform(S.scale,0,0,Z.scale,0,0),We.save(),this.clipBbox(X,h,f,p,m),X.baseTransform=Xe(X.ctx),X.executeOperatorList(i),X.endDrawing(),We.restore(),T||E){let se=_e.canvas;T&&(N=l),E&&(k=u);let _n=this.getSizeAndScale(N,this.ctx.canvas.width,P),Yr=this.getSizeAndScale(k,this.ctx.canvas.height,x),en=_n.size,ot=Yr.size,Qe=t.cachedCanvases.getCanvas("pattern-workaround",en,ot),Qn=Qe.context,Qr=T?Math.floor(v/l):0,zt=E?Math.floor(w/u):0;for(let Fe=0;Fe<=Qr;Fe++)for(let wn=0;wn<=zt;wn++)Qn.drawImage(se,en*Fe,ot*wn,en,ot,0,0,en,ot);return{canvas:Qe.canvas,scaleX:_n.scale,scaleY:Yr.scale,offsetX:h,offsetY:f}}return{canvas:_e.canvas,scaleX:S.scale,scaleY:Z.scale,offsetX:h,offsetY:f}}getSizeAndScale(t,r,i){let s=Math.max(n.MAX_PATTERN_SIZE,r),o=Math.ceil(t*i);return o>=s?o=s:i=o/t,{scale:i,size:o}}clipBbox(t,r,i,s,o){let a=s-r,c=o-i;t.ctx.rect(r,i,a,c),t.current.updateRectMinMax(Xe(t.ctx),[r,i,s,o]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,r,i){let s=t.ctx,o=t.current;switch(r){case QM.COLORED:let a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,o.fillColor=a.fillStyle,o.strokeColor=a.strokeStyle;break;case QM.UNCOLORED:let c=K.makeHexColor(i[0],i[1],i[2]);s.fillStyle=c,s.strokeStyle=c,o.fillColor=c,o.strokeColor=c;break;default:throw new Uw(`Unsupported paint type: ${r}`)}}getPattern(t,r,i,s){let o=i;s!==cn.SHADING&&(o=K.transform(o,r.baseTransform),this.matrix&&(o=K.transform(o,this.matrix)));let a=this.createPatternCanvas(r),c=new DOMMatrix(o);c=c.translate(a.offsetX,a.offsetY),c=c.scale(1/a.scaleX,1/a.scaleY);let l=t.createPattern(a.canvas,"repeat");return l.setTransform(c),l}}return n})();function R$({src:n,srcPos:e=0,dest:t,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){let a=Ut.isLittleEndian?4278190080:255,[c,l]=o?[s,a]:[a,s],u=r>>3,h=r&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let m=0;m<i;m++){for(let w=e+u;e<w;e++){let I=e<f?n[e]:255;t[p++]=I&128?l:c,t[p++]=I&64?l:c,t[p++]=I&32?l:c,t[p++]=I&16?l:c,t[p++]=I&8?l:c,t[p++]=I&4?l:c,t[p++]=I&2?l:c,t[p++]=I&1?l:c}if(h===0)continue;let v=e<f?n[e++]:255;for(let w=0;w<h;w++)t[p++]=v&1<<7-w?l:c}return{srcPos:e,destPos:p}}var XM=16,JM=100,N$=15,ZM=10,eR=1e3,yn=16;function O$(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(r,i){e.translate(r,i),this.__originalTranslate(r,i)},n.scale=function(r,i){e.scale(r,i),this.__originalScale(r,i)},n.transform=function(r,i,s,o,a,c){e.transform(r,i,s,o,a,c),this.__originalTransform(r,i,s,o,a,c)},n.setTransform=function(r,i,s,o,a,c){e.setTransform(r,i,s,o,a,c),this.__originalSetTransform(r,i,s,o,a,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(r){e.rotate(r),this.__originalRotate(r)},n.clip=function(r){e.clip(r),this.__originalClip(r)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,i,s,o,a){e.bezierCurveTo(t,r,i,s,o,a),this.__originalBezierCurveTo(t,r,i,s,o,a)},n.rect=function(t,r,i,s){e.rect(t,r,i,s),this.__originalRect(t,r,i,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}var cE=class{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,r)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(let e in this.cache){let t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}};function Sf(n,e,t,r,i,s,o,a,c,l){let[u,h,f,p,m,v]=Xe(n);if(h===0&&f===0){let D=o*u+m,P=Math.round(D),x=a*p+v,N=Math.round(x),k=(o+c)*u+m,T=Math.abs(Math.round(k)-P)||1,E=(a+l)*p+v,_=Math.abs(Math.round(E)-N)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(p),P,N),n.drawImage(e,t,r,i,s,0,0,T,_),n.setTransform(u,h,f,p,m,v),[T,_]}if(u===0&&p===0){let D=a*f+m,P=Math.round(D),x=o*h+v,N=Math.round(x),k=(a+l)*f+m,T=Math.abs(Math.round(k)-P)||1,E=(o+c)*h+v,_=Math.abs(Math.round(E)-N)||1;return n.setTransform(0,Math.sign(h),Math.sign(f),0,P,N),n.drawImage(e,t,r,i,s,0,0,_,T),n.setTransform(u,h,f,p,m,v),[_,T]}n.drawImage(e,t,r,i,s,o,a,c,l);let w=Math.hypot(u,h),I=Math.hypot(f,p);return[w*c,I*l]}function k$(n){let{width:e,height:t}=n;if(e>eR||t>eR)return null;let r=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=e+1,o=new Uint8Array(s*(t+1)),a,c,l,u=e+7&-8,h=new Uint8Array(u*t),f=0;for(let I of n.data){let D=128;for(;D>0;)h[f++]=I&D?0:255,D>>=1}let p=0;for(f=0,h[f]!==0&&(o[0]=1,++p),c=1;c<e;c++)h[f]!==h[f+1]&&(o[c]=h[f]?2:1,++p),f++;for(h[f]!==0&&(o[c]=2,++p),a=1;a<t;a++){f=a*u,l=a*s,h[f-u]!==h[f]&&(o[l]=h[f]?1:8,++p);let I=(h[f]?4:0)+(h[f-u]?8:0);for(c=1;c<e;c++)I=(I>>2)+(h[f+1]?4:0)+(h[f-u+1]?8:0),i[I]&&(o[l+c]=i[I],++p),f++;if(h[f-u]!==h[f]&&(o[l+c]=h[f]?2:4,++p),p>r)return null}for(f=u*(t-1),l=a*s,h[f]!==0&&(o[l]=8,++p),c=1;c<e;c++)h[f]!==h[f+1]&&(o[l+c]=h[f]?4:8,++p),f++;if(h[f]!==0&&(o[l+c]=4,++p),p>r)return null;let m=new Int32Array([0,s,-1,0,-s,0,0,0,1]),v=new Path2D;for(a=0;p&&a<=t;a++){let I=a*s,D=I+e;for(;I<D&&!o[I];)I++;if(I===D)continue;v.moveTo(I%s,a);let P=I,x=o[I];do{let N=m[x];do I+=N;while(!o[I]);let k=o[I];k!==5&&k!==10?(x=k,o[I]=0):(x=k&51*x>>4,o[I]&=x>>2|x<<2),v.lineTo(I%s,I/s|0),o[I]||--p}while(P!==I);--a}return h=null,o=null,function(I){I.save(),I.scale(1/e,-1/t),I.translate(0,-t),I.fill(v),I.beginPath(),I.restore()}}var Kf=class{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=aR,this.textMatrixScale=1,this.fontMatrix=Bw,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Yt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){let e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,r){[t,r]=K.applyTransform([t,r],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,r),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,r)}updateRectMinMax(e,t){let r=K.applyTransform(t,e),i=K.applyTransform(t.slice(2),e),s=K.applyTransform([t[0],t[3]],e),o=K.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,r[0],i[0],s[0],o[0]),this.minY=Math.min(this.minY,r[1],i[1],s[1],o[1]),this.maxX=Math.max(this.maxX,r[0],i[0],s[0],o[0]),this.maxY=Math.max(this.maxY,r[1],i[1],s[1],o[1])}updateScalingPathMinMax(e,t){K.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,r,i,s,o,a,c,l,u){let h=K.bezierBoundingBox(t,r,i,s,o,a,c,l,u);u||this.updateRectMinMax(e,h)}getPathBoundingBox(e=cn.FILL,t=null){let r=[this.minX,this.minY,this.maxX,this.maxY];if(e===cn.STROKE){t||Ge("Stroke bounding box must include transform.");let i=K.singularValueDecompose2dScale(t),s=i[0]*this.lineWidth/2,o=i[1]*this.lineWidth/2;r[0]-=s,r[1]-=o,r[2]+=s,r[3]+=o}return r}updateClipFromPath(){let e=K.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=cn.FILL,t=null){return K.intersect(this.clipBox,this.getPathBoundingBox(e,t))}};function tR(n,e){if(typeof ImageData<"u"&&e instanceof ImageData){n.putImageData(e,0,0);return}let t=e.height,r=e.width,i=t%yn,s=(t-i)/yn,o=i===0?s:s+1,a=n.createImageData(r,yn),c=0,l,u=e.data,h=a.data,f,p,m,v;if(e.kind===Nf.GRAYSCALE_1BPP){let w=u.byteLength,I=new Uint32Array(h.buffer,0,h.byteLength>>2),D=I.length,P=r+7>>3,x=4294967295,N=Ut.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(m=f<s?yn:i,l=0,p=0;p<m;p++){let k=w-c,T=0,E=k>P?r:k*8-7,_=E&-8,A=0,C=0;for(;T<_;T+=8)C=u[c++],I[l++]=C&128?x:N,I[l++]=C&64?x:N,I[l++]=C&32?x:N,I[l++]=C&16?x:N,I[l++]=C&8?x:N,I[l++]=C&4?x:N,I[l++]=C&2?x:N,I[l++]=C&1?x:N;for(;T<E;T++)A===0&&(C=u[c++],A=128),I[l++]=C&A?x:N,A>>=1}for(;l<D;)I[l++]=0;n.putImageData(a,0,f*yn)}}else if(e.kind===Nf.RGBA_32BPP){for(p=0,v=r*yn*4,f=0;f<s;f++)h.set(u.subarray(c,c+v)),c+=v,n.putImageData(a,0,p),p+=yn;f<o&&(v=r*i*4,h.set(u.subarray(c,c+v)),n.putImageData(a,0,p))}else if(e.kind===Nf.RGB_24BPP)for(m=yn,v=r*m,f=0;f<o;f++){for(f>=s&&(m=i,v=r*m),l=0,p=v;p--;)h[l++]=u[c++],h[l++]=u[c++],h[l++]=u[c++],h[l++]=255;n.putImageData(a,0,f*yn)}else throw new Error(`bad image kind: ${e.kind}`)}function nR(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}let t=e.height,r=e.width,i=t%yn,s=(t-i)/yn,o=i===0?s:s+1,a=n.createImageData(r,yn),c=0,l=e.data,u=a.data;for(let h=0;h<o;h++){let f=h<s?yn:i;({srcPos:c}=R$({src:l,srcPos:c,dest:u,width:r,height:f,nonBlackColor:0})),n.putImageData(a,0,h*yn)}}function Vl(n,e){let t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Df(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Qt){let{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function rR(n,e){if(e)return!0;let t=K.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);let r=Math.fround((globalThis.devicePixelRatio||1)*rs.PDF_TO_CSS_UNITS);return t[0]<=r&&t[1]<=r}var L$=["butt","round","square"],F$=["miter","round","bevel"],V$={},iR={},Aa=class n{constructor(e,t,r,i,s,{optionalContentConfig:o,markedContentStack:a=null},c,l){this.ctx=e,this.current=new Kf(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new cE(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:i=null}){let s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,r){let c=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Xe(this.compositeCtx))}this.ctx.save(),Df(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Xe(this.ctx)}executeOperatorList(e,t,r,i){let s=e.argsArray,o=e.fnArray,a=t||0,c=s.length;if(c===a)return a;let l=c-a>ZM&&typeof r=="function",u=l?Date.now()+N$:0,h=0,f=this.commonObjs,p=this.objs,m;for(;;){if(i!==void 0&&a===i.nextBreakPoint)return i.breakIt(a,r),a;if(m=o[a],m!==lr.dependency)this[m].apply(this,s[a]);else for(let v of s[a]){let w=v.startsWith("g_")?f:p;if(!w.has(v))return w.get(v,r),a}if(a++,a===c)return a;if(l&&++h>ZM){if(Date.now()>u)return r(),a;h=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let e of this._cachedBitmapsMap.values()){for(let t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){let e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){let t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){let r=e.width??e.displayWidth,i=e.height??e.displayHeight,s=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=r,c=i,l="prescale1",u,h;for(;s>2&&a>1||o>2&&c>1;){let f=a,p=c;s>2&&a>1&&(f=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),s/=a/f),o>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/p),u=this.cachedCanvases.getCanvas(l,f,p),h=u.context,h.clearRect(0,0,f,p),h.drawImage(e,0,0,a,c,0,0,f,p),e=u.canvas,a=f,c=p,l=l==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:c}}_createMaskCanvas(e){let t=this.ctx,{width:r,height:i}=e,s=this.current.fillColor,o=this.current.patternFill,a=Xe(t),c,l,u,h;if((e.bitmap||e.data)&&e.count>1){let E=e.bitmap||e.data.buffer;l=JSON.stringify(o?a:[a.slice(0,4),s]),c=this._cachedBitmapsMap.get(E),c||(c=new Map,this._cachedBitmapsMap.set(E,c));let _=c.get(l);if(_&&!o){let A=Math.round(Math.min(a[0],a[2])+a[4]),C=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:_,offsetX:A,offsetY:C}}u=_}u||(h=this.cachedCanvases.getCanvas("maskCanvas",r,i),nR(h.context,e));let f=K.transform(a,[1/r,0,0,-1/i,0,0]);f=K.transform(f,[1,0,0,1,0,-i]);let[p,m,v,w]=K.getAxialAlignedBoundingBox([0,0,r,i],f),I=Math.round(v-p)||1,D=Math.round(w-m)||1,P=this.cachedCanvases.getCanvas("fillCanvas",I,D),x=P.context,N=p,k=m;x.translate(-N,-k),x.transform(...f),u||(u=this._scaleImage(h.canvas,di(x)),u=u.img,c&&o&&c.set(l,u)),x.imageSmoothingEnabled=rR(Xe(x),e.interpolate),Sf(x,u,0,0,u.width,u.height,0,0,r,i),x.globalCompositeOperation="source-in";let T=K.transform(di(x),[1,0,0,1,-N,-k]);return x.fillStyle=o?s.getPattern(t,this,T,cn.FILL):s,x.fillRect(0,0,r,i),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(l,P.canvas)),{canvas:P.canvas,offsetX:Math.round(N),offsetY:Math.round(k)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=L$[e]}setLineJoin(e){this.ctx.lineJoin=F$[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){let r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(let[t,r]of e)switch(t){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.current.fillAlpha=r,this.ctx.globalAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let e=this.ctx.canvas.width,t=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;let s=this.ctx;s.setTransform(...Xe(this.suspendedCtx)),Vl(this.suspendedCtx,s),O$(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Vl(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,i){let s=i[0],o=i[1],a=i[2]-s,c=i[3]-o;a===0||c===0||(this.genericComposeSMask(t.context,r,a,c,t.subtype,t.backdrop,t.transferMap,s,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,i,s,o,a,c,l,u,h){let f=e.canvas,p=c-u,m=l-h;if(o){let w=K.makeHexColor(...o);if(p<0||m<0||p+r>f.width||m+i>f.height){let I=this.cachedCanvases.getCanvas("maskExtension",r,i),D=I.context;D.drawImage(f,-p,-m),D.globalCompositeOperation="destination-atop",D.fillStyle=w,D.fillRect(0,0,r,i),D.globalCompositeOperation="source-over",f=I.canvas,p=m=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);let I=new Path2D;I.rect(p,m,r,i),e.clip(I),e.globalCompositeOperation="destination-atop",e.fillStyle=w,e.fillRect(p,m,r,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));let v=new Path2D;v.rect(c,l,r,i),t.clip(v),t.globalCompositeOperation="destination-in",t.drawImage(f,p,m,r,i,c,l,r,i),t.restore()}save(){this.inSMaskMode?(Vl(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Vl(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,r,i,s,o){this.ctx.transform(e,t,r,i,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r){let i=this.ctx,s=this.current,o=s.x,a=s.y,c,l,u=Xe(i),h=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,f=h?r.slice(0):null;for(let p=0,m=0,v=e.length;p<v;p++)switch(e[p]|0){case lr.rectangle:o=t[m++],a=t[m++];let w=t[m++],I=t[m++],D=o+w,P=a+I;i.moveTo(o,a),w===0||I===0?i.lineTo(D,P):(i.lineTo(D,a),i.lineTo(D,P),i.lineTo(o,P)),h||s.updateRectMinMax(u,[o,a,D,P]),i.closePath();break;case lr.moveTo:o=t[m++],a=t[m++],i.moveTo(o,a),h||s.updatePathMinMax(u,o,a);break;case lr.lineTo:o=t[m++],a=t[m++],i.lineTo(o,a),h||s.updatePathMinMax(u,o,a);break;case lr.curveTo:c=o,l=a,o=t[m+4],a=t[m+5],i.bezierCurveTo(t[m],t[m+1],t[m+2],t[m+3],o,a),s.updateCurvePathMinMax(u,c,l,t[m],t[m+1],t[m+2],t[m+3],o,a,f),m+=6;break;case lr.curveTo2:c=o,l=a,i.bezierCurveTo(o,a,t[m],t[m+1],t[m+2],t[m+3]),s.updateCurvePathMinMax(u,c,l,o,a,t[m],t[m+1],t[m+2],t[m+3],f),o=t[m+2],a=t[m+3],m+=4;break;case lr.curveTo3:c=o,l=a,o=t[m+2],a=t[m+3],i.bezierCurveTo(t[m],t[m+1],o,a,o,a),s.updateCurvePathMinMax(u,c,l,t[m],t[m+1],o,a,o,a,f),m+=4;break;case lr.closePath:i.closePath();break}h&&s.updateScalingPathMinMax(u,f),s.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(e=!0){let t=this.ctx,r=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof r=="object"&&r?.getPattern?(t.save(),t.strokeStyle=r.getPattern(t,this,di(t),cn.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){let t=this.ctx,r=this.current.fillColor,i=this.current.patternFill,s=!1;i&&(t.save(),t.fillStyle=r.getPattern(t,this,di(t),cn.FILL),s=!0);let o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),s&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V$}eoClip(){this.pendingClip=iR}beginText(){this.current.textMatrix=aR,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(let r of e)t.setTransform(...r.transform),t.translate(r.x,r.y),r.addToPath(t,r.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){let r=this.commonObjs.get(e),i=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=r.fontMatrix||Bw,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ve("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=t,r.isType3Font)return;let s=r.loadedName||"sans-serif",o=r.systemFontInfo?.css||`"${s}", ${r.fallbackName}`,a="normal";r.black?a="900":r.bold&&(a="bold");let c=r.italic?"italic":"normal",l=t;t<XM?l=XM:t>JM&&(l=JM),this.current.fontSizeScale=t/l,this.ctx.font=`${c} ${a} ${l}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,r,i,s,o){this.current.textMatrix=[e,t,r,i,s,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,r,i){let s=this.ctx,o=this.current,a=o.font,c=o.textRenderingMode,l=o.fontSize/o.fontSizeScale,u=c&Yt.FILL_STROKE_MASK,h=!!(c&Yt.ADD_TO_PATH_FLAG),f=o.patternFill&&!a.missingFile,p;(a.disableFontFace||h||f)&&(p=a.getPathGenerator(this.commonObjs,e)),a.disableFontFace||f?(s.save(),s.translate(t,r),s.beginPath(),p(s,l),i&&s.setTransform(...i),(u===Yt.FILL||u===Yt.FILL_STROKE)&&s.fill(),(u===Yt.STROKE||u===Yt.FILL_STROKE)&&s.stroke(),s.restore()):((u===Yt.FILL||u===Yt.FILL_STROKE)&&s.fillText(e,t,r),(u===Yt.STROKE||u===Yt.FILL_STROKE)&&s.strokeText(e,t,r)),h&&(this.pendingTextPaths||=[]).push({transform:Xe(s),x:t,y:r,fontSize:l,addToPath:p})}get isFontSubpixelAAEnabled(){let{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);let t=e.getImageData(0,0,10,10).data,r=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return Te(this,"isFontSubpixelAAEnabled",r)}showText(e){let t=this.current,r=t.font;if(r.isType3Font)return this.showType3Text(e);let i=t.fontSize;if(i===0)return;let s=this.ctx,o=t.fontSizeScale,a=t.charSpacing,c=t.wordSpacing,l=t.fontDirection,u=t.textHScale*l,h=e.length,f=r.vertical,p=f?1:-1,m=r.defaultVMetrics,v=i*t.fontMatrix[0],w=t.textRenderingMode===Yt.FILL&&!r.disableFontFace&&!t.patternFill;s.save(),s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),l>0?s.scale(u,-1):s.scale(u,1);let I;if(t.patternFill){s.save();let k=t.fillColor.getPattern(s,this,di(s),cn.FILL);I=Xe(s),s.restore(),s.fillStyle=k}let D=t.lineWidth,P=t.textMatrixScale;if(P===0||D===0){let k=t.textRenderingMode&Yt.FILL_STROKE_MASK;(k===Yt.STROKE||k===Yt.FILL_STROKE)&&(D=this.getSinglePixelWidth())}else D/=P;if(o!==1&&(s.scale(o,o),D/=o),s.lineWidth=D,r.isInvalidPDFjsFont){let k=[],T=0;for(let E of e)k.push(E.unicode),T+=E.width;s.fillText(k.join(""),0,0),t.x+=T*v*u,s.restore(),this.compose();return}let x=0,N;for(N=0;N<h;++N){let k=e[N];if(typeof k=="number"){x+=p*k*i/1e3;continue}let T=!1,E=(k.isSpace?c:0)+a,_=k.fontChar,A=k.accent,C,M,S=k.width;if(f){let _e=k.vmetric||m,We=-(k.vmetric?_e[1]:S*.5)*v,X=_e[2]*v;S=_e?-_e[0]:S,C=We/o,M=(x+X)/o}else C=x/o,M=0;if(r.remeasure&&S>0){let _e=s.measureText(_).width*1e3/i*o;if(S<_e&&this.isFontSubpixelAAEnabled){let We=S/_e;T=!0,s.save(),s.scale(We,1),C/=We}else S!==_e&&(C+=(S-_e)/2e3*i/o)}if(this.contentVisible&&(k.isInFont||r.missingFile)){if(w&&!A)s.fillText(_,C,M);else if(this.paintChar(_,C,M,I),A){let _e=C+i*A.offset.x/o,We=M-i*A.offset.y/o;this.paintChar(A.fontChar,_e,We,I)}}let Z=f?S*v-E*l:S*v+E*l;x+=Z,T&&s.restore()}f?t.y-=x:t.x+=x*u,s.restore(),this.compose()}showType3Text(e){let t=this.ctx,r=this.current,i=r.font,s=r.fontSize,o=r.fontDirection,a=i.vertical?1:-1,c=r.charSpacing,l=r.wordSpacing,u=r.textHScale*o,h=r.fontMatrix||Bw,f=e.length,p=r.textRenderingMode===Yt.INVISIBLE,m,v,w,I;if(!(p||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...r.textMatrix),t.translate(r.x,r.y),t.scale(u,o),m=0;m<f;++m){if(v=e[m],typeof v=="number"){I=a*v*s/1e3,this.ctx.translate(I,0),r.x+=I*u;continue}let D=(v.isSpace?l:0)+c,P=i.charProcOperatorList[v.operatorListId];if(!P){ve(`Type3 character "${v.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=v,this.save(),t.scale(s,s),t.transform(...h),this.executeOperatorList(P),this.restore()),w=K.applyTransform([v.width,0],h)[0]*s+D,t.translate(w,0),r.x+=w*u}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,r,i,s,o){this.ctx.rect(r,i,s-r,o-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){let r=e[1],i=this.baseTransform||Xe(this.ctx),s={createCanvasGraphics:o=>new n(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new M$(e,r,this.ctx,s,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,r){this.ctx.strokeStyle=this.current.strokeColor=K.makeHexColor(e,t,r)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,r){this.ctx.fillStyle=this.current.fillColor=K.makeHexColor(e,t,r),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=P$(this.getObject(e)),this.cachedPatterns.set(e,r)),t&&(r.matrix=t),r}shadingFill(e){if(!this.contentVisible)return;let t=this.ctx;this.save();let r=this._getPattern(e);t.fillStyle=r.getPattern(t,this,di(t),cn.SHADING);let i=di(t);if(i){let{width:s,height:o}=t.canvas,[a,c,l,u]=K.getAxialAlignedBoundingBox([0,0,s,o],i);this.ctx.fillRect(a,c,l-a,u-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ge("Should not call beginInlineImage")}beginImageData(){Ge("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Xe(this.ctx),t)){let r=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],r,i),this.current.updateRectMinMax(Xe(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let t=this.ctx;e.isolated||mp("TODO: Support non-isolated groups."),e.knockout&&ve("Knockout groups not supported.");let r=Xe(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=K.getAxialAlignedBoundingBox(e.bbox,Xe(t)),s=[0,0,t.canvas.width,t.canvas.height];i=K.intersect(i,s)||[0,0,0,0];let o=Math.floor(i[0]),a=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-o,1),l=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,c,l]);let u="groupAt"+this.groupLevel;e.smask&&(u+="_smask_"+this.smaskCounter++%2);let h=this.cachedCanvases.getCanvas(u,c,l),f=h.context;f.translate(-o,-a),f.transform(...r),e.smask?this.smaskStack.push({canvas:h.canvas,context:f,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),Vl(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;let t=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let i=Xe(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);let s=K.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,r,i,s){if(this.#e(),Df(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){let o=t[2]-t[0],a=t[3]-t[1];if(s&&this.annotationCanvasMap){r=r.slice(),r[4]-=t[0],r[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a;let[c,l]=K.singularValueDecompose2dScale(Xe(this.ctx)),{viewportScale:u}=this,h=Math.ceil(o*this.outputScaleX*u),f=Math.ceil(a*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,f);let{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(c,0,0,-l,0,a*l),Df(this.ctx)}else Df(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new Kf(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;let t=e.count;e=this.getObject(e.data,e),e.count=t;let r=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=k$(e)),i.compiled)){i.compiled(r);return}let s=this._createMaskCanvas(e),o=s.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,s.offsetX,s.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r=0,i=0,s,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);let a=this.ctx;a.save();let c=Xe(a);a.transform(t,r,i,s,0,0);let l=this._createMaskCanvas(e);a.setTransform(1,0,0,1,l.offsetX-c[4],l.offsetY-c[5]);for(let u=0,h=o.length;u<h;u+=2){let f=K.transform(c,[t,r,i,s,o[u],o[u+1]]),[p,m]=K.applyTransform([0,0],f);a.drawImage(l.canvas,p,m)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;let t=this.ctx,r=this.current.fillColor,i=this.current.patternFill;for(let s of e){let{data:o,width:a,height:c,transform:l}=s,u=this.cachedCanvases.getCanvas("maskCanvas",a,c),h=u.context;h.save();let f=this.getObject(o,s);nR(h,f),h.globalCompositeOperation="source-in",h.fillStyle=i?r.getPattern(h,this,di(t),cn.FILL):r,h.fillRect(0,0,a,c),h.restore(),t.save(),t.transform(...l),t.scale(1,-1),Sf(t,u.canvas,0,0,a,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;let t=this.getObject(e);if(!t){ve("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,r,i){if(!this.contentVisible)return;let s=this.getObject(e);if(!s){ve("Dependent image isn't ready yet");return}let o=s.width,a=s.height,c=[];for(let l=0,u=i.length;l<u;l+=2)c.push({transform:[t,0,0,r,i[l],i[l+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(s,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;let{bitmap:t,width:r,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;let t=e.width,r=e.height,i=this.ctx;if(this.save(),!Qt){let{filter:a}=i;a!=="none"&&a!==""&&(i.filter="none")}i.scale(1/t,-1/r);let s;if(e.bitmap)s=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)s=e;else{let c=this.cachedCanvases.getCanvas("inlineImage",t,r).context;tR(c,e),s=this.applyTransferMapsToCanvas(c)}let o=this._scaleImage(s,di(i));i.imageSmoothingEnabled=rR(Xe(i),e.interpolate),Sf(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-r,t,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;let r=this.ctx,i;if(e.bitmap)i=e.bitmap;else{let s=e.width,o=e.height,c=this.cachedCanvases.getCanvas("inlineImage",s,o).context;tR(c,e),i=this.applyTransferMapsToCanvas(c)}for(let s of t)r.save(),r.transform(...s.transform),r.scale(1,-1),Sf(r,i,s.x,s.y,s.w,s.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){let t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);let r=this.ctx;this.pendingClip&&(t||(this.pendingClip===iR?r.clip("evenodd"):r.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),r.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let e=Xe(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{let t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:e}=this.current,{a:t,b:r,c:i,d:s}=this.ctx.getTransform(),o,a;if(r===0&&i===0){let c=Math.abs(t),l=Math.abs(s);if(c===l)if(e===0)o=a=1/c;else{let u=c*e;o=a=u<1?1/u:1}else if(e===0)o=1/c,a=1/l;else{let u=c*e,h=l*e;o=u<1?1/u:1,a=h<1?1/h:1}}else{let c=Math.abs(t*s-r*i),l=Math.hypot(t,r),u=Math.hypot(i,s);if(e===0)o=u/c,a=l/c;else{let h=e*c;o=u>h?u/h:1,a=l>h?l/h:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){let{ctx:t}=this,{lineWidth:r}=this.current,[i,s]=this.getScaleForStroking();if(t.lineWidth=r||1,i===1&&s===1){t.stroke();return}let o=t.getLineDash();if(e&&t.save(),t.scale(i,s),o.length>0){let a=Math.max(i,s);t.setLineDash(o.map(c=>c/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};for(let n in lr)Aa.prototype[n]!==void 0&&(Aa.prototype[lr[n]]=Aa.prototype[n]);var io=class{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}},xf={UNKNOWN:0,DATA:1,ERROR:2},ht={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Cn(n){switch(n instanceof Error||typeof n=="object"&&n!==null||Ge('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new gi(n.message);case"MissingPDFException":return new pi(n.message);case"PasswordException":return new Hl(n.message,n.code);case"UnexpectedResponseException":return new Ca(n.message,n.status);case"UnknownErrorException":return new $l(n.message,n.details);default:return new $l(n.message,n.toString())}}var ro=class{#e=new AbortController;constructor(e,t,r){this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#r(e);return}if(e.callback){let r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===xf.DATA)i.resolve(e.data);else if(e.callback===xf.ERROR)i.reject(Cn(e.reason));else throw new Error("Unexpected callback case");return}let t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){let r=this.sourceName,i=e.sourceName,s=this.comObj;new Promise(function(o){o(t(e.data))}).then(function(o){s.postMessage({sourceName:r,targetName:i,callback:xf.DATA,callbackId:e.callbackId,data:o})},function(o){s.postMessage({sourceName:r,targetName:i,callback:xf.ERROR,callbackId:e.callbackId,reason:Cn(o)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){let r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){let i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(o){s.reject(o)}return s.promise}sendWithStream(e,t,r,i){let s=this.streamId++,o=this.sourceName,a=this.targetName,c=this.comObj;return new ReadableStream({start:l=>{let u=Promise.withResolvers();return this.streamControllers[s]={controller:l,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:a,action:e,streamId:s,data:t,desiredSize:l.desiredSize},i),u.promise},pull:l=>{let u=Promise.withResolvers();return this.streamControllers[s].pullCall=u,c.postMessage({sourceName:o,targetName:a,stream:ht.PULL,streamId:s,desiredSize:l.desiredSize}),u.promise},cancel:l=>{At(l instanceof Error,"cancel must have a valid reason");let u=Promise.withResolvers();return this.streamControllers[s].cancelCall=u,this.streamControllers[s].isClosed=!0,c.postMessage({sourceName:o,targetName:a,stream:ht.CANCEL,streamId:s,reason:Cn(l)}),u.promise}},r)}#n(e){let t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,o=this,a=this.actionHandler[e.action],c={enqueue(l,u=1,h){if(this.isCancelled)return;let f=this.desiredSize;this.desiredSize-=u,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:ht.ENQUEUE,streamId:t,chunk:l},h)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:ht.CLOSE,streamId:t}),delete o.streamSinks[t])},error(l){At(l instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:ht.ERROR,streamId:t,reason:Cn(l)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,new Promise(function(l){l(a(e.data,c))}).then(function(){s.postMessage({sourceName:r,targetName:i,stream:ht.START_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:r,targetName:i,stream:ht.START_COMPLETE,streamId:t,reason:Cn(l)})})}#r(e){let t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case ht.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Cn(e.reason));break;case ht.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Cn(e.reason));break;case ht.PULL:if(!a){s.postMessage({sourceName:r,targetName:i,stream:ht.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,new Promise(function(c){c(a.onPull?.())}).then(function(){s.postMessage({sourceName:r,targetName:i,stream:ht.PULL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:i,stream:ht.PULL_COMPLETE,streamId:t,reason:Cn(c)})});break;case ht.ENQUEUE:if(At(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case ht.CLOSE:if(At(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#i(o,t);break;case ht.ERROR:At(o,"error should have stream controller"),o.controller.error(Cn(e.reason)),this.#i(o,t);break;case ht.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Cn(e.reason)),this.#i(o,t);break;case ht.CANCEL:if(!a)break;new Promise(function(c){c(a.onCancel?.(Cn(e.reason)))}).then(function(){s.postMessage({sourceName:r,targetName:i,stream:ht.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:i,stream:ht.CANCEL_COMPLETE,streamId:t,reason:Cn(c)})}),a.sinkCapability.reject(Cn(e.reason)),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#i(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}},lE=class{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return ib(this.#e)}has(e){return this.#e.has(e)}},Ia=Symbol("INTERNAL"),uE=class{#e=!1;#t=!1;#n=!1;#r=!0;constructor(e,{name:t,intent:r,usage:i,rbGroups:s}){this.#e=!!(e&Sn.DISPLAY),this.#t=!!(e&Sn.PRINT),this.name=t,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(this.#n)return this.#r;if(!this.#r)return!1;let{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,r=!1){e!==Ia&&Ge("Internal method `_setVisible` called."),this.#n=r,this.#r=t}},dE=class{#e=null;#t=new Map;#n=null;#r=null;constructor(e,t=Sn.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#r=e.order;for(let r of e.groups)this.#t.set(r.id,new uE(t,r));if(e.baseState==="OFF")for(let r of this.#t.values())r._setVisible(Ia,!1);for(let r of e.on)this.#t.get(r)._setVisible(Ia,!0);for(let r of e.off)this.#t.get(r)._setVisible(Ia,!1);this.#n=this.getHash()}}#i(e){let t=e.length;if(t<2)return!0;let r=e[0];for(let i=1;i<t;i++){let s=e[i],o;if(Array.isArray(s))o=this.#i(s);else if(this.#t.has(s))o=this.#t.get(s).visible;else return ve(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return r==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return mp("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(ve(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#i(e.expression);if(!e.policy||e.policy==="AnyOn"){for(let t of e.ids){if(!this.#t.has(t))return ve(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(let t of e.ids){if(!this.#t.has(t))return ve(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(let t of e.ids){if(!this.#t.has(t))return ve(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(let t of e.ids){if(!this.#t.has(t))return ve(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return ve(`Unknown optional content policy ${e.policy}.`),!0}return ve(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){let i=this.#t.get(e);if(!i){ve(`Optional content group not found: ${e}`);return}if(r&&t&&i.rbGroups.length)for(let s of i.rbGroups)for(let o of s)o!==e&&this.#t.get(o)?._setVisible(Ia,!1,!0);i._setVisible(Ia,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let r;for(let i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}let s=this.#t.get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#r?this.#r.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?ib(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;let e=new Bf;for(let[t,r]of this.#t)e.update(`${t}:${r.visible}`);return this.#e=e.hexdigest()}},hE=class{constructor(e,{disableRange:t=!1,disableStream:r=!1}){At(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');let{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,s?.length>0){let c=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,l)=>{this._onReceiveData({begin:c,chunk:l})}),e.addProgressListener((c,l)=>{this._onProgress({loaded:c,total:l})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){let r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{let i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});At(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){let t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){At(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let e=this._queuedChunks;return this._queuedChunks=null,new fE(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let r=new pE(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}},fE=class{constructor(e,t,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=ob(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(let s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},pE=class{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(let r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function j$(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let u=a(t);return u=unescape(u),u=c(u),u=l(u),s(u)}if(t=o(n),t){let u=l(t);return s(u)}if(t=r("filename","i").exec(n),t){t=t[1];let u=a(t);return u=l(u),s(u)}function r(u,h){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(u,h){if(u){if(!/^[\x00-\xFF]+$/.test(h))return h;try{let f=new TextDecoder(u,{fatal:!0}),p=yp(h);h=f.decode(p),e=!1}catch{}}return h}function s(u){return e&&/[\x80-\xff]/.test(u)&&(u=i("utf-8",u),e&&(u=i("iso-8859-1",u))),u}function o(u){let h=[],f,p=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(u))!==null;){let[,v,w,I]=f;if(v=parseInt(v,10),v in h){if(v===0)break;continue}h[v]=[w,I]}let m=[];for(let v=0;v<h.length&&v in h;++v){let[w,I]=h[v];I=a(I),w&&(I=unescape(I),v===0&&(I=c(I))),m.push(I)}return m.join("")}function a(u){if(u.startsWith('"')){let h=u.slice(1).split('\\"');for(let f=0;f<h.length;++f){let p=h[f].indexOf('"');p!==-1&&(h[f]=h[f].slice(0,p),h.length=f+1),h[f]=h[f].replaceAll(/\\(.)/g,"$1")}u=h.join('"')}return u}function c(u){let h=u.indexOf("'");if(h===-1)return u;let f=u.slice(0,h),m=u.slice(h+1).replace(/^[^']*'/,"");return i(f,m)}function l(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,f,p,m){if(p==="q"||p==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,w){return String.fromCharCode(parseInt(w,16))}),i(f,m);try{m=atob(m)}catch{}return i(f,m)})}return""}function cb(n,e){let t=new Headers;if(!n||!e||typeof e!="object")return t;for(let r in e){let i=e[r];i!==void 0&&t.append(r,i)}return t}function lb({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){let i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function ub(n){let e=n.get("Content-Disposition");if(e){let t=j$(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(ob(t))return t}return null}function wp(n,e){return n===404||n===0&&e.startsWith("file:")?new pi('Missing PDF "'+e+'".'):new Ca(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function uR(n){return n===200||n===206}function dR(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function hR(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ve(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}var Yf=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=cb(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return At(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new gE(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let r=new mE(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},gE=class{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;let t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;let r=new Headers(e.headers),i=t.url;fetch(i,dR(r,this._withCredentials,this._abortController)).then(s=>{if(!uR(s.status))throw wp(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();let o=s.headers,{allowRangeRequests:a,suggestedLength:c}=lb({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=c||this._contentLength,this._filename=ub(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new gi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;let{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:hR(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},mE=class{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;let i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;let s=new Headers(e.headers);s.append("Range",`bytes=${t}-${r-1}`);let o=i.url;fetch(o,dR(s,this._withCredentials,this._abortController)).then(a=>{if(!uR(a.status))throw wp(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;let{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:hR(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},Vw=200,jw=206;function B$(n){let e=n.response;return typeof e!="string"?e:yp(e).buffer}var yE=class{constructor({url:e,httpHeaders:t,withCredentials:r}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=cb(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,r){let i={begin:e,end:t};for(let s in r)i[s]=r[s];return this.request(i)}requestFull(e){return this.request(e)}request(e){let t=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(let[s,o]of this.headers)t.setRequestHeader(s,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=jw):i.expectedStatus=Vw,t.responseType="arraybuffer",e.onError&&(t.onerror=function(s){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){let r=this.pendingRequests[e];r&&r.onProgress?.(t)}onStateChange(e,t){let r=this.pendingRequests[e];if(!r)return;let i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError?.(i.status);return}let s=i.status||Vw;if(!(s===Vw&&r.expectedStatus===jw)&&s!==r.expectedStatus){r.onError?.(i.status);return}let a=B$(i);if(s===jw){let c=i.getResponseHeader("Content-Range"),l=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);r.onDone({begin:parseInt(l[1],10),chunk:a})}else a?r.onDone({begin:0,chunk:a}):r.onError?.(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){let t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},vE=class{constructor(e){this._source=e,this._manager=new yE(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){let t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return At(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _E(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){let r=new wE(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},_E=class{constructor(e,t){this._manager=e;let r={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(r),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let e=this._fullRequestId,t=this._manager.getRequestXhr(e),r=new Headers(t.getAllResponseHeaders().trim().split(/[\r\n]+/).map(o=>{let[a,...c]=o.split(": ");return[a,c.join(": ")]})),{allowRangeRequests:i,suggestedLength:s}=lb({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=ub(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=wp(e,this._url),this._headersCapability.reject(this._storedError);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},wE=class{constructor(e,t,r){this._manager=e;let i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,r,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){let t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(let r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=wp(e,this._url);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},U$=/^[a-z][a-z0-9\-+.]+:/i;function H$(n){if(U$.test(n))return new URL(n);let e=Mr.get("url");return new URL(e.pathToFileURL(n))}function fR(n,e,t){return n.protocol==="http:"?Mr.get("http").request(n,{headers:e},t):Mr.get("https").request(n,{headers:e},t)}var EE=class{constructor(e){this.source=e,this.url=H$(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=cb(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return At(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new AE(this):new bE(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let r=this.isFsUrl?new TE(this,e,t):new IE(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Qf=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;let t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new gi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},Xf=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();let t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}},bE=class extends Qf{constructor(e){super(e);let t=Object.fromEntries(e.headers),r=i=>{if(i.statusCode===404){let c=new pi(`Missing PDF "${this._url}".`);this._storedError=c,this._headersCapability.reject(c);return}this._headersCapability.resolve(),this._setReadableStream(i);let s=new Headers(this._readableStream.headers),{allowRangeRequests:o,suggestedLength:a}=lb({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=a||this._contentLength,this._filename=ub(s)};this._request=fR(this._url,t,r),this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}},IE=class extends Xf{constructor(e,t,r){super(e);let i=Object.fromEntries(e.headers);i.Range=`bytes=${t}-${r-1}`;let s=o=>{if(o.statusCode===404){let a=new pi(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(o)};this._request=fR(this._url,i,s),this._request.on("error",o=>{this._storedError=o}),this._request.end()}},AE=class extends Qf{constructor(e){super(e);let t=Mr.get("fs");t.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(t.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new pi(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}},TE=class extends Xf{constructor(e,t,r){super(e);let i=Mr.get("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:r-1}))}},$$=1e5,mn=30,z$=.8,Ql=class n{#e=Promise.withResolvers();#t=null;#n=!1;#r=!!globalThis.FontInspector?.enabled;#i=null;#s=null;#c=0;#l=0;#u=null;#a=null;#d=0;#o=0;#h=Object.create(null);#p=[];#f=null;#g=[];#y=new WeakMap;#m=null;static#v=new Map;static#w=new Map;static#I=new WeakMap;static#E=null;static#b=new Set;constructor({textContentSource:e,container:t,viewport:r}){if(e instanceof ReadableStream)this.#f=e;else if(typeof e=="object")this.#f=new ReadableStream({start(c){c.enqueue(e),c.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#a=t,this.#o=r.scale*(globalThis.devicePixelRatio||1),this.#d=r.rotation,this.#s={div:null,properties:null,ctx:null};let{pageWidth:i,pageHeight:s,pageX:o,pageY:a}=r.rawDims;this.#m=[1,0,0,-1,-o,a+s],this.#l=i,this.#c=s,n.#M(),so(t,r),this.#e.promise.finally(()=>{n.#b.delete(this),this.#s=null,this.#h=null}).catch(()=>{})}static get fontFamilyMap(){let{isWindows:e,isFirefox:t}=Ut.platform;return Te(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){let e=()=>{this.#u.read().then(({value:t,done:r})=>{if(r){this.#e.resolve();return}this.#i??=t.lang,Object.assign(this.#h,t.styles),this.#P(t.items),e()},this.#e.reject)};return this.#u=this.#f.getReader(),n.#b.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){let r=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==this.#d&&(t?.(),this.#d=i,so(this.#a,{rotation:i})),r!==this.#o){t?.(),this.#o=r;let s={div:null,properties:null,ctx:n.#D(this.#i)};for(let o of this.#g)s.properties=this.#y.get(o),s.div=o,this.#A(s)}}cancel(){let e=new gi("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#p}#P(e){if(this.#n)return;this.#s.ctx??=n.#D(this.#i);let t=this.#g,r=this.#p;for(let i of e){if(t.length>$$){ve("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){let s=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id!==null&&this.#t.setAttribute("id",`${i.id}`),s.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}r.push(i.str),this.#S(i)}}#S(e){let t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#g.push(t);let i=K.transform(this.#m,e.transform),s=Math.atan2(i[1],i[0]),o=this.#h[e.fontName];o.vertical&&(s+=Math.PI/2);let a=this.#r&&o.fontSubstitution||o.fontFamily;a=n.fontFamilyMap.get(a)||a;let c=Math.hypot(i[2],i[3]),l=c*n.#N(a,this.#i),u,h;s===0?(u=i[4],h=i[5]-l):(u=i[4]+l*Math.sin(s),h=i[5]-l*Math.cos(s));let f="calc(var(--scale-factor)*",p=t.style;this.#t===this.#a?(p.left=`${(100*u/this.#l).toFixed(2)}%`,p.top=`${(100*h/this.#c).toFixed(2)}%`):(p.left=`${f}${u.toFixed(2)}px)`,p.top=`${f}${h.toFixed(2)}px)`),p.fontSize=`${f}${(n.#E*c).toFixed(2)}px)`,p.fontFamily=a,r.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#r&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let m=!1;if(e.str.length>1)m=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){let v=Math.abs(e.transform[0]),w=Math.abs(e.transform[3]);v!==w&&Math.max(v,w)/Math.min(v,w)>1.5&&(m=!0)}if(m&&(r.canvasWidth=o.vertical?e.height:e.width),this.#y.set(t,r),this.#s.div=t,this.#s.properties=r,this.#A(this.#s),r.hasText&&this.#t.append(t),r.hasEOL){let v=document.createElement("br");v.setAttribute("role","presentation"),this.#t.append(v)}}#A(e){let{div:t,properties:r,ctx:i}=e,{style:s}=t,o="";if(n.#E>1&&(o=`scale(${1/n.#E})`),r.canvasWidth!==0&&r.hasText){let{fontFamily:a}=s,{canvasWidth:c,fontSize:l}=r;n.#C(i,l*this.#o,a);let{width:u}=i.measureText(t.textContent);u>0&&(o=`scaleX(${c*this.#o/u}) ${o}`)}r.angle!==0&&(o=`rotate(${r.angle}deg) ${o}`),o.length>0&&(s.transform=o)}static cleanup(){if(!(this.#b.size>0)){this.#v.clear();for(let{canvas:e}of this.#w.values())e.remove();this.#w.clear()}}static#D(e=null){let t=this.#w.get(e||="");if(!t){let r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#w.set(e,t),this.#I.set(t,{size:0,family:""})}return t}static#C(e,t,r){let i=this.#I.get(e);t===i.size&&r===i.family||(e.font=`${t}px ${r}`,i.size=t,i.family=r)}static#M(){if(this.#E!==null)return;let e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#E=e.getBoundingClientRect().height,e.remove()}static#N(e,t){let r=this.#v.get(e);if(r)return r;let i=this.#D(t);i.canvas.width=i.canvas.height=mn,this.#C(i,mn,e);let s=i.measureText(""),o=s.fontBoundingBoxAscent,a=Math.abs(s.fontBoundingBoxDescent);if(o){let u=o/(o+a);return this.#v.set(e,u),i.canvas.width=i.canvas.height=0,u}i.strokeStyle="red",i.clearRect(0,0,mn,mn),i.strokeText("g",0,0);let c=i.getImageData(0,0,mn,mn).data;a=0;for(let u=c.length-1-3;u>=0;u-=4)if(c[u]>0){a=Math.ceil(u/4/mn);break}i.clearRect(0,0,mn,mn),i.strokeText("A",0,mn),c=i.getImageData(0,0,mn,mn).data,o=0;for(let u=0,h=c.length;u<h;u+=4)if(c[u]>0){o=mn-Math.floor(u/4/mn);break}i.canvas.width=i.canvas.height=0;let l=o?o/(o+a):z$;return this.#v.set(e,l),l}},Xl=class n{static textContent(e){let t=[],r={items:t,styles:Object.create(null)};function i(s){if(!s)return;let o=null,a=s.name;if(a==="#text")o=s.value;else if(n.shouldBuildText(a))s?.attributes?.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&t.push({str:o}),!!s.children)for(let c of s.children)i(c)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}},G$=65536,W$=100,q$=5e3,K$=Qt?tE:Jw,Y$=Qt?nE:zf,Q$=Qt?eE:Zw,X$=Qt?rE:qf;function J$(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});let e=new CE,{docId:t}=e,r=n.url?Z$(n.url):null,i=n.data?ez(n.data):null,s=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,c=n.range instanceof Jf?n.range:null,l=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:G$,u=n.worker instanceof Ta?n.worker:null,h=n.verbosity,f=typeof n.docBaseUrl=="string"&&!_p(n.docBaseUrl)?n.docBaseUrl:null,p=typeof n.cMapUrl=="string"?n.cMapUrl:null,m=n.cMapPacked!==!1,v=n.CMapReaderFactory||Y$,w=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,I=n.StandardFontDataFactory||X$,D=n.stopAtErrors!==!0,P=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,x=n.isEvalSupported!==!1,N=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Qt,k=typeof n.isChrome=="boolean"?n.isChrome:!Ut.platform.isFirefox&&typeof window<"u"&&!!window?.chrome,T=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,E=typeof n.disableFontFace=="boolean"?n.disableFontFace:Qt,_=n.fontExtraProperties===!0,A=n.enableXfa===!0,C=n.ownerDocument||globalThis.document,M=n.disableRange===!0,S=n.disableStream===!0,Z=n.disableAutoFetch===!0,_e=n.pdfBug===!0,We=n.CanvasFactory||K$,X=n.FilterFactory||Q$,se=n.enableHWA===!0,_n=c?c.length:n.length??NaN,Yr=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Qt&&!E,en=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:v===zf&&I===qf&&p&&w&&Bl(p,document.baseURI)&&Bl(w,document.baseURI);n.canvasFactory&&qM("`canvasFactory`-instance option, please use `CanvasFactory` instead."),n.filterFactory&&qM("`filterFactory`-instance option, please use `FilterFactory` instead.");let ot=null;f$(h);let Qe={canvasFactory:new We({ownerDocument:C,enableHWA:se}),filterFactory:new X({docId:t,ownerDocument:C}),cMapReaderFactory:en?null:new v({baseUrl:p,isCompressed:m}),standardFontDataFactory:en?null:new I({baseUrl:w})};if(!u){let zt={verbosity:h,port:io.workerPort};u=zt.port?Ta.fromPort(zt):new Ta(zt),e._worker=u}let Qn={docId:t,apiVersion:"4.8.69",data:i,password:a,disableAutoFetch:Z,rangeChunkSize:l,length:_n,docBaseUrl:f,enableXfa:A,evaluatorOptions:{maxImageSize:P,disableFontFace:E,ignoreErrors:D,isEvalSupported:x,isOffscreenCanvasSupported:N,isChrome:k,canvasMaxAreaInBytes:T,fontExtraProperties:_,useSystemFonts:Yr,cMapUrl:en?p:null,standardFontDataUrl:en?w:null}},Qr={disableFontFace:E,fontExtraProperties:_,ownerDocument:C,pdfBug:_e,styleElement:ot,loadingParams:{disableAutoFetch:Z,enableXfa:A}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");let zt=u.messageHandler.sendWithPromise("GetDocRequest",Qn,i?[i.buffer]:null),Fe;if(c)Fe=new hE(c,{disableRange:M,disableStream:S});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");let wn;Qt?wn=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&Bl(r)?Yf:EE:wn=Bl(r)?Yf:vE,Fe=new wn({url:r,length:_n,httpHeaders:s,withCredentials:o,rangeChunkSize:l,disableRange:M,disableStream:S})}return zt.then(wn=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");let Bo=new ro(t,wn,u.port),ad=new PE(Bo,e,Fe,Qr,Qe);e._transport=ad,Bo.send("Ready",null)})}).catch(e._capability.reject),e}function Z$(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Qt&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function ez(n){if(Qt&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return yp(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function sR(n){return typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0}var CE=class n{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${n.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}},Jf=class{constructor(e,t,r=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(let r of this._rangeListeners)r(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(let r of this._progressListeners)r(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(let t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Ge("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},SE=class{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Te(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}},DE=class{#e=null;#t=!1;constructor(e,t,r,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=i?new Ff:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new Zf,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new zl({viewBox:this.view,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Te(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:r="display",annotationMode:i=ns.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:c=null,pageColors:l=null,printAnnotationStorage:u=null,isEditing:h=!1}){this._stats?.time("Overall");let f=this._transport.getRenderingIntent(r,i,u,h),{renderingIntent:p,cacheKey:m}=f;this.#t=!1,this.#r(),a||=this._transport.getOptionalContentConfig(p);let v=this._intentStates.get(m);v||(v=Object.create(null),this._intentStates.set(m,v)),v.streamReaderCancelTimeout&&(clearTimeout(v.streamReaderCancelTimeout),v.streamReaderCancelTimeout=null);let w=!!(p&Sn.PRINT);v.displayReadyCapability||(v.displayReadyCapability=Promise.withResolvers(),v.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(f));let I=x=>{v.renderTasks.delete(D),(this._maybeCleanupAfterRender||w)&&(this.#t=!0),this.#n(!w),x?(D.capability.reject(x),this._abortOperatorList({intentState:v,reason:x instanceof Error?x:new Error(x)})):D.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},D=new RE({callback:I,params:{canvasContext:e,viewport:t,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:v.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:l});(v.renderTasks||=new Set).add(D);let P=D.task;return Promise.all([v.displayReadyCapability.promise,a]).then(([x,N])=>{if(this.destroyed){I();return}if(this._stats?.time("Rendering"),!(N.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");D.initializeGraphics({transparency:x,optionalContentConfig:N}),D.operatorListChanged()}).catch(I),P}getOperatorList({intent:e="display",annotationMode:t=ns.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){function s(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(c))}let o=this._transport.getRenderingIntent(e,t,r,i,!0),a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let c;return a.opListReadCapability||(c=Object.create(null),c.operatorListChanged=s,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(c),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Xl.textContent(r));let t=this.streamTextContent(e);return new Promise(function(r,i){function s(){o.read().then(function({value:c,done:l}){if(l){r(a);return}a.lang??=c.lang,Object.assign(a.styles,c.styles),a.items.push(...c.items),s()},i)}let o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let e=[];for(let t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(let r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),this.#t=!1,this.#r(),Promise.all(e)}cleanup(e=!1){this.#t=!0;let t=this.#n(!1);return e&&t&&(this._stats&&=new Ff),t}#n(e=!1){if(this.#r(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},q$),!1;for(let{renderTasks:t,operatorList:r}of this._intentStates.values())if(t.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#r(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){let r=this._intentStates.get(t);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let r=0,i=e.length;r<i;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(let r of t.renderTasks)r.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:i}){let{map:s,transfer:o}=r,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},o).getReader(),l=this._intentStates.get(t);l.streamReader=c;let u=()=>{c.read().then(({value:h,done:f})=>{if(f){l.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,l),u())},h=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(let f of l.renderTasks)f.operatorListChanged();this.#n(!0)}if(l.displayReadyCapability)l.displayReadyCapability.reject(h);else if(l.opListReadCapability)l.opListReadCapability.reject(h);else throw h}})};u()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof Gl){let i=W$;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new gi(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(let[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}},xE=class{#e=new Map;#t=Promise.resolve();postMessage(e,t){let r={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(let[i]of this.#e)i.call(this,r)})}addEventListener(e,t,r=null){let i=null;if(r?.signal instanceof AbortSignal){let{signal:s}=r;if(s.aborted){ve("LoopbackPort - cannot use an `aborted` signal.");return}let o=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(let[,e]of this.#e)e?.();this.#e.clear()}},Ta=class n{static#e=0;static#t=!1;static#n;static{Qt&&(this.#t=!0,io.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let r;try{if(r=new URL(e),!r.origin||r.origin==="null")return!1}catch{return!1}let i=new URL(t,r);return r.origin===i.origin},this._createCDNWrapper=e=>{let t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}}constructor({name:e=null,port:t=null,verbosity:r=p$()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=r,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(n.#n?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(n.#n||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return Qt?Promise.all([Mr.promise,this._readyCapability.promise]):this._readyCapability.promise}#r(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new ro("main","worker",e),this._messageHandler.on("ready",function(){}),this.#r()}_initialize(){if(n.#t||n.#i){this._setupFakeWorker();return}let{workerSrc:e}=n;try{n._isSameOrigin(window.location.href,e)||(e=n._createCDNWrapper(new URL(e,window.location).href));let t=new Worker(e,{type:"module"}),r=new ro("main","worker",t),i=()=>{s.abort(),r.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:s.signal}),r.on("test",a=>{if(s.abort(),this.destroyed||!a){i();return}this._messageHandler=r,this._port=t,this._webWorker=t,this.#r()}),r.on("ready",a=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{this._setupFakeWorker()}});let o=()=>{let a=new Uint8Array;r.send("test",a,[a.buffer])};o();return}catch{mp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){n.#t||(ve("Setting up fake worker."),n.#t=!0),n._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let t=new xE;this._port=t;let r=`fake${n.#e++}`,i=new ro(r+"_worker",r,t);e.setup(i,t),this._messageHandler=new ro(r,r+"_worker",t),this.#r()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),n.#n?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let t=this.#n?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new n(e)}static get workerSrc(){if(io.workerSrc)return io.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#i(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return Te(this,"_setupFakeWorkerGlobal",(async()=>this.#i?this.#i:(await import(this.workerSrc)).WorkerMessageHandler)())}},PE=class{#e=new Map;#t=new Map;#n=new Map;#r=new Map;#i=null;constructor(e,t,r,i,s){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Zf,this.fontLoader=new Qw({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#s(e,t=null){let r=this.#e.get(e);if(r)return r;let i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return Te(this,"annotationStorage",new Kl)}getRenderingIntent(e,t=ns.ENABLE,r=null,i=!1,s=!1){let o=Sn.DISPLAY,a=Yw;switch(e){case"any":o=Sn.ANY;break;case"display":break;case"print":o=Sn.PRINT;break;default:ve(`getRenderingIntent - invalid intent: ${e}`)}let c=o&Sn.PRINT&&r instanceof Uf?r:this.annotationStorage;switch(t){case ns.DISABLE:o+=Sn.ANNOTATIONS_DISABLE;break;case ns.ENABLE:break;case ns.ENABLE_FORMS:o+=Sn.ANNOTATIONS_FORMS;break;case ns.ENABLE_STORAGE:o+=Sn.ANNOTATIONS_STORAGE,a=c.serializable;break;default:ve(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=Sn.IS_EDITING),s&&(o+=Sn.OPLIST);let{ids:l,hash:u}=c.modifiedIds,h=[o,a.hash,u];return{renderingIntent:o,cacheKey:h.join("_"),annotationStorageSerializable:a,modifiedIds:l}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));let e=[];for(let r of this.#t.values())e.push(r._destroy());this.#t.clear(),this.#n.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ql.cleanup(),this._networkStream?.cancelAllRequests(new gi("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,i)=>{At(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}At(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async r=>{await this._fullReader.headersReady;let{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=a=>{t.onProgress?.({loaded:a.loaded,total:a.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),e.on("GetRangeReader",(r,i)=>{At(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:a}){if(a){i.close();return}At(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new SE(r,this))}),e.on("DocException",function(r){let i;switch(r.name){case"PasswordException":i=new Hl(r.message,r.code);break;case"InvalidPDFException":i=new Lf(r.message);break;case"MissingPDFException":i=new pi(r.message);break;case"UnexpectedResponseException":i=new Ca(r.message,r.status);break;case"UnknownErrorException":i=new $l(r.message,r.details);break;default:Ge("DocException - expected a valid Error.")}t._capability.reject(i)}),e.on("PasswordRequest",r=>{if(this.#i=Promise.withResolvers(),t.onPassword){let i=s=>{s instanceof Error?this.#i.reject(s):this.#i.resolve({password:s})};try{t.onPassword(i,r.code)}catch(s){this.#i.reject(s)}}else this.#i.reject(new Hl(r.message,r.code));return this.#i.promise}),e.on("DataLoaded",r=>{t.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;this.#t.get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":let{disableFontFace:o,fontExtraProperties:a,pdfBug:c}=this._params;if("error"in s){let f=s.error;ve(`Error during font loading: ${f}`),this.commonObjs.resolve(r,f);break}let l=c&&globalThis.FontInspector?.enabled?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,u=new Xw(s,{disableFontFace:o,inspectFont:l});this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!a&&u.data&&(u.data=null),this.commonObjs.resolve(r,u)});break;case"CopyLocalImage":let{imageRef:h}=s;At(h,"The imageRef must be defined.");for(let f of this.#t.values())for(let[,p]of f.objs)if(p?.ref===h)return p.dataLen?(this.commonObjs.resolve(r,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,s,o])=>{if(this.destroyed)return;let a=this.#t.get(i);if(!a.objs.has(r)){if(a._intentStates.size===0){o?.bitmap?.close();return}switch(s){case"Image":a.objs.resolve(r,o),o?.dataLen>c$&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(r,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{this.destroyed||t.onProgress?.({loaded:r.loaded,total:r.total})}),e.on("FetchBuiltInCMap",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(r)}),e.on("FetchStandardFontData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ve("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));let t=e-1,r=this.#n.get(t);if(r)return r;let i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#r.set(s.refStr,e);let o=new DE(t,s,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#n.set(t,i),i}getPageIndex(e){return sR(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new dE(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let e="GetMetadata",t=this.#e.get(e);if(t)return t;let r=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new lE(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(let t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ql.cleanup()}}cachedPageNumber(e){if(!sR(e))return null;let t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#r.get(t)??null}},Pf=Symbol("INITIAL_DATA"),Zf=class{#e=Object.create(null);#t(e){return this.#e[e]||=J(L({},Promise.withResolvers()),{data:Pf})}get(e,t=null){if(t){let i=this.#t(e);return i.promise.then(()=>t(i.data)),null}let r=this.#e[e];if(!r||r.data===Pf)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){let t=this.#e[e];return!!t&&t.data!==Pf}resolve(e,t=null){let r=this.#t(e);r.data=t,r.resolve()}clear(){for(let e in this.#e){let{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(let e in this.#e){let{data:t}=this.#e[e];t!==Pf&&(yield[e,t])}}},ME=class{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){let{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;let{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}},RE=class n{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:a,canvasFactory:c,filterFactory:l,useRequestAnimationFrame:u=!1,pdfBug:h=!1,pageColors:f=null}){this.callback=e,this.params=t,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=c,this.filterFactory=l,this._pdfBug=h,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ME(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(n.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");n.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:r,viewport:i,transform:s,background:o}=this.params;this.gfx=new Aa(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),n.#t.delete(this._canvas),this.callback(e||new Gl(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),n.#t.delete(this._canvas),this.callback())))}},tz="4.8.69",nz="3634dab10";function oR(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function jl(n){return Math.max(0,Math.min(255,255*n))}var ep=class{static CMYK_G([e,t,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=jl(e),[e,e,e]}static G_HTML([e]){let t=oR(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(jl)}static RGB_HTML(e){return`#${e.map(oR).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,r,i]){return[jl(1-Math.min(1,e+i)),jl(1-Math.min(1,r+i)),jl(1-Math.min(1,t+i))]}static CMYK_HTML(e){let t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){let i=1-e,s=1-t,o=1-r,a=Math.min(i,s,o);return["CMYK",i,s,o,a]}},NE=class{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");let i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ge("Abstract method `_createSVG` called.")}},Jl=class extends NE{_createSVG(e){return document.createElementNS(hi,e)}},tp=class{static setupStorage(e,t,r,i,s){let o=i.getValue(t,{value:null});switch(r.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),s==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(o.value===r.attributes.xfaOn?e.setAttribute("checked",!0):o.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),s==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(let a of r.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{let c=a.target.options,l=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:l})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:i,linkService:s}){let{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(let[c,l]of Object.entries(o))if(l!=null)switch(c){case"class":l.length&&e.setAttribute(c,l.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",l);break;case"style":Object.assign(e.style,l);break;case"textContent":e.textContent=l;break;default:(!a||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,l)}a&&s.addLinkAttributes(e,o.href,o.newWindow),r&&o.dataId&&this.setupStorage(e,o.dataId,t,r)}static render(e){let t=e.annotationStorage,r=e.linkService,i=e.xfaHtml,s=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:r});let a=s!=="richText",c=e.div;if(c.append(o),e.viewport){let h=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=h}a&&c.setAttribute("class","xfaLayer xfaFont");let l=[];if(i.children.length===0){if(i.value){let h=document.createTextNode(i.value);o.append(h),a&&Xl.shouldBuildText(i.name)&&l.push(h)}return{textDivs:l}}let u=[[i,-1,o]];for(;u.length>0;){let[h,f,p]=u.at(-1);if(f+1===h.children.length){u.pop();continue}let m=h.children[++u.at(-1)[1]];if(m===null)continue;let{name:v}=m;if(v==="#text"){let I=document.createTextNode(m.value);l.push(I),p.append(I);continue}let w=m?.attributes?.xmlns?document.createElementNS(m.attributes.xmlns,v):document.createElement(v);if(p.append(w),m.attributes&&this.setAttributes({html:w,element:m,storage:t,intent:s,linkService:r}),m.children?.length>0)u.push([m,-1,w]);else if(m.value){let I=document.createTextNode(m.value);a&&Xl.shouldBuildText(v)&&l.push(I),w.append(I)}}for(let h of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))h.setAttribute("readOnly",!0);return{textDivs:l}}static update(e){let t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}},nu=1e3,rz=9,ao=new WeakSet;function fi(n){return{width:n[2]-n[0],height:n[3]-n[1]}}var OE=class{static create(e){switch(e.data.annotationType){case It.LINK:return new np(e);case It.TEXT:return new kE(e);case It.WIDGET:switch(e.data.fieldType){case"Tx":return new LE(e);case"Btn":return e.data.radioButton?new rp(e):e.data.checkBox?new VE(e):new jE(e);case"Ch":return new BE(e);case"Sig":return new FE(e)}return new mi(e);case It.POPUP:return new Zl(e);case It.FREETEXT:return new ip(e);case It.LINE:return new HE(e);case It.SQUARE:return new $E(e);case It.CIRCLE:return new zE(e);case It.POLYLINE:return new sp(e);case It.CARET:return new WE(e);case It.INK:return new eu(e);case It.POLYGON:return new GE(e);case It.HIGHLIGHT:return new op(e);case It.UNDERLINE:return new qE(e);case It.SQUIGGLY:return new KE(e);case It.STRIKEOUT:return new YE(e);case It.STAMP:return new ap(e);case It.FILEATTACHMENT:return new QE(e);default:return new lt(e)}}},lt=class n{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:r}){return!!(e?.str||t?.str||r?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return n._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};let{rect:t}=e;t&&this.#r(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#r(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#r(e){let{container:{style:t},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:a,pageY:c}}}}=this;r?.splice(0,4,...e);let{width:l,height:u}=fi(e);t.left=`${100*(e[0]-a)/s}%`,t.top=`${100*(o-e[3]+c)/o}%`,i===0?(t.width=`${100*l/s}%`,t.height=`${100*u/o}%`):this.setRotation(i)}_createContainer(e){let{data:t,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof mi||(s.tabIndex=nu);let{style:o}=s;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof Zl){let{rotation:v}=t;return!t.hasOwnCanvas&&v!==0&&this.setRotation(v,s),s}let{width:a,height:c}=fi(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;let v=t.borderStyle.horizontalCornerRadius,w=t.borderStyle.verticalCornerRadius;if(v>0||w>0){let D=`calc(${v}px * var(--scale-factor)) / calc(${w}px * var(--scale-factor))`;o.borderRadius=D}else if(this instanceof rp){let D=`calc(${a}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;o.borderRadius=D}switch(t.borderStyle.style){case Fl.SOLID:o.borderStyle="solid";break;case Fl.DASHED:o.borderStyle="dashed";break;case Fl.BEVELED:ve("Unimplemented border style: beveled");break;case Fl.INSET:ve("Unimplemented border style: inset");break;case Fl.UNDERLINE:o.borderBottomStyle="solid";break;default:break}let I=t.borderColor||null;I?(this.#t=!0,o.borderColor=K.makeHexColor(I[0]|0,I[1]|0,I[2]|0)):o.borderWidth=0}let l=K.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:u,pageHeight:h,pageX:f,pageY:p}=i.rawDims;o.left=`${100*(l[0]-f)/u}%`,o.top=`${100*(l[1]-p)/h}%`;let{rotation:m}=t;return t.hasOwnCanvas||m===0?(o.width=`${100*a/u}%`,o.height=`${100*c/h}%`):this.setRotation(m,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;let{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims,{width:s,height:o}=fi(this.data.rect),a,c;e%180===0?(a=100*s/r,c=100*o/i):(a=100*o/r,c=100*s/i),t.style.width=`${a}%`,t.style.height=`${c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){let e=(t,r,i)=>{let s=i.detail[t],o=s[0],a=s.slice(1);i.target.style[r]=ep[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[r]:ep[`${o}_rgb`](a)})};return Te(this,"_commonActions",{display:t=>{let{display:r}=t.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{let{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{let r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){let r=this._commonActions;for(let i of Object.keys(t.detail))(e[i]||r[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;let t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;let r=this._commonActions;for(let[i,s]of Object.entries(t)){let o=r[i];if(o){let a={detail:{[i]:s},target:e};o(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:e}=this.data;if(!e)return;let[t,r,i,s]=this.data.rect.map(v=>Math.fround(v));if(e.length===8){let[v,w,I,D]=e.subarray(2,6);if(i===v&&s===w&&t===I&&r===D)return}let{style:o}=this.container,a;if(this.#t){let{borderColor:v,borderWidth:w}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}let c=i-t,l=s-r,{svgFactory:u}=this,h=u.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);let f=u.createElement("defs");h.append(f);let p=u.createElement("clipPath"),m=`clippath_${this.data.id}`;p.setAttribute("id",m),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let v=2,w=e.length;v<w;v+=8){let I=e[v],D=e[v+1],P=e[v+2],x=e[v+3],N=u.createElement("rect"),k=(P-t)/c,T=(s-D)/l,E=(I-P)/c,_=(D-x)/l;N.setAttribute("x",k),N.setAttribute("y",T),N.setAttribute("width",E),N.setAttribute("height",_),p.append(N),a?.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${T}" width="${E}" height="${_}"/>`)}this.#t&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${m})`}_createPopup(){let{data:e}=this,t=this.#n=new Zl({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){Ge("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){let r=[];if(this._fieldObjects){let i=this._fieldObjects[e];if(i)for(let{page:s,id:o,exportValues:a}of i){if(s===-1||o===t)continue;let c=typeof a=="string"?a:null,l=document.querySelector(`[data-element-id="${o}"]`);if(l&&!ao.has(l)){ve(`_getElementsByName - element not allowed: ${o}`);continue}r.push({id:o,exportValue:c,domElement:l})}return r}for(let i of document.getElementsByName(e)){let{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==t&&ao.has(i)&&r.push({id:o,exportValue:s,domElement:i})}return r}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(let t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;let{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}},np=class extends lt{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){let{data:e,linkService:t}=this,r=document.createElement("a");r.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(r,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(r,e.action),i=!0):e.attachment?(this.#t(r,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(this.#n(r,e.setOCGState),i=!0):e.dest?(this._bindLink(r,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,e),i=!0),e.resetForm?(this._bindResetFormAction(r,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(r),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,r=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,r),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");let r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let i of Object.keys(t.actions)){let s=r.get(i);s&&(e[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){let r=e.onclick;if(r||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){ve('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(e.onclick=()=>!1);return}e.onclick=()=>{r?.();let{fields:i,refs:s,include:o}=t,a=[];if(i.length!==0||s.length!==0){let u=new Set(s);for(let h of i){let f=this._fieldObjects[h]||[];for(let{id:p}of f)u.add(p)}for(let h of Object.values(this._fieldObjects))for(let f of h)u.has(f.id)===o&&a.push(f)}else for(let u of Object.values(this._fieldObjects))a.push(...u);let c=this.annotationStorage,l=[];for(let u of a){let{id:h}=u;switch(l.push(h),u.type){case"text":{let p=u.defaultValue||"";c.setValue(h,{value:p});break}case"checkbox":case"radiobutton":{let p=u.defaultValue===u.exportValues;c.setValue(h,{value:p});break}case"combobox":case"listbox":{let p=u.defaultValue||"";c.setValue(h,{value:p});break}default:continue}let f=document.querySelector(`[data-element-id="${h}"]`);if(f){if(!ao.has(f)){ve(`_bindResetFormAction - element not allowed: ${h}`);continue}}else continue;f.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:l,name:"ResetForm"}}),!1}}},kE=class extends lt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}},mi=class extends lt{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Ut.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,i,s){r.includes("mouse")?e.addEventListener(r,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(r,o=>{if(r==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}})})}_setEventListeners(e,t,r,i){for(let[s,o]of r)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,s,o,i),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){let t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":K.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){let t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||rz,s=e.style,o,a=2,c=l=>Math.round(10*l)/10;if(this.data.multiLine){let l=Math.abs(this.data.rect[3]-this.data.rect[1]-a),u=Math.round(l/(Rf*i))||1,h=l/u;o=Math.min(i,c(h/Rf))}else{let l=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,c(l/Rf))}s.fontSize=`calc(${o}px * var(--scale-factor))`,s.color=K.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}},LE=class extends mi{constructor(e){let t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,i){let s=this.annotationStorage;for(let o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=r),s.setValue(o.id,{[i]:r})}render(){let e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){let i=e.getValue(t,{value:this.data.fieldValue}),s=i.value||"",o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&s.length>o&&(s=s.slice(0,o));let a=i.formattedValue||this.data.textContent?.join(`
`)||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));let c={userValue:s,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=a??s,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type="text",r.setAttribute("value",a??s),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),ao.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=nu,this._setRequired(r,this.data.required),o&&(r.maxLength=o),r.addEventListener("input",u=>{e.setValue(t,{value:u.target.value}),this.setPropertyOnSiblings(r,"value",u.target.value,"value"),c.formattedValue=null}),r.addEventListener("resetform",u=>{let h=this.data.defaultFieldValue??"";r.value=c.userValue=h,c.formattedValue=null});let l=u=>{let{formattedValue:h}=c;h!=null&&(u.target.value=h),u.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",h=>{if(c.focused)return;let{target:f}=h;c.userValue&&(f.value=c.userValue),c.lastCommittedValue=f.value,c.commitKey=1,this.data.actions?.Focus||(c.focused=!0)}),r.addEventListener("updatefromsandbox",h=>{this.showElementAndHideCanvas(h.target);let f={value(p){c.userValue=p.detail.value??"",e.setValue(t,{value:c.userValue.toString()}),p.target.value=c.userValue},formattedValue(p){let{formattedValue:m}=p.detail;c.formattedValue=m,m!=null&&p.target!==document.activeElement&&(p.target.value=m),e.setValue(t,{formattedValue:m})},selRange(p){p.target.setSelectionRange(...p.detail.selRange)},charLimit:p=>{let{charLimit:m}=p.detail,{target:v}=p;if(m===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",m);let w=c.userValue;!w||w.length<=m||(w=w.slice(0,m),v.value=c.userValue=w,e.setValue(t,{value:w}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(f,h)}),r.addEventListener("keydown",h=>{c.commitKey=1;let f=-1;if(h.key==="Escape"?f=0:h.key==="Enter"&&!this.data.multiLine?f=2:h.key==="Tab"&&(c.commitKey=3),f===-1)return;let{value:p}=h.target;c.lastCommittedValue!==p&&(c.lastCommittedValue=p,c.userValue=p,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,willCommit:!0,commitKey:f,selStart:h.target.selectionStart,selEnd:h.target.selectionEnd}}))});let u=l;l=null,r.addEventListener("blur",h=>{if(!c.focused||!h.relatedTarget)return;this.data.actions?.Blur||(c.focused=!1);let{value:f}=h.target;c.userValue=f,c.lastCommittedValue!==f&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:c.commitKey,selStart:h.target.selectionStart,selEnd:h.target.selectionEnd}}),u(h)}),this.data.actions?.Keystroke&&r.addEventListener("beforeinput",h=>{c.lastCommittedValue=null;let{data:f,target:p}=h,{value:m,selectionStart:v,selectionEnd:w}=p,I=v,D=w;switch(h.inputType){case"deleteWordBackward":{let P=m.substring(0,v).match(/\w*[^\w]*$/);P&&(I-=P[0].length);break}case"deleteWordForward":{let P=m.substring(v).match(/^[^\w]*\w*/);P&&(D+=P[0].length);break}case"deleteContentBackward":v===w&&(I-=1);break;case"deleteContentForward":v===w&&(D+=1);break}h.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,change:f||"",willCommit:!1,selStart:I,selEnd:D}})}),this._setEventListeners(r,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],h=>h.target.value)}if(l&&r.addEventListener("blur",l),this.data.comb){let h=(this.data.rect[2]-this.data.rect[0])/o;r.classList.add("comb"),r.style.letterSpacing=`calc(${h}px * var(--scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}},FE=class extends mi{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}},VE=class extends mi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){let e=this.annotationStorage,t=this.data,r=t.id,i=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let s=document.createElement("input");return ao.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=nu,s.addEventListener("change",o=>{let{name:a,checked:c}=o.target;for(let l of this._getElementsByName(a,r)){let u=c&&l.exportValue===t.exportValue;l.domElement&&(l.domElement.checked=u),e.setValue(l.id,{value:u})}e.setValue(r,{value:c})}),s.addEventListener("resetform",o=>{let a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{let a={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(r,{value:c.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},rp=class extends mi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let e=this.annotationStorage,t=this.data,r=t.id,i=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(r,{value:i})),i)for(let o of this._getElementsByName(t.fieldName,r))e.setValue(o.id,{value:!1});let s=document.createElement("input");if(ao.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=nu,s.addEventListener("change",o=>{let{name:a,checked:c}=o.target;for(let l of this._getElementsByName(a,r))e.setValue(l.id,{value:!1});e.setValue(r,{value:c})}),s.addEventListener("resetform",o=>{let a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){let o=t.buttonValue;s.addEventListener("updatefromsandbox",a=>{let c={value:l=>{let u=o===l.detail.value;for(let h of this._getElementsByName(l.target.name)){let f=u&&h.id===r;h.domElement&&(h.domElement.checked=f),e.setValue(h.id,{value:f})}}};this._dispatchEventFromSandbox(c,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},jE=class extends np{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){let e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");let t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}},BE=class extends mi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");ao.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=nu;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",u=>{let h=this.data.defaultFieldValue;for(let f of i.options)f.selected=f.value===h});for(let u of this.data.options){let h=document.createElement("option");h.textContent=u.displayValue,h.value=u.exportValue,r.value.includes(u.exportValue)&&(h.setAttribute("selected",!0),s=!1),i.append(h)}let o=null;if(s){let u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),i.prepend(u),o=()=>{u.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}let a=u=>{let h=u?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,m=>m.selected).map(m=>m[h]):f.selectedIndex===-1?null:f[f.selectedIndex][h]},c=a(!1),l=u=>{let h=u.target.options;return Array.prototype.map.call(h,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",u=>{let h={value(f){o?.();let p=f.detail.value,m=new Set(Array.isArray(p)?p:[p]);for(let v of i.options)v.selected=m.has(v.value);e.setValue(t,{value:a(!0)}),c=a(!1)},multipleSelection(f){i.multiple=!0},remove(f){let p=i.options,m=f.detail.remove;p[m].selected=!1,i.remove(m),p.length>0&&Array.prototype.findIndex.call(p,w=>w.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:a(!0),items:l(f)}),c=a(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=a(!1)},insert(f){let{index:p,displayValue:m,exportValue:v}=f.detail.insert,w=i.children[p],I=document.createElement("option");I.textContent=m,I.value=v,w?w.before(I):i.append(I),e.setValue(t,{value:a(!0),items:l(f)}),c=a(!1)},items(f){let{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(let m of p){let{displayValue:v,exportValue:w}=m,I=document.createElement("option");I.textContent=v,I.value=w,i.append(I)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:l(f)}),c=a(!1)},indices(f){let p=new Set(f.detail.indices);for(let m of f.target.options)m.selected=p.has(m.index);e.setValue(t,{value:a(!0)}),c=a(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(h,u)}),i.addEventListener("input",u=>{let h=a(!0),f=a(!1);e.setValue(t,{value:h}),u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):i.addEventListener("input",function(u){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},Zl=class extends lt{constructor(e){let{data:t,elements:r}=e;super(e,{isRenderable:lt._hasPopupData(t)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");let e=this.popup=new UE({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(let r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",t.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(r=>`${sb}${r}`).join(",")),this.container}},UE=class{#e=this.#P.bind(this);#t=this.#C.bind(this);#n=this.#D.bind(this);#r=this.#A.bind(this);#i=null;#s=null;#c=null;#l=null;#u=null;#a=null;#d=null;#o=!1;#h=null;#p=null;#f=null;#g=null;#y=null;#m=null;#v=!1;constructor({container:e,color:t,elements:r,titleObj:i,modificationDate:s,contentsObj:o,richText:a,parent:c,rect:l,parentRect:u,open:h}){this.#s=e,this.#y=i,this.#c=o,this.#g=a,this.#a=c,this.#i=t,this.#f=l,this.#d=u,this.#u=r,this.#l=Vf.toDateObject(s),this.trigger=r.flatMap(f=>f.getElementsToTriggerPopup());for(let f of this.trigger)f.addEventListener("click",this.#r),f.addEventListener("mouseenter",this.#n),f.addEventListener("mouseleave",this.#t),f.classList.add("popupTriggerArea");for(let f of r)f.container?.addEventListener("keydown",this.#e);this.#s.hidden=!0,h&&this.#A()}render(){if(this.#h)return;let e=this.#h=document.createElement("div");if(e.className="popup",this.#i){let s=e.style.outlineColor=K.makeHexColor(...this.#i);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:e.style.backgroundColor=K.makeHexColor(...this.#i.map(a=>Math.floor(.7*(255-a)+a)))}let t=document.createElement("span");t.className="header";let r=document.createElement("h1");if(t.append(r),{dir:r.dir,str:r.textContent}=this.#y,e.append(t),this.#l){let s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#l.valueOf()})),t.append(s)}let i=this.#w;if(i)tp.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{let s=this._formatContents(this.#c);e.append(s)}this.#s.append(e)}get#w(){let e=this.#g,t=this.#c;return e?.str&&(!t?.str||t.str===e.str)&&this.#g.html||null}get#I(){return this.#w?.attributes?.style?.fontSize||0}get#E(){return this.#w?.attributes?.style?.color||null}#b(e){let t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#E,fontSize:this.#I?`calc(${this.#I}px * var(--scale-factor))`:""}};for(let s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return r}_formatContents({str:e,dir:t}){let r=document.createElement("p");r.classList.add("popupContent"),r.dir=t;let i=e.split(/(?:\r\n?|\n)/);for(let s=0,o=i.length;s<o;++s){let a=i[s];r.append(document.createTextNode(a)),s<o-1&&r.append(document.createElement("br"))}return r}#P(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#o)&&this.#A()}updateEdited({rect:e,popupContent:t}){this.#m||={contentsObj:this.#c,richText:this.#g},e&&(this.#p=null),t&&(this.#g=this.#b(t),this.#c=null),this.#h?.remove(),this.#h=null}resetEdited(){this.#m&&({contentsObj:this.#c,richText:this.#g}=this.#m,this.#m=null,this.#h?.remove(),this.#h=null,this.#p=null)}#S(){if(this.#p!==null)return;let{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:i,pageY:s}}}=this.#a,o=!!this.#d,a=o?this.#d:this.#f;for(let m of this.#u)if(!a||K.intersect(m.data.rect,a)!==null){a=m.data.rect,o=!0;break}let c=K.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),u=o?a[2]-a[0]+5:0,h=c[0]+u,f=c[1];this.#p=[100*(h-i)/t,100*(f-s)/r];let{style:p}=this.#s;p.left=`${this.#p[0]}%`,p.top=`${this.#p[1]}%`}#A(){this.#o=!this.#o,this.#o?(this.#D(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#C(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#D(){this.#h||this.render(),this.isVisible?this.#o&&this.#s.classList.add("focused"):(this.#S(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#C(){this.#s.classList.remove("focused"),!(this.#o||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#v=this.isVisible,this.#v&&(this.#s.hidden=!0)}maybeShow(){this.#v&&(this.#h||this.#D(),this.#v=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}},ip=class extends lt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=pe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(let t of this.textContent){let r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},HE=class extends lt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let e=this.data,{width:t,height:r}=fi(e.rect),i=this.svgFactory.create(t,r,!0),s=this.#e=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},$E=class extends lt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let e=this.data,{width:t,height:r}=fi(e.rect),i=this.svgFactory.create(t,r,!0),s=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",s/2),o.setAttribute("y",s/2),o.setAttribute("width",t-s),o.setAttribute("height",r-s),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},zE=class extends lt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let e=this.data,{width:t,height:r}=fi(e.rect),i=this.svgFactory.create(t,r,!0),s=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",r/2),o.setAttribute("rx",t/2-s/2),o.setAttribute("ry",r/2-s/2),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},sp=class extends lt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,vertices:t,borderStyle:r,popupRef:i}}=this;if(!t)return this.container;let{width:s,height:o}=fi(e),a=this.svgFactory.create(s,o,!0),c=[];for(let u=0,h=t.length;u<h;u+=2){let f=t[u]-e[0],p=e[3]-t[u+1];c.push(`${f},${p}`)}c=c.join(" ");let l=this.#e=this.svgFactory.createElement(this.svgElementName);return l.setAttribute("points",c),l.setAttribute("stroke-width",r.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},GE=class extends sp{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},WE=class extends lt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},eu=class extends lt{#e=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?pe.HIGHLIGHT:pe.INK}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,inkLists:t,borderStyle:r,popupRef:i}}=this,{width:s,height:o}=fi(e),a=this.svgFactory.create(s,o,!0);for(let c of t){let l=[];for(let h=0,f=c.length;h<f;h+=2){let p=c[h]-e[0],m=e[3]-c[h+1];l.push(`${p},${m}`)}l=l.join(" ");let u=this.svgFactory.createElement(this.svgElementName);this.#e.push(u),u.setAttribute("points",l),u.setAttribute("stroke-width",r.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),a.append(u)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(a),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},op=class extends lt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=pe.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}},qE=class extends lt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}},KE=class extends lt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}},YE=class extends lt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}},ap=class extends lt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=pe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},QE=class extends lt{#e=null;constructor(e){super(e,{isRenderable:!0});let{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",L({source:this},t))}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:e,data:t}=this,r;t.hasAppearance||t.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),r.addEventListener("dblclick",this.#t.bind(this)),this.#e=r;let{isMac:i}=Ut.platform;return e.addEventListener("keydown",s=>{s.key==="Enter"&&(i?s.metaKey:s.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),e.append(r),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}},XE=class{#e=null;#t=null;#n=new Map;#r=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:a}){this.div=e,this.#e=t,this.#t=r,this.#r=a||null,this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#n.size>0}async#i(e,t){let r=e.firstChild||e,i=r.id=`${sb}${t}`,s=await this.#r?.getAriaAttributes(i);if(s)for(let[o,a]of s)r.setAttribute(o,a);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,r,!1)}async render(e){let{annotations:t}=e,r=this.div;so(r,this.viewport);let i=new Map,s={data:null,layer:r,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Jl,annotationStorage:e.annotationStorage||new Kl,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(let o of t){if(o.noHTML)continue;let a=o.annotationType===It.POPUP;if(a){let u=i.get(o.id);if(!u)continue;s.elements=u}else{let{width:u,height:h}=fi(o.rect);if(u<=0||h<=0)continue}s.data=o;let c=OE.create(s);if(!c.isRenderable)continue;if(!a&&o.popupRef){let u=i.get(o.popupRef);u?u.push(c):i.set(o.popupRef,[c])}let l=c.render();o.hidden&&(l.style.visibility="hidden"),await this.#i(l,o.id),c._isEditable&&(this.#n.set(c.data.id,c),this._annotationEditorUIManager?.renderAnnotationElement(c))}this.#s()}update({viewport:e}){let t=this.div;this.viewport=e,so(t,{rotation:e.rotation}),this.#s(),t.hidden=!1}#s(){if(!this.#t)return;let e=this.div;for(let[t,r]of this.#t){let i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;r.className="annotationContent";let{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(r):s.classList.contains("annotationContent")?s.after(r):s.before(r):i.append(r)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}},Mf=/\r\n?|\n/g,JE=class n extends Le{#e;#t="";#n=`${this.id}-editor`;#r=null;#i;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let e=n.prototype,t=s=>s.isEmpty(),r=ql.TRANSLATE_SMALL,i=ql.TRANSLATE_BIG;return Te(this,"_keyboardManager",new oo([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=pe.FREETEXT;constructor(e){super(J(L({},e),{name:"freeTextEditor"})),this.#e=e.color||n._defaultColor||Le._defaultLineColor,this.#i=e.fontSize||n._defaultFontSize}static initialize(e,t){Le.initialize(e,t);let r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case ae.FREETEXT_SIZE:n._defaultFontSize=t;break;case ae.FREETEXT_COLOR:n._defaultColor=t;break}}updateParams(e,t){switch(e){case ae.FREETEXT_SIZE:this.#s(t);break;case ae.FREETEXT_COLOR:this.#c(t);break}}static get defaultPropertiesToUpdate(){return[[ae.FREETEXT_SIZE,n._defaultFontSize],[ae.FREETEXT_COLOR,n._defaultColor||Le._defaultLineColor]]}get propertiesToUpdate(){return[[ae.FREETEXT_SIZE,this.#i],[ae.FREETEXT_COLOR,this.#e]]}#s(e){let t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--scale-factor))`,this.translate(0,-(i-this.#i)*this.parentScale),this.#i=i,this.#u()},r=this.#i;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#c(e){let t=i=>{this.#e=this.editorDiv.style.color=i},r=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){let e=this.parentScale;return[-n._internalPadding*e,-(n._internalPadding+this.#i)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(pe.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#r=new AbortController;let e=this._uiManager.combinedSignal(this.#r);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#r?.abort(),this.#r=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#l(){let e=[];this.editorDiv.normalize();let t=null;for(let r of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&r.nodeName==="BR"||(e.push(n.#a(r)),t=r);return e.join(`
`)}#u(){let[e,t]=this.parentDimensions,r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{let{currentLayer:i,div:s}=this,o=s.style.display,a=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",i.div.append(this.div),r=s.getBoundingClientRect(),s.remove(),s.style.display=o,s.classList.toggle("hidden",a)}this.rotation%180===this.parentRotation%180?(this.width=r.width/e,this.height=r.height/t):(this.width=r.height/e,this.height=r.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let e=this.#t,t=this.#t=this.#l().trimEnd();if(e===t)return;let r=i=>{if(this.#t=i,!i){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{r(t)},undo:()=>{r(e)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){n._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;let{style:r}=this.editorDiv;if(r.fontSize=`calc(${this.#i}px * var(--scale-factor))`,r.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),jf(this,this.div,["dblclick","keydown"]),this.width){let[i,s]=this.parentDimensions;if(this.annotationElementId){let{position:o}=this._initialData,[a,c]=this.getInitialTranslation();[a,c]=this.pageTranslationToScreen(a,c);let[l,u]=this.pageDimensions,[h,f]=this.pageTranslation,p,m;switch(this.rotation){case 0:p=e+(o[0]-h)/l,m=t+this.height-(o[1]-f)/u;break;case 90:p=e+(o[0]-h)/l,m=t-(o[1]-f)/u,[a,c]=[c,-a];break;case 180:p=e-this.width+(o[0]-h)/l,m=t-(o[1]-f)/u,[a,c]=[-a,-c];break;case 270:p=e+(o[0]-h-this.height*u)/l,m=t+(o[1]-f-this.width*l)/u,[a,c]=[-c,a];break}this.setAt(p*i,m*s,a,c)}else this.setAt(e*i,t*s,this.width*i,this.height*s);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#a(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Mf,"")}editorDivPaste(e){let t=e.clipboardData||window.clipboardData,{types:r}=t;if(r.length===1&&r[0]==="text/plain")return;e.preventDefault();let i=n.#h(t.getData("text")||"").replaceAll(Mf,`
`);if(!i)return;let s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();let o=s.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),s.collapseToStart();return}let{startContainer:a,startOffset:c}=o,l=[],u=[];if(a.nodeType===Node.TEXT_NODE){let p=a.parentElement;if(u.push(a.nodeValue.slice(c).replaceAll(Mf,"")),p!==this.editorDiv){let m=l;for(let v of this.editorDiv.childNodes){if(v===p){m=u;continue}m.push(n.#a(v))}}l.push(a.nodeValue.slice(0,c).replaceAll(Mf,""))}else if(a===this.editorDiv){let p=l,m=0;for(let v of this.editorDiv.childNodes)m++===c&&(p=u),p.push(n.#a(v))}this.#t=`${l.join(`
`)}${i}${u.join(`
`)}`,this.#d();let h=new Range,f=l.reduce((p,m)=>p+m.length,0);for(let{firstChild:p}of this.editorDiv.childNodes)if(p.nodeType===Node.TEXT_NODE){let m=p.nodeValue.length;if(f<=m){h.setStart(p,f),h.setEnd(p,f);break}f-=m}s.removeAllRanges(),s.addRange(h)}#d(){if(this.editorDiv.replaceChildren(),!!this.#t)for(let e of this.#t.split(`
`)){let t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#o(){return this.#t.replaceAll("\xA0"," ")}static#h(e){return e.replaceAll(" ","\xA0")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,r){let i=null;if(e instanceof ip){let{data:{defaultAppearanceData:{fontSize:o,fontColor:a},rect:c,rotation:l,id:u,popupRef:h},textContent:f,textPosition:p,parent:{page:{pageNumber:m}}}=e;if(!f||f.length===0)return null;i=e={annotationType:pe.FREETEXT,color:Array.from(a),fontSize:o,value:f.join(`
`),position:p,pageIndex:m-1,rect:c.slice(0),rotation:l,id:u,deleted:!1,popupRef:h}}let s=await super.deserialize(e,t,r);return s.#i=e.fontSize,s.#e=K.makeHexColor(...e.color),s.#t=n.#h(e.value),s.annotationElementId=e.id||null,s._initialData=i,s}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let t=n._internalPadding*this.parentScale,r=this.getRect(t,t),i=Le._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),s={annotationType:pe.FREETEXT,color:i,fontSize:this.#i,value:this.#o(),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?s:this.annotationElementId&&!this.#p(s)?null:(s.id=this.annotationElementId,s)}#p(e){let{value:t,fontSize:r,color:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==r||e.color.some((o,a)=>o!==i[a])||e.pageIndex!==s}renderAnnotationElement(e){let t=super.renderAnnotationElement(e);if(this.deleted)return t;let{style:r}=t;r.fontSize=`calc(${this.#i}px * var(--scale-factor))`,r.color=this.#e,t.replaceChildren();for(let s of this.#t.split(`
`)){let o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),t.append(o)}let i=n._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(i,i),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},cp=class{toSVGPath(){Ge("Abstract method `toSVGPath` must be implemented.")}get box(){Ge("Abstract getter `box` must be implemented.")}serialize(e,t){Ge("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){Ge("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){Ge("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}},lp=class n{#e;#t=[];#n;#r;#i=[];#s=new Float64Array(18);#c;#l;#u;#a;#d;#o;#h=[];static#p=8;static#f=2;static#g=n.#p+n.#f;constructor({x:e,y:t},r,i,s,o,a=0){this.#e=r,this.#o=s*i,this.#r=o,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=a,this.#a=n.#p*i,this.#u=n.#g*i,this.#d=i,this.#h.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#y(){let e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[r,i,s,o]=this.#e;return[(this.#c+(e[0]-t[0])/2-r)/s,(this.#l+(e[1]-t[1])/2-i)/o,(this.#c+(t[0]-e[0])/2-r)/s,(this.#l+(t[1]-e[1])/2-i)/o]}add({x:e,y:t}){this.#c=e,this.#l=t;let[r,i,s,o]=this.#e,[a,c,l,u]=this.#s.subarray(8,12),h=e-l,f=t-u,p=Math.hypot(h,f);if(p<this.#u)return!1;let m=p-this.#a,v=m/p,w=v*h,I=v*f,D=a,P=c;a=l,c=u,l+=w,u+=I,this.#h?.push(e,t);let x=-I/m,N=w/m,k=x*this.#o,T=N*this.#o;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([l+k,u+T],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([l-k,u-T],16),isNaN(this.#s[6])?(this.#i.length===0&&(this.#s.set([a+k,c+T],2),this.#i.push(NaN,NaN,NaN,NaN,(a+k-r)/s,(c+T-i)/o),this.#s.set([a-k,c-T],14),this.#t.push(NaN,NaN,NaN,NaN,(a-k-r)/s,(c-T-i)/o)),this.#s.set([D,P,a,c,l,u],6),!this.isEmpty()):(this.#s.set([D,P,a,c,l,u],6),Math.abs(Math.atan2(P-c,D-a)-Math.atan2(I,w))<Math.PI/2?([a,c,l,u]=this.#s.subarray(2,6),this.#i.push(NaN,NaN,NaN,NaN,((a+l)/2-r)/s,((c+u)/2-i)/o),[a,c,D,P]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((D+a)/2-r)/s,((P+c)/2-i)/o),!0):([D,P,a,c,l,u]=this.#s.subarray(0,6),this.#i.push(((D+5*a)/6-r)/s,((P+5*c)/6-i)/o,((5*a+l)/6-r)/s,((5*c+u)/6-i)/o,((a+l)/2-r)/s,((c+u)/2-i)/o),[l,u,a,c,D,P]=this.#s.subarray(12,18),this.#t.push(((D+5*a)/6-r)/s,((P+5*c)/6-i)/o,((5*a+l)/6-r)/s,((5*c+u)/6-i)/o,((a+l)/2-r)/s,((c+u)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";let e=this.#i,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#m();let r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#w(r);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#v(r),r.join(" ")}#m(){let[e,t,r,i]=this.#e,[s,o,a,c]=this.#y();return`M${(this.#s[2]-e)/r} ${(this.#s[3]-t)/i} L${(this.#s[4]-e)/r} ${(this.#s[5]-t)/i} L${s} ${o} L${a} ${c} L${(this.#s[16]-e)/r} ${(this.#s[17]-t)/i} L${(this.#s[14]-e)/r} ${(this.#s[15]-t)/i} Z`}#v(e){let t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#w(e){let[t,r,i,s]=this.#e,o=this.#s.subarray(4,6),a=this.#s.subarray(16,18),[c,l,u,h]=this.#y();e.push(`L${(o[0]-t)/i} ${(o[1]-r)/s} L${c} ${l} L${u} ${h} L${(a[0]-t)/i} ${(a[1]-r)/s}`)}newFreeDrawOutline(e,t,r,i,s,o){return new up(e,t,r,i,s,o)}getOutlines(){let e=this.#i,t=this.#t,r=this.#s,[i,s,o,a]=this.#e,c=new Float64Array((this.#h?.length??0)+2);for(let h=0,f=c.length-2;h<f;h+=2)c[h]=(this.#h[h]-i)/o,c[h+1]=(this.#h[h+1]-s)/a;if(c[c.length-2]=(this.#c-i)/o,c[c.length-1]=(this.#l-s)/a,isNaN(r[6])&&!this.isEmpty())return this.#I(c);let l=new Float64Array(this.#i.length+24+this.#t.length),u=e.length;for(let h=0;h<u;h+=2){if(isNaN(e[h])){l[h]=l[h+1]=NaN;continue}l[h]=e[h],l[h+1]=e[h+1]}u=this.#b(l,u);for(let h=t.length-6;h>=6;h-=6)for(let f=0;f<6;f+=2){if(isNaN(t[h+f])){l[u]=l[u+1]=NaN,u+=2;continue}l[u]=t[h+f],l[u+1]=t[h+f+1],u+=2}return this.#E(l,u),this.newFreeDrawOutline(l,c,this.#e,this.#d,this.#n,this.#r)}#I(e){let t=this.#s,[r,i,s,o]=this.#e,[a,c,l,u]=this.#y(),h=new Float64Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-r)/s,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-r)/s,(t[5]-i)/o,NaN,NaN,NaN,NaN,a,c,NaN,NaN,NaN,NaN,l,u,NaN,NaN,NaN,NaN,(t[16]-r)/s,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-r)/s,(t[15]-i)/o],0),this.newFreeDrawOutline(h,e,this.#e,this.#d,this.#n,this.#r)}#E(e,t){let r=this.#t;return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6}#b(e,t){let r=this.#s.subarray(4,6),i=this.#s.subarray(16,18),[s,o,a,c]=this.#e,[l,u,h,f]=this.#y();return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/a,(r[1]-o)/c,NaN,NaN,NaN,NaN,l,u,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,(i[0]-s)/a,(i[1]-o)/c],t),t+=24}},up=class extends cp{#e;#t=null;#n;#r;#i;#s;#c;constructor(e,t,r,i,s,o){super(),this.#c=e,this.#i=t,this.#e=r,this.#s=i,this.#n=s,this.#r=o,this.#a(o);let{x:a,y:c,width:l,height:u}=this.#t;for(let h=0,f=e.length;h<f;h+=2)e[h]=(e[h]-a)/l,e[h+1]=(e[h+1]-c)/u;for(let h=0,f=t.length;h<f;h+=2)t[h]=(t[h]-a)/l,t[h+1]=(t[h+1]-c)/u}toSVGPath(){let e=[`M${this.#c[4]} ${this.#c[5]}`];for(let t=6,r=this.#c.length;t<r;t+=6){if(isNaN(this.#c[t])){e.push(`L${this.#c[t+4]} ${this.#c[t+5]}`);continue}e.push(`C${this.#c[t]} ${this.#c[t+1]} ${this.#c[t+2]} ${this.#c[t+3]} ${this.#c[t+4]} ${this.#c[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,r,i],s){let o=r-e,a=i-t,c,l;switch(s){case 0:c=this.#l(this.#c,e,i,o,-a),l=this.#l(this.#i,e,i,o,-a);break;case 90:c=this.#u(this.#c,e,t,o,a),l=this.#u(this.#i,e,t,o,a);break;case 180:c=this.#l(this.#c,r,t,-o,a),l=this.#l(this.#i,r,t,-o,a);break;case 270:c=this.#u(this.#c,r,i,-o,-a),l=this.#u(this.#i,r,i,-o,-a);break}return{outline:Array.from(c),points:[Array.from(l)]}}#l(e,t,r,i,s){let o=new Float64Array(e.length);for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a]*i,o[a+1]=r+e[a+1]*s;return o}#u(e,t,r,i,s){let o=new Float64Array(e.length);for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a+1]*i,o[a+1]=r+e[a]*s;return o}#a(e){let t=this.#c,r=t[4],i=t[5],s=r,o=i,a=r,c=i,l=r,u=i,h=e?Math.max:Math.min;for(let w=6,I=t.length;w<I;w+=6){if(isNaN(t[w]))s=Math.min(s,t[w+4]),o=Math.min(o,t[w+5]),a=Math.max(a,t[w+4]),c=Math.max(c,t[w+5]),u<t[w+5]?(l=t[w+4],u=t[w+5]):u===t[w+5]&&(l=h(l,t[w+4]));else{let D=K.bezierBoundingBox(r,i,...t.slice(w,w+6));s=Math.min(s,D[0]),o=Math.min(o,D[1]),a=Math.max(a,D[2]),c=Math.max(c,D[3]),u<D[3]?(l=D[2],u=D[3]):u===D[3]&&(l=h(l,D[2]))}r=t[w+4],i=t[w+5]}let f=s-this.#n,p=o-this.#n,m=a-s+2*this.#n,v=c-o+2*this.#n;this.#t={x:f,y:p,width:m,height:v,lastPoint:[l,u]}}get box(){return this.#t}newOutliner(e,t,r,i,s,o=0){return new lp(e,t,r,i,s,o)}getNewOutline(e,t){let{x:r,y:i,width:s,height:o}=this.#t,[a,c,l,u]=this.#e,h=s*l,f=o*u,p=r*l+a,m=i*u+c,v=this.newOutliner({x:this.#i[0]*h+p,y:this.#i[1]*f+m},this.#e,this.#s,e,this.#r,t??this.#n);for(let w=2;w<this.#i.length;w+=2)v.add({x:this.#i[w]*h+p,y:this.#i[w+1]*f+m});return v.getOutlines()}get mustRemoveSelfIntersections(){return!0}},dp=class{#e;#t=[];#n=[];constructor(e,t=0,r=0,i=!0){let s=1/0,o=-1/0,a=1/0,c=-1/0,u=10**-4;for(let{x:I,y:D,width:P,height:x}of e){let N=Math.floor((I-t)/u)*u,k=Math.ceil((I+P+t)/u)*u,T=Math.floor((D-t)/u)*u,E=Math.ceil((D+x+t)/u)*u,_=[N,T,E,!0],A=[k,T,E,!1];this.#t.push(_,A),s=Math.min(s,N),o=Math.max(o,k),a=Math.min(a,T),c=Math.max(c,E)}let h=o-s+2*r,f=c-a+2*r,p=s-r,m=a-r,v=this.#t.at(i?-1:-2),w=[v[0],v[2]];for(let I of this.#t){let[D,P,x]=I;I[0]=(D-p)/h,I[1]=(P-m)/f,I[2]=(x-m)/f}this.#e={x:p,y:m,width:h,height:f,lastPoint:w}}getOutlines(){this.#t.sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);let e=[];for(let t of this.#t)t[3]?(e.push(...this.#l(t)),this.#s(t)):(this.#c(t),e.push(...this.#l(t)));return this.#r(e)}#r(e){let t=[],r=new Set;for(let o of e){let[a,c,l]=o;t.push([a,c,o],[a,l,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){let c=t[o][2],l=t[o+1][2];c.push(l),l.push(c),r.add(c),r.add(l)}let i=[],s;for(;r.size>0;){let o=r.values().next().value,[a,c,l,u,h]=o;r.delete(o);let f=a,p=c;for(s=[a,l],i.push(s);;){let m;if(r.has(u))m=u;else if(r.has(h))m=h;else break;r.delete(m),[a,c,l,u,h]=m,f!==a&&(s.push(f,p,a,p===c?c:l),f=a),p=p===c?l:c}s.push(f,p)}return new ZE(i,this.#e)}#i(e){let t=this.#n,r=0,i=t.length-1;for(;r<=i;){let s=r+i>>1,o=t[s][0];if(o===e)return s;o<e?r=s+1:i=s-1}return i+1}#s([,e,t]){let r=this.#i(e);this.#n.splice(r,0,[e,t])}#c([,e,t]){let r=this.#i(e);for(let i=r;i<this.#n.length;i++){let[s,o]=this.#n[i];if(s!==e)break;if(s===e&&o===t){this.#n.splice(i,1);return}}for(let i=r-1;i>=0;i--){let[s,o]=this.#n[i];if(s!==e)break;if(s===e&&o===t){this.#n.splice(i,1);return}}}#l(e){let[t,r,i]=e,s=[[t,r,i]],o=this.#i(i);for(let a=0;a<o;a++){let[c,l]=this.#n[a];for(let u=0,h=s.length;u<h;u++){let[,f,p]=s[u];if(!(l<=f||p<=c)){if(f>=c){if(p>l)s[u][1]=l;else{if(h===1)return[];s.splice(u,1),u--,h--}continue}s[u][2]=c,p>l&&s.push([t,l,p])}}}return s}},ZE=class extends cp{#e;#t;constructor(e,t){super(),this.#t=e,this.#e=t}toSVGPath(){let e=[];for(let t of this.#t){let[r,i]=t;e.push(`M${r} ${i}`);for(let s=2;s<t.length;s+=2){let o=t[s],a=t[s+1];o===r?(e.push(`V${a}`),i=a):a===i&&(e.push(`H${o}`),r=o)}e.push("Z")}return e.join(" ")}serialize([e,t,r,i],s){let o=[],a=r-e,c=i-t;for(let l of this.#t){let u=new Array(l.length);for(let h=0;h<l.length;h+=2)u[h]=e+l[h]*a,u[h+1]=i-l[h+1]*c;o.push(u)}return o}get box(){return this.#e}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}},tu=class extends lp{newFreeDrawOutline(e,t,r,i,s,o){return new eb(e,t,r,i,s,o)}get classNamesForDrawing(){return["highlight","free"]}},eb=class extends up{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(e,t,r,i,s,o=0){return new tu(e,t,r,i,s,o)}},hp=class n{#e=null;#t=null;#n;#r=null;#i=!1;#s=!1;#c=null;#l;#u=null;#a=null;#d;static#o=null;static get _keyboardManager(){return Te(this,"_keyboardManager",new oo([[["Escape","mac+Escape"],n.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],n.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],n.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],n.prototype._moveToPrevious],[["Home","mac+Home"],n.prototype._moveToBeginning],[["End","mac+End"],n.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#d=ae.HIGHLIGHT_COLOR,this.#c=e):(this.#s=!0,this.#d=ae.HIGHLIGHT_DEFAULT_COLOR),this.#a=e?._uiManager||t,this.#l=this.#a._eventBus,this.#n=e?.color||this.#a?.highlightColors.values().next().value||"#FFFF98",n.#o||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){let e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);let t=this.#a._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#f.bind(this),{signal:t});let r=this.#t=document.createElement("span");return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=this.#n,e.append(r),e}renderMainDropdown(){let e=this.#r=this.#h();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#h(){let e=document.createElement("div"),t=this.#a._signal;e.addEventListener("contextmenu",Wn,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(let[r,i]of this.#a.highlightColors){let s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",n.#o[r]);let o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.setAttribute("aria-selected",i===this.#n),s.addEventListener("click",this.#p.bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",this.#f.bind(this),{signal:t}),e}#p(e,t){t.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:this.#d,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}let t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#m){this.#g(e);return}if(e.target===this.#e){this.#r.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#r?.firstChild||e.target===this.#e){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#m){this.#g(e);return}this.#r.firstChild?.focus()}_moveToEnd(e){if(!this.#m){this.#g(e);return}this.#r.lastChild?.focus()}#f(e){n._keyboardManager.exec(this,e)}#g(e){if(this.#m){this.hideDropdown();return}if(this.#i=e.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#y.bind(this),{signal:this.#a.combinedSignal(this.#u)})),this.#r){this.#r.classList.remove("hidden");return}let t=this.#r=this.#h();this.#e.append(t)}#y(e){this.#r?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#r?.classList.add("hidden"),this.#u?.abort(),this.#u=null}get#m(){return this.#r&&!this.#r.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#m){this.#c?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#i})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#r)return;let t=this.#a.highlightColors.values();for(let r of this.#r.children)r.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#r?.remove(),this.#r=null}},fp=class n extends Le{#e=null;#t=0;#n;#r=null;#i=null;#s=null;#c=null;#l=0;#u=null;#a=null;#d=null;#o=!1;#h=null;#p;#f=null;#g="";#y;#m="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=pe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){let e=n.prototype;return Te(this,"_keyboardManager",new oo([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(J(L({},e),{name:"highlightEditor"})),this.color=e.color||n._defaultColor,this.#y=e.thickness||n._defaultThickness,this.#p=e.opacity||n._defaultOpacity,this.#n=e.boxes||null,this.#m=e.methodOfCreation||"",this.#g=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#o=!0,this.#w(e),this.#S()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#c=e.focusNode,this.#l=e.focusOffset,this.#v(),this.#S(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#o?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#y,methodOfCreation:this.#m}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#v(){let e=new dp(this.#n,.001);this.#a=e.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#a.box;let t=new dp(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();let{lastPoint:r}=this.#s.box;this.#h=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#w({highlightOutlines:e,highlightId:t,clipPathId:r}){this.#a=e;let i=1.5;if(this.#s=e.getNewOutline(this.#y/2+i,.0025),t>=0)this.#d=t,this.#r=r,this.parent.drawLayer.finalizeLine(t,e),this.#f=this.parent.drawLayer.drawOutline(this.#s);else if(this.parent){let u=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#d,e),this.parent.drawLayer.updateBox(this.#d,n.#A(this.#a.box,(u-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#f,this.#s),this.parent.drawLayer.updateBox(this.#f,n.#A(this.#s.box,u))}let{x:s,y:o,width:a,height:c}=e.box;switch(this.rotation){case 0:this.x=s,this.y=o,this.width=a,this.height=c;break;case 90:{let[u,h]=this.parentDimensions;this.x=o,this.y=1-s,this.width=a*h/u,this.height=c*u/h;break}case 180:this.x=1-s,this.y=1-o,this.width=a,this.height=c;break;case 270:{let[u,h]=this.parentDimensions;this.x=1-o,this.y=s,this.width=a*h/u,this.height=c*u/h;break}}let{lastPoint:l}=this.#s.box;this.#h=[(l[0]-s)/a,(l[1]-o)/c]}static initialize(e,t){Le.initialize(e,t),n._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case ae.HIGHLIGHT_DEFAULT_COLOR:n._defaultColor=t;break;case ae.HIGHLIGHT_THICKNESS:n._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#h}updateParams(e,t){switch(e){case ae.HIGHLIGHT_COLOR:this.#I(t);break;case ae.HIGHLIGHT_THICKNESS:this.#E(t);break}}static get defaultPropertiesToUpdate(){return[[ae.HIGHLIGHT_DEFAULT_COLOR,n._defaultColor],[ae.HIGHLIGHT_THICKNESS,n._defaultThickness]]}get propertiesToUpdate(){return[[ae.HIGHLIGHT_COLOR,this.color||n._defaultColor],[ae.HIGHLIGHT_THICKNESS,this.#y||n._defaultThickness],[ae.HIGHLIGHT_FREE,this.#o]]}#I(e){let t=(s,o)=>{this.color=s,this.parent?.drawLayer.changeColor(this.#d,s),this.#i?.updateColor(s),this.#p=o,this.parent?.drawLayer.changeOpacity(this.#d,o)},r=this.color,i=this.#p;this.addCommands({cmd:t.bind(this,e,n._defaultOpacity),undo:t.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#E(e){let t=this.#y,r=i=>{this.#y=i,this.#b(i)};this.addCommands({cmd:r.bind(this,e),undo:r.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){let e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#i=new hp({editor:this}),e.addColorPicker(this.#i)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#M())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#P(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#S(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#P():e&&(this.#S(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#b(e){if(!this.#o)return;this.#w({highlightOutlines:this.#a.getNewOutline(e/2)}),this.fixAndSetPosition();let[t,r]=this.parentDimensions;this.setDims(this.width*t,this.height*r)}#P(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#f),this.#f=null)}#S(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#r}=e.drawLayer.draw(this.#a,this.color,this.#p),this.#f=e.drawLayer.drawOutline(this.#s),this.#u&&(this.#u.style.clipPath=this.#r))}static#A({x:e,y:t,width:r,height:i},s){switch(s){case 90:return{x:1-t-i,y:e,width:i,height:r};case 180:return{x:1-e-r,y:1-t-i,width:r,height:i};case 270:return{x:t,y:1-e-r,width:i,height:r}}return{x:e,y:t,width:r,height:i}}rotate(e){let{drawLayer:t}=this.parent,r;this.#o?(e=(e-this.rotation+360)%360,r=n.#A(this.#a.box,e)):r=n.#A(this,e),t.rotate(this.#d,e),t.rotate(this.#f,e),t.updateBox(this.#d,r),t.updateBox(this.#f,n.#A(this.#s.box,e))}render(){if(this.div)return this.div;let e=super.render();this.#g&&(e.setAttribute("aria-label",this.#g),e.setAttribute("role","mark")),this.#o?e.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});let t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#r;let[r,i]=this.parentDimensions;return this.setDims(this.width*r,this.height*i),jf(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(this.#f,"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(this.#f,"hovered")}#D(e){n._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(e){if(!this.#e)return;let t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#c,this.#l)}select(){super.select(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"hovered"),this.parent?.drawLayer.addClass(this.#f,"selected"))}unselect(){super.unselect(),this.#f&&(this.parent?.drawLayer.removeClass(this.#f,"selected"),this.#o||this.#C(!1))}get _mustFixPosition(){return!this.#o}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(this.#d,e),this.parent.drawLayer.show(this.#f,e))}#M(){return this.#o?this.rotation:0}#N(){if(this.#o)return null;let[e,t]=this.pageDimensions,[r,i]=this.pageTranslation,s=this.#n,o=new Float32Array(s.length*8),a=0;for(let{x:c,y:l,width:u,height:h}of s){let f=c*e+r,p=(1-l-h)*t+i;o[a]=o[a+4]=f,o[a+1]=o[a+3]=p,o[a+2]=o[a+6]=f+u*e,o[a+5]=o[a+7]=p+h*t,a+=8}return o}#T(e){return this.#a.serialize(e,this.#M())}static startHighlighting(e,t,{target:r,x:i,y:s}){let{x:o,y:a,width:c,height:l}=r.getBoundingClientRect(),u=new AbortController,h=e.combinedSignal(u),f=m=>{m.preventDefault(),m.stopPropagation()},p=m=>{u.abort(),this.#x(e,m)};window.addEventListener("blur",p,{signal:h}),window.addEventListener("pointerup",p,{signal:h}),window.addEventListener("pointerdown",f,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",Wn,{signal:h}),r.addEventListener("pointermove",this.#_.bind(this,e),{signal:h}),this._freeHighlight=new tu({x:i,y:s},[o,a,c,l],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static#_(e,t){this._freeHighlight.add(t)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#x(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,r){let i=null;if(e instanceof op){let{data:{quadPoints:m,rect:v,rotation:w,id:I,color:D,opacity:P,popupRef:x},parent:{page:{pageNumber:N}}}=e;i=e={annotationType:pe.HIGHLIGHT,color:Array.from(D),opacity:P,quadPoints:m,boxes:null,pageIndex:N-1,rect:v.slice(0),rotation:w,id:I,deleted:!1,popupRef:x}}else if(e instanceof eu){let{data:{inkLists:m,rect:v,rotation:w,id:I,color:D,borderStyle:{rawWidth:P},popupRef:x},parent:{page:{pageNumber:N}}}=e;i=e={annotationType:pe.HIGHLIGHT,color:Array.from(D),thickness:P,inkLists:m,boxes:null,pageIndex:N-1,rect:v.slice(0),rotation:w,id:I,deleted:!1,popupRef:x}}let{color:s,quadPoints:o,inkLists:a,opacity:c}=e,l=await super.deserialize(e,t,r);l.color=K.makeHexColor(...s),l.#p=c||1,a&&(l.#y=e.thickness),l.annotationElementId=e.id||null,l._initialData=i;let[u,h]=l.pageDimensions,[f,p]=l.pageTranslation;if(o){let m=l.#n=[];for(let v=0;v<o.length;v+=8)m.push({x:(o[v]-f)/u,y:1-(o[v+1]-p)/h,width:(o[v+2]-o[v])/u,height:(o[v+1]-o[v+5])/h});l.#v(),l.#S(),l.rotate(l.rotation)}else if(a){l.#o=!0;let m=a[0],v={x:m[0]-f,y:h-(m[1]-p)},w=new tu(v,[0,0,u,h],1,l.#y/2,!0,.001);for(let P=0,x=m.length;P<x;P+=2)v.x=m[P]-f,v.y=h-(m[P+1]-p),w.add(v);let{id:I,clipPathId:D}=t.drawLayer.draw(w,l.color,l._defaultOpacity,!0);l.#w({highlightOutlines:w.getOutlines(),highlightId:I,clipPathId:D}),l.#S()}return l}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();let t=this.getRect(0,0),r=Le._colorManager.convert(this.color),i={annotationType:pe.HIGHLIGHT,color:r,opacity:this.#p,thickness:this.#y,quadPoints:this.#N(),outlines:this.#T(t),pageIndex:this.pageIndex,rect:t,rotation:this.#M(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#R(i)?null:(i.id=this.annotationElementId,i)}#R(e){let{color:t}=this._initialData;return e.color.some((r,i)=>r!==t[i])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}},tb=class n extends Le{#e=0;#t=0;#n=null;#r=new Path2D;#i=!1;#s=null;#c=!1;#l=!1;#u=null;#a=null;#d=0;#o=0;#h=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=pe.INK;constructor(e){super(J(L({},e),{name:"inkEditor"})),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,t){Le.initialize(e,t)}static updateDefaultParams(e,t){switch(e){case ae.INK_THICKNESS:n._defaultThickness=t;break;case ae.INK_COLOR:n._defaultColor=t;break;case ae.INK_OPACITY:n._defaultOpacity=t/100;break}}updateParams(e,t){switch(e){case ae.INK_THICKNESS:this.#p(t);break;case ae.INK_COLOR:this.#f(t);break;case ae.INK_OPACITY:this.#g(t);break}}static get defaultPropertiesToUpdate(){return[[ae.INK_THICKNESS,n._defaultThickness],[ae.INK_COLOR,n._defaultColor||Le._defaultLineColor],[ae.INK_OPACITY,Math.round(n._defaultOpacity*100)]]}get propertiesToUpdate(){return[[ae.INK_THICKNESS,this.thickness||n._defaultThickness],[ae.INK_COLOR,this.color||n._defaultColor||Le._defaultLineColor],[ae.INK_OPACITY,Math.round(100*(this.opacity??n._defaultOpacity))]]}#p(e){let t=i=>{this.thickness=i,this.#O()},r=this.thickness;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#f(e){let t=i=>{this.color=i,this.#A()},r=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(e){let t=i=>{this.opacity=i,this.#A()};e/=100;let r=this.opacity;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#N(),this.#T()),this.isAttachedToDOM||(this.parent.add(this),this.#_()),this.#O()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#n&&(clearTimeout(this.#n),this.#n=null),this.#u?.disconnect(),this.#u=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){let[e,t]=this.parentDimensions,r=this.width*e,i=this.height*t;this.setDimensions(r,i)}enableEditMode(){this.#i||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.#D())}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.#C())}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#y(){let{parentRotation:e,parentDimensions:[t,r]}=this;switch(e){case 90:return[0,r,r,t];case 180:return[t,r,t,r];case 270:return[t,0,r,t];default:return[0,0,t,r]}}#m(){let{ctx:e,color:t,opacity:r,thickness:i,parentScale:s,scaleFactor:o}=this;e.lineWidth=i*s/o,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${D$(r)}`}#v(e,t){this.canvas.addEventListener("contextmenu",Wn,{signal:this._uiManager._signal}),this.#C(),this.#s=new AbortController;let r=this._uiManager.combinedSignal(this.#s);this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:r}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:r}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:r}),this.isEditing=!0,this.#l||(this.#l=!0,this.#_(),this.thickness||=n._defaultThickness,this.color||=n._defaultColor||Le._defaultLineColor,this.opacity??=n._defaultOpacity),this.currentPath.push([e,t]),this.#c=!1,this.#m(),this.#h=()=>{this.#b(),this.#h&&window.requestAnimationFrame(this.#h)},window.requestAnimationFrame(this.#h)}#w(e,t){let[r,i]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===r&&t===i)return;let s=this.currentPath,o=this.#r;if(s.push([e,t]),this.#c=!0,s.length<=2){o.moveTo(...s[0]),o.lineTo(e,t);return}s.length===3&&(this.#r=o=new Path2D,o.moveTo(...s[0])),this.#P(o,...s.at(-3),...s.at(-2),e,t)}#I(){if(this.currentPath.length===0)return;let e=this.currentPath.at(-1);this.#r.lineTo(...e)}#E(e,t){this.#h=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#w(e,t),this.#I();let r;if(this.currentPath.length!==1)r=this.#S();else{let c=[e,t];r=[[c,c.slice(),c.slice(),c]]}let i=this.#r,s=this.currentPath;this.currentPath=[],this.#r=new Path2D;let o=()=>{this.allRawPaths.push(s),this.paths.push(r),this.bezierPath2D.push(i),this._uiManager.rebuild(this)},a=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#N(),this.#T()),this.#O())};this.addCommands({cmd:o,undo:a,mustExec:!0})}#b(){if(!this.#c)return;this.#c=!1;let e=Math.ceil(this.thickness*this.parentScale),t=this.currentPath.slice(-3),r=t.map(u=>u[0]),i=t.map(u=>u[1]),s=Math.min(...r)-e,o=Math.max(...r)+e,a=Math.min(...i)-e,c=Math.max(...i)+e,{ctx:l}=this;l.save(),l.clearRect(0,0,this.canvas.width,this.canvas.height);for(let u of this.bezierPath2D)l.stroke(u);l.stroke(this.#r),l.restore()}#P(e,t,r,i,s,o,a){let c=(t+i)/2,l=(r+s)/2,u=(i+o)/2,h=(s+a)/2;e.bezierCurveTo(c+2*(i-c)/3,l+2*(s-l)/3,u+2*(i-u)/3,h+2*(s-h)/3,u,h)}#S(){let e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];let t=[],r,[i,s]=e[0];for(r=1;r<e.length-2;r++){let[f,p]=e[r],[m,v]=e[r+1],w=(f+m)/2,I=(p+v)/2,D=[i+2*(f-i)/3,s+2*(p-s)/3],P=[w+2*(f-w)/3,I+2*(p-I)/3];t.push([[i,s],D,P,[w,I]]),[i,s]=[w,I]}let[o,a]=e[r],[c,l]=e[r+1],u=[i+2*(o-i)/3,s+2*(a-s)/3],h=[c+2*(o-c)/3,l+2*(a-l)/3];return t.push([[i,s],u,h,[c,l]]),t}#A(){if(this.isEmpty()){this.#R();return}this.#m();let{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#R();for(let r of this.bezierPath2D)t.stroke(r)}commit(){this.#i||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#i=!0,this.div.classList.add("disabled"),this.#O(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}#D(){if(this.#a)return;this.#a=new AbortController;let e=this._uiManager.combinedSignal(this.#a);this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})}#C(){this.pointerdownAC?.abort(),this.pointerdownAC=null}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||this.#i||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#v(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#w(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#M(e)}canvasPointerleave(e){this.#M(e)}#M(e){this.#s?.abort(),this.#s=null,this.#D(),this.#n&&clearTimeout(this.#n),this.#n=setTimeout(()=>{this.#n=null,this.canvas.removeEventListener("contextmenu",Wn)},10),this.#E(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#N(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#T(){this.#u=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),this.#u.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#u?.disconnect(),this.#u=null},{once:!0})}get isResizable(){return!this.isEmpty()&&this.#i}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");let[r,i,s,o]=this.#y();if(this.setAt(r,i,0,0),this.setDims(s,o),this.#N(),this.width){let[a,c]=this.parentDimensions;this.setAspectRatio(this.width*a,this.height*c),this.setAt(e*a,t*c,this.width*a,this.height*c),this.#l=!0,this.#_(),this.setDims(this.width*a,this.height*c),this.#A(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#T(),this.div}#_(){if(!this.#l)return;let[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#R()}setDimensions(e,t){let r=Math.round(e),i=Math.round(t);if(this.#d===r&&this.#o===i)return;this.#d=r,this.#o=i,this.canvas.style.visibility="hidden";let[s,o]=this.parentDimensions;this.width=e/s,this.height=t/o,this.fixAndSetPosition(),this.#i&&this.#x(e,t),this.#_(),this.#A(),this.canvas.style.visibility="visible",this.fixDims()}#x(e,t){let r=this.#j(),i=(e-r)/this.#t,s=(t-r)/this.#e;this.scaleFactor=Math.min(i,s)}#R(){let e=this.#j()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#F(e){let t=new Path2D;for(let r=0,i=e.length;r<i;r++){let[s,o,a,c]=e[r];r===0&&t.moveTo(...s),t.bezierCurveTo(o[0],o[1],a[0],a[1],c[0],c[1])}return t}static#U(e,t,r){let[i,s,o,a]=t;switch(r){case 0:for(let c=0,l=e.length;c<l;c+=2)e[c]+=i,e[c+1]=a-e[c+1];break;case 90:for(let c=0,l=e.length;c<l;c+=2){let u=e[c];e[c]=e[c+1]+i,e[c+1]=u+s}break;case 180:for(let c=0,l=e.length;c<l;c+=2)e[c]=o-e[c],e[c+1]+=s;break;case 270:for(let c=0,l=e.length;c<l;c+=2){let u=e[c];e[c]=o-e[c+1],e[c+1]=a-u}break;default:throw new Error("Invalid rotation")}return e}static#B(e,t,r){let[i,s,o,a]=t;switch(r){case 0:for(let c=0,l=e.length;c<l;c+=2)e[c]-=i,e[c+1]=a-e[c+1];break;case 90:for(let c=0,l=e.length;c<l;c+=2){let u=e[c];e[c]=e[c+1]-s,e[c+1]=u-i}break;case 180:for(let c=0,l=e.length;c<l;c+=2)e[c]=o-e[c],e[c+1]-=s;break;case 270:for(let c=0,l=e.length;c<l;c+=2){let u=e[c];e[c]=a-e[c+1],e[c+1]=o-u}break;default:throw new Error("Invalid rotation")}return e}#L(e,t,r,i){let s=[],o=this.thickness/2,a=e*t+o,c=e*r+o;for(let l of this.paths){let u=[],h=[];for(let f=0,p=l.length;f<p;f++){let[m,v,w,I]=l[f];if(m[0]===I[0]&&m[1]===I[1]&&p===1){let A=e*m[0]+a,C=e*m[1]+c;u.push(A,C),h.push(A,C);break}let D=e*m[0]+a,P=e*m[1]+c,x=e*v[0]+a,N=e*v[1]+c,k=e*w[0]+a,T=e*w[1]+c,E=e*I[0]+a,_=e*I[1]+c;f===0&&(u.push(D,P),h.push(D,P)),u.push(x,N,k,T,E,_),h.push(x,N),f===p-1&&h.push(E,_)}s.push({bezier:n.#U(u,i,this.rotation),points:n.#U(h,i,this.rotation)})}return s}#V(){let e=1/0,t=-1/0,r=1/0,i=-1/0;for(let s of this.paths)for(let[o,a,c,l]of s){let u=K.bezierBoundingBox(...o,...a,...c,...l);e=Math.min(e,u[0]),r=Math.min(r,u[1]),t=Math.max(t,u[2]),i=Math.max(i,u[3])}return[e,r,t,i]}#j(){return this.#i?Math.ceil(this.thickness*this.parentScale):0}#O(e=!1){if(this.isEmpty())return;if(!this.#i){this.#A();return}let t=this.#V(),r=this.#j();this.#t=Math.max(Le.MIN_SIZE,t[2]-t[0]),this.#e=Math.max(Le.MIN_SIZE,t[3]-t[1]);let i=Math.ceil(r+this.#t*this.scaleFactor),s=Math.ceil(r+this.#e*this.scaleFactor),[o,a]=this.parentDimensions;this.width=i/o,this.height=s/a,this.setAspectRatio(i,s);let c=this.translationX,l=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#_(),this.#A(),this.#d=i,this.#o=s,this.setDims(i,s);let u=e?r/this.scaleFactor/2:0;this.translate(c-this.translationX-u,l-this.translationY-u)}static async deserialize(e,t,r){if(e instanceof eu)return null;let i=await super.deserialize(e,t,r);i.thickness=e.thickness,i.color=K.makeHexColor(...e.color),i.opacity=e.opacity;let[s,o]=i.pageDimensions,a=i.width*s,c=i.height*o,l=i.parentScale,u=e.thickness/2;i.#i=!0,i.#d=Math.round(a),i.#o=Math.round(c);let{paths:h,rect:f,rotation:p}=e;for(let{bezier:v}of h){v=n.#B(v,f,p);let w=[];i.paths.push(w);let I=l*(v[0]-u),D=l*(v[1]-u);for(let x=2,N=v.length;x<N;x+=6){let k=l*(v[x]-u),T=l*(v[x+1]-u),E=l*(v[x+2]-u),_=l*(v[x+3]-u),A=l*(v[x+4]-u),C=l*(v[x+5]-u);w.push([[I,D],[k,T],[E,_],[A,C]]),I=A,D=C}let P=this.#F(w);i.bezierPath2D.push(P)}let m=i.#V();return i.#t=Math.max(Le.MIN_SIZE,m[2]-m[0]),i.#e=Math.max(Le.MIN_SIZE,m[3]-m[1]),i.#x(a,c),i}serialize(){if(this.isEmpty())return null;let e=this.getRect(0,0),t=Le._colorManager.convert(this.ctx.strokeStyle);return{annotationType:pe.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#L(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}},nb=class n extends Le{#e=null;#t=null;#n=null;#r=null;#i=null;#s="";#c=null;#l=null;#u=null;#a=!1;#d=!1;static _type="stamp";static _editorType=pe.STAMP;constructor(e){super(J(L({},e),{name:"stampEditor"})),this.#r=e.bitmapUrl,this.#i=e.bitmapFile}static initialize(e,t){Le.initialize(e,t)}static get supportedTypes(){return Te(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return Te(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(pe.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){let t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#o(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#a=e.isSvg),e.file&&(this.#s=e.file.name),this.#f()}#h(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#c){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;let{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");let{data:i,width:s,height:o}=e||this.copyCanvas(null,null,!0).imageData,a=await r.guess({name:"altText",request:{data:i,width:s,height:o,channels:i.length/(s*o)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");let c=a.output;return await this.setGuessedAltText(c),t&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}#p(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(r=>this.#o(r,!0)).finally(()=>this.#h());return}if(this.#r){let r=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(r).then(i=>this.#o(i)).finally(()=>this.#h());return}if(this.#i){let r=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(r).then(i=>this.#o(i)).finally(()=>this.#h());return}let e=document.createElement("input");e.type="file",e.accept=n.supportedTypesStr;let t=this._uiManager._signal;this.#n=new Promise(r=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#o(i)}r()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),r()},{signal:t})}).finally(()=>this.#h()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#c?.remove(),this.#c=null,this.#l?.disconnect(),this.#l=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#p();return}super.rebuild(),this.div!==null&&(this.#t&&this.#c===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#r||this.#i||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#f():this.#p(),this.width&&!this.annotationElementId){let[r,i]=this.parentDimensions;this.setAt(e*r,t*i,this.width*r,this.height*i)}return this.div}#f(){let{div:e}=this,{width:t,height:r}=this.#e,[i,s]=this.pageDimensions,o=.75;if(this.width)t=this.width*i,r=this.height*s;else if(t>o*i||r>o*s){let u=Math.min(o*i/t,o*s/r);t*=u,r*=u}let[a,c]=this.parentDimensions;this.setDims(t*a/i,r*c/s),this._uiManager.enableWaiting(!1);let l=this.#c=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#m(t,r),this.#w(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&l.setAttribute("aria-label",this.#s)}copyCanvas(e,t,r=!1){e||(e=224);let{width:i,height:s}=this.#e,o=new Wl,a=this.#e,c=i,l=s,u=null;if(t){if(i>t||s>t){let k=Math.min(t/i,t/s);c=Math.floor(i*k),l=Math.floor(s*k)}u=document.createElement("canvas");let f=u.width=Math.ceil(c*o.sx),p=u.height=Math.ceil(l*o.sy);this.#a||(a=this.#y(f,p));let m=u.getContext("2d");m.filter=this._uiManager.hcmFilter;let v="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",w="#42414d");let I=15,D=I*o.sx,P=I*o.sy,x=new OffscreenCanvas(D*2,P*2),N=x.getContext("2d");N.fillStyle=v,N.fillRect(0,0,D*2,P*2),N.fillStyle=w,N.fillRect(0,0,D,P),N.fillRect(D,P,D,P),m.fillStyle=m.createPattern(x,"repeat"),m.fillRect(0,0,f,p),m.drawImage(a,0,0,a.width,a.height,0,0,f,p)}let h=null;if(r){let f,p;if(o.symmetric&&a.width<e&&a.height<e)f=a.width,p=a.height;else if(a=this.#e,i>e||s>e){let w=Math.min(e/i,e/s);f=Math.floor(i*w),p=Math.floor(s*w),this.#a||(a=this.#y(f,p))}let v=new OffscreenCanvas(f,p).getContext("2d",{willReadFrequently:!0});v.drawImage(a,0,0,a.width,a.height,0,0,f,p),h={width:f,height:p,data:v.getImageData(0,0,f,p).data}}return{canvas:u,width:c,height:l,imageData:h}}#g(e,t){let[r,i]=this.parentDimensions;this.width=e/r,this.height=t/i,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#u!==null&&clearTimeout(this.#u);let s=200;this.#u=setTimeout(()=>{this.#u=null,this.#m(e,t)},s)}#y(e,t){let{width:r,height:i}=this.#e,s=r,o=i,a=this.#e;for(;s>2*e||o>2*t;){let c=s,l=o;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));let u=new OffscreenCanvas(s,o);u.getContext("2d").drawImage(a,0,0,c,l,0,0,s,o),a=u.transferToImageBitmap()}return a}#m(e,t){let r=new Wl,i=Math.ceil(e*r.sx),s=Math.ceil(t*r.sy),o=this.#c;if(!o||o.width===i&&o.height===s)return;o.width=i,o.height=s;let a=this.#a?this.#e:this.#y(i,s),c=o.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(a,0,0,a.width,a.height,0,0,i,s)}getImageForAltText(){return this.#c}#v(e){if(e){if(this.#a){let i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}let t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#a){let[t,r]=this.pageDimensions,i=Math.round(this.width*t*rs.PDF_TO_CSS_UNITS),s=Math.round(this.height*r*rs.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,s);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,s),o.transferToImageBitmap()}return structuredClone(this.#e)}#w(){this._uiManager._signal&&(this.#l=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.#g(t.width,t.height)}),this.#l.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#l?.disconnect(),this.#l=null},{once:!0}))}static async deserialize(e,t,r){let i=null;if(e instanceof ap){let{data:{rect:m,rotation:v,id:w,structParent:I,popupRef:D},container:P,parent:{page:{pageNumber:x}}}=e,N=P.querySelector("canvas"),k=r.imageManager.getFromCanvas(P.id,N);N.remove();let T=(await t._structTree.getAriaAttributes(`${sb}${w}`))?.get("aria-label")||"";i=e={annotationType:pe.STAMP,bitmapId:k.id,bitmap:k.bitmap,pageIndex:x-1,rect:m.slice(0),rotation:v,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:T},isSvg:!1,structParent:I,popupRef:D}}let s=await super.deserialize(e,t,r),{rect:o,bitmap:a,bitmapUrl:c,bitmapId:l,isSvg:u,accessibilityData:h}=e;l&&r.imageManager.isValidId(l)?(s.#t=l,a&&(s.#e=a)):s.#r=c,s.#a=u;let[f,p]=s.pageDimensions;return s.width=(o[2]-o[0])/f,s.height=(o[3]-o[1])/p,s.annotationElementId=e.id||null,h&&(s.altTextData=h),s._initialData=i,s.#d=!!i,s}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let r={annotationType:pe.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#a,structTreeParentId:this._structTreeParentId};if(e)return r.bitmapUrl=this.#v(!0),r.accessibilityData=this.serializeAltText(!0),r;let{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(r.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){let a=this.#I(r);if(a.isSame)return null;a.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,t===null)return r;t.stamps||=new Map;let o=this.#a?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:r}),r.bitmap=this.#v(!1);else if(this.#a){let a=t.stamps.get(this.#t);o>a.area&&(a.area=o,a.serialized.bitmap.close(),a.serialized.bitmap=this.#v(!1))}return r}#I(e){let{rect:t,pageIndex:r,accessibilityData:{altText:i}}=this._initialData,s=e.rect.every((c,l)=>Math.abs(c-t[l])<1),o=e.pageIndex===r,a=(e.accessibilityData?.alt||"")===i;return{isSame:s&&o&&a,isSameAltText:a}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}},iz=(()=>{class n{#e;#t=!1;#n=null;#r=null;#i=null;#s=new Map;#c=!1;#l=!1;#u=!1;#a=null;#d=null;#o;static _initialized=!1;static#h=new Map([JE,tb,nb,fp].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:r,div:i,structTreeLayer:s,accessibilityManager:o,annotationLayer:a,drawLayer:c,textLayer:l,viewport:u,l10n:h}){let f=[...n.#h.values()];if(!n._initialized){n._initialized=!0;for(let p of f)p.initialize(h,t)}t.registerEditorTypes(f),this.#o=t,this.pageIndex=r,this.div=i,this.#e=o,this.#n=a,this.viewport=u,this.#a=l,this.drawLayer=c,this._structTree=s,this.#o.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#o.getMode()===pe.NONE}updateToolbar(t){this.#o.updateToolbar(t)}updateMode(t=this.#o.getMode()){switch(this.#m(),t){case pe.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case pe.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case pe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);let{classList:r}=this.div;for(let i of n.#h.values())r.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#a?.div}addInkEditorIfNeeded(t){if(this.#o.getMode()!==pe.INK)return;if(!t){for(let i of this.#s.values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){this.#o.setEditingState(t)}addCommands(t){this.#o.addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);let t=new Set;for(let i of this.#s.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#o.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#n)return;let r=this.#n.getEditableAnnotations();for(let i of r){if(i.hide(),this.#o.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;let s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}}disable(){this.#u=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);let t=new Map,r=new Map;for(let s of this.#s.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else r.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){let s=this.#n.getEditableAnnotations();for(let o of s){let{id:a}=o.data;if(this.#o.isDeletedAnnotationElement(a))continue;let c=r.get(a);if(c){c.resetAnnotationElement(o),c.show(!1),o.show();continue}c=t.get(a),c&&(this.#o.addChangedExistingAnnotation(c),c.renderAnnotationElement(o)&&c.show(!1)),o.show()}}this.#m(),this.isEmpty&&(this.div.hidden=!0);let{classList:i}=this.div;for(let s of n.#h.values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#u=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#o.getActive()!==t&&this.#o.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#a?.div&&!this.#d){this.#d=new AbortController;let t=this.#o.combinedSignal(this.#d);this.#a.div.addEventListener("pointerdown",this.#p.bind(this),{signal:t}),this.#a.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#a?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#a.div.classList.remove("highlighting"))}#p(t){this.#o.unselectAll();let{target:r}=t;if(r===this.#a.div||(r.getAttribute("role")==="img"||r.classList.contains("endOfContent"))&&this.#a.div.contains(r)){let{isMac:i}=Ut.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#o.showAllEditors("highlight",!0,!0),this.#a.div.classList.add("free"),this.toggleDrawing(),fp.startHighlighting(this,this.#o.direction==="ltr",{target:this.#a.div,x:t.x,y:t.y}),this.#a.div.addEventListener("pointerup",()=>{this.#a.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#o._signal}),t.preventDefault()}}enableClick(){if(this.#r)return;this.#r=new AbortController;let t=this.#o.combinedSignal(this.#r);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){this.#r?.abort(),this.#r=null}attach(t){this.#s.set(t.id,t);let{annotationElementId:r}=t;r&&this.#o.isDeletedAnnotationElement(r)&&this.#o.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#e?.removePointerInTextLayer(t.contentDiv),!this.#u&&t.annotationElementId&&this.#o.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#o.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#o.addDeletedAnnotationElement(t.annotationElementId),Le.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#o.addEditor(t),this.attach(t),!t.isAttachedToDOM){let r=t.render();this.div.append(r),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#o.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;let{activeElement:r}=document;t.div.contains(r)&&!this.#i&&(t._focusEventsAllowed=!1,this.#i=setTimeout(()=>{this.#i=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#o._signal}),r.focus())},0)),t._structTreeParentId=this.#e?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){let r=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:r,undo:i,mustExec:!1})}getNextId(){return this.#o.getId()}get#f(){return n.#h.get(this.#o.getMode())}combinedSignal(t){return this.#o.combinedSignal(t)}#g(t){let r=this.#f;return r?new r.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#f?.canCreateNewEmptyEditor()}pasteEditor(t,r){this.#o.updateToolbar(t),this.#o.updateMode(t);let{offsetX:i,offsetY:s}=this.#y(),o=this.getNextId(),a=this.#g(L({parent:this,id:o,x:i,y:s,uiManager:this.#o,isCentered:!0},r));a&&this.add(a)}async deserialize(t){return await n.#h.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#o)||null}createAndAddNewEditor(t,r,i={}){let s=this.getNextId(),o=this.#g(L({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#o,isCentered:r},i));return o&&this.add(o),o}#y(){let{x:t,y:r,width:i,height:s}=this.div.getBoundingClientRect(),o=Math.max(0,t),a=Math.max(0,r),c=Math.min(window.innerWidth,t+i),l=Math.min(window.innerHeight,r+s),u=(o+c)/2-t,h=(a+l)/2-r,[f,p]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:f,offsetY:p}}addNewEditor(){this.createAndAddNewEditor(this.#y(),!0)}setSelected(t){this.#o.setSelected(t)}toggleSelected(t){this.#o.toggleSelected(t)}unselect(t){this.#o.unselect(t)}pointerup(t){let{isMac:r}=Ut.platform;if(!(t.button!==0||t.ctrlKey&&r)&&t.target===this.div&&this.#c){if(this.#c=!1,!this.#t){this.#t=!0;return}if(this.#o.getMode()===pe.STAMP){this.#o.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#o.getMode()===pe.HIGHLIGHT&&this.enableTextSelection(),this.#c){this.#c=!1;return}let{isMac:r}=Ut.platform;if(t.button!==0||t.ctrlKey&&r||t.target!==this.div)return;this.#c=!0;let i=this.#o.getActive();this.#t=!i||i.isEmpty()}findNewParent(t,r,i){let s=this.#o.findParent(r,i);return s===null||s===this?!1:(s.changeParent(t),!0)}destroy(){this.#o.getActive()?.parent===this&&(this.#o.commitOrRemove(),this.#o.setActiveEditor(null)),this.#i&&(clearTimeout(this.#i),this.#i=null);for(let t of this.#s.values())this.#e?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#o.removeLayer(this)}#m(){this.#l=!0;for(let t of this.#s.values())t.isEmpty()&&t.remove();this.#l=!1}render({viewport:t}){this.viewport=t,so(this.div,t);for(let r of this.#o.getEditors(this.pageIndex))this.add(r),r.rebuild();this.updateMode()}update({viewport:t}){this.#o.commitOrRemove(),this.#m();let r=this.viewport.rotation,i=t.rotation;if(this.viewport=t,so(this.div,{rotation:i}),r!==i)for(let s of this.#s.values())s.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){let{pageWidth:t,pageHeight:r}=this.viewport.rawDims;return[t,r]}get scale(){return this.#o.viewParameters.realScale}}return n})(),rb=class n{#e=null;#t=0;#n=new Map;#r=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(let t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Te(this,"_svgFactory",new Jl)}static#i(e,{x:t=0,y:r=0,width:i=1,height:s=1}={}){let{style:o}=e;o.top=`${100*r}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*s}%`}#s(e){let t=n._svgFactory.create(1,1,!0);return this.#e.append(t),t.setAttribute("aria-hidden",!0),n.#i(t,e),t}#c(e,t){let r=n._svgFactory.createElement("clipPath");e.append(r);let i=`clip_${t}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");let s=n._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i}draw(e,t,r,i=!1){let s=this.#t++,o=this.#s(e.box);o.classList.add(...e.classNamesForDrawing);let a=n._svgFactory.createElement("defs");o.append(a);let c=n._svgFactory.createElement("path");a.append(c);let l=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",l),c.setAttribute("d",e.toSVGPath()),i&&this.#r.set(s,c);let u=this.#c(a,l),h=n._svgFactory.createElement("use");return o.append(h),o.setAttribute("fill",t),o.setAttribute("fill-opacity",r),h.setAttribute("href",`#${l}`),this.#n.set(s,o),{id:s,clipPathId:`url(#${u})`}}drawOutline(e){let t=this.#t++,r=this.#s(e.box);r.classList.add(...e.classNamesForOutlining);let i=n._svgFactory.createElement("defs");r.append(i);let s=n._svgFactory.createElement("path");i.append(s);let o=`path_p${this.pageIndex}_${t}`;s.setAttribute("id",o),s.setAttribute("d",e.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let a;if(e.mustRemoveSelfIntersections){let u=n._svgFactory.createElement("mask");i.append(u),a=`mask_p${this.pageIndex}_${t}`,u.setAttribute("id",a),u.setAttribute("maskUnits","objectBoundingBox");let h=n._svgFactory.createElement("rect");u.append(h),h.setAttribute("width","1"),h.setAttribute("height","1"),h.setAttribute("fill","white");let f=n._svgFactory.createElement("use");u.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}let c=n._svgFactory.createElement("use");r.append(c),c.setAttribute("href",`#${o}`),a&&c.setAttribute("mask",`url(#${a})`);let l=c.cloneNode();return r.append(l),c.classList.add("mainOutline"),l.classList.add("secondaryOutline"),this.#n.set(t,r),t}finalizeLine(e,t){let r=this.#r.get(e);this.#r.delete(e),this.updateBox(e,t.box),r.setAttribute("d",t.toSVGPath())}updateLine(e,t){this.#n.get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}updatePath(e,t){this.#r.get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){n.#i(this.#n.get(e),t)}show(e,t){this.#n.get(e).classList.toggle("hidden",!t)}rotate(e,t){this.#n.get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){this.#n.get(e).setAttribute("fill",t)}changeOpacity(e,t){this.#n.get(e).setAttribute("fill-opacity",t)}addClass(e,t){this.#n.get(e).classList.add(t)}removeClass(e,t){this.#n.get(e).classList.remove(t)}getSVGRoot(e){return this.#n.get(e)}remove(e){this.#r.delete(e),this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(let e of this.#n.values())e.remove();this.#n.clear(),this.#r.clear()}};var sz=ce.AbortException,oz=ce.AnnotationEditorLayer,az=ce.AnnotationEditorParamsType,db=ce.AnnotationEditorType,cz=ce.AnnotationEditorUIManager,lz=ce.AnnotationLayer,uz=ce.AnnotationMode,dz=ce.ColorPicker,hz=ce.DOMSVGFactory,fz=ce.DrawLayer,pz=ce.FeatureTest,hb=ce.GlobalWorkerOptions,gz=ce.ImageKind,mz=ce.InvalidPDFException,yz=ce.MissingPDFException,vz=ce.OPS,_z=ce.OutputScale,wz=ce.PDFDataRangeTransport,Ez=ce.PDFDateString,bz=ce.PDFWorker,Iz=ce.PasswordResponses,Az=ce.PermissionFlag,Tz=ce.PixelsPerInch,Cz=ce.RenderingCancelledException,Sz=ce.TextLayer,Dz=ce.UnexpectedResponseException,xz=ce.Util,fb=ce.VerbosityLevel,Pz=ce.XfaLayer,Mz=ce.build,Rz=ce.createValidAbsoluteUrl,Nz=ce.fetchData,pb=ce.getDocument,Oz=ce.getFilenameFromUrl,kz=ce.getPdfFilenameFromUrl,Lz=ce.getXfaPageViewport,Fz=ce.isDataScheme,Vz=ce.isPdfFile,jz=ce.noContextMenu,Bz=ce.normalizeUnicode,Uz=ce.setLayerDimensions,Hz=ce.shadow,ru=ce.version;var nI={};hS(nI,{AnnotationLayerBuilder:()=>x3,DownloadManager:()=>P3,EventBus:()=>M3,FindState:()=>R3,GenericL10n:()=>Xb,LinkTarget:()=>ho,PDFFindController:()=>Jb,PDFHistory:()=>N3,PDFLinkService:()=>Zb,PDFPageView:()=>O3,PDFScriptingManager:()=>k3,PDFSinglePageViewer:()=>eI,PDFViewer:()=>tI,ProgressBar:()=>L3,RenderingStates:()=>F3,ScrollMode:()=>V3,SimpleLinkService:()=>j3,SpreadMode:()=>B3,StructTreeLayerBuilder:()=>U3,TextLayerBuilder:()=>H3,XfaLayerBuilder:()=>$3,parseQueryString:()=>z3});var su={};su.d=(n,e)=>{for(var t in e)su.o(e,t)&&!su.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};su.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Je=globalThis.pdfjsViewer={};su.d(Je,{AnnotationLayerBuilder:()=>Pp,DownloadManager:()=>Sb,EventBus:()=>Mp,FindState:()=>ss,GenericL10n:()=>Ma,LinkTarget:()=>co,PDFFindController:()=>Tb,PDFHistory:()=>Vb,PDFLinkService:()=>Dp,PDFPageView:()=>Fp,PDFScriptingManager:()=>qb,PDFSinglePageViewer:()=>Qb,PDFViewer:()=>Vp,ProgressBar:()=>Ab,RenderingStates:()=>nt,ScrollMode:()=>Se,SimpleLinkService:()=>cu,SpreadMode:()=>Xt,StructTreeLayerBuilder:()=>Op,TextLayerBuilder:()=>kp,XfaLayerBuilder:()=>Lp,parseQueryString:()=>jp});var $z="auto",qR=1,pR=1.1,zz=.1,Gz=10,gb=0,Wz=1.25,gR=40,mR=5,nt={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},Da={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};var Rr={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},Se={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},Xt={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};function KR(n,e,t=!1){let r=n.offsetParent;if(!r){console.error("offsetParent is not set -- cannot scroll");return}let i=n.offsetTop+n.clientTop,s=n.offsetLeft+n.clientLeft;for(;r.clientHeight===r.scrollHeight&&r.clientWidth===r.scrollWidth||t&&(r.classList.contains("markedContent")||getComputedStyle(r).overflow==="hidden");)if(i+=r.offsetTop,s+=r.offsetLeft,r=r.offsetParent,!r)return;e&&(e.top!==void 0&&(i+=e.top),e.left!==void 0&&(s+=e.left,r.scrollLeft=s)),r.scrollTop=i}function qz(n,e,t=void 0){let r=function(o){s||(s=window.requestAnimationFrame(function(){s=null;let c=n.scrollLeft,l=i.lastX;c!==l&&(i.right=c>l),i.lastX=c;let u=n.scrollTop,h=i.lastY;u!==h&&(i.down=u>h),i.lastY=u,e(i)}))},i={right:!0,down:!0,lastX:n.scrollLeft,lastY:n.scrollTop,_eventHandler:r},s=null;return n.addEventListener("scroll",r,{useCapture:!0,signal:t}),t?.addEventListener("abort",()=>window.cancelAnimationFrame(s),{once:!0}),i}function jp(n){let e=new Map;for(let[t,r]of new URLSearchParams(n))e.set(t.toLowerCase(),r);return e}var yR=/[\x00-\x1F]/g;function ou(n,e=!1){return yR.test(n)?e?n.replaceAll(yR,t=>t==="\0"?"":" "):n.replaceAll("\0",""):n}function au(n,e,t=0){let r=t,i=n.length-1;if(i<0||!e(n[i]))return n.length;if(e(n[r]))return r;for(;r<i;){let s=r+i>>1,o=n[s];e(o)?i=s:r=s+1}return r}function vR(n){if(Math.floor(n)===n)return[n,1];let e=1/n,t=8;if(e>t)return[1,t];if(Math.floor(e)===e)return[1,e];let r=n>1?e:n,i=0,s=1,o=1,a=1;for(;;){let l=i+o,u=s+a;if(u>t)break;r<=l/u?(o=l,a=u):(i=l,s=u)}let c;return r-i/s<o/a-r?c=r===n?[i,s]:[s,i]:c=r===n?[o,a]:[a,o],c}function Ep(n,e){return n-n%e}function Kz(n,e,t){if(n<2)return n;let r=e[n].div,i=r.offsetTop+r.clientTop;i>=t&&(r=e[n-1].div,i=r.offsetTop+r.clientTop);for(let s=n-2;s>=0&&(r=e[s].div,!(r.offsetTop+r.clientTop+r.clientHeight<=i));--s)n=s;return n}function Yz({scrollEl:n,views:e,sortByVisibility:t=!1,horizontal:r=!1,rtl:i=!1}){let s=n.scrollTop,o=s+n.clientHeight,a=n.scrollLeft,c=a+n.clientWidth;function l(D){let P=D.div;return P.offsetTop+P.clientTop+P.clientHeight>s}function u(D){let P=D.div,x=P.offsetLeft+P.clientLeft,N=x+P.clientWidth;return i?x<c:N>a}let h=[],f=new Set,p=e.length,m=au(e,r?u:l);m>0&&m<p&&!r&&(m=Kz(m,e,s));let v=r?c:-1;for(let D=m;D<p;D++){let P=e[D],x=P.div,N=x.offsetLeft+x.clientLeft,k=x.offsetTop+x.clientTop,T=x.clientWidth,E=x.clientHeight,_=N+T,A=k+E;if(v===-1)A>=o&&(v=A);else if((r?N:k)>v)break;if(A<=s||k>=o||_<=a||N>=c)continue;let C=Math.max(0,s-k)+Math.max(0,A-o),M=Math.max(0,a-N)+Math.max(0,_-c),S=(E-C)/E,Z=(T-M)/T,_e=S*Z*100|0;h.push({id:P.id,x:N,y:k,view:P,percent:_e,widthPercent:Z*100|0}),f.add(P.id)}let w=h[0],I=h.at(-1);return t&&h.sort(function(D,P){let x=D.percent-P.percent;return Math.abs(x)>.001?-x:D.id-P.id}),{first:w,last:I,views:h,ids:f}}function YR(n){return Number.isInteger(n)&&n%90===0}function Qz(n){return Number.isInteger(n)&&Object.values(Se).includes(n)&&n!==Se.UNKNOWN}function Xz(n){return Number.isInteger(n)&&Object.values(Xt).includes(n)&&n!==Xt.UNKNOWN}function _R(n){return n.width<=n.height}var ode=new Promise(function(n){window.requestAnimationFrame(n)}),Jz=document.documentElement.style;function Zz(n,e,t){return Math.min(Math.max(n,e),t)}var Ab=class{#e=null;#t=null;#n=0;#r=null;#i=!0;constructor(e){this.#e=e.classList,this.#r=e.style}get percent(){return this.#n}set percent(e){if(this.#n=Zz(e,0,100),isNaN(e)){this.#e.add("indeterminate");return}this.#e.remove("indeterminate"),this.#r.setProperty("--progressBar-percent",`${this.#n}%`)}setWidth(e){if(!e)return;let r=e.parentNode.offsetWidth-e.offsetWidth;r>0&&this.#r.setProperty("--progressBar-end-offset",`${r}px`)}setDisableAutoFetch(e=5e3){this.#n===100||isNaN(this.#n)||(this.#t&&clearTimeout(this.#t),this.show(),this.#t=setTimeout(()=>{this.#t=null,this.hide()},e))}hide(){this.#i&&(this.#i=!1,this.#e.add("hidden"))}show(){this.#i||(this.#i=!0,this.#e.remove("hidden"))}};function e4(n){let e=Se.VERTICAL,t=Xt.NONE;switch(n){case"SinglePage":e=Se.PAGE;break;case"OneColumn":break;case"TwoPageLeft":e=Se.PAGE;case"TwoColumnLeft":t=Xt.ODD;break;case"TwoPageRight":e=Se.PAGE;case"TwoColumnRight":t=Xt.EVEN;break}return{scrollMode:e,spreadMode:t}}var bp=(function(){let n=document.createElement("div");return n.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)",n.style.width==="calc(1320px)"?Math.fround:e=>e})(),ur={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function t4(n){return n<11904}function n4(n){return(n&65408)===0}function r4(n){return n>=97&&n<=122||n>=65&&n<=90}function i4(n){return n>=48&&n<=57}function s4(n){return n===32||n===9||n===13||n===10}function o4(n){return n>=13312&&n<=40959||n>=63744&&n<=64255}function a4(n){return n>=12448&&n<=12543}function c4(n){return n>=12352&&n<=12447}function l4(n){return n>=65376&&n<=65439}function u4(n){return(n&65408)===3584}function Ip(n){return t4(n)?n4(n)?s4(n)?ur.SPACE:r4(n)||i4(n)||n===95?ur.ALPHA_LETTER:ur.PUNCT:u4(n)?ur.THAI_LETTER:n===160?ur.SPACE:ur.ALPHA_LETTER:o4(n)?ur.HAN_LETTER:a4(n)?ur.KATAKANA_LETTER:c4(n)?ur.HIRAGANA_LETTER:l4(n)?ur.HALFWIDTH_KATAKANA_LETTER:ur.ALPHA_LETTER}var wR;function d4(){return wR||="\xA0\xA8\xAA\xAF\xB2-\xB5\xB8-\xBA\xBC-\xBE\u0132-\u0133\u013F-\u0140\u0149\u017F\u01C4-\u01CC\u01F1-\u01F3\u02B0-\u02B8\u02D8-\u02DD\u02E0-\u02E4\u0374\u037A\u037E\u0384-\u0385\u0387\u03D0-\u03D6\u03F0-\u03F2\u03F4-\u03F5\u03F9\u0587\u0675-\u0678\u0958-\u095F\u09DC-\u09DD\u09DF\u0A33\u0A36\u0A59-\u0A5B\u0A5E\u0B5C-\u0B5D\u0E33\u0EB3\u0EDC-\u0EDD\u0F0C\u0F43\u0F4D\u0F52\u0F57\u0F5C\u0F69\u10FC\u1D2C-\u1D2E\u1D30-\u1D3A\u1D3C-\u1D4D\u1D4F-\u1D6A\u1D78\u1D9B-\u1DBF\u1E9A-\u1E9B\u1F71\u1F73\u1F75\u1F77\u1F79\u1F7B\u1F7D\u1FBB\u1FBD-\u1FC1\u1FC9\u1FCB\u1FCD-\u1FCF\u1FD3\u1FDB\u1FDD-\u1FDF\u1FE3\u1FEB\u1FED-\u1FEF\u1FF9\u1FFB\u1FFD-\u1FFE\u2000-\u200A\u2011\u2017\u2024-\u2026\u202F\u2033-\u2034\u2036-\u2037\u203C\u203E\u2047-\u2049\u2057\u205F\u2070-\u2071\u2074-\u208E\u2090-\u209C\u20A8\u2100-\u2103\u2105-\u2107\u2109-\u2113\u2115-\u2116\u2119-\u211D\u2120-\u2122\u2124\u2126\u2128\u212A-\u212D\u212F-\u2131\u2133-\u2139\u213B-\u2140\u2145-\u2149\u2150-\u217F\u2189\u222C-\u222D\u222F-\u2230\u2329-\u232A\u2460-\u24EA\u2A0C\u2A74-\u2A76\u2ADC\u2C7C-\u2C7D\u2D6F\u2E9F\u2EF3\u2F00-\u2FD5\u3000\u3036\u3038-\u303A\u309B-\u309C\u309F\u30FF\u3131-\u318E\u3192-\u319F\u3200-\u321E\u3220-\u3247\u3250-\u327E\u3280-\u33FF\uA69C-\uA69D\uA770\uA7F2-\uA7F4\uA7F8-\uA7F9\uAB5C-\uAB5F\uAB69\uF900-\uFA0D\uFA10\uFA12\uFA15-\uFA1E\uFA20\uFA22\uFA25-\uFA26\uFA2A-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE10-\uFE19\uFE30-\uFE44\uFE47-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE72\uFE74\uFE76-\uFEFC\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6",wR}var ss={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},h4=250,f4=-50,p4=-400,ER={"\u2010":"-","\u2018":"'","\u2019":"'","\u201A":"'","\u201B":"'","\u201C":'"',"\u201D":'"',"\u201E":'"',"\u201F":'"',"\xBC":"1/4","\xBD":"1/2","\xBE":"3/4"},bR=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),IR,g4=new RegExp("\\p{M}+","gu"),m4=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),y4=new RegExp("([^\\p{M}])\\p{M}*$","u"),v4=new RegExp("^\\p{M}*([^\\p{M}])","u"),_4=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,AR=new Map,w4="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",TR=new Map,mb=null,yb=null;function vb(n){let e=[],t;for(;(t=_4.exec(n))!==null;){let{index:p}=t;for(let m of t[0]){let v=AR.get(m);v||(v=m.normalize("NFD").length,AR.set(m,v)),e.push([v,p++])}}let r;if(e.length===0&&mb)r=mb;else if(e.length>0&&yb)r=yb;else{let p=Object.keys(ER).join(""),m=d4(),D=`([${p}])|([${m}])|((?:\u3099|\u309A)\\n)|(\\p{M}+(?:-\\n)?)|(\\p{Ll}-\\n\\p{Lu})|(\\S-\\n)|((?:\\p{Ideographic}|[\u3040-\u30FF])\\n)|(\\n)`;e.length===0?r=mb=new RegExp(D+"|(\\u0000)","gum"):r=yb=new RegExp(D+`|(${w4})`,"gum")}let i=[];for(;(t=g4.exec(n))!==null;)i.push([t[0].length,t.index]);let s=n.normalize("NFD"),o=[[0,0]],a=0,c=0,l=0,u=0,h=0,f=!1;return s=s.replace(r,(p,m,v,w,I,D,P,x,N,k,T)=>{if(T-=u,m){let E=ER[m],_=E.length;for(let A=1;A<_;A++)o.push([T-l+A,l-A]);return l-=_-1,E}if(v){let E=TR.get(v);E||(E=v.normalize("NFKC"),TR.set(v,E));let _=E.length;for(let A=1;A<_;A++)o.push([T-l+A,l-A]);return l-=_-1,E}if(w)return f=!0,T+h===i[a]?.[1]?++a:(o.push([T-1-l+1,l-1]),l-=1,u+=1),o.push([T-l+1,l]),u+=1,h+=1,w.charAt(0);if(I){let E=I.endsWith(`
`),_=E?I.length-2:I.length;f=!0;let A=_;T+h===i[a]?.[1]&&(A-=i[a][0],++a);for(let C=1;C<=A;C++)o.push([T-1-l+C,l-C]);return l-=A,u+=A,E?(T+=_-1,o.push([T-l+1,1+l]),l+=1,u+=1,h+=1,I.slice(0,_)):I}if(D)return o.push([T-l+3,1+l]),l+=1,u+=1,h+=1,D.replace(`
`,"");if(P){let E=P.length-2;return o.push([T-l+E,1+l]),l+=1,u+=1,h+=1,P.slice(0,-2)}if(x){let E=x.length-1;return o.push([T-l+E,l]),u+=1,h+=1,x.slice(0,-1)}if(N)return o.push([T-l+1,l-1]),l-=1,u+=1,h+=1," ";if(T+h===e[c]?.[1]){let E=e[c][0]-1;++c;for(let _=1;_<=E;_++)o.push([T-(l-_),l-_]);l-=E,u+=E}return k}),o.push([s.length,l]),[s,o,f]}function E4(n,e,t){if(!n)return[e,t];let r=e,i=e+t-1,s=au(n,u=>u[0]>=r);n[s][0]>r&&--s;let o=au(n,u=>u[0]>=i,s);n[o][0]>i&&--o;let a=r+n[s][1],l=i+n[o][1]+1-a;return[a,l]}var Tb=class{#e=null;#t=!0;#n=0;constructor({linkService:e,eventBus:t,updateMatchesCountOnProgress:r=!0}){this._linkService=e,this._eventBus=t,this.#t=r,this.onIsPageVisible=null,this.#i(),t._on("find",this.#r.bind(this)),t._on("findbarclose",this.#v.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#e}setDocument(e){this._pdfDocument&&this.#i(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}#r(e){if(!e)return;let t=this._pdfDocument,{type:r}=e;(this.#e===null||this.#c(e))&&(this._dirtyMatch=!0),this.#e=e,r!=="highlightallchange"&&this.#E(ss.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||t&&this._pdfDocument!==t)return;this.#d();let i=!this._highlightMatches,s=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),r?this._dirtyMatch?this.#p():r==="again"?(this.#p(),i&&this.#e.highlightAll&&this.#h()):r==="highlightallchange"?(s?this.#p():this._highlightMatches=!0,this.#h()):this.#p():this._findTimeout=setTimeout(()=>{this.#p(),this._findTimeout=null},h4)})}scrollMatchIntoView({element:e=null,selectedLeft:t=0,pageIndex:r=-1,matchIndex:i=-1}){if(!this._scrollMatches||!e)return;if(i===-1||i!==this._selected.matchIdx)return;if(r===-1||r!==this._selected.pageIdx)return;this._scrollMatches=!1;let s={top:f4,left:t+p4};KR(e,s,!0)}#i(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#n=0,this.#e=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#s(){let{query:e}=this.#e;return typeof e=="string"?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=vb(e)),this._normalizedQuery):(e||[]).filter(t=>!!t).map(t=>vb(t)[0])}#c(e){let t=e.query,r=this.#e.query,i=typeof t;if(i!==typeof r)return!0;if(i==="string"){if(t!==r)return!0}else if(JSON.stringify(t)!==JSON.stringify(r))return!0;switch(e.type){case"again":let o=this._selected.pageIdx+1,a=this._linkService;return o>=1&&o<=a.pagesCount&&o!==a.page&&!(this.onIsPageVisible?.(o)??!0);case"highlightallchange":return!1}return!0}#l(e,t,r){let i=e.slice(0,t).match(y4);if(i){let s=e.charCodeAt(t),o=i[1].charCodeAt(0);if(Ip(s)===Ip(o))return!1}if(i=e.slice(t+r).match(v4),i){let s=e.charCodeAt(t+r-1),o=i[1].charCodeAt(0);if(Ip(s)===Ip(o))return!1}return!0}#u(e,t){let{matchDiacritics:r}=this.#e,i=!1;e=e.replaceAll(m4,(o,a,c,l,u,h)=>a?`[ ]*\\${a}[ ]*`:c?`[ ]*${c}[ ]*`:l?"[ ]+":r?u||h:u?bR.has(u.charCodeAt(0))?u:"":t?(i=!0,`${h}\\p{M}*`):h);let s="[ ]*";return e.endsWith(s)&&(e=e.slice(0,e.length-s.length)),r&&t&&(IR||=String.fromCharCode(...bR),i=!0,e=`${e}(?=[${IR}]|[^\\p{M}]|$)`),[i,e]}#a(e){let t=this.#s;if(t.length===0)return;let r=this._pageContents[e],i=this.match(t,r,e),s=this._pageMatches[e]=[],o=this._pageMatchesLength[e]=[],a=this._pageDiffs[e];i?.forEach(({index:l,length:u})=>{let[h,f]=E4(a,l,u);f&&(s.push(h),o.push(f))}),this.#e.highlightAll&&this.#o(e),this._resumePageIdx===e&&(this._resumePageIdx=null,this.#g());let c=s.length;this._matchesCountTotal+=c,this.#t?c>0&&this.#I():++this.#n===this._linkService.pagesCount&&this.#I()}match(e,t,r){let i=this._hasDiacritics[r],s=!1;if(typeof e=="string"?[s,e]=this.#u(e,i):e=e.sort().reverse().map(h=>{let[f,p]=this.#u(h,i);return s||=f,`(${p})`}).join("|"),!e)return;let{caseSensitive:o,entireWord:a}=this.#e,c=`g${s?"u":""}${o?"":"i"}`;e=new RegExp(e,c);let l=[],u;for(;(u=e.exec(t))!==null;)a&&!this.#l(t,u.index,u[0].length)||l.push({index:u.index,length:u[0].length});return l}#d(){if(this._extractTextPromises.length>0)return;let e=Promise.resolve(),t={disableNormalization:!0};for(let r=0,i=this._linkService.pagesCount;r<i;r++){let{promise:s,resolve:o}=Promise.withResolvers();this._extractTextPromises[r]=s,e=e.then(()=>this._pdfDocument.getPage(r+1).then(a=>a.getTextContent(t)).then(a=>{let c=[];for(let l of a.items)c.push(l.str),l.hasEOL&&c.push(`
`);[this._pageContents[r],this._pageDiffs[r],this._hasDiacritics[r]]=vb(c.join("")),o()},a=>{console.error(`Unable to get text content for page ${r+1}`,a),this._pageContents[r]="",this._pageDiffs[r]=null,this._hasDiacritics[r]=!1,o()}))}}#o(e){this._scrollMatches&&this._selected.pageIdx===e&&(this._linkService.page=e+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:e})}#h(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#p(){let e=this.#e.findPrevious,t=this._linkService.page-1,r=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#n=0,this._matchesCountTotal=0,this.#h();for(let o=0;o<r;o++)this._pendingFindMatches.has(o)||(this._pendingFindMatches.add(o),this._extractTextPromises[o].then(()=>{this._pendingFindMatches.delete(o),this.#a(o)}))}if(this.#s.length===0){this.#E(ss.FOUND);return}if(this._resumePageIdx)return;let s=this._offset;if(this._pagesToSearch=r,s.matchIdx!==null){let o=this._pageMatches[s.pageIdx].length;if(!e&&s.matchIdx+1<o||e&&s.matchIdx>0){s.matchIdx=e?s.matchIdx-1:s.matchIdx+1,this.#m(!0);return}this.#y(e)}this.#g()}#f(e){let t=this._offset,r=e.length,i=this.#e.findPrevious;return r?(t.matchIdx=i?r-1:0,this.#m(!0),!0):(this.#y(i),t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0)?(this.#m(!1),!0):!1)}#g(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let e=null;do{let t=this._offset.pageIdx;if(e=this._pageMatches[t],!e){this._resumePageIdx=t;break}}while(!this.#f(e))}#y(e){let t=this._offset,r=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=r||t.pageIdx<0)&&(t.pageIdx=e?r-1:0,t.wrapped=!0)}#m(e=!1){let t=ss.NOT_FOUND,r=this._offset.wrapped;if(this._offset.wrapped=!1,e){let i=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=r?ss.WRAPPED:ss.FOUND,i!==-1&&i!==this._selected.pageIdx&&this.#o(i)}this.#E(t,this.#e.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#o(this._selected.pageIdx))}#v(e){let t=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||t&&this._pdfDocument!==t||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#E(ss.FOUND),this._highlightMatches=!1,this.#h())})}#w(){let{pageIdx:e,matchIdx:t}=this._selected,r=0,i=this._matchesCountTotal;if(t!==-1){for(let s=0;s<e;s++)r+=this._pageMatches[s]?.length||0;r+=t+1}return(r<1||r>i)&&(r=i=0),{current:r,total:i}}#I(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#w()})}#E(e,t=!1){!this.#t&&(this.#n!==this._linkService.pagesCount||e===ss.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:e,previous:t,entireWord:this.#e?.entireWord??null,matchesCount:this.#w(),rawQuery:this.#e?.query??null})}},b4="noopener noreferrer nofollow",co={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},Dp=class n{externalLinkEnabled=!0;constructor({eventBus:e,externalLinkTarget:t=null,externalLinkRel:r=null,ignoreDestinationZoom:i=!1}={}){this.eventBus=e,this.externalLinkTarget=t,this.externalLinkRel=r,this._ignoreDestinationZoom=i,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,t=null){this.baseUrl=t,this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(e){this.pdfDocument&&(this.pdfViewer.currentPageNumber=e)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(e){this.pdfDocument&&(this.pdfViewer.pagesRotation=e)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}async goToDestination(e){if(!this.pdfDocument)return;let t,r,i;if(typeof e=="string"?(t=e,r=await this.pdfDocument.getDestination(e)):(t=null,r=await e),!Array.isArray(r)){console.error(`goToDestination: "${r}" is not a valid destination array, for dest="${e}".`);return}let[s]=r;if(s&&typeof s=="object"){if(i=this.pdfDocument.cachedPageNumber(s),!i)try{i=await this.pdfDocument.getPageIndex(s)+1}catch{console.error(`goToDestination: "${s}" is not a valid page reference, for dest="${e}".`);return}}else Number.isInteger(s)&&(i=s+1);if(!i||i<1||i>this.pagesCount){console.error(`goToDestination: "${i}" is not a valid page number, for dest="${e}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:t,explicitDest:r,pageNumber:i})),this.pdfViewer.scrollPageIntoView({pageNumber:i,destArray:r,ignoreDestinationZoom:this._ignoreDestinationZoom})}goToPage(e){if(!this.pdfDocument)return;let t=typeof e=="string"&&this.pdfViewer.pageLabelToPageNumber(e)||e|0;if(!(Number.isInteger(t)&&t>0&&t<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(t)),this.pdfViewer.scrollPageIntoView({pageNumber:t})}addLinkAttributes(e,t,r=!1){if(!t||typeof t!="string")throw new Error('A valid "url" parameter must provided.');let i=r?co.BLANK:this.externalLinkTarget,s=this.externalLinkRel;this.externalLinkEnabled?e.href=e.title=t:(e.href="",e.title=`Disabled: ${t}`,e.onclick=()=>!1);let o="";switch(i){case co.NONE:break;case co.SELF:o="_self";break;case co.BLANK:o="_blank";break;case co.PARENT:o="_parent";break;case co.TOP:o="_top";break}e.target=o,e.rel=typeof s=="string"?s:b4}getDestinationHash(e){if(typeof e=="string"){if(e.length>0)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){let t=JSON.stringify(e);if(t.length>0)return this.getAnchorUrl("#"+escape(t))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(e){if(!this.pdfDocument)return;let t,r;if(e.includes("=")){let i=jp(e);if(i.has("search")){let s=i.get("search").replaceAll('"',""),o=i.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:o?s:s.match(/\S+/g)})}if(i.has("page")&&(t=i.get("page")|0||1),i.has("zoom")){let s=i.get("zoom").split(","),o=s[0],a=parseFloat(o);o.includes("Fit")?o==="Fit"||o==="FitB"?r=[null,{name:o}]:o==="FitH"||o==="FitBH"||o==="FitV"||o==="FitBV"?r=[null,{name:o},s.length>1?s[1]|0:null]:o==="FitR"?s.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):r=[null,{name:o},s[1]|0,s[2]|0,s[3]|0,s[4]|0]:console.error(`PDFLinkService.setHash: "${o}" is not a valid zoom value.`):r=[null,{name:"XYZ"},s.length>1?s[1]|0:null,s.length>2?s[2]|0:null,a?a/100:o]}r?this.pdfViewer.scrollPageIntoView({pageNumber:t||this.page,destArray:r,allowNegativeOffset:!0}):t&&(this.page=t),i.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:i.get("pagemode")}),i.has("nameddest")&&this.goToDestination(i.get("nameddest"));return}r=unescape(e);try{r=JSON.parse(r),Array.isArray(r)||(r=r.toString())}catch{}if(typeof r=="string"||n.#e(r)){this.goToDestination(r);return}console.error(`PDFLinkService.setHash: "${unescape(e)}" is not a valid destination.`)}executeNamedAction(e){if(this.pdfDocument){switch(e){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break;default:break}this.eventBus.dispatch("namedaction",{source:this,action:e})}}async executeSetOCGState(e){if(!this.pdfDocument)return;let t=this.pdfDocument,r=await this.pdfViewer.optionalContentConfigPromise;t===this.pdfDocument&&(r.setOCGState(e),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(r))}static#e(e){if(!Array.isArray(e)||e.length<2)return!1;let[t,r,...i]=e;if(!(typeof t=="object"&&Number.isInteger(t?.num)&&Number.isInteger(t?.gen))&&!Number.isInteger(t)||!(typeof r=="object"&&typeof r?.name=="string"))return!1;let s=i.length,o=!0;switch(r.name){case"XYZ":if(s<2||s>3)return!1;break;case"Fit":case"FitB":return s===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(s>1)return!1;break;case"FitR":if(s!==4)return!1;o=!1;break;default:return!1}for(let a of i)if(!(typeof a=="number"||o&&a===null))return!1;return!0}},cu=class extends Dp{setDocument(e,t=null){}},{AbortException:I4,AnnotationEditorLayer:A4,AnnotationEditorParamsType:ade,AnnotationEditorType:Dn,AnnotationEditorUIManager:T4,AnnotationLayer:C4,AnnotationMode:vi,build:cde,ColorPicker:lde,createValidAbsoluteUrl:S4,DOMSVGFactory:ude,DrawLayer:D4,FeatureTest:dde,fetchData:CR,getDocument:hde,getFilenameFromUrl:fde,getPdfFilenameFromUrl:x4,getXfaPageViewport:pde,GlobalWorkerOptions:gde,ImageKind:mde,InvalidPDFException:yde,isDataScheme:vde,isPdfFile:P4,MissingPDFException:_de,noContextMenu:wde,normalizeUnicode:M4,OPS:Ede,OutputScale:R4,PasswordResponses:bde,PDFDataRangeTransport:Ide,PDFDateString:Ade,PDFWorker:Tde,PermissionFlag:Ap,PixelsPerInch:yi,RenderingCancelledException:Cb,setLayerDimensions:N4,shadow:xp,TextLayer:O4,UnexpectedResponseException:Cde,Util:Sde,VerbosityLevel:Dde,version:SR,XfaLayer:_b}=globalThis.pdfjsLib,Pp=class{#e=null;#t=null;constructor({pdfPage:e,linkService:t,downloadManager:r,annotationStorage:i=null,imageResourcesPath:s="",renderForms:o=!0,enableScripting:a=!1,hasJSActionsPromise:c=null,fieldObjectsPromise:l=null,annotationCanvasMap:u=null,accessibilityManager:h=null,annotationEditorUIManager:f=null,onAppend:p=null}){this.pdfPage=e,this.linkService=t,this.downloadManager=r,this.imageResourcesPath=s,this.renderForms=o,this.annotationStorage=i,this.enableScripting=a,this._hasJSActionsPromise=c||Promise.resolve(!1),this._fieldObjectsPromise=l||Promise.resolve(null),this._annotationCanvasMap=u,this._accessibilityManager=h,this._annotationEditorUIManager=f,this.#e=p,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=t.eventBus}async render(e,t,r="display"){if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:e.clone({dontFlip:!0})});return}let[i,s,o]=await Promise.all([this.pdfPage.getAnnotations({intent:r}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;let a=this.div=document.createElement("div");if(a.className="annotationLayer",this.#e?.(a),i.length===0){this.hide();return}this.annotationLayer=new C4({div:a,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:e.clone({dontFlip:!0}),structTreeLayer:t?.structTreeLayer||null}),await this.annotationLayer.render({annotations:i,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:s,fieldObjects:o}),this.linkService.isInPresentationMode&&this.#n(Da.FULLSCREEN),this.#t||(this.#t=new AbortController,this._eventBus?._on("presentationmodechanged",c=>{this.#n(c.state)},{signal:this.#t.signal}))}cancel(){this._cancelled=!0,this.#t?.abort(),this.#t=null}hide(){this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}#n(e){if(!this.div)return;let t=!1;switch(e){case Da.FULLSCREEN:t=!0;break;case Da.NORMAL:break;default:return}for(let r of this.div.childNodes)r.hasAttribute("data-internal-link")||(r.inert=t)}};function DR(n,e){let t=document.createElement("a");if(!t.click)throw new Error('DownloadManager: "a.click()" is not supported.');t.href=n,t.target="_parent","download"in t&&(t.download=e),(document.body||document.documentElement).append(t),t.click(),t.remove()}var Sb=class{#e=new WeakMap;downloadData(e,t,r){let i=URL.createObjectURL(new Blob([e],{type:r}));DR(i,t)}openOrDownloadData(e,t,r=null){let s=P4(t)?"application/pdf":"";return this.downloadData(e,t,s),!1}download(e,t,r){let i;if(e)i=URL.createObjectURL(new Blob([e],{type:"application/pdf"}));else{if(!S4(t,"http://example.com")){console.error(`download - not a valid URL: ${t}`);return}i=t+"#pdfjs.action=download"}DR(i,r)}},xR={EVENT:"event",TIMEOUT:"timeout"};async function k4({target:n,name:e,delay:t=0}){if(typeof n!="object"||!(e&&typeof e=="string")||!(Number.isInteger(t)&&t>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");let{promise:r,resolve:i}=Promise.withResolvers(),s=new AbortController;function o(l){s.abort(),clearTimeout(c),i(l)}let a=n instanceof Mp?"_on":"addEventListener";n[a](e,o.bind(null,xR.EVENT),{signal:s.signal});let c=setTimeout(o.bind(null,xR.TIMEOUT),t);return r}var Mp=class{#e=Object.create(null);on(e,t,r=null){this._on(e,t,{external:!0,once:r?.once,signal:r?.signal})}off(e,t,r=null){this._off(e,t)}dispatch(e,t){let r=this.#e[e];if(!r||r.length===0)return;let i;for(let{listener:s,external:o,once:a}of r.slice(0)){if(a&&this._off(e,s),o){(i||=[]).push(s);continue}s(t)}if(i){for(let s of i)s(t);i=null}}_on(e,t,r=null){let i=null;if(r?.signal instanceof AbortSignal){let{signal:o}=r;if(o.aborted){console.error("Cannot use an `aborted` signal.");return}let a=()=>this._off(e,t);i=()=>o.removeEventListener("abort",a),o.addEventListener("abort",a)}(this.#e[e]||=[]).push({listener:t,external:r?.external===!0,once:r?.once===!0,rmAbort:i})}_off(e,t,r=null){let i=this.#e[e];if(i)for(let s=0,o=i.length;s<o;s++){let a=i[s];if(a.listener===t){a.rmAbort?.(),i.splice(s,1);return}}}};var xa=class{constructor(e){this.value=e}valueOf(){return this.value}},rt=class extends xa{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},dr=class extends xa{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},uo=class extends xa{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}},PR=100,L4="\u2068",F4="\u2069";function V4(n,e,t){if(t===e||t instanceof dr&&e instanceof dr&&t.value===e.value)return!0;if(e instanceof dr&&typeof t=="string"){let r=n.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===r)return!0}return!1}function MR(n,e,t){return e[t]?Pa(n,e[t].value):(n.reportError(new RangeError("No default")),new rt)}function Db(n,e){let t=[],r=Object.create(null);for(let i of e)i.type==="narg"?r[i.name]=lu(n,i.value):t.push(lu(n,i));return{positional:t,named:r}}function lu(n,e){switch(e.type){case"str":return e.value;case"num":return new dr(e.value,{minimumFractionDigits:e.precision});case"var":return j4(n,e);case"mesg":return B4(n,e);case"term":return U4(n,e);case"func":return H4(n,e);case"select":return $4(n,e);default:return new rt}}function j4(n,{name:e}){let t;if(n.params)if(Object.prototype.hasOwnProperty.call(n.params,e))t=n.params[e];else return new rt(`$${e}`);else if(n.args&&Object.prototype.hasOwnProperty.call(n.args,e))t=n.args[e];else return n.reportError(new ReferenceError(`Unknown variable: $${e}`)),new rt(`$${e}`);if(t instanceof xa)return t;switch(typeof t){case"string":return t;case"number":return new dr(t);case"object":if(t instanceof Date)return new uo(t.getTime());default:return n.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new rt(`$${e}`)}}function B4(n,{name:e,attr:t}){let r=n.bundle._messages.get(e);if(!r)return n.reportError(new ReferenceError(`Unknown message: ${e}`)),new rt(e);if(t){let i=r.attributes[t];return i?Pa(n,i):(n.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new rt(`${e}.${t}`))}return r.value?Pa(n,r.value):(n.reportError(new ReferenceError(`No value: ${e}`)),new rt(e))}function U4(n,{name:e,attr:t,args:r}){let i=`-${e}`,s=n.bundle._terms.get(i);if(!s)return n.reportError(new ReferenceError(`Unknown term: ${i}`)),new rt(i);if(t){let a=s.attributes[t];if(a){n.params=Db(n,r).named;let c=Pa(n,a);return n.params=null,c}return n.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new rt(`${i}.${t}`)}n.params=Db(n,r).named;let o=Pa(n,s.value);return n.params=null,o}function H4(n,{name:e,args:t}){let r=n.bundle._functions[e];if(!r)return n.reportError(new ReferenceError(`Unknown function: ${e}()`)),new rt(`${e}()`);if(typeof r!="function")return n.reportError(new TypeError(`Function ${e}() is not callable`)),new rt(`${e}()`);try{let i=Db(n,t);return r(i.positional,i.named)}catch(i){return n.reportError(i),new rt(`${e}()`)}}function $4(n,{selector:e,variants:t,star:r}){let i=lu(n,e);if(i instanceof rt)return MR(n,t,r);for(let s of t){let o=lu(n,s.key);if(V4(n,i,o))return Pa(n,s.value)}return MR(n,t,r)}function QR(n,e){if(n.dirty.has(e))return n.reportError(new RangeError("Cyclic reference")),new rt;n.dirty.add(e);let t=[],r=n.bundle._useIsolating&&e.length>1;for(let i of e){if(typeof i=="string"){t.push(n.bundle._transform(i));continue}if(n.placeables++,n.placeables>PR)throw n.dirty.delete(e),new RangeError(`Too many placeables expanded: ${n.placeables}, max allowed is ${PR}`);r&&t.push(L4),t.push(lu(n,i).toString(n)),r&&t.push(F4)}return n.dirty.delete(e),t.join("")}function Pa(n,e){return typeof e=="string"?n.bundle._transform(e):QR(n,e)}var xb=class{constructor(e,t,r){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=r}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,t){let r=this.bundle._intls.get(e);r||(r={},this.bundle._intls.set(e,r));let i=JSON.stringify(t);return r[i]||(r[i]=new e(this.bundle.locales,t)),r[i]}};function Rp(n,e){let t=Object.create(null);for(let[r,i]of Object.entries(n))e.includes(r)&&(t[r]=i.valueOf());return t}var RR=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function z4(n,e){let t=n[0];if(t instanceof rt)return new rt(`NUMBER(${t.valueOf()})`);if(t instanceof dr)return new dr(t.valueOf(),L(L({},t.opts),Rp(e,RR)));if(t instanceof uo)return new dr(t.valueOf(),L({},Rp(e,RR)));throw new TypeError("Invalid argument to NUMBER")}var NR=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function G4(n,e){let t=n[0];if(t instanceof rt)return new rt(`DATETIME(${t.valueOf()})`);if(t instanceof uo)return new uo(t.valueOf(),L(L({},t.opts),Rp(e,NR)));if(t instanceof dr)return new uo(t.valueOf(),L({},Rp(e,NR)));throw new TypeError("Invalid argument to DATETIME")}var OR=new Map;function W4(n){let e=Array.isArray(n)?n.join(" "):n,t=OR.get(e);return t===void 0&&(t=new Map,OR.set(e,t)),t}var Pb=class{constructor(e,{functions:t,useIsolating:r=!0,transform:i=s=>s}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions=L({NUMBER:z4,DATETIME:G4},t),this._useIsolating=r,this._transform=i,this._intls=W4(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let r=[];for(let i=0;i<e.body.length;i++){let s=e.body[i];if(s.id.startsWith("-")){if(t===!1&&this._terms.has(s.id)){r.push(new Error(`Attempt to override an existing term: "${s.id}"`));continue}this._terms.set(s.id,s)}else{if(t===!1&&this._messages.has(s.id)){r.push(new Error(`Attempt to override an existing message: "${s.id}"`));continue}this._messages.set(s.id,s)}}return r}formatPattern(e,t=null,r=null){if(typeof e=="string")return this._transform(e);let i=new xb(this,r,t);try{return QR(i,e).toString(i)}catch(s){if(i.errors&&s instanceof Error)return i.errors.push(s),new rt().toString(i);throw s}}},wb=/^(-?[a-zA-Z][\w-]*) *= */gm,kR=/\.([a-zA-Z][\w-]*) *= */y,q4=/\*?\[/y,Eb=/(-?[0-9]+(?:\.([0-9]+))?)/y,K4=/([a-zA-Z][\w-]*)/y,LR=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,Y4=/^[A-Z][A-Z0-9_-]*$/,Tp=/([^{}\n\r]+)/y,Q4=/([^\\"\n\r]*)/y,FR=/\\([\\"])/y,VR=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,X4=/^\n+/,jR=/ +$/,J4=/ *\r?\n/g,Z4=/( *)$/,e3=/{\s*/y,BR=/\s*}/y,t3=/\[\s*/y,n3=/\s*] */y,r3=/\s*\(\s*/y,i3=/\s*->\s*/y,s3=/\s*:\s*/y,o3=/\s*,?\s*/y,a3=/\s+/y,Mb=class{constructor(e){this.body=[],wb.lastIndex=0;let t=0;for(;;){let _=wb.exec(e);if(_===null)break;t=wb.lastIndex;try{this.body.push(c(_[1]))}catch(A){if(A instanceof SyntaxError)continue;throw A}}function r(_){return _.lastIndex=t,_.test(e)}function i(_,A){if(e[t]===_)return t++,!0;if(A)throw new A(`Expected ${_}`);return!1}function s(_,A){if(r(_))return t=_.lastIndex,!0;if(A)throw new A(`Expected ${_.toString()}`);return!1}function o(_){_.lastIndex=t;let A=_.exec(e);if(A===null)throw new SyntaxError(`Expected ${_.toString()}`);return t=_.lastIndex,A}function a(_){return o(_)[1]}function c(_){let A=u(),C=l();if(A===null&&Object.keys(C).length===0)throw new SyntaxError("Expected message value or attributes");return{id:_,value:A,attributes:C}}function l(){let _=Object.create(null);for(;r(kR);){let A=a(kR),C=u();if(C===null)throw new SyntaxError("Expected attribute value");_[A]=C}return _}function u(){let _;if(r(Tp)&&(_=a(Tp)),e[t]==="{"||e[t]==="}")return h(_?[_]:[],1/0);let A=k();return A?_?h([_,A],A.length):(A.value=T(A.value,X4),h([A],A.length)):_?T(_,jR):null}function h(_=[],A){for(;;){if(r(Tp)){_.push(a(Tp));continue}if(e[t]==="{"){_.push(f());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let Z=k();if(Z){_.push(Z),A=Math.min(A,Z.length);continue}break}let C=_.length-1,M=_[C];typeof M=="string"&&(_[C]=T(M,jR));let S=[];for(let Z of _)Z instanceof Np&&(Z=Z.value.slice(0,Z.value.length-A)),Z&&S.push(Z);return S}function f(){s(e3,SyntaxError);let _=p();if(s(BR))return _;if(s(i3)){let A=w();return s(BR,SyntaxError),L({type:"select",selector:_},A)}throw new SyntaxError("Unclosed placeable")}function p(){if(e[t]==="{")return f();if(r(LR)){let[,_,A,C=null]=o(LR);if(_==="$")return{type:"var",name:A};if(s(r3)){let M=m();if(_==="-")return{type:"term",name:A,attr:C,args:M};if(Y4.test(A))return{type:"func",name:A,args:M};throw new SyntaxError("Function names must be all upper-case")}return _==="-"?{type:"term",name:A,attr:C,args:[]}:{type:"mesg",name:A,attr:C}}return D()}function m(){let _=[];for(;;){switch(e[t]){case")":return t++,_;case void 0:throw new SyntaxError("Unclosed argument list")}_.push(v()),s(o3)}}function v(){let _=p();return _.type!=="mesg"?_:s(s3)?{type:"narg",name:_.name,value:D()}:_}function w(){let _=[],A=0,C;for(;r(q4);){i("*")&&(C=A);let M=I(),S=u();if(S===null)throw new SyntaxError("Expected variant value");_[A++]={key:M,value:S}}if(A===0)return null;if(C===void 0)throw new SyntaxError("Expected default variant");return{variants:_,star:C}}function I(){s(t3,SyntaxError);let _;return r(Eb)?_=P():_={type:"str",value:a(K4)},s(n3,SyntaxError),_}function D(){if(r(Eb))return P();if(e[t]==='"')return x();throw new SyntaxError("Invalid expression")}function P(){let[,_,A=""]=o(Eb),C=A.length;return{type:"num",value:parseFloat(_),precision:C}}function x(){i('"',SyntaxError);let _="";for(;;){if(_+=a(Q4),e[t]==="\\"){_+=N();continue}if(i('"'))return{type:"str",value:_};throw new SyntaxError("Unclosed string literal")}}function N(){if(r(FR))return a(FR);if(r(VR)){let[,_,A]=o(VR),C=parseInt(_||A,16);return C<=55295||57344<=C?String.fromCodePoint(C):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function k(){let _=t;switch(s(a3),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return E(e.slice(_,t))}return e[t-1]===" "?E(e.slice(_,t)):!1}function T(_,A){return _.replace(A,"")}function E(_){let A=_.replace(J4,`
`),C=Z4.exec(_)[1].length;return new Np(A,C)}}},Np=class{constructor(e,t){this.value=e,this.length=t}},c3=/<|&#?\w+;/,l3={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},u3={"http://www.w3.org/1999/xhtml":{global:["title","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function d3(n,e){let{value:t}=e;if(typeof t=="string")if(n.localName==="title"&&n.namespaceURI==="http://www.w3.org/1999/xhtml")n.textContent=t;else if(!c3.test(t))n.textContent=t;else{let r=n.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");r.innerHTML=t,h3(r.content,n)}XR(e,n)}function h3(n,e){for(let t of n.childNodes)if(t.nodeType!==t.TEXT_NODE){if(t.hasAttribute("data-l10n-name")){let r=p3(e,t);n.replaceChild(r,t);continue}if(m3(t)){let r=g3(t);n.replaceChild(r,t);continue}console.warn(`An element of forbidden type "${t.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),n.replaceChild(Rb(t),t)}e.textContent="",e.appendChild(n)}function f3(n,e){if(!n)return!1;for(let t of n)if(t.name===e)return!0;return!1}function XR(n,e){let t=e.hasAttribute("data-l10n-attrs")?e.getAttribute("data-l10n-attrs").split(",").map(r=>r.trim()):null;for(let r of Array.from(e.attributes))UR(r.name,e,t)&&!f3(n.attributes,r.name)&&e.removeAttribute(r.name);if(n.attributes)for(let r of Array.from(n.attributes))UR(r.name,e,t)&&e.getAttribute(r.name)!==r.value&&e.setAttribute(r.name,r.value)}function p3(n,e){let t=e.getAttribute("data-l10n-name"),r=n.querySelector(`[data-l10n-name="${t}"]`);if(!r)return console.warn(`An element named "${t}" wasn't found in the source.`),Rb(e);if(r.localName!==e.localName)return console.warn(`An element named "${t}" was found in the translation but its type ${e.localName} didn't match the element found in the source (${r.localName}).`),Rb(e);n.removeChild(r);let i=r.cloneNode(!1);return JR(e,i)}function g3(n){let e=n.ownerDocument.createElement(n.localName);return JR(n,e)}function Rb(n){return n.ownerDocument.createTextNode(n.textContent)}function m3(n){let e=l3[n.namespaceURI];return e&&e.includes(n.localName)}function UR(n,e,t=null){if(t&&t.includes(n))return!0;let r=u3[e.namespaceURI];if(!r)return!1;let i=n.toLowerCase(),s=e.localName;if(r.global.includes(i))return!0;if(!r[s])return!1;if(r[s].includes(i))return!0;if(e.namespaceURI==="http://www.w3.org/1999/xhtml"&&s==="input"&&i==="value"){let o=e.type.toLowerCase();if(o==="submit"||o==="button"||o==="reset")return!0}return!1}function JR(n,e){return e.textContent=n.textContent,XR(n,e),e}var Nb=class extends Array{static from(e){return e instanceof this?e:new this(e)}};var Ob=class extends Nb{constructor(e){if(super(),Symbol.asyncIterator in Object(e))this.iterator=e[Symbol.asyncIterator]();else if(Symbol.iterator in Object(e))this.iterator=e[Symbol.iterator]();else throw new TypeError("Argument must implement the iteration protocol.")}[Symbol.asyncIterator](){let e=this,t=0;return{async next(){return e.length<=t&&e.push(e.iterator.next()),e[t++]}}}async touchNext(e=1){let t=0;for(;t++<e;){let r=this[this.length-1];if(r&&(await r).done)break;this.push(this.iterator.next())}return this[this.length-1]}},kb=class{constructor(e=[],t){this.resourceIds=e,this.generateBundles=t,this.onChange(!0)}addResourceIds(e,t=!1){return this.resourceIds.push(...e),this.onChange(t),this.resourceIds.length}removeResourceIds(e){return this.resourceIds=this.resourceIds.filter(t=>!e.includes(t)),this.onChange(),this.resourceIds.length}async formatWithFallback(e,t){let r=[],i=!1;for await(let s of this.bundles){i=!0;let o=_3(t,s,e,r);if(o.size===0)break;if(typeof console<"u"){let a=s.locales[0],c=Array.from(o).join(", ");console.warn(`[fluent] Missing translations in ${a}: ${c}`)}}return!i&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.
  keys: ${JSON.stringify(e)}.
  resourceIds: ${JSON.stringify(this.resourceIds)}.`),r}formatMessages(e){return this.formatWithFallback(e,v3)}formatValues(e){return this.formatWithFallback(e,y3)}async formatValue(e,t){let[r]=await this.formatValues([{id:e,args:t}]);return r}handleEvent(){this.onChange()}onChange(e=!1){this.bundles=Ob.from(this.generateBundles(this.resourceIds)),e&&this.bundles.touchNext(2)}};function y3(n,e,t,r){return t.value?n.formatPattern(t.value,r,e):null}function v3(n,e,t,r){let i={value:null,attributes:null};t.value&&(i.value=n.formatPattern(t.value,r,e));let s=Object.keys(t.attributes);if(s.length>0){i.attributes=new Array(s.length);for(let[o,a]of s.entries()){let c=n.formatPattern(t.attributes[a],r,e);i.attributes[o]={name:a,value:c}}}return i}function _3(n,e,t,r){let i=[],s=new Set;return t.forEach(({id:o,args:a},c)=>{if(r[c]!==void 0)return;let l=e.getMessage(o);if(l){if(i.length=0,r[c]=n(e,i,l,a),i.length>0&&typeof console<"u"){let u=e.locales[0],h=i.join(", ");console.warn(`[fluent][resolver] errors in ${u}/${o}: ${h}.`)}}else s.add(o)}),s}var lo="data-l10n-id",iu="data-l10n-args",w3=`[${lo}]`,Lb=class extends kb{constructor(e,t){super(e,t),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[lo,iu]}}onChange(e=!1){super.onChange(e),this.roots&&this.translateRoots()}setAttributes(e,t,r){return e.setAttribute(lo,t),r?e.setAttribute(iu,JSON.stringify(r)):e.removeAttribute(iu),e}getAttributes(e){return{id:e.getAttribute(lo),args:JSON.parse(e.getAttribute(iu)||null)}}connectRoot(e){for(let t of this.roots)if(t===e||t.contains(e)||e.contains(t))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==e.ownerDocument.defaultView)throw new Error(`Cannot connect a root:
          DOMLocalization already has a root from a different window.`)}else this.windowElement=e.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(t=>this.translateMutations(t));this.roots.add(e),this.mutationObserver.observe(e,this.observerConfig)}disconnectRoot(e){return this.roots.delete(e),this.pauseObserving(),this.roots.size===0?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){let e=Array.from(this.roots);return Promise.all(e.map(t=>this.translateFragment(t)))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(let e of this.roots)this.mutationObserver.observe(e,this.observerConfig)}translateMutations(e){for(let t of e)switch(t.type){case"attributes":t.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(t.target);break;case"childList":for(let r of t.addedNodes)if(r.nodeType===r.ELEMENT_NODE)if(r.childElementCount)for(let i of this.getTranslatables(r))this.pendingElements.add(i);else r.hasAttribute(lo)&&this.pendingElements.add(r);break}this.pendingElements.size>0&&this.pendingrAF===null&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(e){return this.translateElements(this.getTranslatables(e))}async translateElements(e){if(!e.length)return;let t=e.map(this.getKeysForElement),r=await this.formatMessages(t);return this.applyTranslations(e,r)}applyTranslations(e,t){this.pauseObserving();for(let r=0;r<e.length;r++)t[r]!==void 0&&d3(e[r],t[r]);this.resumeObserving()}getTranslatables(e){let t=Array.from(e.querySelectorAll(w3));return typeof e.hasAttribute=="function"&&e.hasAttribute(lo)&&t.push(e),t}getKeysForElement(e){return{id:e.getAttribute(lo),args:JSON.parse(e.getAttribute(iu)||null)}}},Fb=class n{#e;#t;#n;#r;constructor({lang:e,isRTL:t},r=null){this.#n=n.#i(e),this.#r=r,this.#e=t??n.#s(this.#n)?"rtl":"ltr"}_setL10n(e){this.#r=e}getLanguage(){return this.#n}getDirection(){return this.#e}async get(e,t=null,r){return Array.isArray(e)?(e=e.map(o=>({id:o})),(await this.#r.formatMessages(e)).map(o=>o.value)):(await this.#r.formatMessages([{id:e,args:t}]))[0]?.value||r}async translate(e){(this.#t||=new Set).add(e);try{this.#r.connectRoot(e),await this.#r.translateRoots()}catch{}}async translateOnce(e){try{await this.#r.translateElements([e])}catch(t){console.error(`translateOnce: "${t}".`)}}async destroy(){if(this.#t){for(let e of this.#t)this.#r.disconnectRoot(e);this.#t.clear(),this.#t=null}this.#r.pauseObserving()}pause(){this.#r.pauseObserving()}resume(){this.#r.resumeObserving()}static#i(e){return e=e?.toLowerCase()||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[e]||e}static#s(e){let t=e.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(t)}};function HR(n,e){let t=new Mb(e),r=new Pb(n),i=r.addResource(t);return i.length&&console.error("L10n errors",i),r}var Ma=class n extends Fb{constructor(e){super({lang:e});let t=e?n.#e.bind(n,"en-us",this.getLanguage()):n.#r.bind(n,this.getLanguage());this._setL10n(new Lb([],t))}static async*#e(e,t){let{baseURL:r,paths:i}=await this.#n(),s=[t];if(e!==t){let o=t.split("-",1)[0];o!==t&&s.push(o),s.push(e)}for(let o of s){let a=await this.#t(o,r,i);a?yield a:o==="en-us"&&(yield this.#i(o))}}static async#t(e,t,r){let i=r[e];if(!i)return null;let s=new URL(i,t),o=await CR(s,"text");return HR(e,o)}static async#n(){try{let{href:e}=document.querySelector('link[type="application/l10n"]'),t=await CR(e,"json");return{baseURL:e.replace(/[^/]*$/,"")||"./",paths:t}}catch{}return{baseURL:"./",paths:Object.create(null)}}static async*#r(e){yield this.#i(e)}static async#i(e){return HR(e,`pdfjs-previous-button =
    .title = Previous Page
pdfjs-previous-button-label = Previous
pdfjs-next-button =
    .title = Next Page
pdfjs-next-button-label = Next
pdfjs-page-input =
    .title = Page
pdfjs-of-pages = of { $pagesCount }
pdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })
pdfjs-zoom-out-button =
    .title = Zoom Out
pdfjs-zoom-out-button-label = Zoom Out
pdfjs-zoom-in-button =
    .title = Zoom In
pdfjs-zoom-in-button-label = Zoom In
pdfjs-zoom-select =
    .title = Zoom
pdfjs-presentation-mode-button =
    .title = Switch to Presentation Mode
pdfjs-presentation-mode-button-label = Presentation Mode
pdfjs-open-file-button =
    .title = Open File
pdfjs-open-file-button-label = Open
pdfjs-print-button =
    .title = Print
pdfjs-print-button-label = Print
pdfjs-save-button =
    .title = Save
pdfjs-save-button-label = Save
pdfjs-download-button =
    .title = Download
pdfjs-download-button-label = Download
pdfjs-bookmark-button =
    .title = Current Page (View URL from Current Page)
pdfjs-bookmark-button-label = Current Page
pdfjs-tools-button =
    .title = Tools
pdfjs-tools-button-label = Tools
pdfjs-first-page-button =
    .title = Go to First Page
pdfjs-first-page-button-label = Go to First Page
pdfjs-last-page-button =
    .title = Go to Last Page
pdfjs-last-page-button-label = Go to Last Page
pdfjs-page-rotate-cw-button =
    .title = Rotate Clockwise
pdfjs-page-rotate-cw-button-label = Rotate Clockwise
pdfjs-page-rotate-ccw-button =
    .title = Rotate Counterclockwise
pdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise
pdfjs-cursor-text-select-tool-button =
    .title = Enable Text Selection Tool
pdfjs-cursor-text-select-tool-button-label = Text Selection Tool
pdfjs-cursor-hand-tool-button =
    .title = Enable Hand Tool
pdfjs-cursor-hand-tool-button-label = Hand Tool
pdfjs-scroll-page-button =
    .title = Use Page Scrolling
pdfjs-scroll-page-button-label = Page Scrolling
pdfjs-scroll-vertical-button =
    .title = Use Vertical Scrolling
pdfjs-scroll-vertical-button-label = Vertical Scrolling
pdfjs-scroll-horizontal-button =
    .title = Use Horizontal Scrolling
pdfjs-scroll-horizontal-button-label = Horizontal Scrolling
pdfjs-scroll-wrapped-button =
    .title = Use Wrapped Scrolling
pdfjs-scroll-wrapped-button-label = Wrapped Scrolling
pdfjs-spread-none-button =
    .title = Do not join page spreads
pdfjs-spread-none-button-label = No Spreads
pdfjs-spread-odd-button =
    .title = Join page spreads starting with odd-numbered pages
pdfjs-spread-odd-button-label = Odd Spreads
pdfjs-spread-even-button =
    .title = Join page spreads starting with even-numbered pages
pdfjs-spread-even-button-label = Even Spreads
pdfjs-document-properties-button =
    .title = Document Properties\u2026
pdfjs-document-properties-button-label = Document Properties\u2026
pdfjs-document-properties-file-name = File name:
pdfjs-document-properties-file-size = File size:
pdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)
pdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)
pdfjs-document-properties-title = Title:
pdfjs-document-properties-author = Author:
pdfjs-document-properties-subject = Subject:
pdfjs-document-properties-keywords = Keywords:
pdfjs-document-properties-creation-date = Creation Date:
pdfjs-document-properties-modification-date = Modification Date:
pdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-document-properties-creator = Creator:
pdfjs-document-properties-producer = PDF Producer:
pdfjs-document-properties-version = PDF Version:
pdfjs-document-properties-page-count = Page Count:
pdfjs-document-properties-page-size = Page Size:
pdfjs-document-properties-page-size-unit-inches = in
pdfjs-document-properties-page-size-unit-millimeters = mm
pdfjs-document-properties-page-size-orientation-portrait = portrait
pdfjs-document-properties-page-size-orientation-landscape = landscape
pdfjs-document-properties-page-size-name-a-three = A3
pdfjs-document-properties-page-size-name-a-four = A4
pdfjs-document-properties-page-size-name-letter = Letter
pdfjs-document-properties-page-size-name-legal = Legal
pdfjs-document-properties-page-size-dimension-string = { $width } \xD7 { $height } { $unit } ({ $orientation })
pdfjs-document-properties-page-size-dimension-name-string = { $width } \xD7 { $height } { $unit } ({ $name }, { $orientation })
pdfjs-document-properties-linearized = Fast Web View:
pdfjs-document-properties-linearized-yes = Yes
pdfjs-document-properties-linearized-no = No
pdfjs-document-properties-close-button = Close
pdfjs-print-progress-message = Preparing document for printing\u2026
pdfjs-print-progress-percent = { $progress }%
pdfjs-print-progress-close-button = Cancel
pdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.
pdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.
pdfjs-toggle-sidebar-button =
    .title = Toggle Sidebar
pdfjs-toggle-sidebar-notification-button =
    .title = Toggle Sidebar (document contains outline/attachments/layers)
pdfjs-toggle-sidebar-button-label = Toggle Sidebar
pdfjs-document-outline-button =
    .title = Show Document Outline (double-click to expand/collapse all items)
pdfjs-document-outline-button-label = Document Outline
pdfjs-attachments-button =
    .title = Show Attachments
pdfjs-attachments-button-label = Attachments
pdfjs-layers-button =
    .title = Show Layers (double-click to reset all layers to the default state)
pdfjs-layers-button-label = Layers
pdfjs-thumbs-button =
    .title = Show Thumbnails
pdfjs-thumbs-button-label = Thumbnails
pdfjs-current-outline-item-button =
    .title = Find Current Outline Item
pdfjs-current-outline-item-button-label = Current Outline Item
pdfjs-findbar-button =
    .title = Find in Document
pdfjs-findbar-button-label = Find
pdfjs-additional-layers = Additional Layers
pdfjs-thumb-page-title =
    .title = Page { $page }
pdfjs-thumb-page-canvas =
    .aria-label = Thumbnail of Page { $page }
pdfjs-find-input =
    .title = Find
    .placeholder = Find in document\u2026
pdfjs-find-previous-button =
    .title = Find the previous occurrence of the phrase
pdfjs-find-previous-button-label = Previous
pdfjs-find-next-button =
    .title = Find the next occurrence of the phrase
pdfjs-find-next-button-label = Next
pdfjs-find-highlight-checkbox = Highlight All
pdfjs-find-match-case-checkbox-label = Match Case
pdfjs-find-match-diacritics-checkbox-label = Match Diacritics
pdfjs-find-entire-word-checkbox-label = Whole Words
pdfjs-find-reached-top = Reached top of document, continued from bottom
pdfjs-find-reached-bottom = Reached end of document, continued from top
pdfjs-find-match-count =
    { $total ->
        [one] { $current } of { $total } match
       *[other] { $current } of { $total } matches
    }
pdfjs-find-match-count-limit =
    { $limit ->
        [one] More than { $limit } match
       *[other] More than { $limit } matches
    }
pdfjs-find-not-found = Phrase not found
pdfjs-page-scale-width = Page Width
pdfjs-page-scale-fit = Page Fit
pdfjs-page-scale-auto = Automatic Zoom
pdfjs-page-scale-actual = Actual Size
pdfjs-page-scale-percent = { $scale }%
pdfjs-page-landmark =
    .aria-label = Page { $page }
pdfjs-loading-error = An error occurred while loading the PDF.
pdfjs-invalid-file-error = Invalid or corrupted PDF file.
pdfjs-missing-file-error = Missing PDF file.
pdfjs-unexpected-response-error = Unexpected server response.
pdfjs-rendering-error = An error occurred while rendering the page.
pdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-text-annotation-type =
    .alt = [{ $type } Annotation]
pdfjs-password-label = Enter the password to open this PDF file.
pdfjs-password-invalid = Invalid password. Please try again.
pdfjs-password-ok-button = OK
pdfjs-password-cancel-button = Cancel
pdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.
pdfjs-editor-free-text-button =
    .title = Text
pdfjs-editor-free-text-button-label = Text
pdfjs-editor-ink-button =
    .title = Draw
pdfjs-editor-ink-button-label = Draw
pdfjs-editor-stamp-button =
    .title = Add or edit images
pdfjs-editor-stamp-button-label = Add or edit images
pdfjs-editor-highlight-button =
    .title = Highlight
pdfjs-editor-highlight-button-label = Highlight
pdfjs-highlight-floating-button1 =
    .title = Highlight
    .aria-label = Highlight
pdfjs-highlight-floating-button-label = Highlight
pdfjs-editor-remove-ink-button =
    .title = Remove drawing
pdfjs-editor-remove-freetext-button =
    .title = Remove text
pdfjs-editor-remove-stamp-button =
    .title = Remove image
pdfjs-editor-remove-highlight-button =
    .title = Remove highlight
pdfjs-editor-free-text-color-input = Color
pdfjs-editor-free-text-size-input = Size
pdfjs-editor-ink-color-input = Color
pdfjs-editor-ink-thickness-input = Thickness
pdfjs-editor-ink-opacity-input = Opacity
pdfjs-editor-stamp-add-image-button =
    .title = Add image
pdfjs-editor-stamp-add-image-button-label = Add image
pdfjs-editor-free-highlight-thickness-input = Thickness
pdfjs-editor-free-highlight-thickness-title =
    .title = Change thickness when highlighting items other than text
pdfjs-free-text2 =
    .aria-label = Text Editor
    .default-content = Start typing\u2026
pdfjs-ink =
    .aria-label = Draw Editor
pdfjs-ink-canvas =
    .aria-label = User-created image
pdfjs-editor-alt-text-button =
    .aria-label = Alt text
pdfjs-editor-alt-text-button-label = Alt text
pdfjs-editor-alt-text-edit-button =
    .aria-label = Edit alt text
pdfjs-editor-alt-text-dialog-label = Choose an option
pdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can\u2019t see the image or when it doesn\u2019t load.
pdfjs-editor-alt-text-add-description-label = Add a description
pdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.
pdfjs-editor-alt-text-mark-decorative-label = Mark as decorative
pdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.
pdfjs-editor-alt-text-cancel-button = Cancel
pdfjs-editor-alt-text-save-button = Save
pdfjs-editor-alt-text-decorative-tooltip = Marked as decorative
pdfjs-editor-alt-text-textarea =
    .placeholder = For example, \u201CA young man sits down at a table to eat a meal\u201D
pdfjs-editor-resizer-top-left =
    .aria-label = Top left corner \u2014 resize
pdfjs-editor-resizer-top-middle =
    .aria-label = Top middle \u2014 resize
pdfjs-editor-resizer-top-right =
    .aria-label = Top right corner \u2014 resize
pdfjs-editor-resizer-middle-right =
    .aria-label = Middle right \u2014 resize
pdfjs-editor-resizer-bottom-right =
    .aria-label = Bottom right corner \u2014 resize
pdfjs-editor-resizer-bottom-middle =
    .aria-label = Bottom middle \u2014 resize
pdfjs-editor-resizer-bottom-left =
    .aria-label = Bottom left corner \u2014 resize
pdfjs-editor-resizer-middle-left =
    .aria-label = Middle left \u2014 resize
pdfjs-editor-highlight-colorpicker-label = Highlight color
pdfjs-editor-colorpicker-button =
    .title = Change color
pdfjs-editor-colorpicker-dropdown =
    .aria-label = Color choices
pdfjs-editor-colorpicker-yellow =
    .title = Yellow
pdfjs-editor-colorpicker-green =
    .title = Green
pdfjs-editor-colorpicker-blue =
    .title = Blue
pdfjs-editor-colorpicker-pink =
    .title = Pink
pdfjs-editor-colorpicker-red =
    .title = Red
pdfjs-editor-highlight-show-all-button-label = Show all
pdfjs-editor-highlight-show-all-button =
    .title = Show all
pdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)
pdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)
pdfjs-editor-new-alt-text-textarea =
    .placeholder = Write your description here\u2026
pdfjs-editor-new-alt-text-description = Short description for people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.
pdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more
pdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically
pdfjs-editor-new-alt-text-not-now-button = Not now
pdfjs-editor-new-alt-text-error-title = Couldn\u2019t create alt text automatically
pdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.
pdfjs-editor-new-alt-text-error-close-button = Close
pdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
pdfjs-editor-new-alt-text-added-button =
    .aria-label = Alt text added
pdfjs-editor-new-alt-text-added-button-label = Alt text added
pdfjs-editor-new-alt-text-missing-button =
    .aria-label = Missing alt text
pdfjs-editor-new-alt-text-missing-button-label = Missing alt text
pdfjs-editor-new-alt-text-to-review-button =
    .aria-label = Review alt text
pdfjs-editor-new-alt-text-to-review-button-label = Review alt text
pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }
pdfjs-image-alt-text-settings-button =
    .title = Image alt text settings
pdfjs-image-alt-text-settings-button-label = Image alt text settings
pdfjs-editor-alt-text-settings-dialog-label = Image alt text settings
pdfjs-editor-alt-text-settings-automatic-title = Automatic alt text
pdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically
pdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)
pdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.
pdfjs-editor-alt-text-settings-delete-model-button = Delete
pdfjs-editor-alt-text-settings-download-model-button = Download
pdfjs-editor-alt-text-settings-downloading-model-button = Downloading\u2026
pdfjs-editor-alt-text-settings-editor-title = Alt text editor
pdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image
pdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.
pdfjs-editor-alt-text-settings-close-button = Close`)}},E3=1e3,bb=50,$R=1e3;function Ib(){return document.location.hash}var Vb=class{#e=null;constructor({linkService:e,eventBus:t}){this.linkService=e,this.eventBus=t,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",r=>{this._isPagesLoaded=!!r.pagesCount},{once:!0})})}initialize({fingerprint:e,resetHistory:t=!1,updateUrl:r=!1}){if(!e||typeof e!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();let i=this._fingerprint!==""&&this._fingerprint!==e;this._fingerprint=e,this._updateUrl=r===!0,this._initialized=!0,this.#d();let s=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=Ib(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#i(s,!0)||t){let{hash:a,page:c,rotation:l}=this.#c(!0);if(!a||i||t){this.#t(null,!0);return}this.#t({hash:a,page:c,rotation:l},!0);return}let o=s.destination;this.#s(o,s.uid,!0),o.rotation!==void 0&&(this._initialRotation=o.rotation),o.dest?(this._initialBookmark=JSON.stringify(o.dest),this._destination.page=null):o.hash?this._initialBookmark=o.hash:o.page&&(this._initialBookmark=`page=${o.page}`)}reset(){this._initialized&&(this.#a(),this._initialized=!1,this.#o()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:e=null,explicitDest:t,pageNumber:r}){if(!this._initialized)return;if(e&&typeof e!="string"){console.error(`PDFHistory.push: "${e}" is not a valid namedDest parameter.`);return}else if(Array.isArray(t)){if(!this.#r(r)&&(r!==null||this._destination)){console.error(`PDFHistory.push: "${r}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${t}" is not a valid explicitDest parameter.`);return}let i=e||JSON.stringify(t);if(!i)return;let s=!1;if(this._destination&&(b3(this._destination.hash,i)||I3(this._destination.dest,t))){if(this._destination.page)return;s=!0}this._popStateInProgress&&!s||(this.#t({dest:t,hash:i,page:r,rotation:this.linkService.rotation},s),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(e){if(this._initialized){if(!this.#r(e)){console.error(`PDFHistory.pushPage: "${e}" is not a valid page number.`);return}this._destination?.page!==e&&(this._popStateInProgress||(this.#t({dest:null,hash:`page=${e}`,page:e,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this.#n()}back(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#i(e)&&e.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#i(e)&&e.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#t(e,t=!1){let r=t||!this._destination,i={fingerprint:this._fingerprint,uid:r?this._uid:this._uid+1,destination:e};this.#s(e,i.uid);let s;if(this._updateUrl&&e?.hash){let o=document.location.href.split("#",1)[0];o.startsWith("file://")||(s=`${o}#${e.hash}`)}r?window.history.replaceState(i,"",s):window.history.pushState(i,"",s)}#n(e=!1){if(!this._position)return;let t=this._position;if(e&&(t=Object.assign(Object.create(null),this._position),t.temporary=!0),!this._destination){this.#t(t);return}if(this._destination.temporary){this.#t(t,!0);return}if(this._destination.hash===t.hash||!this._destination.page&&(bb<=0||this._numPositionUpdates<=bb))return;let r=!1;if(this._destination.page>=t.first&&this._destination.page<=t.page){if(this._destination.dest!==void 0||!this._destination.first)return;r=!0}this.#t(t,r)}#r(e){return Number.isInteger(e)&&e>0&&e<=this.linkService.pagesCount}#i(e,t=!1){if(!e)return!1;if(e.fingerprint!==this._fingerprint)if(t){if(typeof e.fingerprint!="string"||e.fingerprint.length!==this._fingerprint.length)return!1;let[r]=performance.getEntriesByType("navigation");if(r?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(e.uid)||e.uid<0||e.destination===null||typeof e.destination!="object")}#s(e,t,r=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),r&&e?.temporary&&delete e.temporary,this._destination=e,this._uid=t,this._maxUid=Math.max(this._maxUid,t),this._numPositionUpdates=0}#c(e=!1){let t=unescape(Ib()).substring(1),r=jp(t),i=r.get("nameddest")||"",s=r.get("page")|0;return(!this.#r(s)||e&&i.length>0)&&(s=null),{hash:t,page:s,rotation:this.linkService.rotation}}#l({location:e}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:e.pdfOpenParams.substring(1),page:this.linkService.page,first:e.pageNumber,rotation:e.rotation},!this._popStateInProgress&&(bb>0&&this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,$R>0&&(this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this.#n(!0),this._updateViewareaTimeout=null},$R)))}#u({state:e}){let t=Ib(),r=this._currentHash!==t;if(this._currentHash=t,!e){this._uid++;let{hash:s,page:o,rotation:a}=this.#c();this.#t({hash:s,page:o,rotation:a},!0);return}if(!this.#i(e))return;this._popStateInProgress=!0,r&&(this._blockHashChange++,k4({target:window,name:"hashchange",delay:E3}).then(()=>{this._blockHashChange--}));let i=e.destination;this.#s(i,e.uid,!0),YR(i.rotation)&&(this.linkService.rotation=i.rotation),i.dest?this.linkService.goToDestination(i.dest):i.hash?this.linkService.setHash(i.hash):i.page&&(this.linkService.page=i.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}#a(){(!this._destination||this._destination.temporary)&&this.#n()}#d(){if(this.#e)return;this.#e=new AbortController;let{signal:e}=this.#e;this.eventBus._on("updateviewarea",this.#l.bind(this),{signal:e}),window.addEventListener("popstate",this.#u.bind(this),{signal:e}),window.addEventListener("pagehide",this.#a.bind(this),{signal:e})}#o(){this.#e?.abort(),this.#e=null}};function b3(n,e){return typeof n!="string"||typeof e!="string"?!1:n===e||jp(n).get("nameddest")===e}function I3(n,e){function t(r,i){if(typeof r!=typeof i||Array.isArray(r)||Array.isArray(i))return!1;if(r!==null&&typeof r=="object"&&i!==null){if(Object.keys(r).length!==Object.keys(i).length)return!1;for(let s in r)if(!t(r[s],i[s]))return!1;return!0}return r===i||Number.isNaN(r)&&Number.isNaN(i)}if(!(Array.isArray(n)&&Array.isArray(e))||n.length!==e.length)return!1;for(let r=0,i=n.length;r<i;r++)if(!t(n[r],e[r]))return!1;return!0}var jb=class{#e=null;#t=null;#n=null;#r=null;#i=null;#s;constructor(e){this.pdfPage=e.pdfPage,this.accessibilityManager=e.accessibilityManager,this.l10n=e.l10n,this.l10n||=new Ma,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#s=e.uiManager,this.#e=e.annotationLayer||null,this.#i=e.textLayer||null,this.#t=e.drawLayer||null,this.#n=e.onAppend||null,this.#r=e.structTreeLayer||null}async render(e,t="display"){if(t!=="display"||this._cancelled)return;let r=e.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:r}),this.show();return}let i=this.div=document.createElement("div");i.className="annotationEditorLayer",i.hidden=!0,i.dir=this.#s.direction,this.#n?.(i),this.annotationEditorLayer=new A4({uiManager:this.#s,div:i,structTreeLayer:this.#r,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:r,annotationLayer:this.#e,textLayer:this.#i,drawLayer:this.#t});let s={viewport:r,div:i,annotations:null,intent:t};this.annotationEditorLayer.render(s),this.show()}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1)}};{Sp=new Map;let n=navigator.userAgent||"",e=navigator.platform||"",t=navigator.maxTouchPoints||1,r=/Android/.test(n),i=/\b(iPad|iPhone|iPod)(?=;)/.test(n)||e==="MacIntel"&&t>1;(function(){(i||r)&&Sp.set("maxCanvasPixels",5242880)})(),(function(){r&&Sp.set("useSystemFonts",!1)})()}var Sp,F={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},Bb={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},Nr={allowedGlobalEvents:{value:null,kind:F.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:F.BROWSER+F.API},isInAutomation:{value:!1,kind:F.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:F.BROWSER},nimbusDataStr:{value:"",kind:F.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:F.BROWSER},supportsDocumentFonts:{value:!0,kind:F.BROWSER},supportsIntegratedFind:{value:!1,kind:F.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:F.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:F.BROWSER},supportsPinchToZoom:{value:!0,kind:F.BROWSER},toolbarDensity:{value:0,kind:F.BROWSER+F.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:F.VIEWER+F.PREFERENCE},annotationEditorMode:{value:0,kind:F.VIEWER+F.PREFERENCE},annotationMode:{value:2,kind:F.VIEWER+F.PREFERENCE},cursorToolOnLoad:{value:0,kind:F.VIEWER+F.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:F.VIEWER},defaultZoomDelay:{value:400,kind:F.VIEWER+F.PREFERENCE},defaultZoomValue:{value:"",kind:F.VIEWER+F.PREFERENCE},disableHistory:{value:!1,kind:F.VIEWER},disablePageLabels:{value:!1,kind:F.VIEWER+F.PREFERENCE},enableAltText:{value:!1,kind:F.VIEWER+F.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:F.VIEWER+F.PREFERENCE+F.EVENT_DISPATCH},enableGuessAltText:{value:!0,kind:F.VIEWER+F.PREFERENCE+F.EVENT_DISPATCH},enableHighlightFloatingButton:{value:!1,kind:F.VIEWER+F.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:F.VIEWER+F.PREFERENCE},enablePermissions:{value:!1,kind:F.VIEWER+F.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:F.VIEWER+F.PREFERENCE},enableScripting:{value:!0,kind:F.VIEWER+F.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:F.VIEWER+F.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:F.VIEWER},externalLinkTarget:{value:0,kind:F.VIEWER+F.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:F.VIEWER+F.PREFERENCE},historyUpdateUrl:{value:!1,kind:F.VIEWER+F.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:F.VIEWER+F.PREFERENCE},imageResourcesPath:{value:"./images/",kind:F.VIEWER},maxCanvasPixels:{value:2**25,kind:F.VIEWER},forcePageColors:{value:!1,kind:F.VIEWER+F.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:F.VIEWER+F.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:F.VIEWER+F.PREFERENCE},pdfBugEnabled:{value:!1,kind:F.VIEWER+F.PREFERENCE},printResolution:{value:150,kind:F.VIEWER},sidebarViewOnLoad:{value:-1,kind:F.VIEWER+F.PREFERENCE},scrollModeOnLoad:{value:-1,kind:F.VIEWER+F.PREFERENCE},spreadModeOnLoad:{value:-1,kind:F.VIEWER+F.PREFERENCE},textLayerMode:{value:1,kind:F.VIEWER+F.PREFERENCE},viewOnLoad:{value:0,kind:F.VIEWER+F.PREFERENCE},cMapPacked:{value:!0,kind:F.API},cMapUrl:{value:"../web/cmaps/",kind:F.API},disableAutoFetch:{value:!1,kind:F.API+F.PREFERENCE},disableFontFace:{value:!1,kind:F.API+F.PREFERENCE},disableRange:{value:!1,kind:F.API+F.PREFERENCE},disableStream:{value:!1,kind:F.API+F.PREFERENCE},docBaseUrl:{value:"",kind:F.API},enableHWA:{value:!0,kind:F.API+F.VIEWER+F.PREFERENCE},enableXfa:{value:!0,kind:F.API+F.PREFERENCE},fontExtraProperties:{value:!1,kind:F.API},isEvalSupported:{value:!0,kind:F.API},isOffscreenCanvasSupported:{value:!0,kind:F.API},maxImageSize:{value:-1,kind:F.API},pdfBug:{value:!1,kind:F.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:F.API},useSystemFonts:{value:void 0,kind:F.API,type:Bb.BOOLEAN+Bb.UNDEFINED},verbosity:{value:1,kind:F.API},workerPort:{value:null,kind:F.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:F.WORKER}};Nr.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:F.VIEWER},Nr.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:F.VIEWER},Nr.viewerCssTheme={value:0,kind:F.VIEWER+F.PREFERENCE},Nr.enableFakeMLManager={value:!0,kind:F.VIEWER};Nr.disablePreferences={value:!1,kind:F.VIEWER};var Ub=class{static eventBus;static#e=new Map;static{for(let e in Nr)this.#e.set(e,Nr[e].value);for(let[e,t]of Sp)this.#e.set(e,t);this._hasInvokedSet=!1,this._checkDisablePreferences=()=>this.get("disablePreferences")?!0:(this._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)}static get(e){return this.#e.get(e)}static getAll(e=null,t=!1){let r=Object.create(null);for(let i in Nr){let s=Nr[i];e&&!(e&s.kind)||(r[i]=t?s.value:this.#e.get(i))}return r}static set(e,t){this.setAll({[e]:t})}static setAll(e,t=!1){this._hasInvokedSet||=!0;let r;for(let i in e){let s=Nr[i],o=e[i];if(!s||!(typeof o==typeof s.value||Bb[(typeof o).toUpperCase()]&s.type))continue;let{kind:a}=s;t&&!(a&F.BROWSER||a&F.PREFERENCE)||(this.eventBus&&a&F.EVENT_DISPATCH&&(r||=new Map).set(i,o),this.#e.set(i,o))}if(r)for(let[i,s]of r)this.eventBus.dispatch(i.toLowerCase(),{source:this,value:s})}},Hb=class{#e=null;constructor(e){this.pageIndex=e.pageIndex}async render(e="display"){e!=="display"||this.#e||this._cancelled||(this.#e=new D4({pageIndex:this.pageIndex}))}cancel(){this._cancelled=!0,this.#e&&(this.#e.destroy(),this.#e=null)}setParent(e){this.#e?.setParent(e)}getDrawLayer(){return this.#e}},zR={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},A3=/^H(\d+)$/,Op=class{#e;#t=null;#n;#r=new Map;#i;#s=null;constructor(e,t){this.#e=e.getStructTree(),this.#i=t}async render(){if(this.#n)return this.#n;let{promise:e,resolve:t,reject:r}=Promise.withResolvers();this.#n=e;try{this.#t=this.#u(await this.#e)}catch(i){r(i)}return this.#e=null,this.#t?.classList.add("structTree"),t(this.#t),e}async getAriaAttributes(e){try{return await this.render(),this.#r.get(e)}catch{}return null}hide(){this.#t&&!this.#t.hidden&&(this.#t.hidden=!0)}show(){this.#t?.hidden&&(this.#t.hidden=!1)}#c(e,t){let{alt:r,id:i,lang:s}=e;if(r!==void 0){let o=!1,a=ou(r);for(let c of e.children)if(c.type==="annotation"){let l=this.#r.get(c.id);l||(l=new Map,this.#r.set(c.id,l)),l.set("aria-label",a),o=!0}o||t.setAttribute("aria-label",a)}i!==void 0&&t.setAttribute("aria-owns",i),s!==void 0&&t.setAttribute("lang",ou(s,!0))}#l(e,t){let{alt:r,bbox:i,children:s}=e,o=s?.[0];if(!this.#i||!r||!i||o?.type!=="content")return!1;let{id:a}=o;if(!a)return!1;t.setAttribute("aria-owns",a);let c=document.createElement("span");(this.#s||=new Map).set(a,c),c.setAttribute("role","img"),c.setAttribute("aria-label",ou(r));let{pageHeight:l,pageX:u,pageY:h}=this.#i,f="calc(var(--scale-factor)*",{style:p}=c;return p.width=`${f}${i[2]-i[0]}px)`,p.height=`${f}${i[3]-i[1]}px)`,p.left=`${f}${i[0]-u}px)`,p.top=`${f}${l-i[3]+h}px)`,!0}addElementsToTextLayer(){if(this.#s){for(let[e,t]of this.#s)document.getElementById(e)?.append(t);this.#s.clear(),this.#s=null}}#u(e){if(!e)return null;let t=document.createElement("span");if("role"in e){let{role:r}=e,i=r.match(A3);if(i?(t.setAttribute("role","heading"),t.setAttribute("aria-level",i[1])):zR[r]&&t.setAttribute("role",zR[r]),r==="Figure"&&this.#l(e,t))return t}if(this.#c(e,t),e.children)if(e.children.length===1&&"id"in e.children[0])this.#c(e.children[0],t);else for(let r of e.children)t.append(this.#u(r));return t}},$b=class n{#e=!1;#t=null;#n=new Map;#r=new Map;setTextMapping(e){this.#t=e}static#i(e,t){let r=e.getBoundingClientRect(),i=t.getBoundingClientRect();if(r.width===0&&r.height===0)return 1;if(i.width===0&&i.height===0)return-1;let s=r.y,o=r.y+r.height,a=r.y+r.height/2,c=i.y,l=i.y+i.height,u=i.y+i.height/2;if(a<=c&&u>=o)return-1;if(u<=s&&a>=l)return 1;let h=r.x+r.width/2,f=i.x+i.width/2;return h-f}enable(){if(this.#e)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#t)throw new Error("Text divs and strings have not been set.");if(this.#e=!0,this.#t=this.#t.slice(),this.#t.sort(n.#i),this.#n.size>0){let e=this.#t;for(let[t,r]of this.#n){if(!document.getElementById(t)){this.#n.delete(t);continue}this.#s(t,e[r])}}for(let[e,t]of this.#r)this.addPointerInTextLayer(e,t);this.#r.clear()}disable(){this.#e&&(this.#r.clear(),this.#t=null,this.#e=!1)}removePointerInTextLayer(e){if(!this.#e){this.#r.delete(e);return}let t=this.#t;if(!t||t.length===0)return;let{id:r}=e,i=this.#n.get(r);if(i===void 0)return;let s=t[i];this.#n.delete(r);let o=s.getAttribute("aria-owns");o?.includes(r)&&(o=o.split(" ").filter(a=>a!==r).join(" "),o?s.setAttribute("aria-owns",o):(s.removeAttribute("aria-owns"),s.setAttribute("role","presentation")))}#s(e,t){let r=t.getAttribute("aria-owns");r?.includes(e)||t.setAttribute("aria-owns",r?`${r} ${e}`:e),t.removeAttribute("role")}addPointerInTextLayer(e,t){let{id:r}=e;if(!r)return null;if(!this.#e)return this.#r.set(e,t),null;t&&this.removePointerInTextLayer(e);let i=this.#t;if(!i||i.length===0)return null;let s=au(i,l=>n.#i(e,l)<0),o=Math.max(0,s-1),a=i[o];this.#s(r,a),this.#n.set(r,o);let c=a.parentNode;return c?.classList.contains("markedContent")?c.id:null}moveElementInDOM(e,t,r,i){let s=this.addPointerInTextLayer(r,i);if(!e.hasChildNodes())return e.append(t),s;let o=Array.from(e.childNodes).filter(l=>l!==t);if(o.length===0)return s;let a=r||t,c=au(o,l=>n.#i(a,l)<0);return c===0?o[0].before(t):o[c-1].after(t),s}},zb=class{#e=null;constructor({findController:e,eventBus:t,pageIndex:r}){this.findController=e,this.matches=[],this.eventBus=t,this.pageIdx=r,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(e,t){this.textDivs=e,this.textContentItemsStr=t}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#e||(this.#e=new AbortController,this.eventBus._on("updatetextlayermatches",e=>{(e.pageIndex===this.pageIdx||e.pageIndex===-1)&&this._updateMatches()},{signal:this.#e.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#e?.abort(),this.#e=null,this._updateMatches(!0))}_convertMatches(e,t){if(!e)return[];let{textContentItemsStr:r}=this,i=0,s=0,o=r.length-1,a=[];for(let c=0,l=e.length;c<l;c++){let u=e[c];for(;i!==o&&u>=s+r[i].length;)s+=r[i].length,i++;i===r.length&&console.error("Could not find a matching mapping");let h={begin:{divIdx:i,offset:u-s}};for(u+=t[c];i!==o&&u>s+r[i].length;)s+=r[i].length,i++;h.end={divIdx:i,offset:u-s},a.push(h)}return a}_renderMatches(e){if(e.length===0)return;let{findController:t,pageIdx:r}=this,{textContentItemsStr:i,textDivs:s}=this,o=r===t.selected.pageIdx,a=t.selected.matchIdx,c=t.state.highlightAll,l=null,u={divIdx:-1,offset:void 0};function h(I,D){let P=I.divIdx;return s[P].textContent="",f(P,0,I.offset,D)}function f(I,D,P,x){let N=s[I];if(N.nodeType===Node.TEXT_NODE){let E=document.createElement("span");N.before(E),E.append(N),s[I]=E,N=E}let k=i[I].substring(D,P),T=document.createTextNode(k);if(x){let E=document.createElement("span");return E.className=`${x} appended`,E.append(T),N.append(E),x.includes("selected")?E.offsetLeft:0}return N.append(T),0}let p=a,m=p+1;if(c)p=0,m=e.length;else if(!o)return;let v=-1,w=-1;for(let I=p;I<m;I++){let D=e[I],P=D.begin;if(P.divIdx===v&&P.offset===w)continue;v=P.divIdx,w=P.offset;let x=D.end,N=o&&I===a,k=N?" selected":"",T=0;if(!l||P.divIdx!==l.divIdx?(l!==null&&f(l.divIdx,l.offset,u.offset),h(P)):f(l.divIdx,l.offset,P.offset),P.divIdx===x.divIdx)T=f(P.divIdx,P.offset,x.offset,"highlight"+k);else{T=f(P.divIdx,P.offset,u.offset,"highlight begin"+k);for(let E=P.divIdx+1,_=x.divIdx;E<_;E++)s[E].className="highlight middle"+k;h(x,"highlight end"+k)}l=x,N&&t.scrollMatchIntoView({element:s[P.divIdx],selectedLeft:T,pageIndex:r,matchIndex:a})}l&&f(l.divIdx,l.offset,u.offset)}_updateMatches(e=!1){if(!this.enabled&&!e)return;let{findController:t,matches:r,pageIdx:i}=this,{textContentItemsStr:s,textDivs:o}=this,a=-1;for(let u of r){let h=Math.max(a,u.begin.divIdx);for(let f=h,p=u.end.divIdx;f<=p;f++){let m=o[f];m.textContent=s[f],m.className=""}a=u.end.divIdx+1}if(!t?.highlightMatches||e)return;let c=t.pageMatches[i]||null,l=t.pageMatchesLength[i]||null;this.matches=this._convertMatches(c,l),this._renderMatches(this.matches)}},kp=class n{#e=!1;#t=null;#n=!1;#r=null;static#i=new Map;static#s=null;constructor({pdfPage:e,highlighter:t=null,accessibilityManager:r=null,enablePermissions:i=!1,onAppend:s=null}){this.pdfPage=e,this.highlighter=t,this.accessibilityManager=r,this.#e=i===!0,this.#t=s,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}async render(e,t=null){if(this.#n&&this.#r){this.#r.update({viewport:e,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),this.#r=new O4({textContentSource:this.pdfPage.streamTextContent(t||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:e});let{textDivs:r,textContentItemsStr:i}=this.#r;this.highlighter?.setTextMapping(r,i),this.accessibilityManager?.setTextMapping(r),await this.#r.render(),this.#n=!0;let s=document.createElement("div");s.className="endOfContent",this.div.append(s),this.#c(s),this.#t?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()}hide(){!this.div.hidden&&this.#n&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#n&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#r?.cancel(),this.#r=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),n.#l(this.div)}#c(e){let{div:t}=this;t.addEventListener("mousedown",()=>{t.classList.add("selecting")}),t.addEventListener("copy",r=>{if(!this.#e){let i=document.getSelection();r.clipboardData.setData("text/plain",ou(M4(i.toString())))}r.preventDefault(),r.stopPropagation()}),n.#i.set(t,e),n.#u()}static#l(e){this.#i.delete(e),this.#i.size===0&&(this.#s?.abort(),this.#s=null)}static#u(){if(this.#s)return;this.#s=new AbortController;let{signal:e}=this.#s,t=(o,a)=>{a.append(o),o.style.width="",o.style.height="",a.classList.remove("selecting")},r=!1;document.addEventListener("pointerdown",()=>{r=!0},{signal:e}),document.addEventListener("pointerup",()=>{r=!1,this.#i.forEach(t)},{signal:e}),window.addEventListener("blur",()=>{r=!1,this.#i.forEach(t)},{signal:e}),document.addEventListener("keyup",()=>{r||this.#i.forEach(t)},{signal:e});var i,s;document.addEventListener("selectionchange",()=>{let o=document.getSelection();if(o.rangeCount===0){this.#i.forEach(t);return}let a=new Set;for(let p=0;p<o.rangeCount;p++){let m=o.getRangeAt(p);for(let v of this.#i.keys())!a.has(v)&&m.intersectsNode(v)&&a.add(v)}for(let[p,m]of this.#i)a.has(p)?p.classList.add("selecting"):t(m,p);if(i??=getComputedStyle(this.#i.values().next().value).getPropertyValue("-moz-user-select")==="none",i)return;let c=o.getRangeAt(0),l=s&&(c.compareBoundaryPoints(Range.END_TO_END,s)===0||c.compareBoundaryPoints(Range.START_TO_END,s)===0),u=l?c.startContainer:c.endContainer;u.nodeType===Node.TEXT_NODE&&(u=u.parentNode);let h=u.parentElement?.closest(".textLayer"),f=this.#i.get(h);f&&(f.style.width=h.style.width,f.style.height=h.style.height,u.parentElement.insertBefore(f,l?u:u.nextSibling)),s=c.cloneRange()},{signal:e})}},Lp=class{constructor({pdfPage:e,annotationStorage:t=null,linkService:r,xfaHtml:i=null}){this.pdfPage=e,this.annotationStorage=t,this.linkService=r,this.xfaHtml=i,this.div=null,this._cancelled=!1}async render(e,t="display"){if(t==="print"){let s={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div=document.createElement("div"),s.div=this.div,_b.render(s)}let r=await this.pdfPage.getXfa();if(this._cancelled||!r)return{textDivs:[]};let i={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:r,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div?_b.update(i):(this.div=document.createElement("div"),i.div=this.div,_b.render(i))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}},T3={annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new cu}},C3=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]),Fp=class{#e=vi.ENABLE_FORMS;#t=!1;#n=!1;#r=!1;#i=null;#s=null;#c=null;#l=1;#u=1;#a=null;#d=nt.INITIAL;#o=Rr.ENABLE;#h={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#p=new WeakMap;#f=[null,null,null,null];constructor(e){let t=e.container,r=e.defaultViewport;this.id=e.id,this.renderingId="page"+this.id,this.#i=e.layerProperties||T3,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||qR,this.viewport=r,this.pdfPageRotate=r.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.#o=e.textLayerMode??Rr.ENABLE,this.#e=e.annotationMode??vi.ENABLE_FORMS,this.imageResourcesPath=e.imageResourcesPath||"",this.maxCanvasPixels=e.maxCanvasPixels??Ub.get("maxCanvasPixels"),this.pageColors=e.pageColors||null,this.#t=e.enableHWA||!1,this.eventBus=e.eventBus,this.renderingQueue=e.renderingQueue,this.l10n=e.l10n,this.l10n||=new Ma,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=t,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null;let i=document.createElement("div");if(i.className="page",i.setAttribute("data-page-number",this.id),i.setAttribute("role","region"),i.setAttribute("data-l10n-id","pdfjs-page-landmark"),i.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=i,this.#y(),t?.append(i),this._isStandalone){t?.style.setProperty("--scale-factor",this.scale*yi.PDF_TO_CSS_UNITS),this.pageColors?.background&&t?.style.setProperty("--page-bg-color",this.pageColors.background);let{optionalContentConfigPromise:s}=e;s&&s.then(o=>{s===this._optionalContentConfigPromise&&(this.#h.initialOptionalContent=o.hasInitialVisibility)}),e.l10n||this.l10n.translate(this.div)}}#g(e,t){let r=C3.get(t),i=this.#f[r];if(this.#f[r]=e,i){i.replaceWith(e);return}for(let s=r-1;s>=0;s--){let o=this.#f[s];if(o){o.after(e);return}}this.div.prepend(e)}get renderingState(){return this.#d}set renderingState(e){if(e!==this.#d)switch(this.#d=e,this.#s&&(clearTimeout(this.#s),this.#s=null),e){case nt.PAUSED:this.div.classList.remove("loading");break;case nt.RUNNING:this.div.classList.add("loadingIcon"),this.#s=setTimeout(()=>{this.div.classList.add("loading"),this.#s=null},0);break;case nt.INITIAL:case nt.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}#y(){let{viewport:e}=this;if(this.pdfPage){if(this.#c===e.rotation)return;this.#c=e.rotation}N4(this.div,e,!0,!1)}setPdfPage(e){this._isStandalone&&(this.pageColors?.foreground==="CanvasText"||this.pageColors?.background==="Canvas")&&(this._container?.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=e,this.pdfPageRotate=e.rotate;let t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*yi.PDF_TO_CSS_UNITS,rotation:t}),this.#y(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return xp(this,"_textHighlighter",new zb({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#i.findController}))}#m(e,t){this.eventBus.dispatch(e,{source:this,pageNumber:this.id,error:t})}async#v(){let e=null;try{await this.annotationLayer.render(this.viewport,{structTreeLayer:this.structTreeLayer},"display")}catch(t){console.error(`#renderAnnotationLayer: "${t}".`),e=t}finally{this.#m("annotationlayerrendered",e)}}async#w(){let e=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(t){console.error(`#renderAnnotationEditorLayer: "${t}".`),e=t}finally{this.#m("annotationeditorlayerrendered",e)}}async#I(){try{await this.drawLayer.render("display")}catch(e){console.error(`#renderDrawLayer: "${e}".`)}}async#E(){let e=null;try{let t=await this.xfaLayer.render(this.viewport,"display");t?.textDivs&&this._textHighlighter&&this.#S(t.textDivs)}catch(t){console.error(`#renderXfaLayer: "${t}".`),e=t}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#g(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#m("xfalayerrendered",e)}}async#b(){if(!this.textLayer)return;let e=null;try{await this.textLayer.render(this.viewport)}catch(t){if(t instanceof I4)return;console.error(`#renderTextLayer: "${t}".`),e=t}this.#m("textlayerrendered",e),this.#P()}async#P(){if(!this.textLayer)return;let e=await this.structTreeLayer?.render();e&&(this.l10n.pause(),this.structTreeLayer?.addElementsToTextLayer(),this.canvas&&e.parentNode!==this.canvas&&this.canvas.append(e),this.l10n.resume()),this.structTreeLayer?.show()}async#S(e){let t=await this.pdfPage.getTextContent(),r=[];for(let i of t.items)r.push(i.str);this._textHighlighter.setTextMapping(e,r),this._textHighlighter.enable()}_resetZoomLayer(e=!1){if(!this.zoomLayer)return;let t=this.zoomLayer.firstChild;this.#p.delete(t),t.width=0,t.height=0,e&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:e=!1,keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:r=!1,keepXfaLayer:i=!1,keepTextLayer:s=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:r,keepXfaLayer:i,keepTextLayer:s}),this.renderingState=nt.INITIAL;let o=this.div,a=o.childNodes,c=e&&this.zoomLayer||null,l=t&&this.annotationLayer?.div||null,u=r&&this.annotationEditorLayer?.div||null,h=i&&this.xfaLayer?.div||null,f=s&&this.textLayer?.div||null;for(let p=a.length-1;p>=0;p--){let m=a[p];switch(m){case c:case l:case u:case h:case f:continue}m.remove();let v=this.#f.indexOf(m);v>=0&&(this.#f[v]=null)}o.removeAttribute("data-loaded"),l&&this.annotationLayer.hide(),u&&this.annotationEditorLayer.hide(),h&&this.xfaLayer.hide(),f&&this.textLayer.hide(),this.structTreeLayer?.hide(),c||(this.canvas&&(this.#p.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}toggleEditingMode(e){this.hasEditableAnnotations()&&(this.#r=e,this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0}))}update({scale:e=0,rotation:t=null,optionalContentConfigPromise:r=null,drawingDelay:i=-1}){this.scale=e||this.scale,typeof t=="number"&&(this.rotation=t),r instanceof Promise&&(this._optionalContentConfigPromise=r,r.then(o=>{r===this._optionalContentConfigPromise&&(this.#h.initialOptionalContent=o.hasInitialVisibility)})),this.#h.directDrawing=!0;let s=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*yi.PDF_TO_CSS_UNITS,rotation:s}),this.#y(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.canvas){let o=!1;if(this.#n){if(this.maxCanvasPixels===0)o=!0;else if(this.maxCanvasPixels>0){let{width:c,height:l}=this.viewport,{sx:u,sy:h}=this.outputScale;o=(Math.floor(c)*u|0)*(Math.floor(l)*h|0)>this.maxCanvasPixels}}let a=i>=0&&i<1e3;if(a||o){if(a&&!o&&this.renderingState!==nt.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:i}),this.renderingState=nt.FINISHED,this.#h.directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!a,hideTextLayer:a}),a)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#a});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:r=!1,keepTextLayer:i=!1,cancelExtraDelay:s=0}={}){this.renderTask&&(this.renderTask.cancel(s),this.renderTask=null),this.resume=null,this.textLayer&&(!i||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!e||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationEditorLayer&&(!t||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!r||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:e,redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:r=!1,redrawXfaLayer:i=!1,redrawTextLayer:s=!1,hideTextLayer:o=!1}){if(!e.hasAttribute("zooming")){e.setAttribute("zooming",!0);let{style:c}=e;c.width=c.height=""}let a=this.#p.get(e);if(this.viewport!==a){let c=this.viewport.rotation-a.rotation,l=Math.abs(c),u=1,h=1;if(l===90||l===270){let{width:f,height:p}=this.viewport;u=p/f,h=f/p}e.style.transform=`rotate(${c}deg) scale(${u}, ${h})`}t&&this.annotationLayer&&this.#v(),r&&this.annotationEditorLayer&&(this.drawLayer&&this.#I(),this.#w()),i&&this.xfaLayer&&this.#E(),this.textLayer&&(o?(this.textLayer.hide(),this.structTreeLayer?.hide()):s&&this.#b())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(e,t){return this.viewport.convertToPdfPoint(e,t)}async#A(e,t=null){if(e===this.renderTask&&(this.renderTask=null),t instanceof Cb){this.#a=null;return}if(this.#a=t,this.renderingState=nt.FINISHED,this._resetZoomLayer(!0),this.#h.regularAnnotations=!e.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#a}),t)throw t}async draw(){this.renderingState!==nt.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());let{div:e,l10n:t,pageColors:r,pdfPage:i,viewport:s}=this;if(!i)throw this.renderingState=nt.FINISHED,new Error("pdfPage is not loaded");this.renderingState=nt.RUNNING;let o=document.createElement("div");if(o.classList.add("canvasWrapper"),this.#g(o,"canvasWrapper"),!this.textLayer&&this.#o!==Rr.DISABLE&&!i.isPureXfa&&(this._accessibilityManager||=new $b,this.textLayer=new kp({pdfPage:i,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#o===Rr.ENABLE_PERMISSIONS,onAppend:_=>{this.l10n.pause(),this.#g(_,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#e!==vi.DISABLE){let{annotationStorage:_,annotationEditorUIManager:A,downloadManager:C,enableScripting:M,fieldObjectsPromise:S,hasJSActionsPromise:Z,linkService:_e}=this.#i;this._annotationCanvasMap||=new Map,this.annotationLayer=new Pp({pdfPage:i,annotationStorage:_,imageResourcesPath:this.imageResourcesPath,renderForms:this.#e===vi.ENABLE_FORMS,linkService:_e,downloadManager:C,enableScripting:M,hasJSActionsPromise:Z,fieldObjectsPromise:S,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:A,onAppend:We=>{this.#g(We,"annotationLayer")}})}let a=_=>{if(f?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=nt.PAUSED,this.resume=()=>{this.renderingState=nt.RUNNING,_()};return}_()},{width:c,height:l}=s,u=document.createElement("canvas");u.setAttribute("role","presentation"),u.hidden=!0;let h=!!(r?.background&&r?.foreground),f=_=>{(!h||_)&&(u.hidden=!1,f=null)};o.append(u),this.canvas=u;let p=u.getContext("2d",{alpha:!1,willReadFrequently:!this.#t}),m=this.outputScale=new R4;if(this.maxCanvasPixels===0){let _=1/this.scale;m.sx*=_,m.sy*=_,this.#n=!0}else if(this.maxCanvasPixels>0){let _=c*l,A=Math.sqrt(this.maxCanvasPixels/_);m.sx>A||m.sy>A?(m.sx=A,m.sy=A,this.#n=!0):this.#n=!1}let v=vR(m.sx),w=vR(m.sy),I=u.width=Ep(bp(c*m.sx),v[0]),D=u.height=Ep(bp(l*m.sy),w[0]),P=Ep(bp(c),v[1]),x=Ep(bp(l),w[1]);m.sx=I/P,m.sy=D/x,this.#l!==v[1]&&(e.style.setProperty("--scale-round-x",`${v[1]}px`),this.#l=v[1]),this.#u!==w[1]&&(e.style.setProperty("--scale-round-y",`${w[1]}px`),this.#u=w[1]),this.#p.set(u,s);let N=m.scaled?[m.sx,0,0,m.sy,0,0]:null,k={canvasContext:p,transform:N,viewport:s,annotationMode:this.#e,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:r,isEditing:this.#r},T=this.renderTask=i.render(k);T.onContinue=a;let E=T.promise.then(async()=>{f?.(!0),await this.#A(T),this.structTreeLayer||=new Op(i,s.rawDims),this.#b(),this.annotationLayer&&await this.#v();let{annotationEditorUIManager:_}=this.#i;_&&(this.drawLayer||=new Hb({pageIndex:this.id}),await this.#I(),this.drawLayer.setParent(o),this.annotationEditorLayer||=new jb({uiManager:_,pdfPage:i,l10n:t,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:A=>{this.#g(A,"annotationEditorLayer")}}),this.#w())},_=>(_ instanceof Cb||f?.(!0),this.#A(T,_)));if(i.isPureXfa){if(!this.xfaLayer){let{annotationStorage:_,linkService:A}=this.#i;this.xfaLayer=new Lp({pdfPage:i,annotationStorage:_,linkService:A})}this.#E()}return e.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),E}setPageLabel(e){this.pageLabel=typeof e=="string"?e:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){let{directDrawing:e,initialOptionalContent:t,regularAnnotations:r}=this.#h;return e&&t&&r?this.canvas:null}};async function S3(n){let t="".split("#",1)[0],{info:r,metadata:i,contentDispositionFilename:s,contentLength:o}=await n.getMetadata();if(!o){let{length:a}=await n.getDownloadInfo();o=a}return J(L({},r),{baseURL:t,filesize:o,filename:s||x4(""),metadata:i?.getRaw(),authors:i?.get("dc:creator"),numPages:n.numPages,URL:""})}var Gb=class{constructor(e){this._ready=new Promise((t,r)=>{import(e).then(s=>{t(s.QuickJSSandbox())}).catch(r)})}async createSandbox(e){(await this._ready).create(e)}async dispatchEventInSandbox(e){let t=await this._ready;setTimeout(()=>t.dispatchEvent(e),0)}async destroySandbox(){(await this._ready).nukeSandbox()}},Wb=class{#e=null;#t=null;#n=null;#r=null;#i=null;#s=null;#c=null;#l=null;#u=!1;#a=null;#d=null;constructor({eventBus:e,externalServices:t=null,docProperties:r=null}){this.#i=e,this.#s=t,this.#n=r}setViewer(e){this.#l=e}async setDocument(e){if(this.#c&&await this.#g(),this.#c=e,!e)return;let[t,r,i]=await Promise.all([e.getFieldObjects(),e.getCalculationOrderIds(),e.getJSActions()]);if(!t&&!i){await this.#g();return}if(e!==this.#c)return;try{this.#a=this.#f()}catch(a){console.error(`setDocument: "${a.message}".`),await this.#g();return}let s=this.#i;this.#r=new AbortController;let{signal:o}=this.#r;s._on("updatefromsandbox",a=>{a?.source===window&&this.#o(a.detail)},{signal:o}),s._on("dispatcheventinsandbox",a=>{this.#a?.dispatchEventInSandbox(a.detail)},{signal:o}),s._on("pagechanging",({pageNumber:a,previous:c})=>{a!==c&&(this.#p(c),this.#h(a))},{signal:o}),s._on("pagerendered",({pageNumber:a})=>{this._pageOpenPending.has(a)&&a===this.#l.currentPageNumber&&this.#h(a)},{signal:o}),s._on("pagesdestroy",async()=>{await this.#p(this.#l.currentPageNumber),await this.#a?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#e?.resolve()},{signal:o});try{let a=await this.#n(e);if(e!==this.#c)return;await this.#a.createSandbox({objects:t,calculationOrder:r,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:J(L({},a),{actions:i})}),s.dispatch("sandboxcreated",{source:this})}catch(a){console.error(`setDocument: "${a.message}".`),await this.#g();return}await this.#a?.dispatchEventInSandbox({id:"doc",name:"Open"}),await this.#h(this.#l.currentPageNumber,!0),Promise.resolve().then(()=>{e===this.#c&&(this.#u=!0)})}async dispatchWillSave(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){if(this.#a){await this.#d?.promise,this.#d=Promise.withResolvers();try{await this.#a.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(e){throw this.#d.resolve(),this.#d=null,e}await this.#d.promise}}async dispatchDidPrint(){return this.#a?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this.#t?.promise||null}get ready(){return this.#u}get _pageOpenPending(){return xp(this,"_pageOpenPending",new Set)}get _visitedPages(){return xp(this,"_visitedPages",new Map)}async#o(e){let t=this.#l,r=t.isInPresentationMode||t.isChangingPresentationMode,{id:i,siblings:s,command:o,value:a}=e;if(!i){switch(o){case"clear":console.clear();break;case"error":console.error(a);break;case"layout":if(!r){let l=e4(a);t.spreadMode=l.spreadMode}break;case"page-num":t.currentPageNumber=a+1;break;case"print":await t.pagesPromise,this.#i.dispatch("print",{source:this});break;case"println":console.log(a);break;case"zoom":r||(t.currentScaleValue=a);break;case"SaveAs":this.#i.dispatch("download",{source:this});break;case"FirstPage":t.currentPageNumber=1;break;case"LastPage":t.currentPageNumber=t.pagesCount;break;case"NextPage":t.nextPage();break;case"PrevPage":t.previousPage();break;case"ZoomViewIn":r||t.increaseScale();break;case"ZoomViewOut":r||t.decreaseScale();break;case"WillPrintFinished":this.#d?.resolve(),this.#d=null;break}return}if(r&&e.focus)return;delete e.id,delete e.siblings;let c=s?[i,...s]:[i];for(let l of c){let u=document.querySelector(`[data-element-id="${l}"]`);u?u.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:e})):this.#c?.annotationStorage.setValue(l,e)}}async#h(e,t=!1){let r=this.#c,i=this._visitedPages;if(t&&(this.#e=Promise.withResolvers()),!this.#e)return;let s=this.#l.getPageView(e-1);if(s?.renderingState!==nt.FINISHED){this._pageOpenPending.add(e);return}this._pageOpenPending.delete(e);let o=(async()=>{let a=await(i.has(e)?null:s.pdfPage?.getJSActions());r===this.#c&&await this.#a?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:e,actions:a})})();i.set(e,o)}async#p(e){let t=this.#c,r=this._visitedPages;if(!this.#e||this._pageOpenPending.has(e))return;let i=r.get(e);i&&(r.set(e,null),await i,t===this.#c&&await this.#a?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:e}))}#f(){if(this.#t=Promise.withResolvers(),this.#a)throw new Error("#initScripting: Scripting already exists.");return this.#s.createScripting()}async#g(){if(!this.#a){this.#c=null,this.#t?.resolve();return}this.#e&&(await Promise.race([this.#e.promise,new Promise(e=>{setTimeout(e,1e3)})]).catch(()=>{}),this.#e=null),this.#c=null;try{await this.#a.destroySandbox()}catch{}this.#d?.reject(new Error("Scripting destroyed.")),this.#d=null,this.#r?.abort(),this.#r=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#a=null,this.#u=!1,this.#t?.resolve()}},qb=class extends Wb{constructor(e){e.externalServices||window.addEventListener("updatefromsandbox",t=>{e.eventBus.dispatch("updatefromsandbox",{source:window,detail:t.detail})}),e.externalServices||={createScripting:()=>new Gb(e.sandboxBundleSrc)},e.docProperties||=t=>S3(t),super(e)}},D3=3e4,Kb=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}renderHighestPriority(e){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(e)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),D3)))}getHighestPriority(e,t,r,i=!1){let s=e.views,o=s.length;if(o===0)return null;for(let h=0;h<o;h++){let f=s[h].view;if(!this.isViewFinished(f))return f}let a=e.first.id,c=e.last.id;if(c-a+1>o){let h=e.ids;for(let f=1,p=c-a;f<p;f++){let m=r?a+f:c-f;if(h.has(m))continue;let v=t[m-1];if(!this.isViewFinished(v))return v}}let l=r?c:a-2,u=t[l];return u&&!this.isViewFinished(u)||i&&(l+=r?1:-1,u=t[l],u&&!this.isViewFinished(u))?u:null}isViewFinished(e){return e.renderingState===nt.FINISHED}renderView(e){switch(e.renderingState){case nt.FINISHED:return!1;case nt.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case nt.RUNNING:this.highestPriorityPage=e.renderingId;break;case nt.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally(()=>{this.renderHighestPriority()}).catch(t=>{t instanceof Cb||console.error(`renderView: "${t}"`)});break}return!0}},GR=10,Cp={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function WR(n){return Object.values(Dn).includes(n)&&n!==Dn.DISABLE}var Yb=class{#e=new Set;#t=0;constructor(e){this.#t=e}push(e){let t=this.#e;t.has(e)&&t.delete(e),t.add(e),t.size>this.#t&&this.#n()}resize(e,t=null){this.#t=e;let r=this.#e;if(t){let i=r.size,s=1;for(let o of r)if(t.has(o.id)&&(r.delete(o),r.add(o)),++s>i)break}for(;r.size>this.#t;)this.#n()}has(e){return this.#e.has(e)}[Symbol.iterator](){return this.#e.keys()}#n(){let e=this.#e.keys().next().value;e?.destroy(),this.#e.delete(e)}},Vp=class{#e=null;#t=null;#n=null;#r=Dn.NONE;#i=null;#s=vi.ENABLE_FORMS;#c=null;#l=!1;#u=!1;#a=!1;#d=!1;#o=!1;#h=null;#p=null;#f=null;#g=null;#y=!1;#m=null;#v=!1;#w=0;#I=new ResizeObserver(this.#V.bind(this));#E=null;#b=null;#P=Rr.ENABLE;constructor(e){let t="4.8.69";if(SR!==t)throw new Error(`The API version "${SR}" does not match the Viewer version "${t}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#I.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new cu,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this.#t=e.altTextManager||null,this.findController&&(this.findController.onIsPageVisible=i=>this._getVisiblePages().ids.has(i)),this._scriptingManager=e.scriptingManager||null,this.#P=e.textLayerMode??Rr.ENABLE,this.#s=e.annotationMode??vi.ENABLE_FORMS,this.#r=e.annotationEditorMode??Dn.NONE,this.#n=e.annotationEditorHighlightColors||null,this.#u=e.enableHighlightFloatingButton===!0,this.#d=e.enableUpdatedAddImage===!0,this.#o=e.enableNewAltTextWhenAddingImage===!0,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n,this.l10n||=new Ma,this.#a=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.#p=e.mlManager||null,this.#l=e.enableHWA||!1,this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new Kb,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue;let{abortSignal:r}=e;r?.addEventListener("abort",()=>{this.#I.disconnect(),this.#I=null},{once:!0}),this.scroll=qz(this.container,this._scrollUpdate.bind(this),r),this.presentationModeState=Da.UNKNOWN,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#L(),this.eventBus._on("thumbnailrendered",({pageNumber:i,pdfPage:s})=>{let o=this._pages[i-1];this.#e.has(o)||s?.cleanup()}),e.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}getCachedPageViews(){return new Set(this.#e)}get pageViewsReady(){return this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#s===vi.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,t=!1){if(this._currentPageNumber===e)return t&&this.#R(),!0;if(!(0<e&&e<=this.pagesCount))return!1;let r=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:r}),t&&this.#R(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let t=e|0;if(this._pageLabels){let r=this._pageLabels.indexOf(e);r>=0&&(t=r+1)}this._setCurrentPageNumber(t,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==gb?this._currentScale:qR}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#x(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#x(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!YR(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(e%=360,e<0&&(e+=360),this._pagesRotation===e))return;this._pagesRotation=e;let t=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#x(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:t}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){let e=this;return xp(this,"_layerProperties",{get annotationEditorUIManager(){return e.#i},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}})}#S(e){let t={annotationEditorMode:this.#r,annotationMode:this.#s,textLayerMode:this.#P};return e&&(!e.includes(Ap.COPY)&&this.#P===Rr.ENABLE&&(t.textLayerMode=Rr.ENABLE_PERMISSIONS),e.includes(Ap.MODIFY_CONTENTS)||(t.annotationEditorMode=Dn.DISABLE),!e.includes(Ap.MODIFY_ANNOTATIONS)&&!e.includes(Ap.FILL_INTERACTIVE_FORMS)&&this.#s===vi.ENABLE_FORMS&&(t.annotationMode=vi.ENABLE)),t}async#A(e){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;let t=Promise.withResolvers(),r=new AbortController;document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&t.resolve()},{signal:typeof AbortSignal.any=="function"?AbortSignal.any([e,r.signal]):e}),await Promise.race([this._onePageRenderedCapability.promise,t.promise]),r.abort()}async getAllText(){let e=[],t=[];for(let r=1,i=this.pdfDocument.numPages;r<=i;++r){if(this.#v)return null;t.length=0;let s=await this.pdfDocument.getPage(r),{items:o}=await s.getTextContent();for(let a of o)a.str&&t.push(a.str),a.hasEOL&&t.push(`
`);e.push(ou(t.join("")))}return e.join(`
`)}#D(e,t){let r=document.getSelection(),{focusNode:i,anchorNode:s}=r;if(s&&i&&r.containsNode(this.#m)){if(this.#y||e===Rr.ENABLE_PERMISSIONS){t.preventDefault(),t.stopPropagation();return}this.#y=!0;let{classList:o}=this.viewer;o.add("copyAll");let a=new AbortController;window.addEventListener("keydown",c=>this.#v=c.key==="Escape",{signal:a.signal}),this.getAllText().then(async c=>{c!==null&&await navigator.clipboard.writeText(c)}).catch(c=>{console.warn(`Something goes wrong when extracting the text: ${c.message}`)}).finally(()=>{this.#y=!1,this.#v=!1,a.abort(),o.remove("copyAll")}),t.preventDefault(),t.stopPropagation()}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#i?.destroy(),this.#i=null),this.pdfDocument=e,!e)return;let t=e.numPages,r=e.getPage(1),i=e.getOptionalContentConfig({intent:"display"}),s=this.#a?e.getPermissions():Promise.resolve(),{eventBus:o,pageColors:a,viewer:c}=this;this.#h=new AbortController;let{signal:l}=this.#h;if(t>Cp.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");let f=this._scrollMode=Se.PAGE;o.dispatch("scrollmodechanged",{source:this,mode:f})}this._pagesCapability.promise.then(()=>{o.dispatch("pagesloaded",{source:this,pagesCount:t})},()=>{});let u=f=>{let p=this._pages[f.pageNumber-1];p&&this.#e.push(p)};o._on("pagerender",u,{signal:l});let h=f=>{f.cssTransform||(this._onePageRenderedCapability.resolve({timestamp:f.timestamp}),o._off("pagerendered",h))};o._on("pagerendered",h,{signal:l}),Promise.all([r,s]).then(([f,p])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(f),this._optionalContentConfigPromise=i;let{annotationEditorMode:m,annotationMode:v,textLayerMode:w}=this.#S(p);if(w!==Rr.DISABLE){let x=this.#m=document.createElement("div");x.id="hiddenCopyElement",c.before(x)}if(typeof AbortSignal.any=="function"&&m!==Dn.DISABLE){let x=m;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):WR(x)?(this.#i=new T4(this.container,c,this.#t,o,e,a,this.#n,this.#u,this.#d,this.#o,this.#p),o.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#i}),x!==Dn.NONE&&(x===Dn.STAMP&&this.#p?.loadModel("altText"),this.#i.updateMode(x))):console.error(`Invalid AnnotationEditor mode: ${x}`)}let I=this._scrollMode===Se.PAGE?null:c,D=this.currentScale,P=f.getViewport({scale:D*yi.PDF_TO_CSS_UNITS});c.style.setProperty("--scale-factor",P.scale),a?.background&&c.style.setProperty("--page-bg-color",a.background),(a?.foreground==="CanvasText"||a?.background==="Canvas")&&(c.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),c.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let x=1;x<=t;++x){let N=new Fp({container:I,eventBus:o,id:x,scale:D,defaultViewport:P.clone(),optionalContentConfigPromise:i,renderingQueue:this.renderingQueue,textLayerMode:w,annotationMode:v,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,pageColors:a,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#l});this._pages.push(N)}this._pages[0]?.setPdfPage(f),this._scrollMode===Se.PAGE?this.#C():this._spreadMode!==Xt.NONE&&this._updateSpreadMode(),this.#A(l).then(async()=>{if(e!==this.pdfDocument)return;if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#m&&document.addEventListener("copy",this.#D.bind(this,w),{signal:l}),this.#i&&o.dispatch("annotationeditormodechanged",{source:this,mode:this.#r}),e.loadingParams.disableAutoFetch||t>Cp.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let x=t-1;if(x<=0){this._pagesCapability.resolve();return}for(let N=2;N<=t;++N){let k=e.getPage(N).then(T=>{let E=this._pages[N-1];E.pdfPage||E.setPdfPage(T),--x===0&&this._pagesCapability.resolve()},T=>{console.error(`Unable to get page ${N} to initialize viewer`,T),--x===0&&this._pagesCapability.resolve()});N%Cp.PAUSE_EAGER_PAGE_INIT===0&&await k}}),o.dispatch("pagesinit",{source:this}),e.getMetadata().then(({info:x})=>{e===this.pdfDocument&&x.Language&&(c.lang=x.Language)}),this.defaultRenderingQueue&&this.update()}).catch(f=>{console.error("Unable to initialize viewer",f),this._pagesCapability.reject(f)})}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let t=0,r=this._pages.length;t<r;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=gb,this._currentScaleValue=null,this._pageLabels=null,this.#e=new Yb(GR),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=Se.VERTICAL,this._previousScrollMode=Se.UNKNOWN,this._spreadMode=Xt.NONE,this.#E={previousPageNumber:1,scrollDown:!0,pages:[]},this.#h?.abort(),this.#h=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#m?.remove(),this.#m=null,this.#j()}#C(){if(this._scrollMode!==Se.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");let e=this._currentPageNumber,t=this.#E,r=this.viewer;if(r.textContent="",t.pages.length=0,this._spreadMode===Xt.NONE&&!this.isInPresentationMode){let i=this._pages[e-1];r.append(i.div),t.pages.push(i)}else{let i=new Set,s=this._spreadMode-1;s===-1?i.add(e-1):e%2!==s?(i.add(e-1),i.add(e)):(i.add(e-2),i.add(e-1));let o=document.createElement("div");if(o.className="spread",this.isInPresentationMode){let a=document.createElement("div");a.className="dummyPage",o.append(a)}for(let a of i){let c=this._pages[a];c&&(o.append(c.div),t.pages.push(c))}r.append(o)}t.scrollDown=e>=t.previousPageNumber,t.previousPageNumber=e}_scrollUpdate(){this.pagesCount!==0&&this.update()}#M(e,t=null){let{div:r,id:i}=e;if(this._currentPageNumber!==i&&this._setCurrentPageNumber(i),this._scrollMode===Se.PAGE&&(this.#C(),this.update()),!t&&!this.isInPresentationMode){let s=r.offsetLeft+r.clientLeft,o=s+r.clientWidth,{scrollLeft:a,clientWidth:c}=this.container;(this._scrollMode===Se.HORIZONTAL||s<a||o>a+c)&&(t={left:0,top:0})}KR(r,t),!this._currentScaleValue&&this._location&&(this._location=null)}#N(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#T(e,t,{noScroll:r=!1,preset:i=!1,drawingDelay:s=-1,origin:o=null}){if(this._currentScaleValue=t.toString(),this.#N(e)){i&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:t});return}this.viewer.style.setProperty("--scale-factor",e*yi.PDF_TO_CSS_UNITS);let a=s>=0&&s<1e3;this.refresh(!0,{scale:e,drawingDelay:a?s:-1}),a&&(this.#b=setTimeout(()=>{this.#b=null,this.refresh()},s));let c=this._currentScale;if(this._currentScale=e,!r){let l=this._currentPageNumber,u;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(l=this._location.pageNumber,u=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:l,destArray:u,allowNegativeOffset:!0}),Array.isArray(o)){let h=e/c-1,[f,p]=this.containerTopLeft;this.container.scrollLeft+=(o[0]-p)*h,this.container.scrollTop+=(o[1]-f)*h}}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:i?t:void 0}),this.defaultRenderingQueue&&this.update()}get#_(){return this._spreadMode!==Xt.NONE&&this._scrollMode!==Se.HORIZONTAL?2:1}#x(e,t){let r=parseFloat(e);if(r>0)t.preset=!1,this.#T(r,e,t);else{let i=this._pages[this._currentPageNumber-1];if(!i)return;let s=gR,o=mR;this.isInPresentationMode?(s=o=4,this._spreadMode!==Xt.NONE&&(s*=2)):this.removePageBorders?s=o=0:this._scrollMode===Se.HORIZONTAL&&([s,o]=[o,s]);let a=(this.container.clientWidth-s)/i.width*i.scale/this.#_,c=(this.container.clientHeight-o)/i.height*i.scale;switch(e){case"page-actual":r=1;break;case"page-width":r=a;break;case"page-height":r=c;break;case"page-fit":r=Math.min(a,c);break;case"auto":let l=_R(i)?a:Math.min(c,a);r=Math.min(Wz,l);break;default:console.error(`#setScale: "${e}" is an unknown zoom value.`);return}t.preset=!0,this.#T(r,e,t)}}#R(){let e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#x(this._currentScaleValue,{noScroll:!0}),this.#M(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;let t=this._pageLabels.indexOf(e);return t<0?null:t+1}scrollPageIntoView({pageNumber:e,destArray:t=null,allowNegativeOffset:r=!1,ignoreDestinationZoom:i=!1}){if(!this.pdfDocument)return;let s=Number.isInteger(e)&&this._pages[e-1];if(!s){console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!t){this._setCurrentPageNumber(e,!0);return}let o=0,a=0,c=0,l=0,u,h,f=s.rotation%180!==0,p=(f?s.height:s.width)/s.scale/yi.PDF_TO_CSS_UNITS,m=(f?s.width:s.height)/s.scale/yi.PDF_TO_CSS_UNITS,v=0;switch(t[1].name){case"XYZ":o=t[2],a=t[3],v=t[4],o=o!==null?o:0,a=a!==null?a:m;break;case"Fit":case"FitB":v="page-fit";break;case"FitH":case"FitBH":a=t[2],v="page-width",a===null&&this._location?(o=this._location.left,a=this._location.top):(typeof a!="number"||a<0)&&(a=m);break;case"FitV":case"FitBV":o=t[2],c=p,l=m,v="page-height";break;case"FitR":o=t[2],a=t[3],c=t[4]-o,l=t[5]-a;let P=gR,x=mR;this.removePageBorders&&(P=x=0),u=(this.container.clientWidth-P)/c/yi.PDF_TO_CSS_UNITS,h=(this.container.clientHeight-x)/l/yi.PDF_TO_CSS_UNITS,v=Math.min(Math.abs(u),Math.abs(h));break;default:console.error(`scrollPageIntoView: "${t[1].name}" is not a valid destination type.`);return}if(i||(v&&v!==this._currentScale?this.currentScaleValue=v:this._currentScale===gb&&(this.currentScaleValue=$z)),v==="page-fit"&&!t[4]){this.#M(s);return}let w=[s.viewport.convertToViewportPoint(o,a),s.viewport.convertToViewportPoint(o+c,a+l)],I=Math.min(w[0][0],w[1][0]),D=Math.min(w[0][1],w[1][1]);r||(I=Math.max(I,0),D=Math.max(D,0)),this.#M(s,{left:I,top:D})}_updateLocation(e){let t=this._currentScale,r=this._currentScaleValue,i=parseFloat(r)===t?Math.round(t*1e4)/100:r,s=e.id,o=this._pages[s-1],a=this.container,c=o.getPagePoint(a.scrollLeft-e.x,a.scrollTop-e.y),l=Math.round(c[0]),u=Math.round(c[1]),h=`#page=${s}`;this.isInPresentationMode||(h+=`&zoom=${i},${l},${u}`),this._location={pageNumber:s,scale:i,top:u,left:l,rotation:this._pagesRotation,pdfOpenParams:h}}update(){let e=this._getVisiblePages(),t=e.views,r=t.length;if(r===0)return;let i=Math.max(GR,2*r+1);this.#e.resize(i,e.ids),this.renderingQueue.renderHighestPriority(e);let s=this._spreadMode===Xt.NONE&&(this._scrollMode===Se.PAGE||this._scrollMode===Se.VERTICAL),o=this._currentPageNumber,a=!1;for(let c of t){if(c.percent<100)break;if(c.id===o&&s){a=!0;break}}this._setCurrentPageNumber(a?o:t[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#F(){let e=this._getVisiblePages(),t=[],{ids:r,views:i}=e;for(let s of i){let{view:o}=s;if(!o.hasEditableAnnotations()){r.delete(o.id);continue}t.push(s)}return t.length===0?null:(this.renderingQueue.renderHighestPriority({first:t[0],last:t.at(-1),views:t,ids:r}),r)}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===Da.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===Da.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){let e=this._scrollMode===Se.PAGE?this.#E.pages:this._pages,t=this._scrollMode===Se.HORIZONTAL,r=t&&this._isContainerRtl;return Yz({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:t,rtl:r})}cleanup(){for(let e of this._pages)e.renderingState!==nt.FINISHED&&e.reset()}_cancelRendering(){for(let e of this._pages)e.cancelRendering()}async#U(e){if(e.pdfPage)return e.pdfPage;try{let t=await this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),t}catch(t){return console.error("Unable to get page for page view",t),null}}#B(e){if(e.first?.id===1)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case Se.PAGE:return this.#E.scrollDown;case Se.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){let t=e||this._getVisiblePages(),r=this.#B(t),i=this._spreadMode!==Xt.NONE&&this._scrollMode!==Se.HORIZONTAL,s=this.renderingQueue.getHighestPriority(t,this._pages,r,i);return s?(this.#U(s).then(()=>{this.renderingQueue.renderView(s)}),!0):!1}get hasEqualPageSizes(){let e=this._pages[0];for(let t=1,r=this._pages.length;t<r;++t){let i=this._pages[t];if(i.width!==e.width||i.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map(t=>{let r=t.pdfPage.getViewport({scale:1}),i=_R(r);if(e===void 0)e=i;else if(this.enablePrintAutoRotate&&i!==e)return{width:r.height,height:r.width,rotation:(r.rotation-90)%360};return{width:r.width,height:r.height,rotation:r.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!Qz(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>Cp.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){let t=this._scrollMode,r=this.viewer;r.classList.toggle("scrollHorizontal",t===Se.HORIZONTAL),r.classList.toggle("scrollWrapped",t===Se.WRAPPED),!(!this.pdfDocument||!e)&&(t===Se.PAGE?this.#C():this._previousScrollMode===Se.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#x(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!Xz(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;let t=this.viewer,r=this._pages;if(this._scrollMode===Se.PAGE)this.#C();else if(t.textContent="",this._spreadMode===Xt.NONE)for(let i of this._pages)t.append(i.div);else{let i=this._spreadMode-1,s=null;for(let o=0,a=r.length;o<a;++o)s===null?(s=document.createElement("div"),s.className="spread",t.append(s)):o%2===i&&(s=s.cloneNode(!1),t.append(s)),s.append(r[o].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#x(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,t=!1){switch(this._scrollMode){case Se.WRAPPED:{let{views:r}=this._getVisiblePages(),i=new Map;for(let{id:s,y:o,percent:a,widthPercent:c}of r){if(a===0||c<100)continue;let l=i.get(o);l||i.set(o,l||=[]),l.push(s)}for(let s of i.values()){let o=s.indexOf(e);if(o===-1)continue;let a=s.length;if(a===1)break;if(t)for(let c=o-1,l=0;c>=l;c--){let u=s[c],h=s[c+1]-1;if(u<h)return e-h}else for(let c=o+1,l=a;c<l;c++){let u=s[c],h=s[c-1]+1;if(u>h)return h-e}if(t){let c=s[0];if(c<e)return e-c+1}else{let c=s[a-1];if(c>e)return c-e+1}break}break}case Se.HORIZONTAL:break;case Se.PAGE:case Se.VERTICAL:{if(this._spreadMode===Xt.NONE)break;let r=this._spreadMode-1;if(t&&e%2!==r)break;if(!t&&e%2===r)break;let{views:i}=this._getVisiblePages(),s=t?e-1:e+1;for(let{id:o,percent:a,widthPercent:c}of i)if(o===s){if(a>0&&c===100)return 2;break}break}}return 1}nextPage(){let e=this._currentPageNumber,t=this.pagesCount;if(e>=t)return!1;let r=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+r,t),!0}previousPage(){let e=this._currentPageNumber;if(e<=1)return!1;let t=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-t,1),!0}updateScale({drawingDelay:e,scaleFactor:t=null,steps:r=null,origin:i}){if(r===null&&t===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let s=this._currentScale;if(t>0&&t!==1)s=Math.round(s*t*100)/100;else if(r){let o=r>0?pR:1/pR,a=r>0?Math.ceil:Math.floor;r=Math.abs(r);do s=a((s*o).toFixed(2)*10)/10;while(--r>0)}s=Math.max(zz,Math.min(Gz,s)),this.#x(s,{noScroll:!1,drawingDelay:e,origin:i})}increaseScale(e={}){this.updateScale(J(L({},e),{steps:e.steps??1}))}decreaseScale(e={}){this.updateScale(J(L({},e),{steps:-(e.steps??1)}))}#L(e=this.container.clientHeight){e!==this.#w&&(this.#w=e,Jz.setProperty("--viewer-container-height",`${e}px`))}#V(e){for(let t of e)if(t.target===this.container){this.#L(Math.floor(t.borderBoxSize[0].blockSize)),this.#c=null;break}}get containerTopLeft(){return this.#c||=[this.container.offsetTop,this.container.offsetLeft]}#j(){this.#f?.abort(),this.#f=null,this.#g!==null&&(clearTimeout(this.#g),this.#g=null)}get annotationEditorMode(){return this.#i?this.#r:Dn.DISABLE}set annotationEditorMode({mode:e,editId:t=null,isFromKeyboard:r=!1}){if(!this.#i)throw new Error("The AnnotationEditor is not enabled.");if(this.#r===e)return;if(!WR(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);if(!this.pdfDocument)return;e===Dn.STAMP&&this.#p?.loadModel("altText");let{eventBus:i}=this,s=()=>{this.#j(),this.#r=e,this.#i.updateMode(e,t,r),i.dispatch("annotationeditormodechanged",{source:this,mode:e})};if(e===Dn.NONE||this.#r===Dn.NONE){let o=e!==Dn.NONE;o||this.pdfDocument.annotationStorage.resetModifiedIds();for(let c of this._pages)c.toggleEditingMode(o);let a=this.#F();if(o&&a){this.#j(),this.#f=new AbortController;let c=AbortSignal.any([this.#h.signal,this.#f.signal]);i._on("pagerendered",({pageNumber:l})=>{a.delete(l),a.size===0&&(this.#g=setTimeout(s,0))},{signal:c});return}}s()}refresh(e=!1,t=Object.create(null)){if(this.pdfDocument){for(let r of this._pages)r.update(t);this.#b!==null&&(clearTimeout(this.#b),this.#b=null),e||this.update()}}},Qb=class extends Vp{_resetView(){super._resetView(),this._scrollMode=Se.PAGE,this._spreadMode=Xt.NONE}set scrollMode(e){}_updateScrollMode(){}set spreadMode(e){}_updateSpreadMode(){}};var x3=Je.AnnotationLayerBuilder,P3=Je.DownloadManager,M3=Je.EventBus,R3=Je.FindState,Xb=Je.GenericL10n,ho=Je.LinkTarget,Jb=Je.PDFFindController,N3=Je.PDFHistory,Zb=Je.PDFLinkService,O3=Je.PDFPageView,k3=Je.PDFScriptingManager,eI=Je.PDFSinglePageViewer,tI=Je.PDFViewer,L3=Je.ProgressBar,F3=Je.RenderingStates,V3=Je.ScrollMode,j3=Je.SimpleLinkService,B3=Je.SpreadMode,U3=Je.StructTreeLayerBuilder,H3=Je.TextLayerBuilder,$3=Je.XfaLayerBuilder,z3=Je.parseQueryString;var G3=["pdfViewerContainer"];function W3(n,e){let t=new n.EventBus;return q3(t,e),t}function q3(n,e){Ke(n,"documentload").pipe(Ve(e)).subscribe(()=>{let t=document.createEvent("CustomEvent");t.initCustomEvent("documentload",!0,!0,{}),window.dispatchEvent(t)}),Ke(n,"pagerendered").pipe(Ve(e)).subscribe(({pageNumber:t,cssTransform:r,source:i})=>{let s=document.createEvent("CustomEvent");s.initCustomEvent("pagerendered",!0,!0,{pageNumber:t,cssTransform:r}),i.div.dispatchEvent(s)}),Ke(n,"textlayerrendered").pipe(Ve(e)).subscribe(({pageNumber:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("textlayerrendered",!0,!0,{pageNumber:t}),r.textLayerDiv?.dispatchEvent(i)}),Ke(n,"pagechanging").pipe(Ve(e)).subscribe(({pageNumber:t,source:r})=>{let i=document.createEvent("UIEvents");i.initEvent("pagechanging",!0,!0),i.pageNumber=t,r.container.dispatchEvent(i)}),Ke(n,"pagesinit").pipe(Ve(e)).subscribe(({source:t})=>{let r=document.createEvent("CustomEvent");r.initCustomEvent("pagesinit",!0,!0,null),t.container.dispatchEvent(r)}),Ke(n,"pagesloaded").pipe(Ve(e)).subscribe(({pagesCount:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("pagesloaded",!0,!0,{pagesCount:t}),r.container.dispatchEvent(i)}),Ke(n,"scalechange").pipe(Ve(e)).subscribe(({scale:t,presetValue:r,source:i})=>{let s=document.createEvent("UIEvents");s.initEvent("scalechange",!0,!0),s.scale=t,s.presetValue=r,i.container.dispatchEvent(s)}),Ke(n,"updateviewarea").pipe(Ve(e)).subscribe(({location:t,source:r})=>{let i=document.createEvent("UIEvents");i.initEvent("updateviewarea",!0,!0),i.location=t,r.container.dispatchEvent(i)}),Ke(n,"find").pipe(Ve(e)).subscribe(({source:t,type:r,query:i,phraseSearch:s,caseSensitive:o,highlightAll:a,findPrevious:c})=>{if(t===window)return;let l=document.createEvent("CustomEvent");l.initCustomEvent("find"+r,!0,!0,{query:i,phraseSearch:s,caseSensitive:o,highlightAll:a,findPrevious:c}),window.dispatchEvent(l)}),Ke(n,"attachmentsloaded").pipe(Ve(e)).subscribe(({attachmentsCount:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("attachmentsloaded",!0,!0,{attachmentsCount:t}),r.container.dispatchEvent(i)}),Ke(n,"sidebarviewchanged").pipe(Ve(e)).subscribe(({view:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("sidebarviewchanged",!0,!0,{view:t}),r.outerContainer.dispatchEvent(i)}),Ke(n,"pagemode").pipe(Ve(e)).subscribe(({mode:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("pagemode",!0,!0,{mode:t}),r.pdfViewer.container.dispatchEvent(i)}),Ke(n,"namedaction").pipe(Ve(e)).subscribe(({action:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("namedaction",!0,!0,{action:t}),r.pdfViewer.container.dispatchEvent(i)}),Ke(n,"presentationmodechanged").pipe(Ve(e)).subscribe(({active:t,switchInProgress:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("presentationmodechanged",!0,!0,{active:t,switchInProgress:r}),window.dispatchEvent(i)}),Ke(n,"outlineloaded").pipe(Ve(e)).subscribe(({outlineCount:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("outlineloaded",!0,!0,{outlineCount:t}),r.container.dispatchEvent(i)})}function rI(n,e,t){n[e]=t}function uu(){return typeof window>"u"}uu()||rI(Sa,"verbosity",fb.INFOS);typeof Promise.withResolvers>"u"&&window&&(window.Promise.withResolvers=()=>{let n,e;return{promise:new Promise((r,i)=>{n=r,e=i}),resolve:n,reject:e}});var iI=(function(n){return n[n.DISABLED=0]="DISABLED",n[n.ENABLED=1]="ENABLED",n[n.ENHANCED=2]="ENHANCED",n})(iI||{}),ZR=(()=>{class n{element;ngZone;static CSS_UNITS=96/72;static BORDER_WIDTH=9;pdfViewerContainer;eventBus;pdfLinkService;pdfFindController;pdfViewer;isVisible=!1;_cMapsUrl=typeof Sa<"u"?`https://unpkg.com/pdfjs-dist@${ru}/cmaps/`:null;_imageResourcesPath=typeof Sa<"u"?`https://unpkg.com/pdfjs-dist@${ru}/web/images/`:void 0;_renderText=!0;_renderTextMode=iI.ENABLED;_stickToPage=!1;_originalSize=!0;_pdf;_page=1;_zoom=1;_zoomScale="page-width";_rotation=0;_showAll=!0;_canAutoResize=!0;_fitToPage=!1;_externalLinkTarget="blank";_showBorders=!1;lastLoaded;_latestScrolledPage;pageScrollTimeout=null;isInitialized=!1;loadingTask;destroy$=new _t;afterLoadComplete=new $e;pageRendered=new $e;pageInitialized=new $e;textLayerRendered=new $e;onError=new $e;onProgress=new $e;pageChange=new $e(!0);src;set cMapsUrl(t){this._cMapsUrl=t}set page(t){t=parseInt(t,10)||1;let r=t;this._pdf&&(t=this.getValidPageNumber(t)),this._page=t,r!==t&&this.pageChange.emit(t)}set renderText(t){this._renderText=t}set renderTextMode(t){this._renderTextMode=t}set originalSize(t){this._originalSize=t}set showAll(t){this._showAll=t}set stickToPage(t){this._stickToPage=t}set zoom(t){t<=0||(this._zoom=t)}get zoom(){return this._zoom}set zoomScale(t){this._zoomScale=t}get zoomScale(){return this._zoomScale}set rotation(t){if(!(typeof t=="number"&&t%90===0)){console.warn("Invalid pages rotation angle.");return}this._rotation=t}set externalLinkTarget(t){this._externalLinkTarget=t}set autoresize(t){this._canAutoResize=!!t}set fitToPage(t){this._fitToPage=!!t}set showBorders(t){this._showBorders=!!t}static getLinkTarget(t){switch(t){case"blank":return ho.BLANK;case"none":return ho.NONE;case"self":return ho.SELF;case"parent":return ho.PARENT;case"top":return ho.TOP}return null}constructor(t,r){if(this.element=t,this.ngZone=r,uu())return;let i,s=ru,o=window[`pdfWorkerSrc${s}`];o?i=o:window.hasOwnProperty("pdfWorkerSrc")&&typeof window.pdfWorkerSrc=="string"&&window.pdfWorkerSrc?i=window.pdfWorkerSrc:i=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${s}/legacy/build/pdf.worker.min.mjs`,rI(hb,"workerSrc",i)}ngAfterViewChecked(){if(this.isInitialized)return;let t=this.pdfViewerContainer.nativeElement.offsetParent;if(this.isVisible===!0&&t==null){this.isVisible=!1;return}this.isVisible===!1&&t!=null&&(this.isVisible=!0,setTimeout(()=>{this.initialize(),this.ngOnChanges({src:this.src})}))}ngOnInit(){this.initialize(),this.setupResizeListener()}ngOnDestroy(){this.clear(),this.destroy$.next(),this.loadingTask=null}ngOnChanges(t){if(!(uu()||!this.isVisible)){if("src"in t)this.loadPDF();else if(this._pdf){if(("renderText"in t||"showAll"in t)&&(this.setupViewer(),this.resetPdfDocument()),"page"in t){let{page:r}=t;if(r.currentValue===this._latestScrolledPage)return;this.pdfViewer.scrollPageIntoView({pageNumber:this._page})}this.update()}}}updateSize(){qe(this._pdf.getPage(this.pdfViewer.currentPageNumber)).pipe(Ve(this.destroy$)).subscribe({next:t=>{let r=this._rotation+t.rotate,i=t.getViewport({scale:this._zoom,rotation:r}).width*n.CSS_UNITS,s=this._zoom,o=!0;if(!this._originalSize||this._fitToPage&&i>this.pdfViewerContainer.nativeElement.clientWidth){let a=t.getViewport({scale:1,rotation:r});s=this.getScale(a.width,a.height),o=!this._stickToPage}this.pdfViewer.currentScale=s,o&&this.pdfViewer.scrollPageIntoView({pageNumber:t.pageNumber,ignoreDestinationZoom:!0})}})}clear(){this.loadingTask&&!this.loadingTask.destroyed&&this.loadingTask.destroy(),this._pdf&&(this._latestScrolledPage=0,this._pdf.destroy(),this._pdf=void 0),this.pdfViewer&&this.pdfViewer.setDocument(null),this.pdfLinkService&&this.pdfLinkService.setDocument(null,null),this.pdfFindController&&this.pdfFindController.setDocument(null)}getPDFLinkServiceConfig(){let t=n.getLinkTarget(this._externalLinkTarget);return t?{externalLinkTarget:t}:{}}initEventBus(){this.eventBus=W3(nI,this.destroy$),Ke(this.eventBus,"pagerendered").pipe(Ve(this.destroy$)).subscribe(t=>{this.pageRendered.emit(t)}),Ke(this.eventBus,"pagesinit").pipe(Ve(this.destroy$)).subscribe(t=>{this.pageInitialized.emit(t)}),Ke(this.eventBus,"pagechanging").pipe(Ve(this.destroy$)).subscribe(({pageNumber:t})=>{this.pageScrollTimeout&&clearTimeout(this.pageScrollTimeout),this.pageScrollTimeout=window.setTimeout(()=>{this._latestScrolledPage=t,this.pageChange.emit(t)},100)}),Ke(this.eventBus,"textlayerrendered").pipe(Ve(this.destroy$)).subscribe(t=>{this.textLayerRendered.emit(t)})}initPDFServices(){this.pdfLinkService=new Zb(L({eventBus:this.eventBus},this.getPDFLinkServiceConfig())),this.pdfFindController=new Jb({eventBus:this.eventBus,linkService:this.pdfLinkService})}getPDFOptions(){return{eventBus:this.eventBus,container:this.element.nativeElement.querySelector("div"),removePageBorders:!this._showBorders,linkService:this.pdfLinkService,textLayerMode:this._renderText?this._renderTextMode:iI.DISABLED,findController:this.pdfFindController,l10n:new Xb("en"),imageResourcesPath:this._imageResourcesPath,annotationEditorMode:db.DISABLE}}setupViewer(){this.pdfViewer&&this.pdfViewer.setDocument(null),rI(Sa,"disableTextLayer",!this._renderText),this.initPDFServices(),this._showAll?this.pdfViewer=new tI(this.getPDFOptions()):this.pdfViewer=new eI(this.getPDFOptions()),this.pdfLinkService.setViewer(this.pdfViewer),this.pdfViewer._currentPageNumber=this._page}getValidPageNumber(t){return t<1?1:t>this._pdf.numPages?this._pdf.numPages:t}getDocumentParams(){let t=typeof this.src;if(!this._cMapsUrl)return this.src;let r={cMapUrl:this._cMapsUrl,cMapPacked:!0,enableXfa:!0};return r.isEvalSupported=!1,t==="string"?r.url=this.src:t==="object"&&(this.src.byteLength!==void 0?r.data=this.src:Object.assign(r,this.src)),r}loadPDF(){if(!this.src)return;if(this.lastLoaded===this.src){this.update();return}this.clear(),this.setupViewer(),this.loadingTask=pb(this.getDocumentParams()),this.loadingTask.onProgress=r=>{this.onProgress.emit(r)};let t=this.src;qe(this.loadingTask.promise).pipe(Ve(this.destroy$)).subscribe({next:r=>{this._pdf=r,this.lastLoaded=t,this.afterLoadComplete.emit(r),this.resetPdfDocument(),this.update()},error:r=>{this.lastLoaded=null,this.onError.emit(r)}})}update(){this.page=this._page,this.render()}render(){if(this._page=this.getValidPageNumber(this._page),(this._rotation!==0||this.pdfViewer.pagesRotation!==this._rotation)&&this.pdfViewer.firstPagePromise?.then(()=>this.pdfViewer.pagesRotation=this._rotation),this._stickToPage&&setTimeout(()=>{this.pdfViewer.currentPageNumber=this._page}),this.pdfViewer._pages?.length)this.updateSize();else{let t=this.pageInitialized.subscribe(()=>{this.updateSize(),t.unsubscribe()})}}getScale(t,r){let i=this._showBorders?2*n.BORDER_WIDTH:0,s=this.pdfViewerContainer.nativeElement.clientWidth-i,o=this.pdfViewerContainer.nativeElement.clientHeight-i;if(o===0||r===0||s===0||t===0)return 1;let a=1;switch(this._zoomScale){case"page-fit":a=Math.min(o/r,s/t);break;case"page-height":a=o/r;break;case"page-width":default:a=s/t;break}return this._zoom*a/n.CSS_UNITS}resetPdfDocument(){this.pdfLinkService.setDocument(this._pdf,null),this.pdfFindController.setDocument(this._pdf),this.pdfViewer.setDocument(this._pdf)}initialize(){uu()||!this.isVisible||(this.isInitialized=!0,this.initEventBus(),this.setupViewer())}setupResizeListener(){uu()||this.ngZone.runOutsideAngular(()=>{Ke(window,"resize").pipe(Fy(100),qt(()=>this._canAutoResize&&!!this._pdf),Ve(this.destroy$)).subscribe(()=>{this.updateSize()})})}static \u0275fac=function(r){return new(r||n)(tt(Dr),tt(dt))};static \u0275cmp=Tn({type:n,selectors:[["pdf-viewer"]],viewQuery:function(r,i){if(r&1&&tw(G3,5),r&2){let s;tf(s=nf())&&(i.pdfViewerContainer=s.first)}},inputs:{src:"src",cMapsUrl:[0,"c-maps-url","cMapsUrl"],page:"page",renderText:[0,"render-text","renderText"],renderTextMode:[0,"render-text-mode","renderTextMode"],originalSize:[0,"original-size","originalSize"],showAll:[0,"show-all","showAll"],stickToPage:[0,"stick-to-page","stickToPage"],zoom:"zoom",zoomScale:[0,"zoom-scale","zoomScale"],rotation:"rotation",externalLinkTarget:[0,"external-link-target","externalLinkTarget"],autoresize:"autoresize",fitToPage:[0,"fit-to-page","fitToPage"],showBorders:[0,"show-borders","showBorders"]},outputs:{afterLoadComplete:"after-load-complete",pageRendered:"page-rendered",pageInitialized:"pages-initialized",textLayerRendered:"text-layer-rendered",onError:"error",onProgress:"on-progress",pageChange:"pageChange"},standalone:!1,features:[Xs],decls:3,vars:0,consts:[["pdfViewerContainer",""],[1,"ng2-pdf-viewer-container"],[1,"pdfViewer"]],template:function(r,i){r&1&&(Y(0,"div",1,0),Ot(2,"div",2),Q())},styles:[`.ng2-pdf-viewer-container[_ngcontent-%COMP%]{overflow-x:auto;position:absolute;height:100%;width:100%;-webkit-overflow-scrolling:touch}[_nghost-%COMP%]{display:block;position:relative}[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 0;--page-margin: 1px auto -8px;--page-border: 9px solid transparent;--spreadHorizontalWrapped-margin-LR: -3.5px;--viewer-container-height: 0;--annotation-unfocused-field-background: url("data:image/svg+xml;charset=UTF-8,<svg width='1px' height='1px' xmlns='http://www.w3.org/2000/svg'><rect width='100%' height='100%' style='fill:rgba(0, 54, 255, 0.13);'/></svg>");--xfa-unfocused-field-background: var( --annotation-unfocused-field-background );--page-border-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAA1ElEQVQ4jbWUWw6EIAxFy2NFs/8NzR4UJhpqLsdi5mOmSSMUOfYWqv3S0gMr4XlYH/64gZa/gN3ANYA7KAXALt4ktoQ5MI9YxqaG8bWmsIysMuT6piSQCa4whZThCu8CM4zP9YJaKci9jicPq3NcBWYoPMGUlhG7ivtkB+gVyFY75wXghOvh8t5mto1Mdim6e+MBqH6XsY+YAwjpq3vGF7weTWQptLEDVCZvPTMl5JZZsdh47FHW6qFMyvLYqjcnmdFfY9Xk/KDOlzCusX2mi/ofM7MPkzBcSp4Q1/wAAAAASUVORK5CYII=) 9 9 repeat;--scale-factor: 1;--focus-outline: solid 2px blue;--hover-outline: dashed 2px blue;--freetext-line-height: 1.35;--freetext-padding: 2px;--editorInk-editing-cursor: pointer}@media screen and (forced-colors: active){[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 9px;--page-margin: 8px auto -1px;--page-border: 1px solid CanvasText;--page-border-image: none;--spreadHorizontalWrapped-margin-LR: 3.5px}}@media (forced-colors: active){[_nghost-%COMP%]    {--focus-outline: solid 3px ButtonText;--hover-outline: dashed 3px ButtonText}}[_nghost-%COMP%]     .textLayer{position:absolute;text-align:initial;inset:0;overflow:hidden;opacity:.2;line-height:1;-webkit-text-size-adjust:none;text-size-adjust:none;forced-color-adjust:none;transform-origin:0 0}[_nghost-%COMP%]     .textLayer span, [_nghost-%COMP%]     .textLayer br{color:transparent;position:absolute;white-space:pre;cursor:text;transform-origin:0% 0%}[_nghost-%COMP%]     .textLayer span.markedContent{top:0;height:0}[_nghost-%COMP%]     .textLayer .highlight{margin:-1px;padding:1px;background-color:#b400aa;border-radius:4px}[_nghost-%COMP%]     .textLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .textLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .textLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .textLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .textLayer .highlight.selected{background-color:#006400}[_nghost-%COMP%]     .textLayer ::selection{background:rgb(0,0,255)}[_nghost-%COMP%]     .textLayer br::selection{background:transparent}[_nghost-%COMP%]     .textLayer .endOfContent{display:block;position:absolute;inset:100% 0 0;z-index:-1;cursor:default;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]     .textLayer .endOfContent.active{top:0}@media (forced-colors: active){[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:required, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:required, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:required{outline:1.5px solid selectedItem}}[_nghost-%COMP%]     .annotationLayer{position:absolute;top:0;left:0;pointer-events:none;transform-origin:0 0}[_nghost-%COMP%]     .annotationLayer section{position:absolute;text-align:initial;pointer-events:auto;box-sizing:border-box;transform-origin:0 0}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a{position:absolute;font-size:1em;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>canvas{width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a:hover{opacity:.2;background:rgb(255,255,0);box-shadow:0 2px 10px #ff0}[_nghost-%COMP%]     .annotationLayer .textAnnotation img{position:absolute;cursor:pointer;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{background-image:var(--annotation-unfocused-field-background);border:1px solid transparent;box-sizing:border-box;font:calc(9px * var(--scale-factor)) sans-serif;height:100%;margin:0;vertical-align:top;width:100%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:required, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:required, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:required{outline:1.5px solid red}[_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select option{padding:0}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{border-radius:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea{resize:none}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input[disabled], [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea[disabled], [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input[disabled]{background:none;border:1px solid transparent;cursor:not-allowed}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:hover, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:hover, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:hover{border:1px solid rgb(0,0,0)}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:focus{background:none;border:1px solid transparent}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input :focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea :focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton :focus{background-image:none;background-color:transparent;outline:auto}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{background-color:CanvasText;content:"";display:block;position:absolute}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{height:80%;left:45%;width:1px}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before{transform:rotate(45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{transform:rotate(-45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{border-radius:50%;height:50%;left:30%;top:20%;width:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb{font-family:monospace;padding-left:2px;padding-right:0}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb:focus{width:103%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{-webkit-appearance:none;appearance:none}[_nghost-%COMP%]     .annotationLayer .popupTriggerArea{height:100%;width:100%}[_nghost-%COMP%]     .annotationLayer .popupWrapper{position:absolute;font-size:calc(9px * var(--scale-factor));width:100%;min-width:calc(180px * var(--scale-factor));pointer-events:none}[_nghost-%COMP%]     .annotationLayer .popup{position:absolute;max-width:calc(180px * var(--scale-factor));background-color:#ff9;box-shadow:0 calc(2px * var(--scale-factor)) calc(5px * var(--scale-factor)) #888;border-radius:calc(2px * var(--scale-factor));padding:calc(6px * var(--scale-factor));margin-left:calc(5px * var(--scale-factor));cursor:pointer;font:message-box;white-space:normal;word-wrap:break-word;pointer-events:auto}[_nghost-%COMP%]     .annotationLayer .popup>*{font-size:calc(9px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .popup h1{display:inline-block}[_nghost-%COMP%]     .annotationLayer .popupDate{display:inline-block;margin-left:calc(5px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .popupContent{border-top:1px solid rgb(51,51,51);margin-top:calc(2px * var(--scale-factor));padding-top:calc(2px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .richText>*{white-space:pre-wrap;font-size:calc(9px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .highlightAnnotation, [_nghost-%COMP%]     .annotationLayer .underlineAnnotation, [_nghost-%COMP%]     .annotationLayer .squigglyAnnotation, [_nghost-%COMP%]     .annotationLayer .strikeoutAnnotation, [_nghost-%COMP%]     .annotationLayer .freeTextAnnotation, [_nghost-%COMP%]     .annotationLayer .lineAnnotation svg line, [_nghost-%COMP%]     .annotationLayer .squareAnnotation svg rect, [_nghost-%COMP%]     .annotationLayer .circleAnnotation svg ellipse, [_nghost-%COMP%]     .annotationLayer .polylineAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .polygonAnnotation svg polygon, [_nghost-%COMP%]     .annotationLayer .caretAnnotation, [_nghost-%COMP%]     .annotationLayer .inkAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .stampAnnotation, [_nghost-%COMP%]     .annotationLayer .fileAttachmentAnnotation{cursor:pointer}[_nghost-%COMP%]     .annotationLayer section svg{position:absolute;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .annotationTextContent{position:absolute;width:100%;height:100%;opacity:0;color:transparent;-webkit-user-select:none;user-select:none;pointer-events:none}[_nghost-%COMP%]     .annotationLayer .annotationTextContent span{width:100%;display:inline-block}@media (forced-colors: active){[_nghost-%COMP%]     .xfaLayer *:required{outline:1.5px solid selectedItem}}[_nghost-%COMP%]     .xfaLayer .highlight{margin:-1px;padding:1px;background-color:#efcbed;border-radius:4px}[_nghost-%COMP%]     .xfaLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .xfaLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .xfaLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .xfaLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .xfaLayer .highlight.selected{background-color:#cbdfcb}[_nghost-%COMP%]     .xfaLayer ::selection{background:rgb(0,0,255)}[_nghost-%COMP%]     .xfaPage{overflow:hidden;position:relative}[_nghost-%COMP%]     .xfaContentarea{position:absolute}[_nghost-%COMP%]     .xfaPrintOnly{display:none}[_nghost-%COMP%]     .xfaLayer{position:absolute;text-align:initial;top:0;left:0;transform-origin:0 0;line-height:1.2}[_nghost-%COMP%]     .xfaLayer *{color:inherit;font:inherit;font-style:inherit;font-weight:inherit;font-kerning:inherit;letter-spacing:-.01px;text-align:inherit;text-decoration:inherit;box-sizing:border-box;background-color:transparent;padding:0;margin:0;pointer-events:auto;line-height:inherit}[_nghost-%COMP%]     .xfaLayer *:required{outline:1.5px solid red}[_nghost-%COMP%]     .xfaLayer div{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg *{pointer-events:none}[_nghost-%COMP%]     .xfaLayer a{color:#00f}[_nghost-%COMP%]     .xfaRich li{margin-left:3em}[_nghost-%COMP%]     .xfaFont{color:#000;font-weight:400;font-kerning:none;font-size:10px;font-style:normal;letter-spacing:0;text-decoration:none;vertical-align:0}[_nghost-%COMP%]     .xfaCaption{overflow:hidden;flex:0 0 auto}[_nghost-%COMP%]     .xfaCaptionForCheckButton{overflow:hidden;flex:1 1 auto}[_nghost-%COMP%]     .xfaLabel{height:100%;width:100%}[_nghost-%COMP%]     .xfaLeft{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]     .xfaRight{display:flex;flex-direction:row-reverse;align-items:center}[_nghost-%COMP%]     .xfaLeft>.xfaCaption, [_nghost-%COMP%]     .xfaLeft>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaRight>.xfaCaption, [_nghost-%COMP%]     .xfaRight>.xfaCaptionForCheckButton{max-height:100%}[_nghost-%COMP%]     .xfaTop{display:flex;flex-direction:column;align-items:flex-start}[_nghost-%COMP%]     .xfaBottom{display:flex;flex-direction:column-reverse;align-items:flex-start}[_nghost-%COMP%]     .xfaTop>.xfaCaption, [_nghost-%COMP%]     .xfaTop>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaBottom>.xfaCaption, [_nghost-%COMP%]     .xfaBottom>.xfaCaptionForCheckButton{width:100%}[_nghost-%COMP%]     .xfaBorder{background-color:transparent;position:absolute;pointer-events:none}[_nghost-%COMP%]     .xfaWrapped{width:100%;height:100%}[_nghost-%COMP%]     .xfaTextfield:focus, [_nghost-%COMP%]     .xfaSelect:focus{background-image:none;background-color:transparent;outline:auto;outline-offset:-1px}[_nghost-%COMP%]     .xfaCheckbox:focus, [_nghost-%COMP%]     .xfaRadio:focus{outline:auto}[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{height:100%;width:100%;flex:1 1 auto;border:none;resize:none;background-image:var(--xfa-unfocused-field-background)}[_nghost-%COMP%]     .xfaTop>.xfaTextfield, [_nghost-%COMP%]     .xfaTop>.xfaSelect, [_nghost-%COMP%]     .xfaBottom>.xfaTextfield, [_nghost-%COMP%]     .xfaBottom>.xfaSelect{flex:0 1 auto}[_nghost-%COMP%]     .xfaButton{cursor:pointer;width:100%;height:100%;border:none;text-align:center}[_nghost-%COMP%]     .xfaLink{width:100%;height:100%;position:absolute;top:0;left:0}[_nghost-%COMP%]     .xfaCheckbox, [_nghost-%COMP%]     .xfaRadio{width:100%;height:100%;flex:0 0 auto;border:none}[_nghost-%COMP%]     .xfaRich{white-space:pre-wrap;width:100%;height:100%}[_nghost-%COMP%]     .xfaImage{object-position:left top;object-fit:contain;width:100%;height:100%}[_nghost-%COMP%]     .xfaLrTb, [_nghost-%COMP%]     .xfaRlTb, [_nghost-%COMP%]     .xfaTb{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaLr{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaRl{display:flex;flex-direction:row-reverse;align-items:stretch}[_nghost-%COMP%]     .xfaTb>div{justify-content:left}[_nghost-%COMP%]     .xfaPosition{position:relative}[_nghost-%COMP%]     .xfaArea{position:relative}[_nghost-%COMP%]     .xfaValignMiddle{display:flex;align-items:center}[_nghost-%COMP%]     .xfaTable{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRow{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRlRow{display:flex;flex-direction:row-reverse;align-items:stretch;flex:1}[_nghost-%COMP%]     .xfaTable .xfaRlRow>div{flex:1}[_nghost-%COMP%]     .xfaNonInteractive input, [_nghost-%COMP%]     .xfaNonInteractive textarea, [_nghost-%COMP%]     .xfaDisabled input, [_nghost-%COMP%]     .xfaDisabled textarea, [_nghost-%COMP%]     .xfaReadOnly input, [_nghost-%COMP%]     .xfaReadOnly textarea{background:initial}@media print{[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{background:transparent}[_nghost-%COMP%]     .xfaSelect{-webkit-appearance:none;appearance:none;text-indent:1px;text-overflow:""}}[_nghost-%COMP%]     [data-editor-rotation="90"]{transform:rotate(90deg)}[_nghost-%COMP%]     [data-editor-rotation="180"]{transform:rotate(180deg)}[_nghost-%COMP%]     [data-editor-rotation="270"]{transform:rotate(270deg)}[_nghost-%COMP%]     .annotationEditorLayer{background:transparent;position:absolute;top:0;left:0;font-size:calc(100px * var(--scale-factor));transform-origin:0 0}[_nghost-%COMP%]     .annotationEditorLayer .selectedEditor{outline:var(--focus-outline);resize:none}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor{position:absolute;background:transparent;border-radius:3px;padding:calc(var(--freetext-padding) * var(--scale-factor));resize:none;width:auto;height:auto;z-index:1;transform-origin:0 0;touch-action:none}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal{background:transparent;border:none;top:0;left:0;overflow:visible;white-space:nowrap;resize:none;font:10px sans-serif;line-height:var(--freetext-line-height)}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .overlay{position:absolute;display:none;background:transparent;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .overlay.enabled{display:block}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal:empty:before{content:attr(default-content);color:gray}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal:focus{outline:none}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.disabled{resize:none}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.disabled.selectedEditor{resize:horizontal}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor:hover:not(.selectedEditor), [_nghost-%COMP%]     .annotationEditorLayer .inkEditor:hover:not(.selectedEditor){outline:var(--hover-outline)}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor{position:absolute;background:transparent;border-radius:3px;overflow:auto;width:100%;height:100%;z-index:1;transform-origin:0 0;cursor:auto}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.editing{resize:none;cursor:var(--editorInk-editing-cursor),pointer}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor .inkEditorCanvas{position:absolute;top:0;left:0;width:100%;height:100%;touch-action:none}[_nghost-%COMP%]     [data-main-rotation="90"]{transform:rotate(90deg) translateY(-100%)}[_nghost-%COMP%]     [data-main-rotation="180"]{transform:rotate(180deg) translate(-100%,-100%)}[_nghost-%COMP%]     [data-main-rotation="270"]{transform:rotate(270deg) translate(-100%)}[_nghost-%COMP%]     .pdfViewer{padding-bottom:var(--pdfViewer-padding-bottom)}[_nghost-%COMP%]     .pdfViewer .canvasWrapper{overflow:hidden}[_nghost-%COMP%]     .pdfViewer .canvasWrapper canvas{width:100%}[_nghost-%COMP%]     .pdfViewer .page{direction:ltr;width:816px;height:1056px;margin:var(--page-margin);position:relative;overflow:visible;border:var(--page-border);border-image:var(--page-border-image);background-clip:content-box;background-color:#fff}[_nghost-%COMP%]     .pdfViewer .dummyPage{position:relative;width:0;height:var(--viewer-container-height)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .page{margin:0 auto 10px;border:none}[_nghost-%COMP%]     .pdfViewer.singlePageView{display:inline-block}[_nghost-%COMP%]     .pdfViewer.singlePageView .page{margin:0;border:none}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .pdfViewer.scrollWrapped, [_nghost-%COMP%]     .spread{margin-left:3.5px;margin-right:3.5px;text-align:center}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .spread{white-space:nowrap}[_nghost-%COMP%]     .pdfViewer.removePageBorders, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{margin-left:0;margin-right:0}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .spread .dummyPage, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{display:inline-block;vertical-align:middle}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page{margin-left:var(--spreadHorizontalWrapped-margin-LR);margin-right:var(--spreadHorizontalWrapped-margin-LR)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .spread .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollWrapped .page{margin-left:5px;margin-right:5px}[_nghost-%COMP%]     .pdfViewer .page canvas{margin:0;display:block}[_nghost-%COMP%]     .pdfViewer .page canvas[hidden]{display:none}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon{position:absolute;display:block;inset:0;background:url(data:image/gif;base64,R0lGODlhGAAYAPQQAM7Ozvr6+uDg4LCwsOjo6I6OjsjIyJycnNjY2KioqMDAwPLy8nZ2doaGhri4uGhoaP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/ilPcHRpbWl6ZWQgd2l0aCBodHRwczovL2V6Z2lmLmNvbS9vcHRpbWl6ZQAh+QQJBwAQACwAAAAAGAAYAAAFmiAkjiTkOGVaBgjZNGSgkgKjjM8zLoI8iy+BKCdiCX8iBeMAhEEIPRXLxViYUE9CbCQoFAzFhHY3zkaT3oPvBz1zE4UBsr1eWZH4vAowOBwGAHk8AoQLfH6Agm0Ed3qOAXWOIgQKiWyFJQgDgJEpdG+WEACNEFNFmKVlVzJQk6qdkwqBoi1mebJ3ALNGeIZHtGSwNDS1RZKueCEAIfkECQcAEAAsAAAAABgAGAAABZcgJI4kpChlWgYCWRQkEKgjURgjw4zOg9CjVwuiEyEeO6CxkBC9nA+HiuUqLEyoBZI0Mx4SAFFgQCDZuguBoGv6Dtg0gvpqdhxQQDkBzuUr/4A1JwMKP39pc2mDhYCIc4GQYn6QCwCMeY91l0p6dBAEJ0OfcFRimZ91Mwt0alxxAIZyRmuAsKxDLKKvZbM1tJxmvGKRpn8hACH5BAkHABAALAAAAAAYABgAAAWhICSOJGQYZVoGAnkcJBKoI3EAY1GMCtPSosSBINKJBIwGkHdwBGGQA0OhYpEGQxNqkYzNIITBACEKKBaxxNfBeOCO4vMy0Hg8nDHFeCktkKtfNAtoS4UqAicKBj9zBAKPC4iKi4aRkISGmWWBmjUIAIyHkCUEAKCVo2WmREecVqoCgZhgP4NHrGWCj7e3szSpuxAsoVWxnp6cVV4kyZW+KSEAIfkECQcAEAAsAAAAABgAGAAABZkgJI4kBABlWgYEOQykEKgjMSDjcYxG0dKi108nEhQKQN4rCIMkCgbawjWYnSCLY2yGVSgEooBhWqsGGwxc0RtNBgoMhmJ1QgETjANYFeBKyUmBKQQIdT9JDmgPDQ6EhoKJD4sOgpWWgiwChyqEBH5hmptSoSOZgJ4kLKWkYTF7C2SaqaM/hEWygay4mYG8t6uffFuzl1iANCEAIfkECQcAEAAsAAAAABgAGAAABZ0gJI4khCBlmhKkopBCoI6LIozDMAIHO4uuBVBnOiR+I4FrCDwAZsKdQnaCLIwwmRUA8JmioprWUCjcwlwUMnAoG0qL03k2KCS8cC0UjOzDCQKBfHQFDAwFU4CCfgqFhy9+kZJWgzSKSAcPZn+BfQENDw8OljGWJAFeDoZPYTBnC1GdSXqnsoBolSulX2GyP6hgvnG0KrS3NJNhuSQhACH5BAkHABAALAAAAAAYABgAAAWaICSOJCQIZZoupGGQRKCOC0CMijIiwz2LABtQZxoMfjQhxAXszWQ7gOwECRhh0MCJJRJARTUoIHFAgbfI6uBwAJS01J/i4PClVYHvfV8lbLlIBmwFbQt+aGmChG18jXeGT4dICQxlb4g/AQUMDER9XjR6BAdiDQwINDBmkAsPDVh4cX4imw53iLKuaVqAcUsPqEiidkt6j4AzIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiREEGWaBiSCtCoZCMsIAKOg1LEo0KKbaKFQ9EYLoOkFuQlirNxzCQkUW9GZ0hQd4nyDAWr4G/esYSbyZFYZwu3jqiuvr8u8I2BwOAwASXh1e31/doeHC3klWnElfAlTd46MfQUGk2stCVEGBQWSdCciDg5VDAVYKoEiDQ0iBwxGcj9RDw8+qHIzebc2DJJQJK6qiKVyIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiS0LGWaBiRBtCoZCKgoCCMB1DF0sz6cCQDo5W62l28XAyZFpyECBv3lnCbhUqHMIo0Qg4Jbmn1jRCa4iV27TzfXGjEecOFWMN1OdvvfPGUuXSoKBw6EXokrAwcHRVU0UAeEBANAAAmUI1gNDyhjJgUHLW0iDg8FIqOnBQZrDA9TELE2rEYIDw4jta2LMpCrqld/YQpgIQAh+QQJBwAQACwAAAAAGAAYAAAFmyAkjiS0LGWaBiRBkKw6BgIqCsJcyyMe4yJajhcEml5H26o1PN2QQd3uFiv2AADlAgflIbDdZLgkABOJgep5LfWty4p4zeU+w+XsvJWXliEKDwdEBgMKYQ4PDw1qK3EDCCMAiQ5BCV0LCj+FSDQkgCgGBiYHAy2MIgoMghAHqw4HAGsNDEMFBTekdgwKI7aRB2MwkL2rVHoQoWchACH5BAkHABAALAAAAAAYABgAAAWWICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkfbqjU83ZBB3e4WK0qrCxyU55peid0qcUwuixyNx6PhILsAcAJazXYj4lvz2MkLiFsHDAlEcABKZwwMBX8pBgoKQxAIigpBA1sLBj+PSDQkB4uSACYDlTMyBgWDEKVnl2QFBUigN61gBQYjtLV5JZ4jtlR6omMhACH5BAkHABAALAAAAAAYABgAAAWaICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkdbidYanm7I4AjwYDh6saJuJ3JUG1mZi9srPA7EcRimJLrfJYWZUVC8TziXnEG3u/E+cIJaPAFrPQl1aQAIbRAGBZGHJQiMUQKRBkEKbQsAPZaEXQcslSYKmjMyAAdXj34ACkNEiUgDA5t+PAQHn6Ogjkuzry2DNwhuIQAh+QQFBwAQACwAAAAAGAAYAAAFnCAkjiS0LGVaBgBJEGSguo8zCsK4CPIsMg+ECCcKEH0ix6MwhJl4KiOp8UCdmrEbo6EoHpxF8A6aBBZ6vhf5dmAkkGr0CoWs21WGQ2FvsI9xC3l7B311fy93iWGKJQQOhHCAJQB6A3IqcWwJLU90i2FkUiMKlhBELEI6MwgDXRAGhQgAYD6tTqRFAJxpA6mvrqazSKJJhUWMpjlIIQA7) center no-repeat}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon.notVisible{background:none}[_nghost-%COMP%]     .pdfViewer.enablePermissions .textLayer span{-webkit-user-select:none!important;user-select:none!important;cursor:not-allowed}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer{padding-bottom:0}[_nghost-%COMP%]     .pdfPresentationMode .spread{margin:0}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer .page{margin:0 auto;border:2px solid transparent}`]})}return n})(),eN=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=jt({type:n});static \u0275inj=xt({})}return n})();var le="primary",Eu=Symbol("RouteTitle"),lI=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function mo(n){return new lI(n)}function lN(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Gp(n){return new Promise((e,t)=>{n.pipe(Jr()).subscribe({next:r=>e(r),error:r=>t(r)})})}function Y3(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Or(n[t],e[t]))return!1;return!0}function Or(n,e){let t=n?uI(n):void 0,r=e?uI(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!uN(n[i],e[i]))return!1;return!0}function uI(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function uN(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function dN(n){return n.length>0?n[n.length-1]:null}function yo(n){return Kd(n)?n:_a(n)?qe(Promise.resolve(n)):he(n)}function hN(n){return Kd(n)?Gp(n):Promise.resolve(n)}var Q3={exact:pN,subset:gN},fN={exact:X3,subset:J3,ignored:()=>!0};function tN(n,e,t){return Q3[t.paths](n.root,e.root,t.matrixParams)&&fN[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function X3(n,e){return Or(n,e)}function pN(n,e,t){if(!po(n.segments,e.segments)||!Hp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!pN(n.children[r],e.children[r],t))return!1;return!0}function J3(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>uN(n[t],e[t]))}function gN(n,e,t){return mN(n,e,e.segments,t)}function mN(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!po(i,t)||e.hasChildren()||!Hp(i,t,r))}else if(n.segments.length===t.length){if(!po(n.segments,t)||!Hp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!gN(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!po(n.segments,i)||!Hp(n.segments,i,r)||!n.children[le]?!1:mN(n.children[le],e,s,r)}}function Hp(n,e,t){return e.every((r,i)=>fN[t](n[i].parameters,r.parameters))}var fr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Pe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=mo(this.queryParams),this._queryParamMap}toString(){return tG.serialize(this)}},Pe=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return $p(this)}},os=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=mo(this.parameters),this._parameterMap}toString(){return vN(this)}};function Z3(n,e){return po(n,e)&&n.every((t,r)=>Or(t.parameters,e[r].parameters))}function po(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function eG(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===le&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==le&&(t=t.concat(e(i,r)))}),t}var vo=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>new _i,providedIn:"root"})}return n})(),_i=class{parse(e){let t=new hI(e);return new fr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${du(e.root,!0)}`,r=iG(e.queryParams),i=typeof e.fragment=="string"?`#${nG(e.fragment)}`:"";return`${t}${r}${i}`}},tG=new _i;function $p(n){return n.segments.map(e=>vN(e)).join("/")}function du(n,e){if(!n.hasChildren())return $p(n);if(e){let t=n.children[le]?du(n.children[le],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==le&&r.push(`${i}:${du(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=eG(n,(r,i)=>i===le?[du(n.children[le],!1)]:[`${i}:${du(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[le]!=null?`${$p(n)}/${t[0]}`:`${$p(n)}/(${t.join("//")})`}}function yN(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Bp(n){return yN(n).replace(/%3B/gi,";")}function nG(n){return encodeURI(n)}function dI(n){return yN(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function zp(n){return decodeURIComponent(n)}function nN(n){return zp(n.replace(/\+/g,"%20"))}function vN(n){return`${dI(n.path)}${rG(n.parameters)}`}function rG(n){return Object.entries(n).map(([e,t])=>`;${dI(e)}=${dI(t)}`).join("")}function iG(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Bp(t)}=${Bp(i)}`).join("&"):`${Bp(t)}=${Bp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var sG=/^[^\/()?;#]+/;function sI(n){let e=n.match(sG);return e?e[0]:""}var oG=/^[^\/()?;=#]+/;function aG(n){let e=n.match(oG);return e?e[0]:""}var cG=/^[^=?&#]+/;function lG(n){let e=n.match(cG);return e?e[0]:""}var uG=/^[^&#]+/;function dG(n){let e=n.match(uG);return e?e[0]:""}var hI=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Pe([],{}):new Pe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[le]=new Pe(e,t)),r}parseSegment(){let e=sI(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new os(zp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=aG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=sI(this.remaining);i&&(r=i,this.capture(r))}e[zp(t)]=zp(r)}parseQueryParam(e){let t=lG(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=dG(this.remaining);o&&(r=o,this.capture(r))}let i=nN(t),s=nN(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=sI(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=le);let o=this.parseChildren();t[s??le]=Object.keys(o).length===1&&o[le]?o[le]:new Pe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function _N(n){return n.segments.length>0?new Pe([],{[le]:n}):n}function wN(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=wN(i);if(r===le&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Pe(n.segments,e);return hG(t)}function hG(n){if(n.numberOfChildren===1&&n.children[le]){let e=n.children[le];return new Pe(n.segments.concat(e.segments),e.children)}return n}function La(n){return n instanceof fr}function EN(n,e,t=null,r=null,i=new _i){let s=bN(n);return IN(s,e,t,r,i)}function bN(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Pe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=_N(r);return e??i}function IN(n,e,t,r,i){let s=n;for(;s.parent;)s=s.parent;if(e.length===0)return oI(s,s,s,t,r,i);let o=fG(e);if(o.toRoot())return oI(s,s,new Pe([],{}),t,r,i);let a=pG(o,s,n),c=a.processChildren?fu(a.segmentGroup,a.index,o.commands):TN(a.segmentGroup,a.index,o.commands);return oI(s,a.segmentGroup,c,t,r,i)}function Wp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function gu(n){return typeof n=="object"&&n!=null&&n.outlets}function rN(n,e,t){n||="\u0275";let r=new fr;return r.queryParams={[n]:e},t.parse(t.serialize(r)).queryParams[n]}function oI(n,e,t,r,i,s){let o={};for(let[l,u]of Object.entries(r??{}))o[l]=Array.isArray(u)?u.map(h=>rN(l,h,s)):rN(l,u,s);let a;n===e?a=t:a=AN(n,e,t);let c=_N(wN(a));return new fr(c,o,i)}function AN(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=AN(s,e,t)}),new Pe(n.segments,r)}var qp=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Wp(r[0]))throw new $(4003,!1);let i=r.find(gu);if(i&&i!==dN(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function fG(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new qp(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new qp(t,e,r)}var Na=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function pG(n,e,t){if(n.isAbsolute)return new Na(e,!0,0);if(!t)return new Na(e,!1,NaN);if(t.parent===null)return new Na(t,!0,0);let r=Wp(n.commands[0])?0:1,i=t.segments.length-1+r;return gG(t,i,n.numberOfDoubleDots)}function gG(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new Na(r,!1,i-s)}function mG(n){return gu(n[0])?n[0].outlets:{[le]:n}}function TN(n,e,t){if(n??=new Pe([],{}),n.segments.length===0&&n.hasChildren())return fu(n,e,t);let r=yG(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Pe(n.segments.slice(0,r.pathIndex),{});return s.children[le]=new Pe(n.segments.slice(r.pathIndex),n.children),fu(s,0,i)}else return r.match&&i.length===0?new Pe(n.segments,{}):r.match&&!n.hasChildren()?fI(n,e,t):r.match?fu(n,0,i):fI(n,e,t)}function fu(n,e,t){if(t.length===0)return new Pe(n.segments,{});{let r=mG(t),i={};if(Object.keys(r).some(s=>s!==le)&&n.children[le]&&n.numberOfChildren===1&&n.children[le].segments.length===0){let s=fu(n.children[le],e,t);return new Pe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=TN(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Pe(n.segments,i)}}function yG(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(gu(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!sN(c,l,o))return s;r+=2}else{if(!sN(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function fI(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(gu(s)){let c=vG(s.outlets);return new Pe(r,c)}if(i===0&&Wp(t[0])){let c=n.segments[e];r.push(new os(c.path,iN(t[0]))),i++;continue}let o=gu(s)?s.outlets[le]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Wp(a)?(r.push(new os(o,iN(a))),i+=2):(r.push(new os(o,{})),i++)}return new Pe(r,{})}function vG(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=fI(new Pe([],{}),0,r))}),e}function iN(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function sN(n,e,t){return n==t.path&&Or(e,t.parameters)}var Oa="imperative",Tt=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Tt||{}),Pn=class{id;url;constructor(e,t){this.id=e,this.url=t}},as=class extends Pn{type=Tt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},pr=class extends Pn{urlAfterRedirects;type=Tt.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ln=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(ln||{}),Fa=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(Fa||{}),kr=class extends Pn{reason;code;type=Tt.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Lr=class extends Pn{reason;code;type=Tt.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},Va=class extends Pn{error;target;type=Tt.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},mu=class extends Pn{urlAfterRedirects;state;type=Tt.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Kp=class extends Pn{urlAfterRedirects;state;type=Tt.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Yp=class extends Pn{urlAfterRedirects;state;shouldActivate;type=Tt.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Qp=class extends Pn{urlAfterRedirects;state;type=Tt.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xp=class extends Pn{urlAfterRedirects;state;type=Tt.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Jp=class{route;type=Tt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Zp=class{route;type=Tt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},eg=class{snapshot;type=Tt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},tg=class{snapshot;type=Tt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ng=class{snapshot;type=Tt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},rg=class{snapshot;type=Tt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ja=class{routerEvent;position;anchor;type=Tt.Scroll;constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},yu=class{},Ba=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function _G(n){return!(n instanceof yu)&&!(n instanceof Ba)}function wG(n,e){return n.providers&&!n._injector&&(n._injector=va(n.providers,e,`Route: ${n.path}`)),n._injector??e}function hr(n){return n.outlet||le}function EG(n,e){let t=n.filter(r=>hr(r)===e);return t.push(...n.filter(r=>hr(r)!==e)),t}function $a(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var ig=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return $a(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new _o(this.rootInjector)}},_o=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new ig(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(W(at))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),sg=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=pI(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=pI(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=gI(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return gI(e,this._root).map(t=>t.value)}};function pI(n,e){if(n===e.value)return e;for(let t of e.children){let r=pI(n,t);if(r)return r}return null}function gI(n,e){if(n===e.value)return[e];for(let t of e.children){let r=gI(n,t);if(r.length)return r.unshift(e),r}return[]}var xn=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ra(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var vu=class extends sg{snapshot;constructor(e,t){super(e),this.snapshot=t,EI(this,e)}toString(){return this.snapshot.toString()}};function CN(n){let e=bG(n),t=new wt([new os("",{})]),r=new wt({}),i=new wt({}),s=new wt({}),o=new wt(""),a=new Fr(t,r,s,o,i,le,n,e.root);return a.snapshot=e.root,new vu(new xn(a,[]),e)}function bG(n){let e={},t={},r={},s=new go([],e,r,"",t,le,n,null,{});return new _u("",new xn(s,[]))}var Fr=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ke(l=>l[Eu]))??he(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ke(e=>mo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ke(e=>mo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function og(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:L(L({},e.params),n.params),data:L(L({},e.data),n.data),resolve:L(L(L(L({},n.data),e.data),i?.data),n._resolvedData)}:r={params:L({},n.params),data:L({},n.data),resolve:L(L({},n.data),n._resolvedData??{})},i&&DN(i)&&(r.resolve[Eu]=i.title),r}var go=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Eu]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=mo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=mo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},_u=class extends sg{url;constructor(e,t){super(t),this.url=e,EI(this,t)}toString(){return SN(this._root)}};function EI(n,e){e.value._routerState=n,e.children.forEach(t=>EI(n,t))}function SN(n){let e=n.children.length>0?` { ${n.children.map(SN).join(", ")} } `:"";return`${n.value}${e}`}function aI(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Or(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Or(e.params,t.params)||n.paramsSubject.next(t.params),Y3(e.url,t.url)||n.urlSubject.next(t.url),Or(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function mI(n,e){let t=Or(n.params,e.params)&&Z3(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||mI(n.parent,e.parent))}function DN(n){return typeof n.title=="string"||n.title===null}var xN=new G(""),bu=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=le;activateEvents=new $e;deactivateEvents=new $e;attachEvents=new $e;detachEvents=new $e;routerOutletData=lM();parentContexts=V(_o);location=V(ai);changeDetector=V(ar);inputBinder=V(Iu,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new yI(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Zs({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Xs]})}return n})(),yI=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Fr?this.route:e===_o?this.childContexts:e===xN?this.outletData:this.parent.get(e,t)}},Iu=new G(""),bI=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Qd([r.queryParams,r.params,r.data]).pipe(bn(([s,o,a],c)=>(a=L(L(L({},s),o),a),c===0?he(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let o=pM(r.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(t,i)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),II=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Tn({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Ot(0,"router-outlet")},dependencies:[bu],encapsulation:2})}return n})();function AI(n){let e=n.children&&n.children.map(AI),t=e?J(L({},n),{children:e}):L({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==le&&(t.component=II),t}function IG(n,e,t){let r=wu(n,e._root,t?t._root:void 0);return new vu(r,e)}function wu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=AG(n,e,t);return new xn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>wu(n,a)),o}}let r=TG(e.value),i=e.children.map(s=>wu(n,s));return new xn(r,i)}}function AG(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return wu(n,r,i);return wu(n,r)})}function TG(n){return new Fr(new wt(n.url),new wt(n.params),new wt(n.queryParams),new wt(n.fragment),new wt(n.data),n.outlet,n.component,n)}var Ua=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},PN="ngNavigationCancelingError";function ag(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=La(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=MN(!1,ln.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function MN(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[PN]=!0,t.cancellationCode=e,t}function CG(n){return RN(n)&&La(n.url)}function RN(n){return!!n&&n[PN]}var SG=(n,e,t,r)=>ke(i=>(new vI(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),vI=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),aI(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Ra(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ra(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ra(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Ra(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new rg(s.value.snapshot))}),e.children.length&&this.forwardEvent(new tg(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(aI(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),aI(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},cg=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ka=class{component;route;constructor(e,t){this.component=e,this.route=t}};function DG(n,e,t){let r=n._root,i=e?e._root:null;return hu(r,i,t,[r.value])}function xG(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function za(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!rv(n)?n:e.get(n):r}function hu(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ra(e);return n.children.forEach(o=>{PG(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>pu(a,t.getContext(o),i)),i}function PG(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=MG(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new cg(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?hu(n,e,a?a.children:null,r,i):hu(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ka(a.outlet.component,o))}else o&&pu(e,a,i),i.canActivateChecks.push(new cg(r)),s.component?hu(n,null,a?a.children:null,r,i):hu(n,null,t,r,i);return i}function MG(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!po(n.url,e.url);case"pathParamsOrQueryParamsChange":return!po(n.url,e.url)||!Or(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!mI(n,e)||!Or(n.queryParams,e.queryParams);case"paramsChange":default:return!mI(n,e)}}function pu(n,e,t){let r=Ra(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?pu(o,e.children.getContext(s),t):pu(o,null,t):pu(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new ka(e.outlet.component,i)):t.canDeactivateChecks.push(new ka(null,i)):t.canDeactivateChecks.push(new ka(null,i))}function Au(n){return typeof n=="function"}function RG(n){return typeof n=="boolean"}function NG(n){return n&&Au(n.canLoad)}function OG(n){return n&&Au(n.canActivate)}function kG(n){return n&&Au(n.canActivateChild)}function LG(n){return n&&Au(n.canDeactivate)}function FG(n){return n&&Au(n.canMatch)}function NN(n){return n instanceof Ms||n?.name==="EmptyError"}var Up=Symbol("INITIAL_VALUE");function Ha(){return bn(n=>Qd(n.map(e=>e.pipe(Xr(1),jy(Up)))).pipe(ke(e=>{for(let t of e)if(t!==!0){if(t===Up)return Up;if(t===!1||VG(t))return t}return!0}),qt(e=>e!==Up),Xr(1)))}function VG(n){return La(n)||n instanceof Ua}function ON(n){return n.aborted?he(void 0).pipe(Xr(1)):new Ae(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function kN(n){return Ve(ON(n))}function jG(n,e){return Et(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?he(J(L({},t),{guardsResult:!0})):BG(o,r,i,n).pipe(Et(a=>a&&RG(a)?UG(r,s,n,e):he(a)),ke(a=>J(L({},t),{guardsResult:a})))})}function BG(n,e,t,r){return qe(n).pipe(Et(i=>WG(i.component,i.route,t,e,r)),Jr(i=>i!==!0,!0))}function UG(n,e,t,r){return qe(e).pipe(ji(i=>Zo($G(i.route.parent,r),HG(i.route,r),GG(n,i.path,t),zG(n,i.route,t))),Jr(i=>i!==!0,!0))}function HG(n,e){return n!==null&&e&&e(new ng(n)),he(!0)}function $G(n,e){return n!==null&&e&&e(new eg(n)),he(!0)}function zG(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return he(!0);let i=r.map(s=>Kc(()=>{let o=$a(e)??t,a=za(s,o),c=OG(a)?a.canActivate(e,n):Pt(o,()=>a(e,n));return yo(c).pipe(Jr())}));return he(i).pipe(Ha())}function GG(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>xG(o)).filter(o=>o!==null).map(o=>Kc(()=>{let a=o.guards.map(c=>{let l=$a(o.node)??t,u=za(c,l),h=kG(u)?u.canActivateChild(r,n):Pt(l,()=>u(r,n));return yo(h).pipe(Jr())});return he(a).pipe(Ha())}));return he(s).pipe(Ha())}function WG(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return he(!0);let o=s.map(a=>{let c=$a(e)??i,l=za(a,c),u=LG(l)?l.canDeactivate(n,e,t,r):Pt(c,()=>l(n,e,t,r));return yo(u).pipe(Jr())});return he(o).pipe(Ha())}function qG(n,e,t,r,i){let s=e.canLoad;if(s===void 0||s.length===0)return he(!0);let o=s.map(a=>{let c=za(a,n),l=NG(c)?c.canLoad(e,t):Pt(n,()=>c(e,t)),u=yo(l);return i?u.pipe(kN(i)):u});return he(o).pipe(Ha(),LN(r))}function LN(n){return Ry(rn(e=>{if(typeof e!="boolean")throw ag(n,e)}),ke(e=>e===!0))}function KG(n,e,t,r,i){let s=e.canMatch;if(!s||s.length===0)return he(!0);let o=s.map(a=>{let c=za(a,n),l=FG(c)?c.canMatch(e,t):Pt(n,()=>c(e,t)),u=yo(l);return i?u.pipe(kN(i)):u});return he(o).pipe(Ha(),LN(r))}var fo=class FN extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,FN.prototype)}},_I=class VN extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,VN.prototype)}};function YG(n){throw new $(4e3,!1)}function QG(n){throw MN(!1,ln.GuardRejected)}var XG=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return r;if(i.numberOfChildren>1||!i.children[le])throw YG(`${e.redirectTo}`);i=i.children[le]}}async applyRedirectCommands(e,t,r,i,s){let o=await JG(t,i,s);if(o instanceof fr)throw new _I(o);let a=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),e,r);if(o[0]==="/")throw new _I(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new fr(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Pe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}};function JG(n,e,t){if(typeof n=="string")return Promise.resolve(n);let r=n,{queryParams:i,fragment:s,routeConfig:o,url:a,outlet:c,params:l,data:u,title:h}=e;return Gp(yo(Pt(t,()=>r({params:l,data:u,queryParams:i,fragment:s,routeConfig:o,url:a,outlet:c,title:h}))))}var wI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function ZG(n,e,t,r,i,s){let o=jN(n,e,t);return o.matched?(r=wG(e,r),KG(r,e,t,i,s).pipe(ke(a=>a===!0?o:L({},wI)))):he(o)}function jN(n,e,t){if(e.path==="**")return eW(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?L({},wI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||lN)(t,n,e);if(!i)return L({},wI);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?L(L({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function eW(n){return{matched:!0,parameters:n.length>0?dN(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function oN(n,e,t,r){return t.length>0&&rW(n,t,r)?{segmentGroup:new Pe(e,nW(r,new Pe(t,n.children))),slicedSegments:[]}:t.length===0&&iW(n,t,r)?{segmentGroup:new Pe(n.segments,tW(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Pe(n.segments,n.children),slicedSegments:t}}function tW(n,e,t,r){let i={};for(let s of t)if(ug(n,e,s)&&!r[hr(s)]){let o=new Pe([],{});i[hr(s)]=o}return L(L({},r),i)}function nW(n,e){let t={};t[le]=e;for(let r of n)if(r.path===""&&hr(r)!==le){let i=new Pe([],{});t[hr(r)]=i}return t}function rW(n,e,t){return t.some(r=>ug(n,e,r)&&hr(r)!==le)}function iW(n,e,t){return t.some(r=>ug(n,e,r))}function ug(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function sW(n,e,t){return e.length===0&&!n.children[t]}var oW=class{};async function aW(n,e,t,r,i,s,o="emptyOnly",a){return new lW(n,e,t,r,i,o,s,a).recognize()}var cW=31,lW=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,a,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.abortSignal=c,this.applyRedirects=new XG(this.urlSerializer,this.urlTree)}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}async recognize(){let e=oN(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:r}=await this.match(e),i=new xn(r,t),s=new _u("",i),o=EN(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}async match(e){let t=new go([],Object.freeze({}),Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),le,this.rootComponentType,null,{});try{return{children:await this.processSegmentGroup(this.injector,this.config,e,le,t),rootSnapshot:t}}catch(r){if(r instanceof _I)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof fo?this.noMatchError(r):r}}async processSegmentGroup(e,t,r,i,s){if(r.segments.length===0&&r.hasChildren())return this.processChildren(e,t,r,s);let o=await this.processSegment(e,t,r,r.segments,i,!0,s);return o instanceof xn?[o]:[]}async processChildren(e,t,r,i){let s=[];for(let c of Object.keys(r.children))c==="primary"?s.unshift(c):s.push(c);let o=[];for(let c of s){let l=r.children[c],u=EG(t,c),h=await this.processSegmentGroup(e,u,l,c,i);o.push(...h)}let a=BN(o);return uW(a),a}async processSegment(e,t,r,i,s,o,a){for(let c of t)try{return await this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a)}catch(l){if(l instanceof fo||NN(l))continue;throw l}if(sW(r,i,s))return new oW;throw new fo(r)}async processSegmentAgainstRoute(e,t,r,i,s,o,a,c){if(hr(r)!==o&&(o===le||!ug(i,s,r)))throw new fo(i);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,i,r,s,o,c);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c);throw new fo(i)}async expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:l,consumedSegments:u,positionalParamSegments:h,remainingSegments:f}=jN(t,i,s);if(!c)throw new fo(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>cW&&(this.allowRedirects=!1));let p=new go(s,l,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,aN(i),hr(i),i.component??i._loadedComponent??null,i,cN(i)),m=og(p,a,this.paramsInheritanceStrategy);if(p.params=Object.freeze(m.params),p.data=Object.freeze(m.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let v=await this.applyRedirects.applyRedirectCommands(u,i.redirectTo,h,p,e),w=await this.applyRedirects.lineralizeSegments(i,v);return this.processSegment(e,r,t,w.concat(f),o,!1,a)}async matchSegmentAgainstRoute(e,t,r,i,s,o){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await Gp(ZG(t,r,i,e,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(t.children={}),!a?.matched)throw new fo(t);e=r._injector??e;let{routes:c}=await this.getChildConfig(e,r,i),l=r._loadedInjector??e,{parameters:u,consumedSegments:h,remainingSegments:f}=a,p=new go(h,u,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,aN(r),hr(r),r.component??r._loadedComponent??null,r,cN(r)),m=og(p,o,this.paramsInheritanceStrategy);p.params=Object.freeze(m.params),p.data=Object.freeze(m.data);let{segmentGroup:v,slicedSegments:w}=oN(t,h,f,c);if(w.length===0&&v.hasChildren()){let P=await this.processChildren(l,c,v,p);return new xn(p,P)}if(c.length===0&&w.length===0)return new xn(p,[]);let I=hr(r)===s,D=await this.processSegment(l,c,v,w,I?le:s,!0,p);return new xn(p,D instanceof xn?[D]:[])}async getChildConfig(e,t,r){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0)return{routes:t._loadedRoutes,injector:t._loadedInjector};if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await Gp(qG(e,t,r,this.urlSerializer,this.abortSignal))){let s=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=s.routes,t._loadedInjector=s.injector,s}throw QG(t)}return{routes:[],injector:e}}};function uW(n){n.sort((e,t)=>e.value.outlet===le?-1:t.value.outlet===le?1:e.value.outlet.localeCompare(t.value.outlet))}function dW(n){let e=n.value.routeConfig;return e&&e.path===""}function BN(n){let e=[],t=new Set;for(let r of n){if(!dW(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=BN(r.children);e.push(new xn(r.value,i))}return e.filter(r=>!t.has(r))}function aN(n){return n.data||{}}function cN(n){return n.resolve||{}}var hW=new G("",{factory:()=>aW});function fW(n,e,t,r,i,s,o){let a=n.get(hW);return Et(c=>he(c).pipe(bn(l=>a(n,e,t,r,l.extractedUrl,i,s,o)),ke(({state:l,tree:u})=>J(L({},c),{targetSnapshot:l,urlAfterRedirects:u}))))}function pW(n,e){return Et(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return he(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of UN(c))o.add(l);let a=0;return qe(o).pipe(ji(c=>s.has(c)?gW(c,r,n,e):(c.data=og(c,c.parent,n).resolve,he(void 0))),rn(()=>a++),Xd(1),Et(c=>a===o.size?he(t):hn))})}function UN(n){let e=n.children.map(t=>UN(t)).flat();return[n,...e]}function gW(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!DN(i)&&(s[Eu]=i.title),Kc(()=>(n.data=og(n,n.parent,t).resolve,mW(s,n,e,r).pipe(ke(o=>(n._resolvedData=o,n.data=L(L({},n.data),o),null)))))}function mW(n,e,t,r){let i=uI(n);if(i.length===0)return he({});let s={};return qe(i).pipe(Et(o=>yW(n[o],e,t,r).pipe(Jr(),rn(a=>{if(a instanceof Ua)throw ag(new _i,a);s[o]=a}))),Xd(1),ke(()=>s),ea(o=>NN(o)?hn:Ly(o)))}function yW(n,e,t,r){let i=$a(e)??r,s=za(n,i),o=s.resolve?s.resolve(e,t):Pt(i,()=>s(e,t));return yo(o)}function cI(n){return bn(e=>{let t=n(e);return t?qe(t).pipe(ke(()=>e)):he(e)})}var TI=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===le);return r}getResolvedTitleForRoute(t){return t.data[Eu]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>V(HN),providedIn:"root"})}return n})(),HN=(()=>{class n extends TI{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(W(GM))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wo=new G("",{factory:()=>({})}),Ga=new G(""),dg=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=V(nw);async loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await hN(Pt(t,()=>r.loadComponent())),o=await GN(zN(s));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o,o}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await $N(r,this.compiler,t,this.onLoadEndListener);return r._loadedRoutes=s.routes,r._loadedInjector=s.injector,s}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,i),i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function $N(n,e,t,r){let i=await hN(Pt(t,()=>n.loadChildren())),s=await GN(zN(i)),o;s instanceof Qh||Array.isArray(s)?o=s:o=await e.compileModuleAsync(s),r&&r(n);let a,c,l=!1;return Array.isArray(o)?(c=o,l=!0):(a=o.create(t).injector,c=a.get(Ga,[],{optional:!0,self:!0}).flat()),{routes:c.map(AI),injector:a}}function vW(n){return n&&typeof n=="object"&&"default"in n}function zN(n){return vW(n)?n.default:n}async function GN(n){return n}var hg=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>V(_W),providedIn:"root"})}return n})(),_W=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),CI=new G(""),SI=new G("");function WN(n,e,t){let r=n.get(SI),i=n.get(ct);if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),wW(n)));a.ready.catch(l=>{});let{onViewTransitionCreated:c}=r;return c&&Pt(n,()=>c({transition:a,from:e,to:t})),o}function wW(n){return new Promise(e=>{R_({read:()=>setTimeout(e)},{injector:n})})}var EW=()=>{},DI=new G(""),fg=(()=>{class n{currentNavigation=qi(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=qi(null);events=new _t;transitionAbortWithErrorSubject=new _t;configLoader=V(dg);environmentInjector=V(at);destroyRef=V(ir);urlSerializer=V(vo);rootContexts=V(_o);location=V(es);inputBindingEnabled=V(Iu,{optional:!0})!==null;titleStrategy=V(TI);options=V(wo,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=V(hg);createViewTransition=V(CI,{optional:!0});navigationErrorHandler=V(DI,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>he(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Jp(i)),r=i=>this.events.next(new Zp(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;Tr(()=>{this.transitions?.next(J(L({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(t){return this.transitions=new wt(null),this.transitions.pipe(qt(r=>r!==null),bn(r=>{let i=!1,s=new AbortController;return he(r).pipe(bn(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",ln.SupersededByNewNavigation),hn;this.currentTransition=r;let a=this.lastSuccessfulNavigation();this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:a?J(L({},a),{previousNavigation:null}):null,abort:()=>s.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),l=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&l!=="reload")return this.events.next(new Lr(o.id,this.urlSerializer.serialize(o.rawUrl),"",Fa.IgnoredSameUrlNavigation)),o.resolve(!1),hn;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return he(o).pipe(bn(u=>(this.events.next(new as(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),u.id!==this.navigationId?hn:Promise.resolve(u))),fW(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,s.signal),rn(u=>{r.targetSnapshot=u.targetSnapshot,r.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation.update(f=>(f.finalUrl=u.urlAfterRedirects,f));let h=new mu(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:u,extractedUrl:h,source:f,restoredState:p,extras:m}=o,v=new as(u,this.urlSerializer.serialize(h),f,p);this.events.next(v);let w=CN(this.rootComponentType).snapshot;return this.currentTransition=r=J(L({},o),{targetSnapshot:w,urlAfterRedirects:h,extras:J(L({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(I=>(I.finalUrl=h,I)),he(r)}else return this.events.next(new Lr(o.id,this.urlSerializer.serialize(o.extractedUrl),"",Fa.IgnoredByUrlHandlingStrategy)),o.resolve(!1),hn}),rn(o=>{let a=new Kp(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),ke(o=>(this.currentTransition=r=J(L({},o),{guards:DG(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),jG(this.environmentInjector,o=>this.events.next(o)),rn(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw ag(this.urlSerializer,o.guardsResult);let a=new Yp(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),qt(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",ln.GuardRejected),!1)),cI(o=>{if(o.guards.canActivateChecks.length!==0)return he(o).pipe(rn(a=>{let c=new Qp(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),bn(a=>{let c=!1;return he(a).pipe(pW(this.paramsInheritanceStrategy,this.environmentInjector),rn({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",ln.NoDataFromResolver)}}))}),rn(a=>{let c=new Xp(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),cI(o=>{let a=l=>{let u=[];if(l.routeConfig?._loadedComponent)l.component=l.routeConfig?._loadedComponent;else if(l.routeConfig?.loadComponent){let h=$a(l)??this.environmentInjector;u.push(this.configLoader.loadComponent(h,l.routeConfig).then(f=>{l.component=f}))}for(let h of l.children)u.push(...a(h));return u},c=a(o.targetSnapshot.root);return c.length===0?he(o):qe(Promise.all(c).then(()=>o))}),cI(()=>this.afterPreactivation()),bn(()=>{let{currentSnapshot:o,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return c?qe(c).pipe(ke(()=>r)):he(r)}),ke(o=>{let a=IG(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=J(L({},o),{targetRouterState:a}),this.currentNavigation.update(c=>(c.targetRouterState=a,c)),r}),rn(()=>{this.events.next(new yu)}),SG(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Xr(1),Ve(ON(s.signal).pipe(qt(()=>!i&&!r.targetRouterState),rn(()=>{this.cancelNavigationTransition(r,s.signal.reason+"",ln.Aborted)}))),rn({next:o=>{i=!0,this.currentNavigation.update(a=>(a.abort=EW,a)),this.lastSuccessfulNavigation.set(Tr(this.currentNavigation)),this.events.next(new pr(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),Ve(this.transitionAbortWithErrorSubject.pipe(rn(o=>{throw o}))),ta(()=>{s.abort(),i||this.cancelNavigationTransition(r,"",ln.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),ea(o=>{if(this.destroyed)return r.resolve(!1),hn;if(i=!0,RN(o))this.events.next(new kr(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),CG(o)?this.events.next(new Ba(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let a=new Va(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let c=Pt(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof Ua){let{message:l,cancellationCode:u}=ag(this.urlSerializer,c);this.events.next(new kr(r.id,this.urlSerializer.serialize(r.extractedUrl),l,u)),this.events.next(new Ba(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),o}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return hn}))}))}cancelNavigationTransition(t,r,i){let s=new kr(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Tr(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function bW(n){return n!==Oa}var qN=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>V(IW),providedIn:"root"})}return n})(),lg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},IW=(()=>{class n extends lg{static \u0275fac=(()=>{let t;return function(i){return(t||(t=bl(n)))(i||n)}})();static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xI=(()=>{class n{urlSerializer=V(vo);options=V(wo,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=V(es);urlHandlingStrategy=V(hg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new fr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof fr?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=CN(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>V(KN),providedIn:"root"})}return n})(),KN=(()=>{class n extends xI{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof as?this.updateStateMemento():t instanceof Lr?this.commitTransition(r):t instanceof mu?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof yu?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof kr&&t.code!==ln.SupersededByNewNavigation&&t.code!==ln.Redirect?this.restoreHistory(r):t instanceof Va?this.restoreHistory(r,!0):t instanceof pr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let a=this.browserPageId,c=L(L({},o),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=L(L({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=bl(n)))(i||n)}})();static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pg(n,e){n.events.pipe(qt(t=>t instanceof pr||t instanceof kr||t instanceof Va||t instanceof Lr),ke(t=>t instanceof pr||t instanceof Lr?0:(t instanceof kr?t.code===ln.Redirect||t.code===ln.SupersededByNewNavigation:!1)?2:1),qt(t=>t!==2),Xr(1)).subscribe(()=>{e()})}var AW={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},TW={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},cs=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=V(Y_);stateManager=V(xI);options=V(wo,{optional:!0})||{};pendingTasks=V(si);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=V(fg);urlSerializer=V(vo);location=V(es);urlHandlingStrategy=V(hg);injector=V(at);_events=new _t;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=V(qN);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=V(Ga,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!V(Iu,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new vt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=Tr(this.navigationTransitions.currentNavigation);if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof kr&&r.code!==ln.Redirect&&r.code!==ln.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof pr)this.navigated=!0;else if(r instanceof Ba){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=L({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||bW(i.source)},o);this.scheduleNavigation(a,Oa,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}_G(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Oa,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=L({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s).catch(c=>{this.disposed||this.injector.get($n)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Tr(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(AI),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:o,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=L(L({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let h;try{let f=i?i.snapshot:this.routerState.snapshot.root;h=bN(f)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),h=this.currentUrlTree.root}return IN(h,t,u,l??null,this.urlSerializer)}navigateByUrl(t,r={skipLocationChange:!1}){let i=La(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Oa,null,r)}navigate(t,r={skipLocationChange:!1}){return CW(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(ti(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=L({},AW):r===!1?i=L({},TW):i=r,La(t))return tN(this.currentUrlTree,t,i);let s=this.parseUrl(t);return tN(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((h,f)=>{a=h,c=f});let u=this.pendingTasks.add();return pg(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function CW(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new $(4008,!1)}var Tu=class{};var YN=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(t,r,i,s){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(qt(t=>t instanceof pr),ji(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let s of r){s.providers&&!s._injector&&(s._injector=va(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return qe(i).pipe(Jo())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=qe(this.loader.loadChildren(t,r)):i=he(null);let s=i.pipe(Et(o=>o===null?he(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(r.loadComponent&&!r._loadedComponent){let o=this.loader.loadComponent(t,r);return qe([s,o]).pipe(Jo())}else return s})}static \u0275fac=function(r){return new(r||n)(W(cs),W(at),W(Tu),W(dg))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),QN=new G(""),SW=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=Oa;restoredId=0;store={};constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof as?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof pr?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Lr&&t.code===Fa.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{if(!(t instanceof ja))return;let r={behavior:"instant"};t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0],r):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position,r):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0])})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(async()=>{await new Promise(i=>{setTimeout(i),typeof requestAnimationFrame<"u"&&requestAnimationFrame(i)}),this.zone.run(()=>{this.transitions.events.next(new ja(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){$_()};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();function DW(){return V(cs).routerState.root}function Cu(n,e){return{\u0275kind:n,\u0275providers:e}}function xW(){let n=V(sn);return e=>{let t=n.get(Xi);if(e!==t.components[0])return;let r=n.get(cs),i=n.get(XN);n.get(MI)===1&&r.initialNavigation(),n.get(eO,null,{optional:!0})?.setUpPreloading(),n.get(QN,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var XN=new G("",{factory:()=>new _t}),MI=new G("",{factory:()=>1});function JN(){let n=[{provide:b_,useValue:!0},{provide:MI,useValue:0},Zh(()=>{let e=V(sn);return e.get(fw,Promise.resolve()).then(()=>new Promise(r=>{let i=e.get(cs),s=e.get(XN);pg(i,()=>{r(!0)}),e.get(fg).afterPreactivation=()=>(r(!0),s.closed?he(void 0):s),i.initialNavigation()}))})];return Cu(2,n)}function ZN(){let n=[Zh(()=>{V(cs).setUpLocationChangeListener()}),{provide:MI,useValue:2}];return Cu(3,n)}var eO=new G("");function tO(n){return Cu(0,[{provide:eO,useExisting:YN},{provide:Tu,useExisting:n}])}function nO(){return Cu(8,[bI,{provide:Iu,useExisting:bI}])}function rO(n){ya("NgRouterViewTransitions");let e=[{provide:CI,useValue:WN},{provide:SI,useValue:L({skipNextTransition:!!n?.skipInitialTransition},n)}];return Cu(9,e)}var iO=[es,{provide:vo,useClass:_i},cs,_o,{provide:Fr,useFactory:DW},dg,[]],gg=(()=>{class n{constructor(){}static forRoot(t,r){return{ngModule:n,providers:[iO,[],{provide:Ga,multi:!0,useValue:t},[],r?.errorHandler?{provide:DI,useValue:r.errorHandler}:[],{provide:wo,useValue:r||{}},r?.useHash?MW():RW(),PW(),r?.preloadingStrategy?tO(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?NW(r):[],r?.bindToComponentInputs?nO().\u0275providers:[],r?.enableViewTransitions?rO().\u0275providers:[],OW()]}}static forChild(t){return{ngModule:n,providers:[{provide:Ga,multi:!0,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=jt({type:n});static \u0275inj=xt({})}return n})();function PW(){return{provide:QN,useFactory:()=>{let n=V(bM),e=V(dt),t=V(wo),r=V(fg),i=V(vo);return t.scrollOffset&&n.setOffset(t.scrollOffset),new SW(i,r,n,e,t)}}}function MW(){return{provide:ci,useClass:pw}}function RW(){return{provide:ci,useClass:df}}function NW(n){return[n.initialNavigation==="disabled"?ZN().\u0275providers:[],n.initialNavigation==="enabledBlocking"?JN().\u0275providers:[]]}var PI=new G("");function OW(){return[{provide:PI,useFactory:xW},{provide:ef,multi:!0,useExisting:PI}]}var Su={production:!0,firebase:{apiKey:"AIzaSyAa3aCpidnJ3MB3D2FlpkCHGuVcRyhfmb8",authDomain:"vvskchaitanya-1.firebaseapp.com",projectId:"vvskchaitanya-1",storageBucket:"vvskchaitanya-1.appspot.com",messagingSenderId:"683857452414",appId:"1:683857452414:web:41b3da4368a3df73d5272f",measurementId:"G-BCJ69CN9L7"},githubToken:""};var mg=class n{constructor(e){this.http=e}GIT_USER="vstechapps";GIT_REPO="docs.vvsk.in";DEFAULT_PATH="drive";baseUrl=`https://api.github.com/repos/${this.GIT_USER}/${this.GIT_REPO}/contents`;getContents(e=this.DEFAULT_PATH){let t=`${this.baseUrl}/${e}`;return this.http.get(t)}searchFiles(e){let t=`https://api.github.com/search/code?q=${e}+repo:${this.GIT_USER}/${this.GIT_REPO}+path:${this.DEFAULT_PATH}`,r={Accept:"application/vnd.github.v3+json"};return Su.githubToken&&(r.Authorization=`token ${Su.githubToken}`),this.http.get(t,{headers:r})}static \u0275fac=function(t){return new(t||n)(W(Cf))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var oO=()=>{};var lO=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},FW=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},uO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4,f=(a&15)<<2|l>>6,p=l&63;c||(p=64,o||(f=64)),r.push(t[u],t[h],t[f],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(lO(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):FW(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw new NI;let f=s<<2|a>>4;if(r.push(f),l!==64){let p=a<<4&240|l>>2;if(r.push(p),h!==64){let m=l<<6&192|h;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},NI=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},VW=function(n){let e=lO(n);return uO.encodeByteArray(e,!0)},xu=function(n){return VW(n).replace(/\./g,"")},vg=function(n){try{return uO.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function dO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var jW=()=>dO().__FIREBASE_DEFAULTS__,BW=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},UW=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&vg(n[1]);return e&&JSON.parse(e)},_g=()=>{try{return oO()||jW()||BW()||UW()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},kI=n=>_g()?.emulatorHosts?.[n],hO=n=>{let e=kI(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},LI=()=>_g()?.config,FI=n=>_g()?.[`_${n}`];var yg=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function ls(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function wg(n){return(await fetch(n,{credentials:"include"})).ok}function fO(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=L({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[xu(JSON.stringify(t)),xu(JSON.stringify(o)),""].join(".")}var Du={};function HW(){let n={prod:[],emulator:[]};for(let e of Object.keys(Du))Du[e]?n.emulator.push(e):n.prod.push(e);return n}function $W(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var aO=!1;function Eg(n,e){if(typeof window>"u"||typeof document>"u"||!ls(window.location.host)||Du[n]===e||Du[n]||aO)return;Du[n]=e;function t(f){return`__firebase__banner__${f}`}let r="__firebase__banner",s=HW().prod.length>0;function o(){let f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,p){f.setAttribute("width","24"),f.setAttribute("id",p),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function l(){let f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{aO=!0,o()},f}function u(f,p){f.setAttribute("id",p),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){let f=$W(r),p=t("text"),m=document.getElementById(p)||document.createElement("span"),v=t("learnmore"),w=document.getElementById(v)||document.createElement("a"),I=t("preprendIcon"),D=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){let P=f.element;a(P),u(w,v);let x=l();c(D,I),P.append(D,m,w,x),document.body.appendChild(P)}s?(m.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function kt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pO(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(kt())}function zW(){let n=_g()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bg(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function mO(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yO(){let n=kt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vO(){return!zW()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Pu(){try{return typeof indexedDB=="object"}catch{return!1}}function Ig(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}function _O(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}var GW="FirebaseError",Ht=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=GW,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mn.prototype.create)}},Mn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?WW(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ht(i,a,r)}};function WW(n,e){return n.replace(qW,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var qW=/\{\$([^}]+)}/g;function wO(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function qn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(cO(s)&&cO(o)){if(!qn(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function cO(n){return n!==null&&typeof n=="object"}function Wa(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function EO(n,e){let t=new OI(n,e);return t.subscribe.bind(t)}var OI=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");KW(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=RI),i.error===void 0&&(i.error=RI),i.complete===void 0&&(i.complete=RI);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function KW(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function RI(){}var YW=1e3,QW=2,XW=14400*1e3,JW=.5;function VI(n,e=YW,t=QW){let r=e*Math.pow(t,n),i=Math.round(JW*r*(Math.random()-.5)*2);return Math.min(XW,r+i)}function it(n){return n&&n._delegate?n._delegate:n}var Lt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Eo="[DEFAULT]";var jI=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new yg;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(eq(e))try{this.getOrInitializeService({instanceIdentifier:Eo})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Eo){return this.instances.has(e)}getOptions(e=Eo){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ZW(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Eo){return this.component?this.component.multipleInstances?e:Eo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function ZW(n){return n===Eo?void 0:n}function eq(n){return n.instantiationMode==="EAGER"}var Ag=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new jI(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var tq=[],Ee=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(Ee||{}),nq={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},rq=Ee.INFO,iq={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},sq=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=iq[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Vr=class{constructor(e){this.name=e,this._logLevel=rq,this._logHandler=sq,this._userLogHandler=null,tq.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}};var oq=(n,e)=>e.some(t=>n instanceof t),bO,IO;function aq(){return bO||(bO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cq(){return IO||(IO=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var AO=new WeakMap,UI=new WeakMap,TO=new WeakMap,BI=new WeakMap,$I=new WeakMap;function lq(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(jr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&AO.set(t,n)}).catch(()=>{}),$I.set(e,n),e}function uq(n){if(UI.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});UI.set(n,e)}var HI={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return UI.get(n);if(e==="objectStoreNames")return n.objectStoreNames||TO.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return jr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function CO(n){HI=n(HI)}function dq(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Tg(this),e,...t);return TO.set(r,e.sort?e.sort():[e]),jr(r)}:cq().includes(n)?function(...e){return n.apply(Tg(this),e),jr(AO.get(this))}:function(...e){return jr(n.apply(Tg(this),e))}}function hq(n){return typeof n=="function"?dq(n):(n instanceof IDBTransaction&&uq(n),oq(n,aq())?new Proxy(n,HI):n)}function jr(n){if(n instanceof IDBRequest)return lq(n);if(BI.has(n))return BI.get(n);let e=hq(n);return e!==n&&(BI.set(n,e),$I.set(e,n)),e}var Tg=n=>$I.get(n);function Cg(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=jr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(jr(o.result),c.oldVersion,c.newVersion,jr(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var fq=["get","getKey","getAll","getAllKeys","count"],pq=["put","add","delete","clear"],zI=new Map;function SO(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(zI.get(e))return zI.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=pq.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||fq.includes(t)))return;let s=async function(o,...a){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),i&&c.done]))[0]};return zI.set(e,s),s}CO(n=>J(L({},n),{get:(e,t,r)=>SO(e,t)||n.get(e,t,r),has:(e,t)=>!!SO(e,t)||n.has(e,t)}));var WI=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(gq(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function gq(n){return n.getComponent()?.type==="VERSION"}var qI="@firebase/app",DO="0.14.6";var wi=new Vr("@firebase/app"),mq="@firebase/app-compat",yq="@firebase/analytics-compat",vq="@firebase/analytics",_q="@firebase/app-check-compat",wq="@firebase/app-check",Eq="@firebase/auth",bq="@firebase/auth-compat",Iq="@firebase/database",Aq="@firebase/data-connect",Tq="@firebase/database-compat",Cq="@firebase/functions",Sq="@firebase/functions-compat",Dq="@firebase/installations",xq="@firebase/installations-compat",Pq="@firebase/messaging",Mq="@firebase/messaging-compat",Rq="@firebase/performance",Nq="@firebase/performance-compat",Oq="@firebase/remote-config",kq="@firebase/remote-config-compat",Lq="@firebase/storage",Fq="@firebase/storage-compat",Vq="@firebase/firestore",jq="@firebase/ai",Bq="@firebase/firestore-compat",Uq="firebase",Hq="12.6.0";var KI="[DEFAULT]",$q={[qI]:"fire-core",[mq]:"fire-core-compat",[vq]:"fire-analytics",[yq]:"fire-analytics-compat",[wq]:"fire-app-check",[_q]:"fire-app-check-compat",[Eq]:"fire-auth",[bq]:"fire-auth-compat",[Iq]:"fire-rtdb",[Aq]:"fire-data-connect",[Tq]:"fire-rtdb-compat",[Cq]:"fire-fn",[Sq]:"fire-fn-compat",[Dq]:"fire-iid",[xq]:"fire-iid-compat",[Pq]:"fire-fcm",[Mq]:"fire-fcm-compat",[Rq]:"fire-perf",[Nq]:"fire-perf-compat",[Oq]:"fire-rc",[kq]:"fire-rc-compat",[Lq]:"fire-gcs",[Fq]:"fire-gcs-compat",[Vq]:"fire-fst",[Bq]:"fire-fst-compat",[jq]:"fire-vertex","fire-js":"fire-js",[Uq]:"fire-js-all"};var Sg=new Map,zq=new Map,YI=new Map;function xO(n,e){try{n.container.addComponent(e)}catch(t){wi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function vn(n){let e=n.name;if(YI.has(e))return wi.debug(`There were multiple attempts to register component ${e}.`),!1;YI.set(e,n);for(let t of Sg.values())xO(t,n);for(let t of zq.values())xO(t,n);return!0}function gr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Rn(n){return n==null?!1:n.settings!==void 0}var Gq={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},us=new Mn("app","Firebase",Gq);var QI=class{constructor(e,t,r){this._isDeleted=!1,this._options=L({},e),this._config=L({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Lt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw us.create("app-deleted",{appName:this._name})}};var ds=Hq;function ZI(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=L({name:KI,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw us.create("bad-app-name",{appName:String(i)});if(t||(t=LI()),!t)throw us.create("no-options");let s=Sg.get(i);if(s){if(qn(t,s.options)&&qn(r,s.config))return s;throw us.create("duplicate-app",{appName:i})}let o=new Ag(i);for(let c of YI.values())o.addComponent(c);let a=new QI(t,r,o);return Sg.set(i,a),a}function bo(n=KI){let e=Sg.get(n);if(!e&&n===KI&&LI())return ZI();if(!e)throw us.create("no-app",{appName:n});return e}function $t(n,e,t){let r=$q[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wi.warn(o.join(" "));return}vn(new Lt(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var Wq="firebase-heartbeat-database",qq=1,Mu="firebase-heartbeat-store",GI=null;function NO(){return GI||(GI=Cg(Wq,qq,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Mu)}catch(t){console.warn(t)}}}}).catch(n=>{throw us.create("idb-open",{originalErrorMessage:n.message})})),GI}async function Kq(n){try{let t=(await NO()).transaction(Mu),r=await t.objectStore(Mu).get(OO(n));return await t.done,r}catch(e){if(e instanceof Ht)wi.warn(e.message);else{let t=us.create("idb-get",{originalErrorMessage:e?.message});wi.warn(t.message)}}}async function PO(n,e){try{let r=(await NO()).transaction(Mu,"readwrite");await r.objectStore(Mu).put(e,OO(n)),await r.done}catch(t){if(t instanceof Ht)wi.warn(t.message);else{let r=us.create("idb-set",{originalErrorMessage:t?.message});wi.warn(r.message)}}}function OO(n){return`${n.name}!${n.options.appId}`}var Yq=1024,Qq=30,XI=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new JI(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=MO();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Qq){let i=Jq(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){wi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=MO(),{heartbeatsToSend:t,unsentEntries:r}=Xq(this._heartbeatsCache.heartbeats),i=xu(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return wi.warn(e),""}}};function MO(){return new Date().toISOString().substring(0,10)}function Xq(n,e=Yq){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),RO(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),RO(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var JI=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Pu()?Ig().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await Kq(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return PO(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return PO(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function RO(n){return xu(JSON.stringify({version:2,heartbeats:n})).length}function Jq(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Zq(n){vn(new Lt("platform-logger",e=>new WI(e),"PRIVATE")),vn(new Lt("heartbeat",e=>new XI(e),"PRIVATE")),$t(qI,DO,n),$t(qI,DO,"esm2020"),$t("fire-js","")}Zq("");var e6="firebase",t6="12.6.0";$t(e6,t6,"app");function YO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var QO=YO,XO=new Mn("auth","Firebase",YO());var Ng=new Vr("@firebase/auth");function n6(n,...e){Ng.logLevel<=Ee.WARN&&Ng.warn(`Auth (${ds}): ${n}`,...e)}function xg(n,...e){Ng.logLevel<=Ee.ERROR&&Ng.error(`Auth (${ds}): ${n}`,...e)}function Ur(n,...e){throw y0(n,...e)}function mr(n,...e){return y0(n,...e)}function m0(n,e,t){let r=J(L({},QO()),{[e]:t});return new Mn("auth","Firebase",r).create(e,{appName:n.name})}function Io(n){return m0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function r6(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ur(n,"argument-error"),m0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function y0(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return XO.create(n,...e)}function re(n,e,...t){if(!n)throw y0(e,...t)}function Ei(n){let e="INTERNAL ASSERTION FAILED: "+n;throw xg(e),new Error(e)}function Ii(n,e){n||Ei(e)}function n0(){return typeof self<"u"&&self.location?.href||""}function i6(){return kO()==="http:"||kO()==="https:"}function kO(){return typeof self<"u"&&self.location?.protocol||null}function s6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(i6()||bg()||"connection"in navigator)?navigator.onLine:!0}function o6(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Ao=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ii(t>e,"Short delay should be less than long delay!"),this.isMobile=pO()||mO()}get(){return s6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function v0(n,e){Ii(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Og=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var a6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var c6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],l6=new Ao(3e4,6e4);function _0(n,e){return n.tenantId&&!e.tenantId?J(L({},e),{tenantId:n.tenantId}):e}async function Ka(n,e,t,r,i={}){return JO(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let a=Wa(L({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);let l=L({method:e,headers:c},s);return gO()||(l.referrerPolicy="no-referrer"),n.emulatorConfig&&ls(n.emulatorConfig.host)&&(l.credentials="include"),Og.fetch()(await ZO(n,n.config.apiHost,t,a),l)})}async function JO(n,e,t){n._canInitEmulator=!1;let r=L(L({},a6),e);try{let i=new r0(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw Dg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Dg(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Dg(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Dg(n,"user-disabled",o);let u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw m0(n,u,l);Ur(n,u)}}catch(i){if(i instanceof Ht)throw i;Ur(n,"network-request-failed",{message:String(i)})}}async function u6(n,e,t,r,i={}){let s=await Ka(n,e,t,r,i);return"mfaPendingCredential"in s&&Ur(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function ZO(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?v0(n.config,i):`${n.config.apiScheme}://${i}`;return c6.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}var r0=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(mr(this.auth,"network-request-failed")),l6.get())})}};function Dg(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=mr(n,e,r);return i.customData._tokenResponse=t,i}async function d6(n,e){return Ka(n,"POST","/v1/accounts:delete",e)}async function kg(n,e){return Ka(n,"POST","/v1/accounts:lookup",e)}function Ru(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ek(n,e=!1){let t=it(n),r=await t.getIdToken(e),i=w0(r);re(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Ru(e0(i.auth_time)),issuedAtTime:Ru(e0(i.iat)),expirationTime:Ru(e0(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function e0(n){return Number(n)*1e3}function w0(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return xg("JWT malformed, contained fewer than 3 sections"),null;try{let i=vg(t);return i?JSON.parse(i):(xg("Failed to decode base64 JWT payload"),null)}catch(i){return xg("Caught error parsing JWT payload as JSON",i?.toString()),null}}function LO(n){let e=w0(n);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ou(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ht&&h6(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function h6({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var i0=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var ku=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ru(this.lastLoginAt),this.creationTime=Ru(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Lg(n){let e=n.auth,t=await n.getIdToken(),r=await Ou(n,kg(e,{idToken:t}));re(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let s=i.providerUserInfo?.length?nk(i.providerUserInfo):[],o=f6(n.providerData,s),a=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!o?.length,l=a?c:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ku(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(n,u)}async function tk(n){let e=it(n);await Lg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function f6(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function nk(n){return n.map(r=>{var i=r,{providerId:e}=i,t=$c(i,["providerId"]);return{providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}})}async function p6(n,e){let t=await JO(n,{},async()=>{let r=Wa({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await ZO(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:r};return n.emulatorConfig&&ls(n.emulatorConfig.host)&&(c.credentials="include"),Og.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function g6(n,e){return Ka(n,"POST","/v2/accounts:revokeToken",_0(n,e))}var Nu=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){re(e.length!==0,"internal-error");let t=LO(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await p6(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(re(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(re(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(re(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ei("not implemented")}};function hs(n,e){re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var fs=class n{constructor(s){var o=s,{uid:e,auth:t,stsTokenManager:r}=o,i=$c(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new i0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ku(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await Ou(this,this.stsTokenManager.getToken(this.auth,e));return re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ek(this,e)}reload(){return tk(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>L({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(J(L({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Lg(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rn(this.auth.app))return Promise.reject(Io(this.auth));let e=await this.getIdToken();return await Ou(this,d6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return J(L({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>L({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,c=t._redirectEventId??void 0,l=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:p,providerData:m,stsTokenManager:v}=t;re(h&&v,e,"internal-error");let w=Nu.fromJSON(this.name,v);re(typeof h=="string",e,"internal-error"),hs(r,e.name),hs(i,e.name),re(typeof f=="boolean",e,"internal-error"),re(typeof p=="boolean",e,"internal-error"),hs(s,e.name),hs(o,e.name),hs(a,e.name),hs(c,e.name),hs(l,e.name),hs(u,e.name);let I=new n({uid:h,auth:e,email:i,emailVerified:f,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:w,createdAt:l,lastLoginAt:u});return m&&Array.isArray(m)&&(I.providerData=m.map(D=>L({},D))),c&&(I._redirectEventId=c),I}static async _fromIdTokenResponse(e,t,r=!1){let i=new Nu;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Lg(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];re(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?nk(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Nu;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ku(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c}};var FO=new Map;function bi(n){Ii(n instanceof Function,"Expected a class definition");let e=FO.get(n);return e?(Ii(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,FO.set(n,e),e)}var m6=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),s0=m6;function Pg(n,e,t){return`firebase:${n}:${e}:${t}`}var Fg=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Pg(this.userKey,i.apiKey,s),this.fullPersistenceKey=Pg("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await kg(this.auth,{idToken:e}).catch(()=>{});return t?fs._fromGetAccountInfoResponse(this.auth,t,e):null}return fs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(bi(s0),e,r);let i=(await Promise.all(t.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l),s=i[0]||bi(s0),o=Pg(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let u=await l._get(o);if(u){let h;if(typeof u=="string"){let f=await kg(e,{idToken:u}).catch(()=>{});if(!f)break;h=await fs._fromGetAccountInfoResponse(e,f,u)}else h=fs._fromJSON(e,u);l!==s&&(a=h),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async l=>{if(l!==s)try{await l._remove(o)}catch{}})),new n(s,e,r))}};function VO(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ok(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ck(e))return"Blackberry";if(lk(e))return"Webos";if(ik(e))return"Safari";if((e.includes("chrome/")||sk(e))&&!e.includes("edge/"))return"Chrome";if(ak(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function rk(n=kt()){return/firefox\//i.test(n)}function ik(n=kt()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function sk(n=kt()){return/crios\//i.test(n)}function ok(n=kt()){return/iemobile/i.test(n)}function ak(n=kt()){return/android/i.test(n)}function ck(n=kt()){return/blackberry/i.test(n)}function lk(n=kt()){return/webos/i.test(n)}function E0(n=kt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function y6(n=kt()){return E0(n)&&!!window.navigator?.standalone}function v6(){return yO()&&document.documentMode===10}function uk(n=kt()){return E0(n)||ak(n)||lk(n)||ck(n)||/windows phone/i.test(n)||ok(n)}function dk(n,e=[]){let t;switch(n){case"Browser":t=VO(kt());break;case"Worker":t=`${VO(kt())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ds}/${r}`}var o0=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function _6(n,e={}){return Ka(n,"GET","/v2/passwordPolicy",_0(n,e))}var w6=6,a0=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??w6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var c0=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Vg(this),this.idTokenSubscription=new Vg(this),this.beforeStateQueue=new o0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=XO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Fg.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await kg(this,{idToken:e}),r=await fs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Rn(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Lg(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=o6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rn(this.app))return Promise.reject(Io(this));let t=e?it(e):null;return t&&re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rn(this.app)?Promise.reject(Io(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rn(this.app)?Promise.reject(Io(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await _6(this),t=new a0(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Mn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await g6(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&bi(e)||this._popupRedirectResolver;re(t,this,"argument-error"),this.redirectPersistenceManager=await Fg.create(this,[bi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=dk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&n6(`Error while retrieving App Check token: ${e.error}`),e?.token}};function Wg(n){return it(n)}var Vg=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=EO(t=>this.observer=t)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var b0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function E6(n){b0=n}function b6(n){return b0.loadJS(n)}function I6(){return b0.gapiScript}function hk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function fk(n,e){let t=gr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(qn(s,e??{}))return i;Ur(i,"already-initialized")}return t.initialize({options:e})}function A6(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(bi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function pk(n,e,t){let r=Wg(n);re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=gk(e),{host:o,port:a}=T6(e),c=a===null?"":`:${a}`,l={url:`${s}//${o}${c}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){re(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),re(qn(l,r.config.emulator)&&qn(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,ls(o)?(wg(`${s}//${o}${c}`),Eg("Auth",!0)):i||C6()}function gk(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function T6(n){let e=gk(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:jO(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:jO(o)}}}function jO(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function C6(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Lu=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ei("not implemented")}_getIdTokenResponse(e){return Ei("not implemented")}_linkToIdToken(e,t){return Ei("not implemented")}_getReauthenticationResolver(e){return Ei("not implemented")}};async function qa(n,e){return u6(n,"POST","/v1/accounts:signInWithIdp",_0(n,e))}var S6="http://localhost",jg=class n extends Lu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ur("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let a=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=a,s=$c(a,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return qa(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,qa(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,qa(e,t)}buildRequest(){let e={requestUri:S6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Wa(t)}return e}};var Fu=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Bg=class extends Fu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var I0=(()=>{class n extends Bg{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return jg._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var Vu=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await fs._fromIdTokenResponse(e,r,i),o=BO(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=BO(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function BO(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var l0=class n extends Ht{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function mk(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?l0._fromErrorAndOperation(n,s,e,r):s})}async function D6(n,e,t=!1){let r=await Ou(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Vu._forOperation(n,"link",r)}async function x6(n,e,t=!1){let{auth:r}=n;if(Rn(r.app))return Promise.reject(Io(r));let i="reauthenticate";try{let s=await Ou(n,mk(r,i,e,n),t);re(s.idToken,r,"internal-error");let o=w0(s.idToken);re(o,r,"internal-error");let{sub:a}=o;return re(n.uid===a,r,"user-mismatch"),Vu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ur(r,"user-mismatch"),s}}async function P6(n,e,t=!1){if(Rn(n.app))return Promise.reject(Io(n));let r="signIn",i=await mk(n,r,e),s=await Vu._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function yk(n,e,t,r){return it(n).onIdTokenChanged(e,t,r)}function vk(n,e,t){return it(n).beforeAuthStateChanged(e,t)}function A0(n,e,t,r){return it(n).onAuthStateChanged(e,t,r)}function T0(n){return it(n).signOut()}var Ug="__sak";var Hg=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ug,"1"),this.storage.removeItem(Ug),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var M6=1e3,R6=10,N6=(()=>{class n extends Hg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=uk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);v6()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,R6):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},M6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),_k=N6;var O6=(()=>{class n extends Hg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),C0=O6;function k6(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var L6=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(async u=>u(r.origin,o)),l=await k6(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function S0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var u0=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=S0("",20);i.port1.start();let u=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let f=h;if(f.data.eventId===l)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function Br(){return window}function F6(n){Br().location.href=n}function wk(){return typeof Br().WorkerGlobalScope<"u"&&typeof Br().importScripts=="function"}async function V6(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function j6(){return navigator?.serviceWorker?.controller||null}function B6(){return wk()?self:null}var Ek="firebaseLocalStorageDb",U6=1,$g="firebaseLocalStorage",bk="fbase_key",To=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function qg(n,e){return n.transaction([$g],e?"readwrite":"readonly").objectStore($g)}function H6(){let n=indexedDB.deleteDatabase(Ek);return new To(n).toPromise()}function d0(){let n=indexedDB.open(Ek,U6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore($g,{keyPath:bk})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains($g)?e(r):(r.close(),await H6(),e(await d0()))})})}async function UO(n,e,t){let r=qg(n,!0).put({[bk]:e,value:t});return new To(r).toPromise()}async function $6(n,e){let t=qg(n,!1).get(e),r=await new To(t).toPromise();return r===void 0?null:r.value}function HO(n,e){let t=qg(n,!0).delete(e);return new To(t).toPromise()}var z6=800,G6=3,W6=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await d0(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>G6)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=L6._getInstance(B6()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await V6(),!this.activeServiceWorker)return;this.sender=new u0(this.activeServiceWorker);let t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||j6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await d0();return await UO(t,Ug,"1"),await HO(t,Ug),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>UO(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>$6(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>HO(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(s=>{let o=qg(s,!1).getAll();return new To(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),z6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Ik=W6;var _fe=hk("rcb"),wfe=new Ao(3e4,6e4);function Ak(n,e){return e?bi(e):(re(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var ju=class extends Lu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qa(e,this._buildIdpRequest())}_linkToIdToken(e,t){return qa(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return qa(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function q6(n){return P6(n.auth,new ju(n),n.bypassAuthState)}function K6(n){let{auth:e,user:t}=n;return re(t,e,"internal-error"),x6(t,new ju(n),n.bypassAuthState)}async function Y6(n){let{auth:e,user:t}=n;return re(t,e,"internal-error"),D6(t,new ju(n),n.bypassAuthState)}var zg=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return q6;case"linkViaPopup":case"linkViaRedirect":return Y6;case"reauthViaPopup":case"reauthViaRedirect":return K6;default:Ur(this.auth,"internal-error")}}resolve(e){Ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Q6=new Ao(2e3,1e4);async function D0(n,e,t){if(Rn(n.app))return Promise.reject(mr(n,"operation-not-supported-in-this-environment"));let r=Wg(n);r6(n,e,Fu);let i=Ak(r,t);return new X6(r,"signInViaPopup",e,i).executeNotNull()}var X6=(()=>{class n extends zg{constructor(t,r,i,s,o){super(t,r,s,o),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let t=await this.execute();return re(t,this.auth,"internal-error"),t}async onExecution(){Ii(this.filter.length===1,"Popup operations only handle one event");let t=S0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(mr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(mr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Q6.get())};t()}}n.currentPopupAction=null;return n})(),J6="pendingRedirect",Mg=new Map,h0=class extends zg{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Mg.get(this.auth._key());if(!e){try{let r=await Z6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Mg.set(this.auth._key(),e)}return this.bypassAuthState||Mg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function Z6(n,e){let t=n8(e),r=t8(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function e8(n,e){Mg.set(n._key(),e)}function t8(n){return bi(n._redirectPersistence)}function n8(n){return Pg(J6,n.config.apiKey,n.name)}async function r8(n,e,t=!1){if(Rn(n.app))return Promise.reject(Io(n));let r=Wg(n),i=Ak(r,e),o=await new h0(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}var i8=600*1e3,f0=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!s8(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Tk(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(mr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=i8&&this.cachedEventUids.clear(),this.cachedEventUids.has($O(e))}saveEventToCache(e){this.cachedEventUids.add($O(e)),this.lastProcessedEventTime=Date.now()}};function $O(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Tk({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function s8(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tk(n);default:return!1}}async function o8(n,e={}){return Ka(n,"GET","/v1/projects",e)}var a8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,c8=/^https?/;async function l8(n){if(n.config.emulator)return;let{authorizedDomains:e}=await o8(n);for(let t of e)try{if(u8(t))return}catch{}Ur(n,"unauthorized-domain")}function u8(n){let e=n0(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!c8.test(t))return!1;if(a8.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var d8=new Ao(3e4,6e4);function zO(){let n=Br().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function h8(n){return new Promise((e,t)=>{function r(){zO(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zO(),t(mr(n,"network-request-failed"))},timeout:d8.get()})}if(Br().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Br().gapi?.load)r();else{let i=hk("iframefcb");return Br()[i]=()=>{gapi.load?r():t(mr(n,"network-request-failed"))},b6(`${I6()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw Rg=null,e})}var Rg=null;function f8(n){return Rg=Rg||h8(n),Rg}var p8=new Ao(5e3,15e3),g8="__/auth/iframe",m8="emulator/auth/iframe",y8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},v8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _8(n){let e=n.config;re(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?v0(e,m8):`https://${n.config.authDomain}/${g8}`,r={apiKey:e.apiKey,appName:n.name,v:ds},i=v8.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Wa(r).slice(1)}`}async function w8(n){let e=await f8(n),t=Br().gapi;return re(t,n,"internal-error"),e.open({where:document.body,url:_8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:y8,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=mr(n,"network-request-failed"),a=Br().setTimeout(()=>{s(o)},p8.get());function c(){Br().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})}))}var E8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},b8=500,I8=600,A8="_blank",T8="http://localhost",Gg=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function C8(n,e,t,r=b8,i=I8){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=J(L({},E8),{width:r.toString(),height:i.toString(),top:s,left:o}),l=kt().toLowerCase();t&&(a=sk(l)?A8:t),rk(l)&&(e=e||T8,c.scrollbars="yes");let u=Object.entries(c).reduce((f,[p,m])=>`${f}${p}=${m},`,"");if(y6(l)&&a!=="_self")return S8(e||"",a),new Gg(null);let h=window.open(e||"",a,u);re(h,n,"popup-blocked");try{h.focus()}catch{}return new Gg(h)}function S8(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var D8="__/auth/handler",x8="emulator/auth/handler",P8=encodeURIComponent("fac");async function GO(n,e,t,r,i,s){re(n.config.authDomain,n,"auth-domain-config-required"),re(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:ds,eventId:i};if(e instanceof Fu){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",wO(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[u,h]of Object.entries(s||{}))o[u]=h}if(e instanceof Bg){let u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let u of Object.keys(a))a[u]===void 0&&delete a[u];let c=await n._getAppCheckToken(),l=c?`#${P8}=${encodeURIComponent(c)}`:"";return`${M8(n)}?${Wa(a).slice(1)}${l}`}function M8({config:n}){return n.emulator?v0(n,x8):`https://${n.authDomain}/${D8}`}var t0="webStorageSupport",p0=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=C0,this._completeRedirectFn=r8,this._overrideRedirectResult=e8}async _openPopup(e,t,r,i){Ii(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let s=await GO(e,t,r,n0(),i);return C8(e,s,S0())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await GO(e,t,r,n0(),i);return F6(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ii(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await w8(e),r=new f0(e);return t.register("authEvent",i=>(re(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(t0,{type:t0},i=>{let s=i?.[0]?.[t0];s!==void 0&&t(!!s),Ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=l8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return uk()||ik()||E0()}},Ck=p0;var WO="@firebase/auth",qO="1.11.1";var g0=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function R8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function N8(n){vn(new Lt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;re(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:dk(n)},l=new c0(r,i,s,c);return A6(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),vn(new Lt("auth-internal",e=>{let t=Wg(e.getProvider("auth").getImmediate());return(r=>new g0(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),$t(WO,qO,R8(n)),$t(WO,qO,"esm2020")}var O8=300,k8=FI("authIdTokenMaxAge")||O8,KO=null,L8=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>k8)return;let i=t?.token;KO!==i&&(KO=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function x0(n=bo()){let e=gr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=fk(n,{popupRedirectResolver:Ck,persistence:[Ik,_k,C0]}),r=FI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=L8(s.toString());vk(t,o,()=>o(t.currentUser)),yk(t,a=>o(a))}}let i=kI("auth");return i&&pk(t,`http://${i}`),t}function F8(){return document.getElementsByTagName("head")?.[0]??document}E6({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=mr("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",F8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});N8("Browser");var Sk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dk={};var Ai,P0;(function(){var n;function e(T,E){function _(){}_.prototype=E.prototype,T.F=E.prototype,T.prototype=new _,T.prototype.constructor=T,T.D=function(A,C,M){for(var S=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)S[Z-2]=arguments[Z];return E.prototype[C].apply(A,S)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,E,_){_||(_=0);let A=Array(16);if(typeof E=="string")for(var C=0;C<16;++C)A[C]=E.charCodeAt(_++)|E.charCodeAt(_++)<<8|E.charCodeAt(_++)<<16|E.charCodeAt(_++)<<24;else for(C=0;C<16;++C)A[C]=E[_++]|E[_++]<<8|E[_++]<<16|E[_++]<<24;E=T.g[0],_=T.g[1],C=T.g[2];let M=T.g[3],S;S=E+(M^_&(C^M))+A[0]+3614090360&4294967295,E=_+(S<<7&4294967295|S>>>25),S=M+(C^E&(_^C))+A[1]+3905402710&4294967295,M=E+(S<<12&4294967295|S>>>20),S=C+(_^M&(E^_))+A[2]+606105819&4294967295,C=M+(S<<17&4294967295|S>>>15),S=_+(E^C&(M^E))+A[3]+3250441966&4294967295,_=C+(S<<22&4294967295|S>>>10),S=E+(M^_&(C^M))+A[4]+4118548399&4294967295,E=_+(S<<7&4294967295|S>>>25),S=M+(C^E&(_^C))+A[5]+1200080426&4294967295,M=E+(S<<12&4294967295|S>>>20),S=C+(_^M&(E^_))+A[6]+2821735955&4294967295,C=M+(S<<17&4294967295|S>>>15),S=_+(E^C&(M^E))+A[7]+4249261313&4294967295,_=C+(S<<22&4294967295|S>>>10),S=E+(M^_&(C^M))+A[8]+1770035416&4294967295,E=_+(S<<7&4294967295|S>>>25),S=M+(C^E&(_^C))+A[9]+2336552879&4294967295,M=E+(S<<12&4294967295|S>>>20),S=C+(_^M&(E^_))+A[10]+4294925233&4294967295,C=M+(S<<17&4294967295|S>>>15),S=_+(E^C&(M^E))+A[11]+2304563134&4294967295,_=C+(S<<22&4294967295|S>>>10),S=E+(M^_&(C^M))+A[12]+1804603682&4294967295,E=_+(S<<7&4294967295|S>>>25),S=M+(C^E&(_^C))+A[13]+4254626195&4294967295,M=E+(S<<12&4294967295|S>>>20),S=C+(_^M&(E^_))+A[14]+2792965006&4294967295,C=M+(S<<17&4294967295|S>>>15),S=_+(E^C&(M^E))+A[15]+1236535329&4294967295,_=C+(S<<22&4294967295|S>>>10),S=E+(C^M&(_^C))+A[1]+4129170786&4294967295,E=_+(S<<5&4294967295|S>>>27),S=M+(_^C&(E^_))+A[6]+3225465664&4294967295,M=E+(S<<9&4294967295|S>>>23),S=C+(E^_&(M^E))+A[11]+643717713&4294967295,C=M+(S<<14&4294967295|S>>>18),S=_+(M^E&(C^M))+A[0]+3921069994&4294967295,_=C+(S<<20&4294967295|S>>>12),S=E+(C^M&(_^C))+A[5]+3593408605&4294967295,E=_+(S<<5&4294967295|S>>>27),S=M+(_^C&(E^_))+A[10]+38016083&4294967295,M=E+(S<<9&4294967295|S>>>23),S=C+(E^_&(M^E))+A[15]+3634488961&4294967295,C=M+(S<<14&4294967295|S>>>18),S=_+(M^E&(C^M))+A[4]+3889429448&4294967295,_=C+(S<<20&4294967295|S>>>12),S=E+(C^M&(_^C))+A[9]+568446438&4294967295,E=_+(S<<5&4294967295|S>>>27),S=M+(_^C&(E^_))+A[14]+3275163606&4294967295,M=E+(S<<9&4294967295|S>>>23),S=C+(E^_&(M^E))+A[3]+4107603335&4294967295,C=M+(S<<14&4294967295|S>>>18),S=_+(M^E&(C^M))+A[8]+1163531501&4294967295,_=C+(S<<20&4294967295|S>>>12),S=E+(C^M&(_^C))+A[13]+2850285829&4294967295,E=_+(S<<5&4294967295|S>>>27),S=M+(_^C&(E^_))+A[2]+4243563512&4294967295,M=E+(S<<9&4294967295|S>>>23),S=C+(E^_&(M^E))+A[7]+1735328473&4294967295,C=M+(S<<14&4294967295|S>>>18),S=_+(M^E&(C^M))+A[12]+2368359562&4294967295,_=C+(S<<20&4294967295|S>>>12),S=E+(_^C^M)+A[5]+4294588738&4294967295,E=_+(S<<4&4294967295|S>>>28),S=M+(E^_^C)+A[8]+2272392833&4294967295,M=E+(S<<11&4294967295|S>>>21),S=C+(M^E^_)+A[11]+1839030562&4294967295,C=M+(S<<16&4294967295|S>>>16),S=_+(C^M^E)+A[14]+4259657740&4294967295,_=C+(S<<23&4294967295|S>>>9),S=E+(_^C^M)+A[1]+2763975236&4294967295,E=_+(S<<4&4294967295|S>>>28),S=M+(E^_^C)+A[4]+1272893353&4294967295,M=E+(S<<11&4294967295|S>>>21),S=C+(M^E^_)+A[7]+4139469664&4294967295,C=M+(S<<16&4294967295|S>>>16),S=_+(C^M^E)+A[10]+3200236656&4294967295,_=C+(S<<23&4294967295|S>>>9),S=E+(_^C^M)+A[13]+681279174&4294967295,E=_+(S<<4&4294967295|S>>>28),S=M+(E^_^C)+A[0]+3936430074&4294967295,M=E+(S<<11&4294967295|S>>>21),S=C+(M^E^_)+A[3]+3572445317&4294967295,C=M+(S<<16&4294967295|S>>>16),S=_+(C^M^E)+A[6]+76029189&4294967295,_=C+(S<<23&4294967295|S>>>9),S=E+(_^C^M)+A[9]+3654602809&4294967295,E=_+(S<<4&4294967295|S>>>28),S=M+(E^_^C)+A[12]+3873151461&4294967295,M=E+(S<<11&4294967295|S>>>21),S=C+(M^E^_)+A[15]+530742520&4294967295,C=M+(S<<16&4294967295|S>>>16),S=_+(C^M^E)+A[2]+3299628645&4294967295,_=C+(S<<23&4294967295|S>>>9),S=E+(C^(_|~M))+A[0]+4096336452&4294967295,E=_+(S<<6&4294967295|S>>>26),S=M+(_^(E|~C))+A[7]+1126891415&4294967295,M=E+(S<<10&4294967295|S>>>22),S=C+(E^(M|~_))+A[14]+2878612391&4294967295,C=M+(S<<15&4294967295|S>>>17),S=_+(M^(C|~E))+A[5]+4237533241&4294967295,_=C+(S<<21&4294967295|S>>>11),S=E+(C^(_|~M))+A[12]+1700485571&4294967295,E=_+(S<<6&4294967295|S>>>26),S=M+(_^(E|~C))+A[3]+2399980690&4294967295,M=E+(S<<10&4294967295|S>>>22),S=C+(E^(M|~_))+A[10]+4293915773&4294967295,C=M+(S<<15&4294967295|S>>>17),S=_+(M^(C|~E))+A[1]+2240044497&4294967295,_=C+(S<<21&4294967295|S>>>11),S=E+(C^(_|~M))+A[8]+1873313359&4294967295,E=_+(S<<6&4294967295|S>>>26),S=M+(_^(E|~C))+A[15]+4264355552&4294967295,M=E+(S<<10&4294967295|S>>>22),S=C+(E^(M|~_))+A[6]+2734768916&4294967295,C=M+(S<<15&4294967295|S>>>17),S=_+(M^(C|~E))+A[13]+1309151649&4294967295,_=C+(S<<21&4294967295|S>>>11),S=E+(C^(_|~M))+A[4]+4149444226&4294967295,E=_+(S<<6&4294967295|S>>>26),S=M+(_^(E|~C))+A[11]+3174756917&4294967295,M=E+(S<<10&4294967295|S>>>22),S=C+(E^(M|~_))+A[2]+718787259&4294967295,C=M+(S<<15&4294967295|S>>>17),S=_+(M^(C|~E))+A[9]+3951481745&4294967295,T.g[0]=T.g[0]+E&4294967295,T.g[1]=T.g[1]+(C+(S<<21&4294967295|S>>>11))&4294967295,T.g[2]=T.g[2]+C&4294967295,T.g[3]=T.g[3]+M&4294967295}r.prototype.v=function(T,E){E===void 0&&(E=T.length);let _=E-this.blockSize,A=this.C,C=this.h,M=0;for(;M<E;){if(C==0)for(;M<=_;)i(this,T,M),M+=this.blockSize;if(typeof T=="string"){for(;M<E;)if(A[C++]=T.charCodeAt(M++),C==this.blockSize){i(this,A),C=0;break}}else for(;M<E;)if(A[C++]=T[M++],C==this.blockSize){i(this,A),C=0;break}}this.h=C,this.o+=E},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var E=1;E<T.length-8;++E)T[E]=0;E=this.o*8;for(var _=T.length-8;_<T.length;++_)T[_]=E&255,E/=256;for(this.v(T),T=Array(16),E=0,_=0;_<4;++_)for(let A=0;A<32;A+=8)T[E++]=this.g[_]>>>A&255;return T};function s(T,E){var _=a;return Object.prototype.hasOwnProperty.call(_,T)?_[T]:_[T]=E(T)}function o(T,E){this.h=E;let _=[],A=!0;for(let C=T.length-1;C>=0;C--){let M=T[C]|0;A&&M==E||(_[C]=M,A=!1)}this.g=_}var a={};function c(T){return-128<=T&&T<128?s(T,function(E){return new o([E|0],E<0?-1:0)}):new o([T|0],T<0?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return h;if(T<0)return w(l(-T));let E=[],_=1;for(let A=0;T>=_;A++)E[A]=T/_|0,_*=4294967296;return new o(E,0)}function u(T,E){if(T.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(T.charAt(0)=="-")return w(u(T.substring(1),E));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');let _=l(Math.pow(E,8)),A=h;for(let M=0;M<T.length;M+=8){var C=Math.min(8,T.length-M);let S=parseInt(T.substring(M,M+C),E);C<8?(C=l(Math.pow(E,C)),A=A.j(C).add(l(S))):(A=A.j(_),A=A.add(l(S)))}return A}var h=c(0),f=c(1),p=c(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();let T=0,E=1;for(let _=0;_<this.g.length;_++){let A=this.i(_);T+=(A>=0?A:4294967296+A)*E,E*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(m(this))return"0";if(v(this))return"-"+w(this).toString(T);let E=l(Math.pow(T,6));var _=this;let A="";for(;;){let C=x(_,E).g;_=I(_,C.j(E));let M=((_.g.length>0?_.g[0]:_.h)>>>0).toString(T);if(_=C,m(_))return M+A;for(;M.length<6;)M="0"+M;A=M+A}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function m(T){if(T.h!=0)return!1;for(let E=0;E<T.g.length;E++)if(T.g[E]!=0)return!1;return!0}function v(T){return T.h==-1}n.l=function(T){return T=I(this,T),v(T)?-1:m(T)?0:1};function w(T){let E=T.g.length,_=[];for(let A=0;A<E;A++)_[A]=~T.g[A];return new o(_,~T.h).add(f)}n.abs=function(){return v(this)?w(this):this},n.add=function(T){let E=Math.max(this.g.length,T.g.length),_=[],A=0;for(let C=0;C<=E;C++){let M=A+(this.i(C)&65535)+(T.i(C)&65535),S=(M>>>16)+(this.i(C)>>>16)+(T.i(C)>>>16);A=S>>>16,M&=65535,S&=65535,_[C]=S<<16|M}return new o(_,_[_.length-1]&-2147483648?-1:0)};function I(T,E){return T.add(w(E))}n.j=function(T){if(m(this)||m(T))return h;if(v(this))return v(T)?w(this).j(w(T)):w(w(this).j(T));if(v(T))return w(this.j(w(T)));if(this.l(p)<0&&T.l(p)<0)return l(this.m()*T.m());let E=this.g.length+T.g.length,_=[];for(var A=0;A<2*E;A++)_[A]=0;for(A=0;A<this.g.length;A++)for(let C=0;C<T.g.length;C++){let M=this.i(A)>>>16,S=this.i(A)&65535,Z=T.i(C)>>>16,_e=T.i(C)&65535;_[2*A+2*C]+=S*_e,D(_,2*A+2*C),_[2*A+2*C+1]+=M*_e,D(_,2*A+2*C+1),_[2*A+2*C+1]+=S*Z,D(_,2*A+2*C+1),_[2*A+2*C+2]+=M*Z,D(_,2*A+2*C+2)}for(T=0;T<E;T++)_[T]=_[2*T+1]<<16|_[2*T];for(T=E;T<2*E;T++)_[T]=0;return new o(_,0)};function D(T,E){for(;(T[E]&65535)!=T[E];)T[E+1]+=T[E]>>>16,T[E]&=65535,E++}function P(T,E){this.g=T,this.h=E}function x(T,E){if(m(E))throw Error("division by zero");if(m(T))return new P(h,h);if(v(T))return E=x(w(T),E),new P(w(E.g),w(E.h));if(v(E))return E=x(T,w(E)),new P(w(E.g),E.h);if(T.g.length>30){if(v(T)||v(E))throw Error("slowDivide_ only works with positive integers.");for(var _=f,A=E;A.l(T)<=0;)_=N(_),A=N(A);var C=k(_,1),M=k(A,1);for(A=k(A,2),_=k(_,2);!m(A);){var S=M.add(A);S.l(T)<=0&&(C=C.add(_),M=S),A=k(A,1),_=k(_,1)}return E=I(T,C.j(E)),new P(C,E)}for(C=h;T.l(E)>=0;){for(_=Math.max(1,Math.floor(T.m()/E.m())),A=Math.ceil(Math.log(_)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),M=l(_),S=M.j(E);v(S)||S.l(T)>0;)_-=A,M=l(_),S=M.j(E);m(M)&&(M=f),C=C.add(M),T=I(T,S)}return new P(C,T)}n.B=function(T){return x(this,T).h},n.and=function(T){let E=Math.max(this.g.length,T.g.length),_=[];for(let A=0;A<E;A++)_[A]=this.i(A)&T.i(A);return new o(_,this.h&T.h)},n.or=function(T){let E=Math.max(this.g.length,T.g.length),_=[];for(let A=0;A<E;A++)_[A]=this.i(A)|T.i(A);return new o(_,this.h|T.h)},n.xor=function(T){let E=Math.max(this.g.length,T.g.length),_=[];for(let A=0;A<E;A++)_[A]=this.i(A)^T.i(A);return new o(_,this.h^T.h)};function N(T){let E=T.g.length+1,_=[];for(let A=0;A<E;A++)_[A]=T.i(A)<<1|T.i(A-1)>>>31;return new o(_,T.h)}function k(T,E){let _=E>>5;E%=32;let A=T.g.length-_,C=[];for(let M=0;M<A;M++)C[M]=E>0?T.i(M+_)>>>E|T.i(M+_+1)<<32-E:T.i(M+_);return new o(C,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,P0=Dk.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,Ai=Dk.Integer=o}).apply(typeof Sk<"u"?Sk:typeof self<"u"?self:typeof window<"u"?window:{});var Kg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ti={};var M0,V8,Ya,R0,Bu,Yg,N0,O0,k0;(function(){var n,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kg=="object"&&Kg];for(var g=0;g<d.length;++g){var y=d[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=t(this);function i(d,g){if(g)e:{var y=r;d=d.split(".");for(var b=0;b<d.length-1;b++){var R=d[b];if(!(R in y))break e;y=y[R]}d=d[d.length-1],b=y[d],g=g(b),g!=b&&g!=null&&e(y,d,{configurable:!0,writable:!0,value:g})}}i("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(d){return d||function(g){var y=[],b;for(b in g)Object.prototype.hasOwnProperty.call(g,b)&&y.push([b,g[b]]);return y}});var s=s||{},o=this||self;function a(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function c(d,g,y){return d.call.apply(d.bind,arguments)}function l(d,g,y){return l=c,l.apply(null,arguments)}function u(d,g){var y=Array.prototype.slice.call(arguments,1);return function(){var b=y.slice();return b.push.apply(b,arguments),d.apply(this,b)}}function h(d,g){function y(){}y.prototype=g.prototype,d.Z=g.prototype,d.prototype=new y,d.prototype.constructor=d,d.Ob=function(b,R,O){for(var U=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)U[ge-2]=arguments[ge];return g.prototype[R].apply(b,U)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function p(d){let g=d.length;if(g>0){let y=Array(g);for(let b=0;b<g;b++)y[b]=d[b];return y}return[]}function m(d,g){for(let b=1;b<arguments.length;b++){let R=arguments[b];var y=typeof R;if(y=y!="object"?y:R?Array.isArray(R)?"array":y:"null",y=="array"||y=="object"&&typeof R.length=="number"){y=d.length||0;let O=R.length||0;d.length=y+O;for(let U=0;U<O;U++)d[y+U]=R[U]}else d.push(R)}}class v{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function w(d){o.setTimeout(()=>{throw d},0)}function I(){var d=T;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class D{constructor(){this.h=this.g=null}add(g,y){let b=P.get();b.set(g,y),this.h?this.h.next=b:this.g=b,this.h=b}}var P=new v(()=>new x,d=>d.reset());class x{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let N,k=!1,T=new D,E=()=>{let d=Promise.resolve(void 0);N=()=>{d.then(_)}};function _(){for(var d;d=I();){try{d.h.call(d.g)}catch(y){w(y)}var g=P;g.j(d),g.h<100&&(g.h++,d.next=g.g,g.g=d)}k=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{let y=()=>{};o.addEventListener("test",y,g),o.removeEventListener("test",y,g)}catch{}return d})();function S(d){return/^[\s\xa0]*$/.test(d)}function Z(d,g){C.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,g)}h(Z,C),Z.prototype.init=function(d,g){let y=this.type=d.type,b=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget,g||(y=="mouseover"?g=d.fromElement:y=="mouseout"&&(g=d.toElement)),this.relatedTarget=g,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Z.Z.h.call(this)},Z.prototype.h=function(){Z.Z.h.call(this);let d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var _e="closure_listenable_"+(Math.random()*1e6|0),We=0;function X(d,g,y,b,R){this.listener=d,this.proxy=null,this.src=g,this.type=y,this.capture=!!b,this.ha=R,this.key=++We,this.da=this.fa=!1}function se(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function _n(d,g,y){for(let b in d)g.call(y,d[b],b,d)}function Yr(d,g){for(let y in d)g.call(void 0,d[y],y,d)}function en(d){let g={};for(let y in d)g[y]=d[y];return g}let ot="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Qe(d,g){let y,b;for(let R=1;R<arguments.length;R++){b=arguments[R];for(y in b)d[y]=b[y];for(let O=0;O<ot.length;O++)y=ot[O],Object.prototype.hasOwnProperty.call(b,y)&&(d[y]=b[y])}}function Qn(d){this.src=d,this.g={},this.h=0}Qn.prototype.add=function(d,g,y,b,R){let O=d.toString();d=this.g[O],d||(d=this.g[O]=[],this.h++);let U=zt(d,g,b,R);return U>-1?(g=d[U],y||(g.fa=!1)):(g=new X(g,this.src,O,!!b,R),g.fa=y,d.push(g)),g};function Qr(d,g){let y=g.type;if(y in d.g){var b=d.g[y],R=Array.prototype.indexOf.call(b,g,void 0),O;(O=R>=0)&&Array.prototype.splice.call(b,R,1),O&&(se(g),d.g[y].length==0&&(delete d.g[y],d.h--))}}function zt(d,g,y,b){for(let R=0;R<d.length;++R){let O=d[R];if(!O.da&&O.listener==g&&O.capture==!!y&&O.ha==b)return R}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),wn={};function Bo(d,g,y,b,R){if(b&&b.once)return dC(d,g,y,b,R);if(Array.isArray(g)){for(let O=0;O<g.length;O++)Bo(d,g[O],y,b,R);return null}return y=ty(y),d&&d[_e]?d.J(g,y,a(b)?!!b.capture:!!b,R):ad(d,g,y,!1,b,R)}function ad(d,g,y,b,R,O){if(!g)throw Error("Invalid event type");let U=a(R)?!!R.capture:!!R,ge=Zm(d);if(ge||(d[Fe]=ge=new Qn(d)),y=ge.add(g,y,b,U,O),y.proxy)return y;if(b=bF(),y.proxy=b,b.src=d,b.listener=y,d.addEventListener)M||(R=U),R===void 0&&(R=!1),d.addEventListener(g.toString(),b,R);else if(d.attachEvent)d.attachEvent(fC(g.toString()),b);else if(d.addListener&&d.removeListener)d.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return y}function bF(){function d(y){return g.call(d.src,d.listener,y)}let g=IF;return d}function dC(d,g,y,b,R){if(Array.isArray(g)){for(let O=0;O<g.length;O++)dC(d,g[O],y,b,R);return null}return y=ty(y),d&&d[_e]?d.K(g,y,a(b)?!!b.capture:!!b,R):ad(d,g,y,!0,b,R)}function hC(d,g,y,b,R){if(Array.isArray(g))for(var O=0;O<g.length;O++)hC(d,g[O],y,b,R);else b=a(b)?!!b.capture:!!b,y=ty(y),d&&d[_e]?(d=d.i,O=String(g).toString(),O in d.g&&(g=d.g[O],y=zt(g,y,b,R),y>-1&&(se(g[y]),Array.prototype.splice.call(g,y,1),g.length==0&&(delete d.g[O],d.h--)))):d&&(d=Zm(d))&&(g=d.g[g.toString()],d=-1,g&&(d=zt(g,y,b,R)),(y=d>-1?g[d]:null)&&Jm(y))}function Jm(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[_e])Qr(g.i,d);else{var y=d.type,b=d.proxy;g.removeEventListener?g.removeEventListener(y,b,d.capture):g.detachEvent?g.detachEvent(fC(y),b):g.addListener&&g.removeListener&&g.removeListener(b),(y=Zm(g))?(Qr(y,d),y.h==0&&(y.src=null,g[Fe]=null)):se(d)}}}function fC(d){return d in wn?wn[d]:wn[d]="on"+d}function IF(d,g){if(d.da)d=!0;else{g=new Z(g,this);let y=d.listener,b=d.ha||d.src;d.fa&&Jm(d),d=y.call(b,g)}return d}function Zm(d){return d=d[Fe],d instanceof Qn?d:null}var ey="__closure_events_fn_"+(Math.random()*1e9>>>0);function ty(d){return typeof d=="function"?d:(d[ey]||(d[ey]=function(g){return d.handleEvent(g)}),d[ey])}function Gt(){A.call(this),this.i=new Qn(this),this.M=this,this.G=null}h(Gt,A),Gt.prototype[_e]=!0,Gt.prototype.removeEventListener=function(d,g,y,b){hC(this,d,g,y,b)};function tn(d,g){var y,b=d.G;if(b)for(y=[];b;b=b.G)y.push(b);if(d=d.M,b=g.type||g,typeof g=="string")g=new C(g,d);else if(g instanceof C)g.target=g.target||d;else{var R=g;g=new C(b,d),Qe(g,R)}R=!0;let O,U;if(y)for(U=y.length-1;U>=0;U--)O=g.g=y[U],R=cd(O,b,!0,g)&&R;if(O=g.g=d,R=cd(O,b,!0,g)&&R,R=cd(O,b,!1,g)&&R,y)for(U=0;U<y.length;U++)O=g.g=y[U],R=cd(O,b,!1,g)&&R}Gt.prototype.N=function(){if(Gt.Z.N.call(this),this.i){var d=this.i;for(let g in d.g){let y=d.g[g];for(let b=0;b<y.length;b++)se(y[b]);delete d.g[g],d.h--}}this.G=null},Gt.prototype.J=function(d,g,y,b){return this.i.add(String(d),g,!1,y,b)},Gt.prototype.K=function(d,g,y,b){return this.i.add(String(d),g,!0,y,b)};function cd(d,g,y,b){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();let R=!0;for(let O=0;O<g.length;++O){let U=g[O];if(U&&!U.da&&U.capture==y){let ge=U.listener,yt=U.ha||U.src;U.fa&&Qr(d.i,U),R=ge.call(yt,b)!==!1&&R}}return R&&!b.defaultPrevented}function AF(d,g){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=l(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:o.setTimeout(d,g||0)}function pC(d){d.g=AF(()=>{d.g=null,d.i&&(d.i=!1,pC(d))},d.l);let g=d.h;d.h=null,d.m.apply(null,g)}class TF extends A{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:pC(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sc(d){A.call(this),this.h=d,this.g={}}h(Sc,A);var gC=[];function mC(d){_n(d.g,function(g,y){this.g.hasOwnProperty(y)&&Jm(g)},d),d.g={}}Sc.prototype.N=function(){Sc.Z.N.call(this),mC(this)},Sc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ny=o.JSON.stringify,CF=o.JSON.parse,SF=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function yC(){}function vC(){}var Dc={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ry(){C.call(this,"d")}h(ry,C);function iy(){C.call(this,"c")}h(iy,C);var bs={},_C=null;function ld(){return _C=_C||new Gt}bs.Ia="serverreachability";function wC(d){C.call(this,bs.Ia,d)}h(wC,C);function xc(d){let g=ld();tn(g,new wC(g))}bs.STAT_EVENT="statevent";function EC(d,g){C.call(this,bs.STAT_EVENT,d),this.stat=g}h(EC,C);function nn(d){let g=ld();tn(g,new EC(g,d))}bs.Ja="timingevent";function bC(d,g){C.call(this,bs.Ja,d),this.size=g}h(bC,C);function Pc(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},g)}function Mc(){this.g=!0}Mc.prototype.ua=function(){this.g=!1};function DF(d,g,y,b,R,O){d.info(function(){if(d.g)if(O){var U="",ge=O.split("&");for(let je=0;je<ge.length;je++){var yt=ge[je].split("=");if(yt.length>1){let St=yt[0];yt=yt[1];let _r=St.split("_");U=_r.length>=2&&_r[1]=="type"?U+(St+"="+yt+"&"):U+(St+"=redacted&")}}}else U=null;else U=O;return"XMLHTTP REQ ("+b+") [attempt "+R+"]: "+g+`
`+y+`
`+U})}function xF(d,g,y,b,R,O,U){d.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+R+"]: "+g+`
`+y+`
`+O+" "+U})}function Uo(d,g,y,b){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+MF(d,y)+(b?" "+b:"")})}function PF(d,g){d.info(function(){return"TIMEOUT: "+g})}Mc.prototype.info=function(){};function MF(d,g){if(!d.g)return g;if(!g)return null;try{let O=JSON.parse(g);if(O){for(d=0;d<O.length;d++)if(Array.isArray(O[d])){var y=O[d];if(!(y.length<2)){var b=y[1];if(Array.isArray(b)&&!(b.length<1)){var R=b[0];if(R!="noop"&&R!="stop"&&R!="close")for(let U=1;U<b.length;U++)b[U]=""}}}}return ny(O)}catch{return g}}var ud={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},IC={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},AC;function sy(){}h(sy,yC),sy.prototype.g=function(){return new XMLHttpRequest},AC=new sy;function Rc(d){return encodeURIComponent(String(d))}function RF(d){var g=1;d=d.split(":");let y=[];for(;g>0&&d.length;)y.push(d.shift()),g--;return d.length&&y.push(d.join(":")),y}function Ri(d,g,y,b){this.j=d,this.i=g,this.l=y,this.S=b||1,this.V=new Sc(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new TC}function TC(){this.i=null,this.g="",this.h=!1}var CC={},oy={};function ay(d,g,y){d.M=1,d.A=hd(vr(g)),d.u=y,d.R=!0,SC(d,null)}function SC(d,g){d.F=Date.now(),dd(d),d.B=vr(d.A);var y=d.B,b=d.S;Array.isArray(b)||(b=[String(b)]),BC(y.i,"t",b),d.C=0,y=d.j.L,d.h=new TC,d.g=iS(d.j,y?g:null,!d.u),d.P>0&&(d.O=new TF(l(d.Y,d,d.g),d.P)),g=d.V,y=d.g,b=d.ba;var R="readystatechange";Array.isArray(R)||(R&&(gC[0]=R.toString()),R=gC);for(let O=0;O<R.length;O++){let U=Bo(y,R[O],b||g.handleEvent,!1,g.h||g);if(!U)break;g.g[U.key]=U}g=d.J?en(d.J):{},d.u?(d.v||(d.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,g)):(d.v="GET",d.g.ea(d.B,d.v,null,g)),xc(),DF(d.i,d.v,d.B,d.l,d.S,d.u)}Ri.prototype.ba=function(d){d=d.target;let g=this.O;g&&ki(d)==3?g.j():this.Y(d)},Ri.prototype.Y=function(d){try{if(d==this.g)e:{let ge=ki(this.g),yt=this.g.ya(),je=this.g.ca();if(!(ge<3)&&(ge!=3||this.g&&(this.h.h||this.g.la()||qC(this.g)))){this.K||ge!=4||yt==7||(yt==8||je<=0?xc(3):xc(2)),cy(this);var g=this.g.ca();this.X=g;var y=NF(this);if(this.o=g==200,xF(this.i,this.v,this.B,this.l,this.S,ge,g),this.o){if(this.U&&!this.L){t:{if(this.g){var b,R=this.g;if((b=R.g?R.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(b)){var O=b;break t}}O=null}if(d=O)Uo(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ly(this,d);else{this.o=!1,this.m=3,nn(12),Is(this),Nc(this);break e}}if(this.R){d=!0;let St;for(;!this.K&&this.C<y.length;)if(St=OF(this,y),St==oy){ge==4&&(this.m=4,nn(14),d=!1),Uo(this.i,this.l,null,"[Incomplete Response]");break}else if(St==CC){this.m=4,nn(15),Uo(this.i,this.l,y,"[Invalid Chunk]"),d=!1;break}else Uo(this.i,this.l,St,null),ly(this,St);if(DC(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ge!=4||y.length!=0||this.h.h||(this.m=1,nn(16),d=!1),this.o=this.o&&d,!d)Uo(this.i,this.l,y,"[Invalid Chunked Response]"),Is(this),Nc(this);else if(y.length>0&&!this.W){this.W=!0;var U=this.j;U.g==this&&U.aa&&!U.P&&(U.j.info("Great, no buffering proxy detected. Bytes received: "+y.length),my(U),U.P=!0,nn(11))}}else Uo(this.i,this.l,y,null),ly(this,y);ge==4&&Is(this),this.o&&!this.K&&(ge==4?eS(this.j,this):(this.o=!1,dd(this)))}else KF(this.g),g==400&&y.indexOf("Unknown SID")>0?(this.m=3,nn(12)):(this.m=0,nn(13)),Is(this),Nc(this)}}}catch{}finally{}};function NF(d){if(!DC(d))return d.g.la();let g=qC(d.g);if(g==="")return"";let y="",b=g.length,R=ki(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Is(d),Nc(d),"";d.h.i=new o.TextDecoder}for(let O=0;O<b;O++)d.h.h=!0,y+=d.h.i.decode(g[O],{stream:!(R&&O==b-1)});return g.length=0,d.h.g+=y,d.C=0,d.h.g}function DC(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function OF(d,g){var y=d.C,b=g.indexOf(`
`,y);return b==-1?oy:(y=Number(g.substring(y,b)),isNaN(y)?CC:(b+=1,b+y>g.length?oy:(g=g.slice(b,b+y),d.C=b+y,g)))}Ri.prototype.cancel=function(){this.K=!0,Is(this)};function dd(d){d.T=Date.now()+d.H,xC(d,d.H)}function xC(d,g){if(d.D!=null)throw Error("WatchDog timer not null");d.D=Pc(l(d.aa,d),g)}function cy(d){d.D&&(o.clearTimeout(d.D),d.D=null)}Ri.prototype.aa=function(){this.D=null;let d=Date.now();d-this.T>=0?(PF(this.i,this.B),this.M!=2&&(xc(),nn(17)),Is(this),this.m=2,Nc(this)):xC(this,this.T-d)};function Nc(d){d.j.I==0||d.K||eS(d.j,d)}function Is(d){cy(d);var g=d.O;g&&typeof g.dispose=="function"&&g.dispose(),d.O=null,mC(d.V),d.g&&(g=d.g,d.g=null,g.abort(),g.dispose())}function ly(d,g){try{var y=d.j;if(y.I!=0&&(y.g==d||uy(y.h,d))){if(!d.L&&uy(y.h,d)&&y.I==3){try{var b=y.Ba.g.parse(g)}catch{b=null}if(Array.isArray(b)&&b.length==3){var R=b;if(R[0]==0){e:if(!y.v){if(y.g)if(y.g.F+3e3<d.F)vd(y),md(y);else break e;gy(y),nn(18)}}else y.xa=R[1],0<y.xa-y.K&&R[2]<37500&&y.F&&y.A==0&&!y.C&&(y.C=Pc(l(y.Va,y),6e3));RC(y.h)<=1&&y.ta&&(y.ta=void 0)}else Ts(y,11)}else if((d.L||y.g==d)&&vd(y),!S(g))for(R=y.Ba.g.parse(g),g=0;g<R.length;g++){let je=R[g],St=je[0];if(!(St<=y.K))if(y.K=St,je=je[1],y.I==2)if(je[0]=="c"){y.M=je[1],y.ba=je[2];let _r=je[3];_r!=null&&(y.ka=_r,y.j.info("VER="+y.ka));let Cs=je[4];Cs!=null&&(y.za=Cs,y.j.info("SVER="+y.za));let Li=je[5];Li!=null&&typeof Li=="number"&&Li>0&&(b=1.5*Li,y.O=b,y.j.info("backChannelRequestTimeoutMs_="+b)),b=y;let Fi=d.g;if(Fi){let wd=Fi.g?Fi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wd){var O=b.h;O.g||wd.indexOf("spdy")==-1&&wd.indexOf("quic")==-1&&wd.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(dy(O,O.h),O.h=null))}if(b.G){let yy=Fi.g?Fi.g.getResponseHeader("X-HTTP-Session-Id"):null;yy&&(b.wa=yy,He(b.J,b.G,yy))}}y.I=3,y.l&&y.l.ra(),y.aa&&(y.T=Date.now()-d.F,y.j.info("Handshake RTT: "+y.T+"ms")),b=y;var U=d;if(b.na=rS(b,b.L?b.ba:null,b.W),U.L){NC(b.h,U);var ge=U,yt=b.O;yt&&(ge.H=yt),ge.D&&(cy(ge),dd(ge)),b.g=U}else JC(b);y.i.length>0&&yd(y)}else je[0]!="stop"&&je[0]!="close"||Ts(y,7);else y.I==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?Ts(y,7):py(y):je[0]!="noop"&&y.l&&y.l.qa(je),y.A=0)}}xc(4)}catch{}}var kF=class{constructor(d,g){this.g=d,this.map=g}};function PC(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function MC(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function RC(d){return d.h?1:d.g?d.g.size:0}function uy(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function dy(d,g){d.g?d.g.add(g):d.h=g}function NC(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}PC.prototype.cancel=function(){if(this.i=OC(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let d of this.g.values())d.cancel();this.g.clear()}};function OC(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let g=d.i;for(let y of d.g.values())g=g.concat(y.G);return g}return p(d.i)}var kC=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function LF(d,g){if(d){d=d.split("&");for(let y=0;y<d.length;y++){let b=d[y].indexOf("="),R,O=null;b>=0?(R=d[y].substring(0,b),O=d[y].substring(b+1)):R=d[y],g(R,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function Ni(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;d instanceof Ni?(this.l=d.l,Oc(this,d.j),this.o=d.o,this.g=d.g,kc(this,d.u),this.h=d.h,hy(this,UC(d.i)),this.m=d.m):d&&(g=String(d).match(kC))?(this.l=!1,Oc(this,g[1]||"",!0),this.o=Lc(g[2]||""),this.g=Lc(g[3]||"",!0),kc(this,g[4]),this.h=Lc(g[5]||"",!0),hy(this,g[6]||"",!0),this.m=Lc(g[7]||"")):(this.l=!1,this.i=new Vc(null,this.l))}Ni.prototype.toString=function(){let d=[];var g=this.j;g&&d.push(Fc(g,LC,!0),":");var y=this.g;return(y||g=="file")&&(d.push("//"),(g=this.o)&&d.push(Fc(g,LC,!0),"@"),d.push(Rc(y).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.u,y!=null&&d.push(":",String(y))),(y=this.h)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(Fc(y,y.charAt(0)=="/"?jF:VF,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",Fc(y,UF)),d.join("")},Ni.prototype.resolve=function(d){let g=vr(this),y=!!d.j;y?Oc(g,d.j):y=!!d.o,y?g.o=d.o:y=!!d.g,y?g.g=d.g:y=d.u!=null;var b=d.h;if(y)kc(g,d.u);else if(y=!!d.h){if(b.charAt(0)!="/")if(this.g&&!this.h)b="/"+b;else{var R=g.h.lastIndexOf("/");R!=-1&&(b=g.h.slice(0,R+1)+b)}if(R=b,R==".."||R==".")b="";else if(R.indexOf("./")!=-1||R.indexOf("/.")!=-1){b=R.lastIndexOf("/",0)==0,R=R.split("/");let O=[];for(let U=0;U<R.length;){let ge=R[U++];ge=="."?b&&U==R.length&&O.push(""):ge==".."?((O.length>1||O.length==1&&O[0]!="")&&O.pop(),b&&U==R.length&&O.push("")):(O.push(ge),b=!0)}b=O.join("/")}else b=R}return y?g.h=b:y=d.i.toString()!=="",y?hy(g,UC(d.i)):y=!!d.m,y&&(g.m=d.m),g};function vr(d){return new Ni(d)}function Oc(d,g,y){d.j=y?Lc(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function kc(d,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);d.u=g}else d.u=null}function hy(d,g,y){g instanceof Vc?(d.i=g,HF(d.i,d.l)):(y||(g=Fc(g,BF)),d.i=new Vc(g,d.l))}function He(d,g,y){d.i.set(g,y)}function hd(d){return He(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Lc(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Fc(d,g,y){return typeof d=="string"?(d=encodeURI(d).replace(g,FF),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function FF(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var LC=/[#\/\?@]/g,VF=/[#\?:]/g,jF=/[#\?]/g,BF=/[#\?@]/g,UF=/#/g;function Vc(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function As(d){d.g||(d.g=new Map,d.h=0,d.i&&LF(d.i,function(g,y){d.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}n=Vc.prototype,n.add=function(d,g){As(this),this.i=null,d=Ho(this,d);let y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(g),this.h+=1,this};function FC(d,g){As(d),g=Ho(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function VC(d,g){return As(d),g=Ho(d,g),d.g.has(g)}n.forEach=function(d,g){As(this),this.g.forEach(function(y,b){y.forEach(function(R){d.call(g,R,b,this)},this)},this)};function jC(d,g){As(d);let y=[];if(typeof g=="string")VC(d,g)&&(y=y.concat(d.g.get(Ho(d,g))));else for(d=Array.from(d.g.values()),g=0;g<d.length;g++)y=y.concat(d[g]);return y}n.set=function(d,g){return As(this),this.i=null,d=Ho(this,d),VC(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},n.get=function(d,g){return d?(d=jC(this,d),d.length>0?String(d[0]):g):g};function BC(d,g,y){FC(d,g),y.length>0&&(d.i=null,d.g.set(Ho(d,g),p(y)),d.h+=y.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let d=[],g=Array.from(this.g.keys());for(let b=0;b<g.length;b++){var y=g[b];let R=Rc(y);y=jC(this,y);for(let O=0;O<y.length;O++){let U=R;y[O]!==""&&(U+="="+Rc(y[O])),d.push(U)}}return this.i=d.join("&")};function UC(d){let g=new Vc;return g.i=d.i,d.g&&(g.g=new Map(d.g),g.h=d.h),g}function Ho(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function HF(d,g){g&&!d.j&&(As(d),d.i=null,d.g.forEach(function(y,b){let R=b.toLowerCase();b!=R&&(FC(this,b),BC(this,R,y))},d)),d.j=g}function $F(d,g){let y=new Mc;if(o.Image){let b=new Image;b.onload=u(Oi,y,"TestLoadImage: loaded",!0,g,b),b.onerror=u(Oi,y,"TestLoadImage: error",!1,g,b),b.onabort=u(Oi,y,"TestLoadImage: abort",!1,g,b),b.ontimeout=u(Oi,y,"TestLoadImage: timeout",!1,g,b),o.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=d}else g(!1)}function zF(d,g){let y=new Mc,b=new AbortController,R=setTimeout(()=>{b.abort(),Oi(y,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:b.signal}).then(O=>{clearTimeout(R),O.ok?Oi(y,"TestPingServer: ok",!0,g):Oi(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(R),Oi(y,"TestPingServer: error",!1,g)})}function Oi(d,g,y,b,R){try{R&&(R.onload=null,R.onerror=null,R.onabort=null,R.ontimeout=null),b(y)}catch{}}function GF(){this.g=new SF}function fd(d){this.i=d.Sb||null,this.h=d.ab||!1}h(fd,yC),fd.prototype.g=function(){return new pd(this.i,this.h)};function pd(d,g){Gt.call(this),this.H=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(pd,Gt),n=pd.prototype,n.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=g,this.readyState=1,Bc(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(g.body=d),(this.H||o).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,jc(this)),this.readyState=0},n.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Bc(this)),this.g&&(this.readyState=3,Bc(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;HC(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function HC(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}n.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?jc(this):Bc(this),this.readyState==3&&HC(this)}},n.Oa=function(d){this.g&&(this.response=this.responseText=d,jc(this))},n.Na=function(d){this.g&&(this.response=d,jc(this))},n.ga=function(){this.g&&jc(this)};function jc(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Bc(d)}n.setRequestHeader=function(d,g){this.A.append(d,g)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let d=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=g.next();return d.join(`\r
`)};function Bc(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(pd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function $C(d){let g="";return _n(d,function(y,b){g+=b,g+=":",g+=y,g+=`\r
`}),g}function fy(d,g,y){e:{for(b in y){var b=!1;break e}b=!0}b||(y=$C(y),typeof d=="string"?y!=null&&Rc(y):He(d,g,y))}function et(d){Gt.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(et,Gt);var WF=/^https?$/i,qF=["POST","PUT"];n=et.prototype,n.Fa=function(d){this.H=d},n.ea=function(d,g,y,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():AC.g(),this.g.onreadystatechange=f(l(this.Ca,this));try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(O){zC(this,O);return}if(d=y||"",y=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var R in b)y.set(R,b[R]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(let O of b.keys())y.set(O,b.get(O));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(y.keys()).find(O=>O.toLowerCase()=="content-type"),R=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(qF,g,void 0)>=0)||b||R||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[O,U]of y)this.g.setRequestHeader(O,U);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(O){zC(this,O)}};function zC(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.o=5,GC(d),gd(d)}function GC(d){d.A||(d.A=!0,tn(d,"complete"),tn(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,tn(this,"complete"),tn(this,"abort"),gd(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gd(this,!0)),et.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?WC(this):this.Xa())},n.Xa=function(){WC(this)};function WC(d){if(d.h&&typeof s<"u"){if(d.v&&ki(d)==4)setTimeout(d.Ca.bind(d),0);else if(tn(d,"readystatechange"),ki(d)==4){d.h=!1;try{let O=d.ca();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var b;if(b=O===0){let U=String(d.D).match(kC)[1]||null;!U&&o.self&&o.self.location&&(U=o.self.location.protocol.slice(0,-1)),b=!WF.test(U?U.toLowerCase():"")}y=b}if(y)tn(d,"complete"),tn(d,"success");else{d.o=6;try{var R=ki(d)>2?d.g.statusText:""}catch{R=""}d.l=R+" ["+d.ca()+"]",GC(d)}}finally{gd(d)}}}}function gd(d,g){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);let y=d.g;d.g=null,g||tn(d,"ready");try{y.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ki(d){return d.g?d.g.readyState:0}n.ca=function(){try{return ki(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),CF(g)}};function qC(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function KF(d){let g={};d=(d.g&&ki(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<d.length;b++){if(S(d[b]))continue;var y=RF(d[b]);let R=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();let O=g[R]||[];g[R]=O,O.push(y)}Yr(g,function(b){return b.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Uc(d,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||g}function KC(d){this.za=0,this.i=[],this.j=new Mc,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Uc("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Uc("baseRetryDelayMs",5e3,d),this.Za=Uc("retryDelaySeedMs",1e4,d),this.Ta=Uc("forwardChannelMaxRetries",2,d),this.va=Uc("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new PC(d&&d.concurrentRequestLimit),this.Ba=new GF,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=KC.prototype,n.ka=8,n.I=1,n.connect=function(d,g,y,b){nn(0),this.W=d,this.H=g||{},y&&b!==void 0&&(this.H.OSID=y,this.H.OAID=b),this.F=this.X,this.J=rS(this,null,this.W),yd(this)};function py(d){if(YC(d),d.I==3){var g=d.V++,y=vr(d.J);if(He(y,"SID",d.M),He(y,"RID",g),He(y,"TYPE","terminate"),Hc(d,y),g=new Ri(d,d.j,g),g.M=2,g.A=hd(vr(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(g.A.toString(),"")}catch{}!y&&o.Image&&(new Image().src=g.A,y=!0),y||(g.g=iS(g.j,null),g.g.ea(g.A)),g.F=Date.now(),dd(g)}nS(d)}function md(d){d.g&&(my(d),d.g.cancel(),d.g=null)}function YC(d){md(d),d.v&&(o.clearTimeout(d.v),d.v=null),vd(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function yd(d){if(!MC(d.h)&&!d.m){d.m=!0;var g=d.Ea;N||E(),k||(N(),k=!0),T.add(g,d),d.D=0}}function YF(d,g){return RC(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=g.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=Pc(l(d.Ea,d,g),tS(d,d.D)),d.D++,!0)}n.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;let R=new Ri(this,this.j,d),O=this.o;if(this.U&&(O?(O=en(O),Qe(O,this.U)):O=this.U),this.u!==null||this.R||(R.J=O,O=null),this.S)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var b=this.i[y];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(g+=b,g>4096){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=XC(this,R,g),y=vr(this.J),He(y,"RID",d),He(y,"CVER",22),this.G&&He(y,"X-HTTP-Session-Id",this.G),Hc(this,y),O&&(this.R?g="headers="+Rc($C(O))+"&"+g:this.u&&fy(y,this.u,O)),dy(this.h,R),this.Ra&&He(y,"TYPE","init"),this.S?(He(y,"$req",g),He(y,"SID","null"),R.U=!0,ay(R,y,null)):ay(R,y,g),this.I=2}}else this.I==3&&(d?QC(this,d):this.i.length==0||MC(this.h)||QC(this))};function QC(d,g){var y;g?y=g.l:y=d.V++;let b=vr(d.J);He(b,"SID",d.M),He(b,"RID",y),He(b,"AID",d.K),Hc(d,b),d.u&&d.o&&fy(b,d.u,d.o),y=new Ri(d,d.j,y,d.D+1),d.u===null&&(y.J=d.o),g&&(d.i=g.G.concat(d.i)),g=XC(d,y,1e3),y.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),dy(d.h,y),ay(y,b,g)}function Hc(d,g){d.H&&_n(d.H,function(y,b){He(g,b,y)}),d.l&&_n({},function(y,b){He(g,b,y)})}function XC(d,g,y){y=Math.min(d.i.length,y);let b=d.l?l(d.l.Ka,d.l,d):null;e:{var R=d.i;let ge=-1;for(;;){let yt=["count="+y];ge==-1?y>0?(ge=R[0].g,yt.push("ofs="+ge)):ge=0:yt.push("ofs="+ge);let je=!0;for(let St=0;St<y;St++){var O=R[St].g;let _r=R[St].map;if(O-=ge,O<0)ge=Math.max(0,R[St].g-100),je=!1;else try{O="req"+O+"_"||"";try{var U=_r instanceof Map?_r:Object.entries(_r);for(let[Cs,Li]of U){let Fi=Li;a(Li)&&(Fi=ny(Li)),yt.push(O+Cs+"="+encodeURIComponent(Fi))}}catch(Cs){throw yt.push(O+"type="+encodeURIComponent("_badmap")),Cs}}catch{b&&b(_r)}}if(je){U=yt.join("&");break e}}U=void 0}return d=d.i.splice(0,y),g.G=d,U}function JC(d){if(!d.g&&!d.v){d.Y=1;var g=d.Da;N||E(),k||(N(),k=!0),T.add(g,d),d.A=0}}function gy(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=Pc(l(d.Da,d),tS(d,d.A)),d.A++,!0)}n.Da=function(){if(this.v=null,ZC(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=Pc(l(this.Wa,this),d)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,nn(10),md(this),ZC(this))};function my(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function ZC(d){d.g=new Ri(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var g=vr(d.na);He(g,"RID","rpc"),He(g,"SID",d.M),He(g,"AID",d.K),He(g,"CI",d.F?"0":"1"),!d.F&&d.ia&&He(g,"TO",d.ia),He(g,"TYPE","xmlhttp"),Hc(d,g),d.u&&d.o&&fy(g,d.u,d.o),d.O&&(d.g.H=d.O);var y=d.g;d=d.ba,y.M=1,y.A=hd(vr(g)),y.u=null,y.R=!0,SC(y,d)}n.Va=function(){this.C!=null&&(this.C=null,md(this),gy(this),nn(19))};function vd(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function eS(d,g){var y=null;if(d.g==g){vd(d),my(d),d.g=null;var b=2}else if(uy(d.h,g))y=g.G,NC(d.h,g),b=1;else return;if(d.I!=0){if(g.o)if(b==1){y=g.u?g.u.length:0,g=Date.now()-g.F;var R=d.D;b=ld(),tn(b,new bC(b,y)),yd(d)}else JC(d);else if(R=g.m,R==3||R==0&&g.X>0||!(b==1&&YF(d,g)||b==2&&gy(d)))switch(y&&y.length>0&&(g=d.h,g.i=g.i.concat(y)),R){case 1:Ts(d,5);break;case 4:Ts(d,10);break;case 3:Ts(d,6);break;default:Ts(d,2)}}}function tS(d,g){let y=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(y*=2),y*g}function Ts(d,g){if(d.j.info("Error code "+g),g==2){var y=l(d.bb,d),b=d.Ua;let R=!b;b=new Ni(b||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Oc(b,"https"),hd(b),R?$F(b.toString(),y):zF(b.toString(),y)}else nn(2);d.I=0,d.l&&d.l.pa(g),nS(d),YC(d)}n.bb=function(d){d?(this.j.info("Successfully pinged google.com"),nn(2)):(this.j.info("Failed to ping google.com"),nn(1))};function nS(d){if(d.I=0,d.ja=[],d.l){let g=OC(d.h);(g.length!=0||d.i.length!=0)&&(m(d.ja,g),m(d.ja,d.i),d.h.i.length=0,p(d.i),d.i.length=0),d.l.oa()}}function rS(d,g,y){var b=y instanceof Ni?vr(y):new Ni(y);if(b.g!="")g&&(b.g=g+"."+b.g),kc(b,b.u);else{var R=o.location;b=R.protocol,g=g?g+"."+R.hostname:R.hostname,R=+R.port;let O=new Ni(null);b&&Oc(O,b),g&&(O.g=g),R&&kc(O,R),y&&(O.h=y),b=O}return y=d.G,g=d.wa,y&&g&&He(b,y,g),He(b,"VER",d.ka),Hc(d,b),b}function iS(d,g,y){if(g&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Aa&&!d.ma?new et(new fd({ab:y})):new et(d.ma),g.Fa(d.L),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function sS(){}n=sS.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _d(){}_d.prototype.g=function(d,g){return new En(d,g)};function En(d,g){Gt.call(this),this.g=new KC(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(d?d["X-WebChannel-Client-Profile"]=g.sa:d={"X-WebChannel-Client-Profile":g.sa}),this.g.U=d,(d=g&&g.Qb)&&!S(d)&&(this.g.u=d),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!S(g)&&(this.g.G=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new $o(this)}h(En,Gt),En.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},En.prototype.close=function(){py(this.g)},En.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.v&&(y={},y.__data__=ny(d),d=y);g.i.push(new kF(g.Ya++,d)),g.I==3&&yd(g)},En.prototype.N=function(){this.g.l=null,delete this.j,py(this.g),delete this.g,En.Z.N.call(this)};function oS(d){ry.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(let y in g){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}h(oS,ry);function aS(){iy.call(this),this.status=1}h(aS,iy);function $o(d){this.g=d}h($o,sS),$o.prototype.ra=function(){tn(this.g,"a")},$o.prototype.qa=function(d){tn(this.g,new oS(d))},$o.prototype.pa=function(d){tn(this.g,new aS)},$o.prototype.oa=function(){tn(this.g,"b")},_d.prototype.createWebChannel=_d.prototype.g,En.prototype.send=En.prototype.o,En.prototype.open=En.prototype.m,En.prototype.close=En.prototype.close,k0=Ti.createWebChannelTransport=function(){return new _d},O0=Ti.getStatEventTarget=function(){return ld()},N0=Ti.Event=bs,Yg=Ti.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ud.NO_ERROR=0,ud.TIMEOUT=8,ud.HTTP_ERROR=6,Bu=Ti.ErrorCode=ud,IC.COMPLETE="complete",R0=Ti.EventType=IC,vC.EventType=Dc,Dc.OPEN="a",Dc.CLOSE="b",Dc.ERROR="c",Dc.MESSAGE="d",Gt.prototype.listen=Gt.prototype.J,Ya=Ti.WebChannel=vC,V8=Ti.FetchXmlHttpFactory=fd,et.prototype.listenOnce=et.prototype.K,et.prototype.getLastError=et.prototype.Ha,et.prototype.getLastErrorCode=et.prototype.ya,et.prototype.getStatus=et.prototype.ca,et.prototype.getResponseJson=et.prototype.La,et.prototype.getResponseText=et.prototype.la,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Fa,M0=Ti.XhrIo=et}).apply(typeof Kg<"u"?Kg:typeof self<"u"?self:typeof window<"u"?window:{});var xk="@firebase/firestore",Pk="4.9.2";var Ft=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ft.UNAUTHENTICATED=new Ft(null),Ft.GOOGLE_CREDENTIALS=new Ft("google-credentials-uid"),Ft.FIRST_PARTY=new Ft("first-party-uid"),Ft.MOCK_USER=new Ft("mock-user");var Ec="12.3.0";var Do=new Vr("@firebase/firestore");function Qa(){return Do.logLevel}function z(n,...e){if(Do.logLevel<=Ee.DEBUG){let t=e.map(AT);Do.debug(`Firestore (${Ec}): ${n}`,...t)}}function Si(n,...e){if(Do.logLevel<=Ee.ERROR){let t=e.map(AT);Do.error(`Firestore (${Ec}): ${n}`,...t)}}function oc(n,...e){if(Do.logLevel<=Ee.WARN){let t=e.map(AT);Do.warn(`Firestore (${Ec}): ${n}`,...t)}}function AT(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function ne(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,m1(n,r,t)}function m1(n,e,t){let r=`FIRESTORE (${Ec}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Si(r),new Error(r)}function Oe(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||m1(e,i,r)}function ue(n,e){return n}var j={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},q=class extends Ht{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Hr=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var nm=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},U0=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ft.UNAUTHENTICATED))}shutdown(){}},H0=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},$0=class{constructor(e){this.t=e,this.currentUser=Ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Oe(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Hr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Hr,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Hr)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Oe(typeof r.accessToken=="string",31837,{l:r}),new nm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string",2055,{h:e}),new Ft(e)}},z0=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ft.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},G0=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new z0(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}},rm=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},W0=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Oe(this.o===void 0,3512);let r=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new rm(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Oe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new rm(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function j8(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Wu=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=j8(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function be(n,e){return n<e?-1:n>e?1:0}function q0(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return L0(i)===L0(s)?be(i,s):L0(i)?1:-1}return be(n.length,e.length)}var B8=55296,U8=57343;function L0(n){let e=n.charCodeAt(0);return e>=B8&&e<=U8}function ac(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Mk="__name__",im=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ne(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ne(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return be(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):q0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ai.fromString(e.substring(4,e.length-2))}},Ze=class n extends im{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new q(j.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},H8=/^[_a-zA-Z][_a-zA-Z0-9]*$/,On=class n extends im{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return H8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Mk}static keyField(){return new n([Mk])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new q(j.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new q(j.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new q(j.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new q(j.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var te=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ze.fromString(e))}static fromName(e){return new n(Ze.fromString(e).popFirst(5))}static empty(){return new n(Ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ze(e.slice()))}};function y1(n,e,t){if(!t)throw new q(j.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $8(n,e,t,r){if(e===!0&&r===!0)throw new q(j.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Rk(n){if(!te.isDocumentKey(n))throw new q(j.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Nk(n){if(te.isDocumentKey(n))throw new q(j.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function v1(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function TT(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ne(12329,{type:typeof n})}function xo(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new q(j.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=TT(n);throw new q(j.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function gt(n,e){let t={typeString:n};return e&&(t.value=e),t}function rd(n,e){if(!v1(n))throw new q(j.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new q(j.INVALID_ARGUMENT,t);return!0}var Ok=-62135596800,kk=1e6,mt=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*kk);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new q(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new q(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Ok)throw new q(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new q(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kk}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(rd(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-Ok;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};mt._jsonSchemaVersion="firestore/timestamp/1.0",mt._jsonSchema={type:gt("string",mt._jsonSchemaVersion),seconds:gt("number"),nanoseconds:gt("number")};var de=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new mt(0,0))}static max(){return new n(new mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var qu=-1,K0=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};K0.UNKNOWN_ID=-1;function z8(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=de.fromTimestamp(r===1e9?new mt(t+1,0):new mt(t,r));return new Po(i,te.empty(),e)}function G8(n){return new Po(n.readTime,n.key,qu)}var Po=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(de.min(),te.empty(),qu)}static max(){return new n(de.max(),te.empty(),qu)}};function W8(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=te.comparator(n.documentKey,e.documentKey),t!==0?t:be(n.largestBatchId,e.largestBatchId))}var q8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Y0=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function bc(n){if(n.code!==j.FAILED_PRECONDITION||n.message!==q8)throw n;z("LocalStore","Unexpectedly lost primary lease")}var B=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(u=>{o[l]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function K8(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ic(n){return n.name==="IndexedDbTransactionError"}var CT=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),ST=-1;function Om(n){return n==null}function Ku(n){return n===0&&1/n==-1/0}function Y8(n){return typeof n=="number"&&Number.isInteger(n)&&!Ku(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var _1="";function Q8(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Lk(e)),e=X8(n.get(t),e);return Lk(e)}function X8(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case _1:t+="";break;default:t+=s}}return t}function Lk(n){return n+_1+""}var J8="remoteDocuments",w1="owner";var E1="mutationQueues";var b1="mutations";var I1="documentMutations",Z8="remoteDocumentsV14";var A1="remoteDocumentGlobal";var T1="targets";var C1="targetDocuments";var S1="targetGlobal",D1="collectionParents";var x1="clientMetadata";var P1="bundles";var M1="namedQueries";var e5="indexConfiguration";var t5="indexState";var n5="indexEntries";var R1="documentOverlays";var r5="globals";var i5=[E1,b1,I1,J8,T1,w1,S1,C1,x1,A1,D1,P1,M1],tge=[...i5,R1],s5=[E1,b1,I1,Z8,T1,w1,S1,C1,x1,A1,D1,P1,M1,R1],o5=s5,a5=[...o5,e5,t5,n5];var nge=[...a5,r5];function Fk(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Es(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function N1(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var st=class n{constructor(e,t){this.comparator=e,this.root=t||$r.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$r.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$r.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ec(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ec(this.root,e,this.comparator,!1)}getReverseIterator(){return new ec(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ec(this.root,e,this.comparator,!0)}},ec=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},$r=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ne(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw ne(27949);return e+(this.isRed()?0:1)}};$r.EMPTY=null,$r.RED=!0,$r.BLACK=!1;$r.EMPTY=new class{constructor(){this.size=0}get key(){throw ne(57766)}get value(){throw ne(16141)}get color(){throw ne(16727)}get left(){throw ne(29726)}get right(){throw ne(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new $r(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Vt=class n{constructor(e){this.comparator=e,this.data=new st(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new sm(this.data.getIterator())}getIteratorFrom(e){return new sm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},sm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Yn=class n{constructor(e){this.fields=e,e.sort(On.comparator)}static empty(){return new n([])}unionWith(e){let t=new Vt(On.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ac(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var om=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Zt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new om("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Zt.EMPTY_BYTE_STRING=new Zt("");var c5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Di(n){if(Oe(!!n,39018),typeof n=="string"){let e=0,t=c5.exec(n);if(Oe(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ye(n.seconds),nanos:Ye(n.nanos)}}function Ye(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xi(n){return typeof n=="string"?Zt.fromBase64String(n):Zt.fromUint8Array(n)}var O1="server_timestamp",k1="__type__",L1="__previous_value__",F1="__local_write_time__";function DT(n){return(n?.mapValue?.fields||{})[k1]?.stringValue===O1}function km(n){let e=n.mapValue.fields[L1];return DT(e)?km(e):e}function Yu(n){let e=Di(n.mapValue.fields[F1].timestampValue);return new mt(e.seconds,e.nanos)}var Q0=class{constructor(e,t,r,i,s,o,a,c,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=u}},am="(default)",cm=class n{constructor(e,t){this.projectId=e,this.database=t||am}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===am}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var xT="__type__",V1="__max__",Qg={mapValue:{fields:{__type__:{stringValue:V1}}}},PT="__vector__",cc="value";function vs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?DT(n)?4:B1(n)?9007199254740991:j1(n)?10:11:ne(28295,{value:n})}function Wr(n,e){if(n===e)return!0;let t=vs(n);if(t!==vs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yu(n).isEqual(Yu(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Di(i.timestampValue),a=Di(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return xi(i.bytesValue).isEqual(xi(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return Ye(i.geoPointValue.latitude)===Ye(s.geoPointValue.latitude)&&Ye(i.geoPointValue.longitude)===Ye(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return Ye(i.integerValue)===Ye(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ye(i.doubleValue),a=Ye(s.doubleValue);return o===a?Ku(o)===Ku(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return ac(n.arrayValue.values||[],e.arrayValue.values||[],Wr);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Fk(o)!==Fk(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Wr(o[c],a[c])))return!1;return!0})(n,e);default:return ne(52216,{left:n})}}function Qu(n,e){return(n.values||[]).find(t=>Wr(t,e))!==void 0}function lc(n,e){if(n===e)return 0;let t=vs(n),r=vs(e);if(t!==r)return be(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return be(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let a=Ye(s.integerValue||s.doubleValue),c=Ye(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return Vk(n.timestampValue,e.timestampValue);case 4:return Vk(Yu(n),Yu(e));case 5:return q0(n.stringValue,e.stringValue);case 6:return(function(s,o){let a=xi(s),c=xi(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let u=be(a[l],c[l]);if(u!==0)return u}return be(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let a=be(Ye(s.latitude),Ye(o.latitude));return a!==0?a:be(Ye(s.longitude),Ye(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return jk(n.arrayValue,e.arrayValue);case 10:return(function(s,o){let a=s.fields||{},c=o.fields||{},l=a[cc]?.arrayValue,u=c[cc]?.arrayValue,h=be(l?.values?.length||0,u?.values?.length||0);return h!==0?h:jk(l,u)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Qg.mapValue&&o===Qg.mapValue)return 0;if(s===Qg.mapValue)return 1;if(o===Qg.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){let f=q0(c[h],u[h]);if(f!==0)return f;let p=lc(a[c[h]],l[u[h]]);if(p!==0)return p}return be(c.length,u.length)})(n.mapValue,e.mapValue);default:throw ne(23264,{he:t})}}function Vk(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return be(n,e);let t=Di(n),r=Di(e),i=be(t.seconds,r.seconds);return i!==0?i:be(t.nanos,r.nanos)}function jk(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=lc(t[i],r[i]);if(s)return s}return be(t.length,r.length)}function uc(n){return X0(n)}function X0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=Di(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return xi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return te.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=X0(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${X0(t.fields[o])}`;return i+"}"})(n.mapValue):ne(61005,{value:n})}function Zg(n){switch(vs(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=km(n);return e?16+Zg(e):16;case 5:return 2*n.stringValue.length;case 6:return xi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+Zg(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Es(r.fields,(s,o)=>{i+=s.length+Zg(o)}),i})(n.mapValue);default:throw ne(13486,{value:n})}}function J0(n){return!!n&&"integerValue"in n}function MT(n){return!!n&&"arrayValue"in n}function Bk(n){return!!n&&"nullValue"in n}function Uk(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function em(n){return!!n&&"mapValue"in n}function j1(n){return(n?.mapValue?.fields||{})[xT]?.stringValue===PT}function Hu(n){if(n.geoPointValue)return{geoPointValue:L({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:L({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Es(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Hu(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Hu(n.arrayValue.values[t]);return e}return L({},n)}function B1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===V1}var ige={mapValue:{fields:{[xT]:{stringValue:PT},[cc]:{arrayValue:{}}}}};var Nn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!em(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hu(t)}setAll(e){let t=On.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Hu(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());em(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];em(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Es(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Hu(this.value))}};function U1(n){let e=[];return Es(n.fields,(t,r)=>{let i=new On([t]);if(em(r)){let s=U1(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Yn(e)}var yr=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,de.min(),de.min(),de.min(),Nn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,de.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,de.min(),de.min(),Nn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,de.min(),de.min(),Nn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(de.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=de.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var dc=class{constructor(e,t){this.position=e,this.inclusive=t}};function Hk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=te.comparator(te.fromName(o.referenceValue),t.key):r=lc(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function $k(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Wr(n.position[t],e.position[t]))return!1;return!0}var hc=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function l5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var lm=class{},Ct=class n extends lm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new eA(e,t,r):t==="array-contains"?new rA(e,r):t==="in"?new iA(e,r):t==="not-in"?new sA(e,r):t==="array-contains-any"?new oA(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new tA(e,r):new nA(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(lc(t,this.value)):t!==null&&vs(this.value)===vs(t)&&this.matchesComparison(lc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},qr=class n extends lm{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return H1(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function H1(n){return n.op==="and"}function $1(n){return u5(n)&&H1(n)}function u5(n){for(let e of n.filters)if(e instanceof qr)return!1;return!0}function Z0(n){if(n instanceof Ct)return n.field.canonicalString()+n.op.toString()+uc(n.value);if($1(n))return n.filters.map(e=>Z0(e)).join(",");{let e=n.filters.map(t=>Z0(t)).join(",");return`${n.op}(${e})`}}function z1(n,e){return n instanceof Ct?(function(r,i){return i instanceof Ct&&r.op===i.op&&r.field.isEqual(i.field)&&Wr(r.value,i.value)})(n,e):n instanceof qr?(function(r,i){return i instanceof qr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&z1(o,i.filters[a]),!0):!1})(n,e):void ne(19439)}function G1(n){return n instanceof Ct?(function(t){return`${t.field.canonicalString()} ${t.op} ${uc(t.value)}`})(n):n instanceof qr?(function(t){return t.op.toString()+" {"+t.getFilters().map(G1).join(" ,")+"}"})(n):"Filter"}var eA=class extends Ct{constructor(e,t,r){super(e,t,r),this.key=te.fromName(r.referenceValue)}matches(e){let t=te.comparator(e.key,this.key);return this.matchesComparison(t)}},tA=class extends Ct{constructor(e,t){super(e,"in",t),this.keys=W1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},nA=class extends Ct{constructor(e,t){super(e,"not-in",t),this.keys=W1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function W1(n,e){return(e.arrayValue?.values||[]).map(t=>te.fromName(t.referenceValue))}var rA=class extends Ct{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return MT(t)&&Qu(t.arrayValue,this.value)}},iA=class extends Ct{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Qu(this.value.arrayValue,t)}},sA=class extends Ct{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Qu(this.value.arrayValue,t)}},oA=class extends Ct{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!MT(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Qu(this.value.arrayValue,r))}};var aA=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}};function zk(n,e=null,t=[],r=[],i=null,s=null,o=null){return new aA(n,e,t,r,i,s,o)}function RT(n){let e=ue(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Z0(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),Om(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>uc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>uc(r)).join(",")),e.Te=t}return e.Te}function NT(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!l5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!z1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!$k(n.startAt,e.startAt)&&$k(n.endAt,e.endAt)}function cA(n){return te.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var fc=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function d5(n,e,t,r,i,s,o,a){return new fc(n,e,t,r,i,s,o,a)}function q1(n){return new fc(n)}function Gk(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function h5(n){return n.collectionGroup!==null}function $u(n){let e=ue(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Vt(On.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new hc(s,r))}),t.has(On.keyField().canonicalString())||e.Ie.push(new hc(On.keyField(),r))}return e.Ie}function zr(n){let e=ue(n);return e.Ee||(e.Ee=f5(e,$u(n))),e.Ee}function f5(n,e){if(n.limitType==="F")return zk(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new hc(i.field,s)});let t=n.endAt?new dc(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new dc(n.startAt.position,n.startAt.inclusive):null;return zk(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function lA(n,e,t){return new fc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Lm(n,e){return NT(zr(n),zr(e))&&n.limitType===e.limitType}function K1(n){return`${RT(zr(n))}|lt:${n.limitType}`}function Xa(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>G1(i)).join(", ")}]`),Om(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>uc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>uc(i)).join(",")),`Target(${r})`})(zr(n))}; limitType=${n.limitType})`}function Fm(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):te.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of $u(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,c){let l=Hk(o,a,c);return o.inclusive?l<=0:l<0})(r.startAt,$u(r),i)||r.endAt&&!(function(o,a,c){let l=Hk(o,a,c);return o.inclusive?l>=0:l>0})(r.endAt,$u(r),i))})(n,e)}function p5(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Y1(n){return(e,t)=>{let r=!1;for(let i of $u(n)){let s=g5(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function g5(n,e,t){let r=n.field.isKeyField()?te.comparator(e.key,t.key):(function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?lc(c,l):ne(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ne(19790,{direction:n.dir})}}var Pi=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Es(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return N1(this.inner)}size(){return this.innerSize}};var m5=new st(te.comparator);function Mi(){return m5}var Q1=new st(te.comparator);function Uu(...n){let e=Q1;for(let t of n)e=e.insert(t.key,t);return e}function X1(n){let e=Q1;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Co(){return zu()}function J1(){return zu()}function zu(){return new Pi(n=>n.toString(),(n,e)=>n.isEqual(e))}var y5=new st(te.comparator),v5=new Vt(te.comparator);function Ie(...n){let e=v5;for(let t of n)e=e.add(t);return e}var _5=new Vt(be);function w5(){return _5}function OT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ku(e)?"-0":e}}function Z1(n){return{integerValue:""+n}}function E5(n,e){return Y8(e)?Z1(e):OT(n,e)}var pc=class{constructor(){this._=void 0}};function b5(n,e,t){return n instanceof gc?(function(i,s){let o={fields:{[k1]:{stringValue:O1},[F1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&DT(s)&&(s=km(s)),s&&(o.fields[L1]=s),{mapValue:o}})(t,e):n instanceof Mo?tL(n,e):n instanceof Ro?nL(n,e):(function(i,s){let o=eL(i,s),a=Wk(o)+Wk(i.Ae);return J0(o)&&J0(i.Ae)?Z1(a):OT(i.serializer,a)})(n,e)}function I5(n,e,t){return n instanceof Mo?tL(n,e):n instanceof Ro?nL(n,e):t}function eL(n,e){return n instanceof mc?(function(r){return J0(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var gc=class extends pc{},Mo=class extends pc{constructor(e){super(),this.elements=e}};function tL(n,e){let t=rL(e);for(let r of n.elements)t.some(i=>Wr(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ro=class extends pc{constructor(e){super(),this.elements=e}};function nL(n,e){let t=rL(e);for(let r of n.elements)t=t.filter(i=>!Wr(i,r));return{arrayValue:{values:t}}}var mc=class extends pc{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function Wk(n){return Ye(n.integerValue||n.doubleValue)}function rL(n){return MT(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function A5(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Mo&&i instanceof Mo||r instanceof Ro&&i instanceof Ro?ac(r.elements,i.elements,Wr):r instanceof mc&&i instanceof mc?Wr(r.Ae,i.Ae):r instanceof gc&&i instanceof gc})(n.transform,e.transform)}var uA=class{constructor(e,t){this.version=e,this.transformResults=t}},Ci=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function tm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var yc=class{};function iL(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xu(n.key,Ci.none()):new No(n.key,n.data,Ci.none());{let t=n.data,r=Nn.empty(),i=new Vt(On.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Kr(n.key,r,new Yn(i.toArray()),Ci.none())}}function T5(n,e,t){n instanceof No?(function(i,s,o){let a=i.value.clone(),c=Kk(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Kr?(function(i,s,o){if(!tm(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=Kk(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(sL(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Gu(n,e,t,r){return n instanceof No?(function(s,o,a,c){if(!tm(s.precondition,o))return a;let l=s.value.clone(),u=Yk(s.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null})(n,e,t,r):n instanceof Kr?(function(s,o,a,c){if(!tm(s.precondition,o))return a;let l=Yk(s.fieldTransforms,c,o),u=o.data;return u.setAll(sL(s)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))})(n,e,t,r):(function(s,o,a){return tm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function C5(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=eL(r.transform,i||null);s!=null&&(t===null&&(t=Nn.empty()),t.set(r.field,s))}return t||null}function qk(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ac(r,i,(s,o)=>A5(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var No=class extends yc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Kr=class extends yc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function sL(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Kk(n,e,t){let r=new Map;Oe(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,I5(o,a,t[i]))}return r}function Yk(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,b5(s,o,e))}return r}var Xu=class extends yc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},dA=class extends yc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var hA=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&T5(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Gu(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Gu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=J1();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=iL(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(de.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ie())}isEqual(e){return this.batchId===e.batchId&&ac(this.mutations,e.mutations,(t,r)=>qk(t,r))&&ac(this.baseMutations,e.baseMutations,(t,r)=>qk(t,r))}},fA=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Oe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return y5})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var pA=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var gA=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ft,De;function S5(n){switch(n){case j.OK:return ne(64938);case j.CANCELLED:case j.UNKNOWN:case j.DEADLINE_EXCEEDED:case j.RESOURCE_EXHAUSTED:case j.INTERNAL:case j.UNAVAILABLE:case j.UNAUTHENTICATED:return!1;case j.INVALID_ARGUMENT:case j.NOT_FOUND:case j.ALREADY_EXISTS:case j.PERMISSION_DENIED:case j.FAILED_PRECONDITION:case j.ABORTED:case j.OUT_OF_RANGE:case j.UNIMPLEMENTED:case j.DATA_LOSS:return!0;default:return ne(15467,{code:n})}}function oL(n){if(n===void 0)return Si("GRPC error has no .code"),j.UNKNOWN;switch(n){case ft.OK:return j.OK;case ft.CANCELLED:return j.CANCELLED;case ft.UNKNOWN:return j.UNKNOWN;case ft.DEADLINE_EXCEEDED:return j.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return j.RESOURCE_EXHAUSTED;case ft.INTERNAL:return j.INTERNAL;case ft.UNAVAILABLE:return j.UNAVAILABLE;case ft.UNAUTHENTICATED:return j.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return j.INVALID_ARGUMENT;case ft.NOT_FOUND:return j.NOT_FOUND;case ft.ALREADY_EXISTS:return j.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return j.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return j.FAILED_PRECONDITION;case ft.ABORTED:return j.ABORTED;case ft.OUT_OF_RANGE:return j.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return j.UNIMPLEMENTED;case ft.DATA_LOSS:return j.DATA_LOSS;default:return ne(39323,{code:n})}}(De=ft||(ft={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";var D5=null;function x5(){return new TextEncoder}var P5=new Ai([4294967295,4294967295],0);function Qk(n){let e=x5().encode(n),t=new P0;return t.update(e),new Uint8Array(t.digest())}function Xk(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ai([t,r],0),new Ai([i,s],0)]}var mA=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new So(`Invalid padding: ${t}`);if(r<0)throw new So(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new So(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new So(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ai.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Ai.fromNumber(r)));return i.compare(P5)===1&&(i=new Ai([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=Qk(e),[r,i]=Xk(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;let t=Qk(e),[r,i]=Xk(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);this.Se(o)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},So=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var um=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ju.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(de.min(),i,new st(be),Mi(),Ie())}},Ju=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Ie(),Ie(),Ie())}};var nc=class{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}},dm=class{constructor(e,t){this.targetId=e,this.Ce=t}},hm=class{constructor(e,t,r=Zt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},fm=class{constructor(){this.ve=0,this.Fe=Jk(),this.Me=Zt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ie(),t=Ie(),r=Ie();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ne(38017,{changeType:s})}}),new Ju(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Jk()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Oe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},yA=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Mi(),this.Je=Xg(),this.He=Xg(),this.Ye=new st(be)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:ne(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let s=i.target;if(cA(s))if(r===0){let o=new te(s.path);this.et(t,o,yr.newNoDocument(o,de.min()))}else Oe(r===1,20013,{expectedCount:r});else{let o=this._t(t);if(o!==r){let a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,l)}D5?.lt((function(u,h,f,p,m){let v={localCacheCount:u,existenceFilterCount:h.count,databaseId:f.database,projectId:f.projectId},w=h.unchangedNames;return w&&(v.bloomFilter={applied:m===0,hashCount:w?.hashCount??0,bitmapLength:w?.bits?.bitmap?.length??0,padding:w?.bits?.padding??0,mightContain:I=>p?.mightContain(I)??!1}),v})(o,e.Ce,this.Ge.ht(),a,c))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=xi(r).toUint8Array()}catch(c){if(c instanceof om)return oc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new mA(o,i,s)}catch(c){return oc(c instanceof So?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((s,o)=>{let a=this.ot(o);if(a){if(s.current&&cA(a.target)){let c=new te(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,yr.newNoDocument(c,e))}s.Be&&(t.set(o,s.ke()),s.qe())}});let r=Ie();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.ot(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));let i=new um(e,t,this.Ye,this.je,r);return this.je=Mi(),this.Je=Xg(),this.He=Xg(),this.Ye=new st(be),i}Xe(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new fm,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Vt(be),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Vt(be),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||z("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fm),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Xg(){return new st(te.comparator)}function Jk(){return new st(te.comparator)}var M5={asc:"ASCENDING",desc:"DESCENDING"},R5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},N5={and:"AND",or:"OR"},vA=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function _A(n,e){return n.useProto3Json||Om(e)?e:{value:e}}function pm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function aL(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function O5(n,e){return pm(n,e.toTimestamp())}function Gr(n){return Oe(!!n,49232),de.fromTimestamp((function(t){let r=Di(t);return new mt(r.seconds,r.nanos)})(n))}function kT(n,e){return wA(n,e).canonicalString()}function wA(n,e){let t=(function(i){return new Ze(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function cL(n){let e=Ze.fromString(n);return Oe(fL(e),10190,{key:e.toString()}),e}function EA(n,e){return kT(n.databaseId,e.path)}function F0(n,e){let t=cL(e);if(t.get(1)!==n.databaseId.projectId)throw new q(j.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new q(j.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new te(uL(t))}function lL(n,e){return kT(n.databaseId,e)}function k5(n){let e=cL(n);return e.length===4?Ze.emptyPath():uL(e)}function bA(n){return new Ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function uL(n){return Oe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Zk(n,e,t){return{name:EA(n,e),fields:t.value.mapValue.fields}}function L5(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ne(39313,{state:l})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(l,u){return l.useProto3Json?(Oe(u===void 0||typeof u=="string",58123),Zt.fromBase64String(u||"")):(Oe(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Zt.fromUint8Array(u||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(l){let u=l.code===void 0?j.UNKNOWN:oL(l.code);return new q(u,l.message||"")})(o);t=new hm(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=F0(n,r.document.name),s=Gr(r.document.updateTime),o=r.document.createTime?Gr(r.document.createTime):de.min(),a=new Nn({mapValue:{fields:r.document.fields}}),c=yr.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];t=new nc(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=F0(n,r.document),s=r.readTime?Gr(r.readTime):de.min(),o=yr.newNoDocument(i,s),a=r.removedTargetIds||[];t=new nc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=F0(n,r.document),s=r.removedTargetIds||[];t=new nc([],s,i,null)}else{if(!("filter"in e))return ne(11601,{Rt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new gA(i,s),a=r.targetId;t=new dm(a,o)}}return t}function F5(n,e){let t;if(e instanceof No)t={update:Zk(n,e.key,e.value)};else if(e instanceof Xu)t={delete:EA(n,e.key)};else if(e instanceof Kr)t={update:Zk(n,e.key,e.data),updateMask:W5(e.fieldMask)};else{if(!(e instanceof dA))return ne(16599,{Vt:e.type});t={verify:EA(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,o){let a=o.transform;if(a instanceof gc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Mo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ro)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof mc)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ne(20930,{transform:o.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:O5(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ne(27497)})(n,e.precondition)),t}function V5(n,e){return n&&n.length>0?(Oe(e!==void 0,14353),n.map(t=>(function(i,s){let o=i.updateTime?Gr(i.updateTime):Gr(s);return o.isEqual(de.min())&&(o=Gr(s)),new uA(o,i.transformResults||[])})(t,e))):[]}function j5(n,e){return{documents:[lL(n,e.path)]}}function B5(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=lL(n,i);let s=(function(l){if(l.length!==0)return hL(qr.create(l,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(l){if(l.length!==0)return l.map(u=>(function(f){return{field:Ja(f.field),direction:$5(f.dir)}})(u))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=_A(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(l){return{before:l.inclusive,values:l.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(l){return{before:!l.inclusive,values:l.position}})(e.endAt)),{ft:t,parent:i}}function U5(n){let e=k5(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Oe(r===1,65062);let u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=(function(h){let f=dL(h);return f instanceof qr&&$1(f)?f.getFilters():[f]})(t.where));let o=[];t.orderBy&&(o=(function(h){return h.map(f=>(function(m){return new hc(Za(m.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(m.direction))})(f))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,Om(f)?null:f})(t.limit));let c=null;t.startAt&&(c=(function(h){let f=!!h.before,p=h.values||[];return new dc(p,f)})(t.startAt));let l=null;return t.endAt&&(l=(function(h){let f=!h.before,p=h.values||[];return new dc(p,f)})(t.endAt)),d5(e,i,o,s,a,"F",c,l)}function H5(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ne(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function dL(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Za(t.unaryFilter.field);return Ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Za(t.unaryFilter.field);return Ct.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Za(t.unaryFilter.field);return Ct.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Za(t.unaryFilter.field);return Ct.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ne(61313);default:return ne(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ct.create(Za(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ne(58110);default:return ne(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return qr.create(t.compositeFilter.filters.map(r=>dL(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ne(1026)}})(t.compositeFilter.op))})(n):ne(30097,{filter:n})}function $5(n){return M5[n]}function z5(n){return R5[n]}function G5(n){return N5[n]}function Ja(n){return{fieldPath:n.canonicalString()}}function Za(n){return On.fromServerFormat(n.fieldPath)}function hL(n){return n instanceof Ct?(function(t){if(t.op==="=="){if(Uk(t.value))return{unaryFilter:{field:Ja(t.field),op:"IS_NAN"}};if(Bk(t.value))return{unaryFilter:{field:Ja(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Uk(t.value))return{unaryFilter:{field:Ja(t.field),op:"IS_NOT_NAN"}};if(Bk(t.value))return{unaryFilter:{field:Ja(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ja(t.field),op:z5(t.op),value:t.value}}})(n):n instanceof qr?(function(t){let r=t.getFilters().map(i=>hL(i));return r.length===1?r[0]:{compositeFilter:{op:G5(t.op),filters:r}}})(n):ne(54877,{filter:n})}function W5(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function fL(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Zu=class n{constructor(e,t,r,i,s=de.min(),o=de.min(),a=Zt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var IA=class{constructor(e){this.yt=e}};function q5(n){let e=U5({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lA(e,e.limit,"L"):e}var gm=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ye(e.integerValue));else if("doubleValue"in e){let r=Ye(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Ku(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Di(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(xi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?B1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):j1(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ne(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=cc,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ye(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),te.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};gm.Kt=new gm;var AA=class{constructor(){this.Cn=new TA}addToCollectionParentIndex(e,t){return this.Cn.add(t),B.resolve()}getCollectionParents(e,t){return B.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return B.resolve()}deleteFieldIndex(e,t){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,t){return B.resolve()}getDocumentsMatchingTarget(e,t){return B.resolve(null)}getIndexType(e,t){return B.resolve(0)}getFieldIndexes(e,t){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,t){return B.resolve(Po.min())}getMinOffsetFromCollectionGroup(e,t){return B.resolve(Po.min())}updateCollectionGroup(e,t,r){return B.resolve()}updateIndexEntries(e,t){return B.resolve()}},TA=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Vt(Ze.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Vt(Ze.comparator)).toArray()}};var sge=new Uint8Array(0);var e1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pL=41943040,Kn=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Kn.DEFAULT_COLLECTION_PERCENTILE=10,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kn.DEFAULT=new Kn(pL,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kn.DISABLED=new Kn(-1,0,0);var ed=class n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new n(0)}static cr(){return new n(-1)}};var t1="LruGarbageCollector",K5=1048576;function n1([n,e],[t,r]){let i=be(n,t);return i===0?be(e,r):i}var CA=class{constructor(e){this.Ir=e,this.buffer=new Vt(n1),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();n1(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},SA=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){z(t1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ic(t)?z(t1,"Ignoring IndexedDB error during garbage collection: ",t):await bc(t)}await this.Vr(3e5)})}},DA=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return B.resolve(CT.ce);let r=new CA(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(e1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),e1):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,o,a,c,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),Qa()<=Ee.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function Y5(n,e){return new DA(n,e)}var xA=class{constructor(){this.changes=new Pi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?B.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var PA=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var MA=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Gu(r.mutation,i,Yn.empty(),mt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ie()){let i=Co();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Uu();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Co();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ie()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Mi(),o=zu(),a=(function(){return zu()})();return t.forEach((c,l)=>{let u=r.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof Kr)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),Gu(u.mutation,l,u.mutation.getFieldMask(),mt.now())):o.set(l.key,Yn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),t.forEach((l,u)=>a.set(l,new PA(u,o.get(l)??null))),a))}recalculateAndSaveOverlays(e,t){let r=zu(),i=new st((o,a)=>o-a),s=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let u=r.get(c)||Yn.empty();u=a.applyToLocalView(l,u),r.set(c,u);let h=(i.get(a.batchId)||Ie()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,h=J1();u.forEach(f=>{if(!s.has(f)){let p=iL(t.get(f),r.get(f));p!==null&&h.set(f,p),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return B.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return te.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):h5(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):B.resolve(Co()),a=qu,c=s;return o.next(l=>B.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?B.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,Ie())).next(u=>({batchId:a,changes:X1(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new te(t)).next(r=>{let i=Uu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Uu();return this.indexManager.getCollectionParents(e,s).next(a=>B.forEach(a,c=>{let l=(function(h,f){return new fc(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(u=>{u.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let u=l.getKey();o.get(u)===null&&(o=o.insert(u,yr.newInvalidDocument(u)))});let a=Uu();return o.forEach((c,l)=>{let u=s.get(c);u!==void 0&&Gu(u.mutation,l,Yn.empty(),mt.now()),Fm(t,l)&&(a=a.insert(c,l))}),a})}};var RA=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return B.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Gr(i.createTime)}})(t)),B.resolve()}getNamedQuery(e,t){return B.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:q5(i.bundledQuery),readTime:Gr(i.readTime)}})(t)),B.resolve()}};var NA=class{constructor(){this.overlays=new st(te.comparator),this.qr=new Map}getOverlay(e,t){return B.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Co();return B.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),B.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),B.resolve()}getOverlaysForCollection(e,t,r){let i=Co(),s=t.length+1,o=new te(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return B.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new st((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let u=s.get(l.largestBatchId);u===null&&(u=Co(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}let a=Co(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return B.resolve(a)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new pA(t,r));let s=this.qr.get(t);s===void 0&&(s=Ie(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}};var OA=class{constructor(){this.sessionToken=Zt.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,B.resolve()}};var td=class{constructor(){this.Qr=new Vt(pt.$r),this.Ur=new Vt(pt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new pt(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new pt(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){let t=new te(new Ze([])),r=new pt(t,e),i=new pt(t,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new te(new Ze([])),r=new pt(t,e),i=new pt(t,e+1),s=Ie();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new pt(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},pt=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return te.comparator(e.key,t.key)||be(e.Yr,t.Yr)}static Kr(e,t){return be(e.Yr,t.Yr)||te.comparator(e.key,t.key)}};var kA=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Vt(pt.$r)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new hA(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.Zr=this.Zr.add(new pt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return B.resolve(o)}lookupMutationBatch(e,t){return B.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ei(r),s=i<0?0:i;return B.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?ST:this.tr-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new pt(t,0),i=new pt(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{let a=this.Xr(o.Yr);s.push(a)}),B.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Vt(be);return t.forEach(i=>{let s=new pt(i,0),o=new pt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),B.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;te.isDocumentKey(s)||(s=s.child(""));let o=new pt(new te(s),0),a=new Vt(be);return this.Zr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.Yr)),!0)},o),B.resolve(this.ti(a))}ti(e){let t=[];return e.forEach(r=>{let i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Oe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return B.forEach(t.mutations,i=>{let s=new pt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){let r=new pt(t,0),i=this.Zr.firstAfterOrEqual(r);return B.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var LA=class{constructor(e){this.ri=e,this.docs=(function(){return new st(te.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return B.resolve(r?r.document.mutableCopy():yr.newInvalidDocument(t))}getEntries(e,t){let r=Mi();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yr.newInvalidDocument(i))}),B.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Mi(),o=t.path,a=new te(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||W8(G8(u),r)<=0||(i.has(u.key)||Fm(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return B.resolve(s)}getAllFromCollectionGroup(e,t,r,i){ne(9500)}ii(e,t){return B.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new FA(this)}getSize(e){return B.resolve(this.size)}},FA=class extends xA{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),B.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var VA=class{constructor(e){this.persistence=e,this.si=new Pi(t=>RT(t),NT),this.lastRemoteSnapshotVersion=de.min(),this.highestTargetId=0,this.oi=0,this._i=new td,this.targetCount=0,this.ai=ed.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),B.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new ed(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,B.resolve()}updateTargetData(e,t){return this.Pr(t),B.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),B.waitFor(s).next(()=>i)}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return B.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),B.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),B.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),B.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return B.resolve(r)}containsKey(e,t){return B.resolve(this._i.containsKey(t))}};var mm=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new CT(0),this.li=!1,this.li=!0,this.hi=new OA,this.referenceDelegate=e(this),this.Pi=new VA(this),this.indexManager=new AA,this.remoteDocumentCache=(function(i){return new LA(i)})(r=>this.referenceDelegate.Ti(r)),this.serializer=new IA(t),this.Ii=new RA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new NA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new kA(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){z("MemoryPersistence","Starting transaction:",e);let i=new jA(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,t){return B.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}},jA=class extends Y0{constructor(e){super(),this.currentSequenceNumber=e}},BA=class n{constructor(e){this.persistence=e,this.Ri=new td,this.Vi=null}static mi(e){return new n(e)}get fi(){if(this.Vi)return this.Vi;throw ne(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),B.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),B.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.fi,r=>{let i=te.fromPath(r);return this.gi(e,i).next(s=>{s||t.removeEntry(i,de.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return B.or([()=>B.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},ym=class n{constructor(e,t){this.persistence=e,this.pi=new Pi(r=>Q8(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Y5(this,t)}static mi(e,t){return new n(e,t)}Ei(){}di(e){return B.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return B.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?B.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,t).next(a=>{a||(r++,s.removeEntry(o,de.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),B.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),B.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),B.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Zg(e.data.value)),t}br(e,t,r){return B.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.pi.get(t);return B.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var UA=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Ie(),i=Ie();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var HA=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var $A=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return vO()?8:K8(kt())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ys(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new HA;return this.Ss(e,t,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)})}).next(()=>s.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(Qa()<=Ee.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",Xa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),B.resolve()):(Qa()<=Ee.DEBUG&&z("QueryEngine","Query:",Xa(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Qa()<=Ee.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",Xa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zr(t))):B.resolve())}ys(e,t){if(Gk(t))return B.resolve(null);let r=zr(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=lA(t,null,"F"),r=zr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Ie(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.Ds(t,a);return this.Cs(t,l,o,c.readTime)?this.ys(e,lA(t,null,"F")):this.vs(e,l,t,c)}))})))}ws(e,t,r,i){return Gk(t)||i.isEqual(de.min())?B.resolve(null):this.ps.getDocuments(e,r).next(s=>{let o=this.Ds(t,s);return this.Cs(t,o,r,i)?B.resolve(null):(Qa()<=Ee.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Xa(t)),this.vs(e,o,t,z8(i,qu)).next(a=>a))})}Ds(e,t){let r=new Vt(Y1(e));return t.forEach((i,s)=>{Fm(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Qa()<=Ee.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",Xa(t)),this.ps.getDocumentsMatchingQuery(e,t,Po.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var LT="LocalStore",Q5=3e8,zA=class{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new st(be),this.xs=new Pi(s=>RT(s),NT),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MA(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}};function X5(n,e,t,r){return new zA(n,e,t,r)}async function gL(n,e){let t=ue(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=Ie();for(let l of i){o.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}for(let l of s){a.push(l.batchId);for(let u of l.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(r,c).next(l=>({Ls:l,removedBatchIds:o,addedBatchIds:a}))})})}function J5(n,e){let t=ue(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,l,u){let h=l.batch,f=h.keys(),p=B.resolve();return f.forEach(m=>{p=p.next(()=>u.getEntry(c,m)).next(v=>{let w=l.docVersions.get(m);Oe(w!==null,48541),v.version.compareTo(w)<0&&(h.applyToRemoteDocument(v,l),v.isValidDocument()&&(v.setReadTime(l.commitVersion),u.addEntry(v)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(c,h))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let c=Ie();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function mL(n){let e=ue(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function Z5(n,e){let t=ue(n),r=e.snapshotVersion,i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;let a=[];e.targetChanges.forEach((u,h)=>{let f=i.get(h);if(!f)return;a.push(t.Pi.removeMatchingKeys(s,u.removedDocuments,h).next(()=>t.Pi.addMatchingKeys(s,u.addedDocuments,h)));let p=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Zt.EMPTY_BYTE_STRING,de.min()).withLastLimboFreeSnapshotVersion(de.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,r)),i=i.insert(h,p),(function(v,w,I){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=Q5?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0})(f,p,u)&&a.push(t.Pi.updateTargetData(s,p))});let c=Mi(),l=Ie();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(e9(s,o,e.documentUpdates).next(u=>{c=u.ks,l=u.qs})),!r.isEqual(de.min())){let u=t.Pi.getLastRemoteSnapshotVersion(s).next(h=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return B.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.Ms=i,s))}function e9(n,e,t){let r=Ie(),i=Ie();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Mi();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(de.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):z(LT,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{ks:o,qs:i}})}function t9(n,e){let t=ue(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ST),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function n9(n,e){let t=ue(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(s=>s?(i=s,B.resolve(i)):t.Pi.allocateTargetId(r).next(o=>(i=new Zu(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function GA(n,e,t){let r=ue(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Ic(o))throw o;z(LT,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function r1(n,e,t){let r=ue(n),i=de.min(),s=Ie();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(c,l,u){let h=ue(c),f=h.xs.get(u);return f!==void 0?B.resolve(h.Ms.get(f)):h.Pi.getTargetData(l,u)})(r,o,zr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:de.min(),t?s:Ie())).next(a=>(r9(r,p5(e),a),{documents:a,Qs:s})))}function r9(n,e,t){let r=n.Os.get(e)||de.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Os.set(e,r)}var vm=class{constructor(){this.activeTargetIds=w5()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var WA=class{constructor(){this.Mo=new vm,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new vm,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var qA=class{Oo(e){}shutdown(){}};var i1="ConnectivityMonitor",_m=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){z(i1,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){z(i1,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Jg=null;function KA(){return Jg===null?Jg=(function(){return 268435456+Math.round(2147483648*Math.random())})():Jg++,"0x"+Jg.toString(16)}var V0="RestConnection",i9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},YA=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===am?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){let o=KA(),a=this.zo(e,t.toUriEncodedString());z(V0,`Sending RPC '${e}' ${o}:`,a,r);let c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,s);let{host:l}=new URL(a),u=ls(l);return this.Jo(e,a,c,r,u).then(h=>(z(V0,`Received RPC '${e}' ${o}: `,h),h),h=>{throw oc(V0,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h})}Ho(e,t,r,i,s,o){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ec})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,t){let r=i9[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}};var QA=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var Jt="WebChannelConnection",XA=class extends YA{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){let o=KA();return new Promise((a,c)=>{let l=new M0;l.setWithCredentials(!0),l.listenOnce(R0.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Bu.NO_ERROR:let h=l.getResponseJson();z(Jt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case Bu.TIMEOUT:z(Jt,`RPC '${e}' ${o} timed out`),c(new q(j.DEADLINE_EXCEEDED,"Request time out"));break;case Bu.HTTP_ERROR:let f=l.getStatus();if(z(Jt,`RPC '${e}' ${o} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);let m=p?.error;if(m&&m.status&&m.message){let v=(function(I){let D=I.toLowerCase().replace(/_/g,"-");return Object.values(j).indexOf(D)>=0?D:j.UNKNOWN})(m.status);c(new q(v,m.message))}else c(new q(j.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new q(j.UNAVAILABLE,"Connection failed."));break;default:ne(9055,{l_:e,streamId:o,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{z(Jt,`RPC '${e}' ${o} completed.`)}});let u=JSON.stringify(i);z(Jt,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",u,r,15)})}T_(e,t,r){let i=KA(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=k0(),a=O0(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let u=s.join("");z(Jt,`Creating RPC '${e}' stream ${i}: ${u}`,c);let h=o.createWebChannel(u,c);this.I_(h);let f=!1,p=!1,m=new QA({Yo:w=>{p?z(Jt,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(f||(z(Jt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),z(Jt,`RPC '${e}' stream ${i} sending:`,w),h.send(w))},Zo:()=>h.close()}),v=(w,I,D)=>{w.listen(I,P=>{try{D(P)}catch(x){setTimeout(()=>{throw x},0)}})};return v(h,Ya.EventType.OPEN,()=>{p||(z(Jt,`RPC '${e}' stream ${i} transport opened.`),m.o_())}),v(h,Ya.EventType.CLOSE,()=>{p||(p=!0,z(Jt,`RPC '${e}' stream ${i} transport closed`),m.a_(),this.E_(h))}),v(h,Ya.EventType.ERROR,w=>{p||(p=!0,oc(Jt,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),m.a_(new q(j.UNAVAILABLE,"The operation could not be completed")))}),v(h,Ya.EventType.MESSAGE,w=>{if(!p){let I=w.data[0];Oe(!!I,16349);let D=I,P=D?.error||D[0]?.error;if(P){z(Jt,`RPC '${e}' stream ${i} received error:`,P);let x=P.status,N=(function(E){let _=ft[E];if(_!==void 0)return oL(_)})(x),k=P.message;N===void 0&&(N=j.INTERNAL,k="Unknown error status: "+x+" with message "+P.message),p=!0,m.a_(new q(N,k)),h.close()}else z(Jt,`RPC '${e}' stream ${i} received:`,I),m.u_(I)}}),v(a,N0.STAT_EVENT,w=>{w.stat===Yg.PROXY?z(Jt,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===Yg.NOPROXY&&z(Jt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{m.__()},0),m}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}};function j0(){return typeof document<"u"?document:null}function Vm(n){return new vA(n,!0)}var wm=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var s1="PersistentStream",Em=class{constructor(e,t,r,i,s,o,a,c){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new wm(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===j.RESOURCE_EXHAUSTED?(Si(t.toString()),Si("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===j.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new q(j.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return z(s1,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(z(s1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},JA=class extends Em{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=L5(this.serializer,e),r=(function(s){if(!("targetChange"in s))return de.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?de.min():o.readTime?Gr(o.readTime):de.min()})(e);return this.listener.H_(t,r)}Y_(e){let t={};t.database=bA(this.serializer),t.addTarget=(function(s,o){let a,c=o.target;if(a=cA(c)?{documents:j5(s,c)}:{query:B5(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=aL(s,o.resumeToken);let l=_A(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(de.min())>0){a.readTime=pm(s,o.snapshotVersion.toTimestamp());let l=_A(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a})(this.serializer,e);let r=H5(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){let t={};t.database=bA(this.serializer),t.removeTarget=e,this.q_(t)}},ZA=class extends Em{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=V5(e.writeResults,e.commitTime),r=Gr(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=bA(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>F5(this.serializer,r))};this.q_(t)}};var eT=class{},tT=class extends eT{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new q(j.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,wA(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(j.UNKNOWN,s.toString())})}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,wA(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(j.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}},nT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Si(t),this.aa=!1):z("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Oo="RemoteStore",rT=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Lo(this)&&(z(Oo,"Restarting streams for network reachability change."),await(async function(c){let l=ue(c);l.Ea.add(4),await id(l),l.Ra.set("Unknown"),l.Ea.delete(4),await jm(l)})(this))})}),this.Ra=new nT(r,i)}};async function jm(n){if(Lo(n))for(let e of n.da)await e(!0)}async function id(n){for(let e of n.da)await e(!1)}function yL(n,e){let t=ue(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),BT(t)?jT(t):Ac(t).O_()&&VT(t,e))}function FT(n,e){let t=ue(n),r=Ac(t);t.Ia.delete(e),r.O_()&&vL(t,e),t.Ia.size===0&&(r.O_()?r.L_():Lo(t)&&t.Ra.set("Unknown"))}function VT(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(de.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ac(n).Y_(e)}function vL(n,e){n.Va.Ue(e),Ac(n).Z_(e)}function jT(n){n.Va=new yA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ac(n).start(),n.Ra.ua()}function BT(n){return Lo(n)&&!Ac(n).x_()&&n.Ia.size>0}function Lo(n){return ue(n).Ea.size===0}function _L(n){n.Va=void 0}async function s9(n){n.Ra.set("Online")}async function o9(n){n.Ia.forEach((e,t)=>{VT(n,e)})}async function a9(n,e){_L(n),BT(n)?(n.Ra.ha(e),jT(n)):n.Ra.set("Unknown")}async function c9(n,e,t){if(n.Ra.set("Online"),e instanceof hm&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))})(n,e)}catch(r){z(Oo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await bm(n,r)}else if(e instanceof nc?n.Va.Ze(e):e instanceof dm?n.Va.st(e):n.Va.tt(e),!t.isEqual(de.min()))try{let r=await mL(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let a=s.Va.Tt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let u=s.Ia.get(l);u&&s.Ia.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let u=s.Ia.get(c);if(!u)return;s.Ia.set(c,u.withResumeToken(Zt.EMPTY_BYTE_STRING,u.snapshotVersion)),vL(s,c);let h=new Zu(u.target,c,l,u.sequenceNumber);VT(s,h)}),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){z(Oo,"Failed to raise snapshot:",r),await bm(n,r)}}async function bm(n,e,t){if(!Ic(e))throw e;n.Ea.add(1),await id(n),n.Ra.set("Offline"),t||(t=()=>mL(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{z(Oo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await jm(n)})}function wL(n,e){return e().catch(t=>bm(n,t,e))}async function Bm(n){let e=ue(n),t=_s(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ST;for(;l9(e);)try{let i=await t9(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,u9(e,i)}catch(i){await bm(e,i)}EL(e)&&bL(e)}function l9(n){return Lo(n)&&n.Ta.length<10}function u9(n,e){n.Ta.push(e);let t=_s(n);t.O_()&&t.X_&&t.ea(e.mutations)}function EL(n){return Lo(n)&&!_s(n).x_()&&n.Ta.length>0}function bL(n){_s(n).start()}async function d9(n){_s(n).ra()}async function h9(n){let e=_s(n);for(let t of n.Ta)e.ea(t.mutations)}async function f9(n,e,t){let r=n.Ta.shift(),i=fA.from(r,e,t);await wL(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Bm(n)}async function p9(n,e){e&&_s(n).X_&&await(async function(r,i){if((function(o){return S5(o)&&o!==j.ABORTED})(i.code)){let s=r.Ta.shift();_s(r).B_(),await wL(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Bm(r)}})(n,e),EL(n)&&bL(n)}async function o1(n,e){let t=ue(n);t.asyncQueue.verifyOperationInProgress(),z(Oo,"RemoteStore received new credentials");let r=Lo(t);t.Ea.add(3),await id(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await jm(t)}async function g9(n,e){let t=ue(n);e?(t.Ea.delete(2),await jm(t)):e||(t.Ea.add(2),await id(t),t.Ra.set("Unknown"))}function Ac(n){return n.ma||(n.ma=(function(t,r,i){let s=ue(t);return s.sa(),new JA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:s9.bind(null,n),t_:o9.bind(null,n),r_:a9.bind(null,n),H_:c9.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),BT(n)?jT(n):n.Ra.set("Unknown")):(await n.ma.stop(),_L(n))})),n.ma}function _s(n){return n.fa||(n.fa=(function(t,r,i){let s=ue(t);return s.sa(),new ZA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:d9.bind(null,n),r_:p9.bind(null,n),ta:h9.bind(null,n),na:f9.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Bm(n)):(await n.fa.stop(),n.Ta.length>0&&(z(Oo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var iT=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Hr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(j.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function UT(n,e){if(Si("AsyncQueue",`${e}: ${n}`),Ic(n))return new q(j.UNAVAILABLE,`${e}: ${n}`);throw n}var Im=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||te.comparator(t.key,r.key):(t,r)=>te.comparator(t.key,r.key),this.keyedMap=Uu(),this.sortedSet=new st(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Am=class{constructor(){this.ga=new st(te.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ne(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},vc=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Im.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var sT=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}},oT=class{constructor(){this.queries=a1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=ue(t),s=i.queries;i.queries=a1(),s.forEach((o,a)=>{for(let c of a.Sa)c.onError(r)})})(this,new q(j.ABORTED,"Firestore shutting down"))}};function a1(){return new Pi(n=>K1(n),Lm)}async function m9(n,e){let t=ue(n),r=3,i=e.query,s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new sT,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let a=UT(o,`Initialization of query '${Xa(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&HT(t)}async function y9(n,e){let t=ue(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function v9(n,e){let t=ue(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&HT(t)}function _9(n,e,t){let r=ue(n),i=r.queries.get(e);if(i)for(let s of i.Sa)s.onError(t);r.queries.delete(e)}function HT(n){n.Ca.forEach(e=>{e.next()})}var aT,c1;(c1=aT||(aT={})).Ma="default",c1.Cache="cache";var cT=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new vc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=vc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==aT.Cache}};var Tm=class{constructor(e){this.key=e}},Cm=class{constructor(e){this.key=e}},lT=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ie(),this.mutatedKeys=Ie(),this.eu=Y1(e),this.tu=new Im(this.eu)}get nu(){return this.Ya}ru(e,t){let r=t?t.iu:new Am,i=t?t.tu:this.tu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{let f=i.get(u),p=Fm(this.query,h)?h:null,m=!!f&&this.mutatedKeys.has(f.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations),w=!1;f&&p?f.data.isEqual(p.data)?m!==v&&(r.track({type:3,doc:p}),w=!0):this.su(f,p)||(r.track({type:2,doc:p}),w=!0,(c&&this.eu(p,c)>0||l&&this.eu(p,l)<0)&&(a=!0)):!f&&p?(r.track({type:0,doc:p}),w=!0):f&&!p&&(r.track({type:1,doc:f}),w=!0,(c||l)&&(a=!0)),w&&(p?(o=o.add(p),s=v?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let o=e.iu.ya();o.sort((u,h)=>(function(p,m){let v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne(20277,{Rt:w})}};return v(p)-v(m)})(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(r),i=i??!1;let a=t&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,l=c!==this.Za;return this.Za=c,o.length!==0||l?{snapshot:new vc(this.query,e.tu,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Am,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=Ie(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});let t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new Cm(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new Tm(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=Ie();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return vc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},$T="SyncEngine",uT=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},dT=class{constructor(e){this.key=e,this.hu=!1}},hT=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Pi(a=>K1(a),Lm),this.Iu=new Map,this.Eu=new Set,this.du=new st(te.comparator),this.Au=new Map,this.Ru=new td,this.Vu={},this.mu=new Map,this.fu=ed.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function w9(n,e,t=!0){let r=DL(n),i,s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await IL(r,e,t,!0),i}async function E9(n,e){let t=DL(n);await IL(t,e,!0,!1)}async function IL(n,e,t,r){let i=await n9(n.localStore,zr(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=await b9(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&yL(n.remoteStore,i),a}async function b9(n,e,t,r,i){n.pu=(h,f,p)=>(async function(v,w,I,D){let P=w.view.ru(I);P.Cs&&(P=await r1(v.localStore,w.query,!1).then(({documents:T})=>w.view.ru(T,P)));let x=D&&D.targetChanges.get(w.targetId),N=D&&D.targetMismatches.get(w.targetId)!=null,k=w.view.applyChanges(P,v.isPrimaryClient,x,N);return u1(v,w.targetId,k.au),k.snapshot})(n,h,f,p);let s=await r1(n.localStore,e,!0),o=new lT(e,s.Qs),a=o.ru(s.documents),c=Ju.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);u1(n,t,l.au);let u=new uT(e,t,o);return n.Tu.set(e,u),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),l.snapshot}async function I9(n,e,t){let r=ue(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!Lm(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await GA(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&FT(r.remoteStore,i.targetId),fT(r,i.targetId)}).catch(bc)):(fT(r,i.targetId),await GA(r.localStore,i.targetId,!0))}async function A9(n,e){let t=ue(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),FT(t.remoteStore,r.targetId))}async function T9(n,e,t){let r=R9(n);try{let i=await(function(o,a){let c=ue(o),l=mt.now(),u=a.reduce((p,m)=>p.add(m.key),Ie()),h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let m=Mi(),v=Ie();return c.Ns.getEntries(p,u).next(w=>{m=w,m.forEach((I,D)=>{D.isValidDocument()||(v=v.add(I))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,m)).next(w=>{h=w;let I=[];for(let D of a){let P=C5(D,h.get(D.key).overlayedDocument);P!=null&&I.push(new Kr(D.key,P,U1(P.value.mapValue),Ci.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,I,a)}).next(w=>{f=w;let I=w.applyToLocalDocumentSet(h,v);return c.documentOverlayCache.saveOverlays(p,w.batchId,I)})}).then(()=>({batchId:f.batchId,changes:X1(h)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,c){let l=o.Vu[o.currentUser.toKey()];l||(l=new st(be)),l=l.insert(a,c),o.Vu[o.currentUser.toKey()]=l})(r,i.batchId,t),await sd(r,i.changes),await Bm(r.remoteStore)}catch(i){let s=UT(i,"Failed to persist write");t.reject(s)}}async function AL(n,e){let t=ue(n);try{let r=await Z5(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Au.get(s);o&&(Oe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?Oe(o.hu,14607):i.removedDocuments.size>0&&(Oe(o.hu,42227),o.hu=!1))}),await sd(t,r,e)}catch(r){await bc(r)}}function l1(n,e,t){let r=ue(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((s,o)=>{let a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),(function(o,a){let c=ue(o);c.onlineState=a;let l=!1;c.queries.forEach((u,h)=>{for(let f of h.Sa)f.va(a)&&(l=!0)}),l&&HT(c)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function C9(n,e,t){let r=ue(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),s=i&&i.key;if(s){let o=new st(te.comparator);o=o.insert(s,yr.newNoDocument(s,de.min()));let a=Ie().add(s),c=new um(de.min(),new Map,new st(be),o,a);await AL(r,c),r.du=r.du.remove(s),r.Au.delete(e),zT(r)}else await GA(r.localStore,e,!1).then(()=>fT(r,e,t)).catch(bc)}async function S9(n,e){let t=ue(n),r=e.batch.batchId;try{let i=await J5(t.localStore,e);CL(t,r,null),TL(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await sd(t,i)}catch(i){await bc(i)}}async function D9(n,e,t){let r=ue(n);try{let i=await(function(o,a){let c=ue(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(Oe(h!==null,37113),u=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})})(r.localStore,e);CL(r,e,t),TL(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await sd(r,i)}catch(i){await bc(i)}}function TL(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function CL(n,e,t){let r=ue(n),i=r.Vu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function fT(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||SL(n,r)})}function SL(n,e){n.Eu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(FT(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),zT(n))}function u1(n,e,t){for(let r of t)r instanceof Tm?(n.Ru.addReference(r.key,e),x9(n,r)):r instanceof Cm?(z($T,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||SL(n,r.key)):ne(19791,{wu:r})}function x9(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(z($T,"New document in limbo: "+t),n.Eu.add(r),zT(n))}function zT(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new te(Ze.fromString(e)),r=n.fu.next();n.Au.set(r,new dT(t)),n.du=n.du.insert(t,r),yL(n.remoteStore,new Zu(zr(q1(t.path)),r,"TargetPurposeLimboResolution",CT.ce))}}async function sd(n,e,t){let r=ue(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let u=l?!l.fromCache:t?.targetChanges.get(c.targetId)?.current;r.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(l){i.push(l);let u=UA.As(c.targetId,l);s.push(u)}}))}),await Promise.all(o),r.Pu.H_(i),await(async function(c,l){let u=ue(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>B.forEach(l,f=>B.forEach(f.Es,p=>u.persistence.referenceDelegate.addReference(h,f.targetId,p)).next(()=>B.forEach(f.ds,p=>u.persistence.referenceDelegate.removeReference(h,f.targetId,p)))))}catch(h){if(!Ic(h))throw h;z(LT,"Failed to update sequence numbers: "+h)}for(let h of l){let f=h.targetId;if(!h.fromCache){let p=u.Ms.get(f),m=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(m);u.Ms=u.Ms.insert(f,v)}}})(r.localStore,s))}async function P9(n,e){let t=ue(n);if(!t.currentUser.isEqual(e)){z($T,"User change. New user:",e.toKey());let r=await gL(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach(a=>{a.forEach(c=>{c.reject(new q(j.CANCELLED,o))})}),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await sd(t,r.Ls)}}function M9(n,e){let t=ue(n),r=t.Au.get(e);if(r&&r.hu)return Ie().add(r.key);{let i=Ie(),s=t.Iu.get(e);if(!s)return i;for(let o of s){let a=t.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function DL(n){let e=ue(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=AL.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=M9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=C9.bind(null,e),e.Pu.H_=v9.bind(null,e.eventManager),e.Pu.yu=_9.bind(null,e.eventManager),e}function R9(n){let e=ue(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=S9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=D9.bind(null,e),e}var xL=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Vm(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return X5(this.persistence,new $A,t.initialUser,this.serializer)}Cu(t){return new mm(BA.mi,this.serializer)}Du(t){return new WA}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),pT=class extends xL{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Oe(this.persistence.referenceDelegate instanceof ym,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new SA(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Kn.withCacheSize(this.cacheSizeBytes):Kn.DEFAULT;return new mm(r=>ym.mi(r,t),this.serializer)}};var N9=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>l1(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=P9.bind(null,this.syncEngine),await g9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new oT})()}createDatastore(t){let r=Vm(t.databaseInfo.databaseId),i=(function(o){return new XA(o)})(t.databaseInfo);return(function(o,a,c,l){return new tT(o,a,c,l)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,a,c){return new rT(i,s,o,a,c)})(this.localStore,this.datastore,t.asyncQueue,r=>l1(this.syncEngine,r,0),(function(){return _m.v()?new _m:new qA})())}createSyncEngine(t,r){return(function(s,o,a,c,l,u,h){let f=new hT(s,o,a,c,l,u);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=ue(r);z(Oo,"RemoteStore shutting down."),i.Ea.add(5),await id(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var gT=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Si("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var ws="FirestoreClient",mT=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ft.UNAUTHENTICATED,this.clientId=Wu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{z(ws,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(z(ws,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Hr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=UT(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function B0(n,e){n.asyncQueue.verifyOperationInProgress(),z(ws,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await gL(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function d1(n,e){n.asyncQueue.verifyOperationInProgress();let t=await O9(n);z(ws,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>o1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>o1(e.remoteStore,i)),n._onlineComponents=e}async function O9(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){z(ws,"Using user provided OfflineComponentProvider");try{await B0(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===j.FAILED_PRECONDITION||i.code===j.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;oc("Error using user provided cache. Falling back to memory cache: "+t),await B0(n,new xL)}}else z(ws,"Using default OfflineComponentProvider"),await B0(n,new pT(void 0));return n._offlineComponents}async function PL(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(z(ws,"Using user provided OnlineComponentProvider"),await d1(n,n._uninitializedComponentsProvider._online)):(z(ws,"Using default OnlineComponentProvider"),await d1(n,new N9))),n._onlineComponents}function k9(n){return PL(n).then(e=>e.syncEngine)}async function L9(n){let e=await PL(n),t=e.eventManager;return t.onListen=w9.bind(null,e.syncEngine),t.onUnlisten=I9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=E9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=A9.bind(null,e.syncEngine),t}function F9(n,e,t={}){let r=new Hr;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,a,c,l){let u=new gT({next:f=>{u.Nu(),o.enqueueAndForget(()=>y9(s,h)),f.fromCache&&c.source==="server"?l.reject(new q(j.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(f)},error:f=>l.reject(f)}),h=new cT(a,u,{includeMetadataChanges:!0,qa:!0});return m9(s,h)})(await L9(n),n.asyncQueue,e,t,r)),r.promise}function ML(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var h1=new Map;var RL="firestore.googleapis.com",f1=!0,Sm=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new q(j.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=RL,this.ssl=f1}else this.host=e.host,this.ssl=e.ssl??f1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pL;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<K5)throw new q(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ML(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new q(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new q(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new q(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},_c=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sm({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(j.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new q(j.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sm(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new U0;switch(r.type){case"firstParty":return new G0(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(j.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=h1.get(t);r&&(z("ComponentProvider","Removing Datastore"),h1.delete(t),r.terminate())})(this),Promise.resolve()}};function V9(n,e,t,r={}){n=xo(n,_c);let i=ls(e),s=n._getSettings(),o=J(L({},s),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;i&&(wg(`https://${a}`),Eg("Firestore",!0)),s.host!==RL&&s.host!==a&&oc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let c=J(L({},s),{host:a,ssl:i,emulatorOptions:r});if(!qn(c,o)&&(n._setSettings(c),r.mockUserToken)){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=Ft.MOCK_USER;else{l=fO(r.mockUserToken,n._app?.options.projectId);let h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new q(j.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ft(h)}n._authCredentials=new H0(new nm(l,u))}}var Dm=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},un=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ps(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(rd(t,n._jsonSchema))return new n(e,r||null,new te(Ze.fromString(t.referencePath)))}};un._jsonSchemaVersion="firestore/documentReference/1.0",un._jsonSchema={type:gt("string",un._jsonSchemaVersion),referencePath:gt("string")};var ps=class n extends Dm{constructor(e,t,r){super(e,t,q1(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new un(this.firestore,null,new te(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function GT(n,e,...t){if(n=it(n),y1("collection","path",e),n instanceof _c){let r=Ze.fromString(e,...t);return Nk(r),new ps(n,null,r)}{if(!(n instanceof un||n instanceof ps))throw new q(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ze.fromString(e,...t));return Nk(r),new ps(n.firestore,null,r)}}function Um(n,e,...t){if(n=it(n),arguments.length===1&&(e=Wu.newId()),y1("doc","path",e),n instanceof _c){let r=Ze.fromString(e,...t);return Rk(r),new un(n,null,new te(r))}{if(!(n instanceof un||n instanceof ps))throw new q(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Ze.fromString(e,...t));return Rk(r),new un(n.firestore,n instanceof ps?n.converter:null,new te(r))}}var p1="AsyncQueue",xm=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new wm(this,"async_queue_retry"),this._c=()=>{let r=j0();r&&z(p1,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=j0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=j0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new Hr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ic(e))throw e;z(p1,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Si("INTERNAL UNHANDLED ERROR: ",g1(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=iT.createAndSchedule(this,e,t,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&ne(47125,{Pc:g1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function g1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var ko=class extends _c{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new xm,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new xm(e),this._firestoreClient=void 0,await e}}};function NL(n,e){let t=typeof n=="object"?n:bo(),r=typeof n=="string"?n:e||am,i=gr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=hO("firestore");s&&V9(i,...s)}return i}function OL(n){if(n._terminated)throw new q(j.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||j9(n),n._firestoreClient}function j9(n){let e=n._freezeSettings(),t=(function(i,s,o,a){return new Q0(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,ML(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new mT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}var gs=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Zt.fromBase64String(e))}catch(t){throw new q(j.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(rd(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};gs._jsonSchemaVersion="firestore/bytes/1.0",gs._jsonSchema={type:gt("string",gs._jsonSchemaVersion),bytes:gt("string")};var wc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new q(j.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new On(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var nd=class{constructor(e){this._methodName=e}};var ms=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new q(j.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new q(j.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(rd(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};ms._jsonSchemaVersion="firestore/geoPoint/1.0",ms._jsonSchema={type:gt("string",ms._jsonSchemaVersion),latitude:gt("number"),longitude:gt("number")};var ys=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(rd(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new q(j.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};ys._jsonSchemaVersion="firestore/vectorValue/1.0",ys._jsonSchema={type:gt("string",ys._jsonSchemaVersion),vectorValues:gt("object")};var B9=/^__.*__$/,yT=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Kr(e,this.data,this.fieldMask,t,this.fieldTransforms):new No(e,this.data,t,this.fieldTransforms)}},Pm=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Kr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function kL(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne(40011,{Ac:n})}}var vT=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n(L(L({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Rm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(kL(this.Ac)&&B9.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}},_T=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Vm(e)}Cc(e,t,r,i=!1){return new vT({Ac:e,methodName:t,Dc:r,path:On.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function LL(n){let e=n._freezeSettings(),t=Vm(n._databaseId);return new _T(n._databaseId,!!e.ignoreUndefinedProperties,t)}function U9(n,e,t,r,i,s={}){let o=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);WT("Data must be an object, but it was:",o,r);let a=FL(r,o),c,l;if(s.merge)c=new Yn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let h of s.mergeFields){let f=wT(e,h,t);if(!o.contains(f))throw new q(j.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);jL(u,f)||u.push(f)}c=new Yn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new yT(new Nn(a),c,l)}var Mm=class n extends nd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function H9(n,e,t,r){let i=n.Cc(1,e,t);WT("Data must be an object, but it was:",i,r);let s=[],o=Nn.empty();Es(r,(c,l)=>{let u=qT(e,c,t);l=it(l);let h=i.yc(u);if(l instanceof Mm)s.push(u);else{let f=Hm(l,h);f!=null&&(s.push(u),o.set(u,f))}});let a=new Yn(s);return new Pm(o,a,i.fieldTransforms)}function $9(n,e,t,r,i,s){let o=n.Cc(1,e,t),a=[wT(e,r,t)],c=[i];if(s.length%2!=0)throw new q(j.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(wT(e,s[f])),c.push(s[f+1]);let l=[],u=Nn.empty();for(let f=a.length-1;f>=0;--f)if(!jL(l,a[f])){let p=a[f],m=c[f];m=it(m);let v=o.yc(p);if(m instanceof Mm)l.push(p);else{let w=Hm(m,v);w!=null&&(l.push(p),u.set(p,w))}}let h=new Yn(l);return new Pm(u,h,o.fieldTransforms)}function Hm(n,e){if(VL(n=it(n)))return WT("Unsupported field value:",e,n),FL(n,e);if(n instanceof nd)return(function(r,i){if(!kL(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let a of r){let c=Hm(a,i.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=it(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return E5(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=mt.fromDate(r);return{timestampValue:pm(i.serializer,s)}}if(r instanceof mt){let s=new mt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:pm(i.serializer,s)}}if(r instanceof ms)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gs)return{bytesValue:aL(i.serializer,r._byteString)};if(r instanceof un){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:kT(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ys)return(function(o,a){return{mapValue:{fields:{[xT]:{stringValue:PT},[cc]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Sc("VectorValues must only contain numeric values.");return OT(a.serializer,l)})}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${TT(r)}`)})(n,e)}function FL(n,e){let t={};return N1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Es(n,(r,i)=>{let s=Hm(i,e.mc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function VL(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof mt||n instanceof ms||n instanceof gs||n instanceof un||n instanceof nd||n instanceof ys)}function WT(n,e,t){if(!VL(t)||!v1(t)){let r=TT(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function wT(n,e,t){if((e=it(e))instanceof wc)return e._internalPath;if(typeof e=="string")return qT(n,e);throw Rm("Field path arguments must be of type string or ",n,!1,void 0,t)}var z9=new RegExp("[~\\*/\\[\\]]");function qT(n,e,t){if(e.search(z9)>=0)throw Rm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new wc(...e.split("."))._internalPath}catch{throw Rm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Rm(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new q(j.INVALID_ARGUMENT,a+n+c)}function jL(n,e){return n.some(t=>t.isEqual(e))}var Nm=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new un(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new ET(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(BL("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},ET=class extends Nm{data(){return super.data()}};function BL(n,e){return typeof e=="string"?qT(n,e):e instanceof wc?e._internalPath:e._delegate._internalPath}function G9(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new q(j.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var bT=class{convertValue(e,t="none"){switch(vs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ne(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Es(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){let t=e.fields?.[cc].arrayValue?.values?.map(r=>Ye(r.doubleValue));return new ys(t)}convertGeoPoint(e){return new ms(Ye(e.latitude),Ye(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=km(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Yu(e));default:return null}}convertTimestamp(e){let t=Di(e);return new mt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Ze.fromString(e);Oe(fL(r),9688,{name:e});let i=new cm(r.get(1),r.get(3)),s=new te(r.popFirst(5));return i.isEqual(t)||Si(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function W9(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var tc=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},rc=class n extends Nm{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ic(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(BL("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(j.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};rc._jsonSchemaVersion="firestore/documentSnapshot/1.0",rc._jsonSchema={type:gt("string",rc._jsonSchemaVersion),bundleSource:gt("string","DocumentSnapshot"),bundleName:gt("string"),bundle:gt("string")};var ic=class extends rc{data(e={}){return super.data(e)}},sc=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new tc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ic(this._firestore,this._userDataWriter,r.key,r,new tc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new q(j.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new ic(i._firestore,i._userDataWriter,a.doc.key,a.doc,new tc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new ic(i._firestore,i._userDataWriter,a.doc.key,a.doc,new tc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:q9(a.type),doc:c,oldIndex:l,newIndex:u}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(j.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Wu.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function q9(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne(61501,{type:n})}}sc._jsonSchemaVersion="firestore/querySnapshot/1.0",sc._jsonSchema={type:gt("string",sc._jsonSchemaVersion),bundleSource:gt("string","QuerySnapshot"),bundleName:gt("string"),bundle:gt("string")};var IT=class extends bT{constructor(e){super(),this.firestore=e}convertBytes(e){return new gs(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new un(this.firestore,null,t)}};function UL(n){n=xo(n,Dm);let e=xo(n.firestore,ko),t=OL(e),r=new IT(e);return G9(n._query),F9(t,n._query).then(i=>new sc(e,r,n,i))}function HL(n,e,t,...r){n=xo(n,un);let i=xo(n.firestore,ko),s=LL(i),o;return o=typeof(e=it(e))=="string"||e instanceof wc?$9(s,"updateDoc",n._key,e,t,r):H9(s,"updateDoc",n._key,e),KT(i,[o.toMutation(n._key,Ci.exists(!0))])}function $L(n){return KT(xo(n.firestore,ko),[new Xu(n._key,Ci.none())])}function zL(n,e){let t=xo(n.firestore,ko),r=Um(n),i=W9(n.converter,e);return KT(t,[U9(LL(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ci.exists(!1))]).then(()=>r)}function KT(n,e){return(function(r,i){let s=new Hr;return r.asyncQueue.enqueueAndForget(async()=>T9(await k9(r),i,s)),s.promise})(OL(n),e)}(function(e,t=!0){(function(i){Ec=i})(ds),vn(new Lt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ko(new $0(r.getProvider("auth-internal")),new W0(o,r.getProvider("app-check-internal")),(function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new q(j.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cm(l.options.projectId,u)})(o,i),o);return s=L({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),$t(xk,Pk,e),$t(xk,Pk,"esm2020")})();var qL="@firebase/installations",JT="0.6.19";var KL=1e4,YL=`w:${JT}`,QL="FIS_v2",K9="https://firebaseinstallations.googleapis.com/v1",Y9=3600*1e3,Q9="installations",X9="Installations";var J9={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Vo=new Mn(Q9,X9,J9);function XL(n){return n instanceof Ht&&n.code.includes("request-failed")}function JL({projectId:n}){return`${K9}/projects/${n}/installations`}function ZL(n){return{token:n.token,requestStatus:2,expiresIn:eK(n.expiresIn),creationTime:Date.now()}}async function eF(n,e){let r=(await e.json()).error;return Vo.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function tF({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Z9(n,{refreshToken:e}){let t=tF(n);return t.append("Authorization",tK(e)),t}async function nF(n){let e=await n();return e.status>=500&&e.status<600?n():e}function eK(n){return Number(n.replace("s","000"))}function tK(n){return`${QL} ${n}`}async function nK({appConfig:n,heartbeatServiceProvider:e},{fid:t}){let r=JL(n),i=tF(n),s=e.getImmediate({optional:!0});if(s){let l=await s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}let o={fid:t,authVersion:QL,appId:n.appId,sdkVersion:YL},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await nF(()=>fetch(r,a));if(c.ok){let l=await c.json();return{fid:l.fid||t,registrationStatus:2,refreshToken:l.refreshToken,authToken:ZL(l.authToken)}}else throw await eF("Create Installation",c)}function rF(n){return new Promise(e=>{setTimeout(e,n)})}function rK(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}var iK=/^[cdef][\w-]{21}$/,XT="";function sK(){try{let n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;let t=oK(n);return iK.test(t)?t:XT}catch{return XT}}function oK(n){return rK(n).substr(0,22)}function zm(n){return`${n.appName}!${n.appId}`}var iF=new Map;function sF(n,e){let t=zm(n);oF(t,e),aK(t,e)}function oF(n,e){let t=iF.get(n);if(t)for(let r of t)r(e)}function aK(n,e){let t=cK();t&&t.postMessage({key:n,fid:e}),lK()}var Fo=null;function cK(){return!Fo&&"BroadcastChannel"in self&&(Fo=new BroadcastChannel("[Firebase] FID Change"),Fo.onmessage=n=>{oF(n.data.key,n.data.fid)}),Fo}function lK(){iF.size===0&&Fo&&(Fo.close(),Fo=null)}var uK="firebase-installations-database",dK=1,jo="firebase-installations-store",YT=null;function ZT(){return YT||(YT=Cg(uK,dK,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(jo)}}})),YT}async function $m(n,e){let t=zm(n),i=(await ZT()).transaction(jo,"readwrite"),s=i.objectStore(jo),o=await s.get(t);return await s.put(e,t),await i.done,(!o||o.fid!==e.fid)&&sF(n,e.fid),e}async function aF(n){let e=zm(n),r=(await ZT()).transaction(jo,"readwrite");await r.objectStore(jo).delete(e),await r.done}async function Gm(n,e){let t=zm(n),i=(await ZT()).transaction(jo,"readwrite"),s=i.objectStore(jo),o=await s.get(t),a=e(o);return a===void 0?await s.delete(t):await s.put(a,t),await i.done,a&&(!o||o.fid!==a.fid)&&sF(n,a.fid),a}async function eC(n){let e,t=await Gm(n.appConfig,r=>{let i=hK(r),s=fK(n,i);return e=s.registrationPromise,s.installationEntry});return t.fid===XT?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function hK(n){let e=n||{fid:sK(),registrationStatus:0};return cF(e)}function fK(n,e){if(e.registrationStatus===0){if(!navigator.onLine){let i=Promise.reject(Vo.create("app-offline"));return{installationEntry:e,registrationPromise:i}}let t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=pK(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:gK(n)}:{installationEntry:e}}async function pK(n,e){try{let t=await nK(n,e);return $m(n.appConfig,t)}catch(t){throw XL(t)&&t.customData.serverCode===409?await aF(n.appConfig):await $m(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function gK(n){let e=await GL(n.appConfig);for(;e.registrationStatus===1;)await rF(100),e=await GL(n.appConfig);if(e.registrationStatus===0){let{installationEntry:t,registrationPromise:r}=await eC(n);return r||t}return e}function GL(n){return Gm(n,e=>{if(!e)throw Vo.create("installation-not-found");return cF(e)})}function cF(n){return mK(n)?{fid:n.fid,registrationStatus:0}:n}function mK(n){return n.registrationStatus===1&&n.registrationTime+KL<Date.now()}async function yK({appConfig:n,heartbeatServiceProvider:e},t){let r=vK(n,t),i=Z9(n,t),s=e.getImmediate({optional:!0});if(s){let l=await s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}let o={installation:{sdkVersion:YL,appId:n.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await nF(()=>fetch(r,a));if(c.ok){let l=await c.json();return ZL(l)}else throw await eF("Generate Auth Token",c)}function vK(n,{fid:e}){return`${JL(n)}/${e}/authTokens:generate`}async function tC(n,e=!1){let t,r=await Gm(n.appConfig,s=>{if(!lF(s))throw Vo.create("not-registered");let o=s.authToken;if(!e&&EK(o))return s;if(o.requestStatus===1)return t=_K(n,e),s;{if(!navigator.onLine)throw Vo.create("app-offline");let a=IK(s);return t=wK(n,a),a}});return t?await t:r.authToken}async function _K(n,e){let t=await WL(n.appConfig);for(;t.authToken.requestStatus===1;)await rF(100),t=await WL(n.appConfig);let r=t.authToken;return r.requestStatus===0?tC(n,e):r}function WL(n){return Gm(n,e=>{if(!lF(e))throw Vo.create("not-registered");let t=e.authToken;return AK(t)?J(L({},e),{authToken:{requestStatus:0}}):e})}async function wK(n,e){try{let t=await yK(n,e),r=J(L({},e),{authToken:t});return await $m(n.appConfig,r),t}catch(t){if(XL(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await aF(n.appConfig);else{let r=J(L({},e),{authToken:{requestStatus:0}});await $m(n.appConfig,r)}throw t}}function lF(n){return n!==void 0&&n.registrationStatus===2}function EK(n){return n.requestStatus===2&&!bK(n)}function bK(n){let e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+Y9}function IK(n){let e={requestStatus:1,requestTime:Date.now()};return J(L({},n),{authToken:e})}function AK(n){return n.requestStatus===1&&n.requestTime+KL<Date.now()}async function TK(n){let e=n,{installationEntry:t,registrationPromise:r}=await eC(e);return r?r.catch(console.error):tC(e).catch(console.error),t.fid}async function CK(n,e=!1){let t=n;return await SK(t),(await tC(t,e)).token}async function SK(n){let{registrationPromise:e}=await eC(n);e&&await e}function DK(n){if(!n||!n.options)throw QT("App Configuration");if(!n.name)throw QT("App Name");let e=["projectId","apiKey","appId"];for(let t of e)if(!n.options[t])throw QT(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function QT(n){return Vo.create("missing-app-config-values",{valueName:n})}var uF="installations",xK="installations-internal",PK=n=>{let e=n.getProvider("app").getImmediate(),t=DK(e),r=gr(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},MK=n=>{let e=n.getProvider("app").getImmediate(),t=gr(e,uF).getImmediate();return{getId:()=>TK(t),getToken:i=>CK(t,i)}};function RK(){vn(new Lt(uF,PK,"PUBLIC")),vn(new Lt(xK,MK,"PRIVATE"))}RK();$t(qL,JT);$t(qL,JT,"esm2020");var Wm="analytics",NK="firebase_id",OK="origin",kK=60*1e3,LK="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",cC="https://www.googletagmanager.com/gtag/js";var dn=new Vr("@firebase/analytics");var FK={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},kn=new Mn("analytics","Analytics",FK);function VK(n){if(!n.startsWith(cC)){let e=kn.create("invalid-gtag-resource",{gtagURL:n});return dn.warn(e.message),""}return n}function yF(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function jK(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function BK(n,e){let t=jK("firebase-js-sdk-policy",{createScriptURL:VK}),r=document.createElement("script"),i=`${cC}?l=${n}&id=${e}`;r.src=t?t?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function UK(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function HK(n,e,t,r,i,s){let o=r[i];try{if(o)await e[o];else{let c=(await yF(t)).find(l=>l.measurementId===i);c&&await e[c.appId]}}catch(a){dn.error(a)}n("config",i,s)}async function $K(n,e,t,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);let a=await yF(t);for(let c of o){let l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),n("event",r,i||{})}catch(s){dn.error(s)}}function zK(n,e,t,r){async function i(s,...o){try{if(s==="event"){let[a,c]=o;await $K(n,e,t,a,c)}else if(s==="config"){let[a,c]=o;await HK(n,e,t,r,a,c)}else if(s==="consent"){let[a,c]=o;n("consent",a,c)}else if(s==="get"){let[a,c,l]=o;n("get",a,c,l)}else if(s==="set"){let[a]=o;n("set",a)}else n(s,...o)}catch(a){dn.error(a)}}return i}function GK(n,e,t,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=zK(s,n,e,t),{gtagCore:s,wrappedGtag:window[i]}}function WK(n){let e=window.document.getElementsByTagName("script");for(let t of Object.values(e))if(t.src&&t.src.includes(cC)&&t.src.includes(n))return t;return null}var qK=30,KK=1e3,rC=class{constructor(e={},t=KK){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},vF=new rC;function YK(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function QK(n){let{appId:e,apiKey:t}=n,r={method:"GET",headers:YK(t)},i=LK.replace("{app-id}",e),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let o="";try{let a=await s.json();a.error?.message&&(o=a.error.message)}catch{}throw kn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:o})}return s.json()}async function XK(n,e=vF,t){let{appId:r,apiKey:i,measurementId:s}=n.options;if(!r)throw kn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw kn.create("no-api-key")}let o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new iC;return setTimeout(async()=>{a.abort()},t!==void 0?t:kK),_F({appId:r,apiKey:i,measurementId:s},o,a,e)}async function _F(n,{throttleEndTimeMillis:e,backoffCount:t},r,i=vF){let{appId:s,measurementId:o}=n;try{await JK(r,e)}catch(a){if(o)return dn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${a?.message}]`),{appId:s,measurementId:o};throw a}try{let a=await QK(n);return i.deleteThrottleMetadata(s),a}catch(a){let c=a;if(!ZK(c)){if(i.deleteThrottleMetadata(s),o)return dn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:s,measurementId:o};throw a}let l=Number(c?.customData?.httpStatus)===503?VI(t,i.intervalMillis,qK):VI(t,i.intervalMillis),u={throttleEndTimeMillis:Date.now()+l,backoffCount:t+1};return i.setThrottleMetadata(s,u),dn.debug(`Calling attemptFetch again in ${l} millis`),_F(n,u,r,i)}}function JK(n,e){return new Promise((t,r)=>{let i=Math.max(e-Date.now(),0),s=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(s),r(kn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function ZK(n){if(!(n instanceof Ht)||!n.customData)return!1;let e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}var iC=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var sC;async function e7(n,e,t,r,i){if(i&&i.global){n("event",t,r);return}else{let s=await e,o=J(L({},r),{send_to:s});n("event",t,o)}}async function t7(n,e,t,r){if(r&&r.global){let i={};for(let s of Object.keys(t))i[`user_properties.${s}`]=t[s];return n("set",i),Promise.resolve()}else{let i=await e;n("config",i,{update:!0,user_properties:t})}}var oC;function n7(n){oC=n}function r7(n){sC=n}async function i7(){if(Pu())try{await Ig()}catch(n){return dn.warn(kn.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return dn.warn(kn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function s7(n,e,t,r,i,s,o){let a=XK(n);a.then(f=>{t[f.measurementId]=f.appId,n.options.measurementId&&f.measurementId!==n.options.measurementId&&dn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>dn.error(f)),e.push(a);let c=i7().then(f=>{if(f)return r.getId()}),[l,u]=await Promise.all([a,c]);WK(s)||BK(s,l.measurementId),oC&&(i("consent","default",oC),n7(void 0)),i("js",new Date);let h=o?.config??{};return h[OK]="firebase",h.update=!0,u!=null&&(h[NK]=u),i("config",l.measurementId,h),sC&&(i("set",sC),r7(void 0)),l.measurementId}var aC=class{constructor(e){this.app=e}_delete(){return delete Tc[this.app.options.appId],Promise.resolve()}},Tc={},dF=[],hF={},nC="dataLayer",o7="gtag",fF,lC,pF=!1;function a7(){let n=[];if(bg()&&n.push("This is a browser extension environment."),_O()||n.push("Cookies are not available."),n.length>0){let e=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),t=kn.create("invalid-analytics-context",{errorInfo:e});dn.warn(t.message)}}function c7(n,e,t){a7();let r=n.options.appId;if(!r)throw kn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)dn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw kn.create("no-api-key");if(Tc[r]!=null)throw kn.create("already-exists",{id:r});if(!pF){UK(nC);let{wrappedGtag:s,gtagCore:o}=GK(Tc,dF,hF,nC,o7);lC=s,fF=o,pF=!0}return Tc[r]=s7(n,dF,hF,e,fF,nC,t),new aC(n)}function wF(n=bo()){n=it(n);let e=gr(n,Wm);return e.isInitialized()?e.getImmediate():l7(n)}function l7(n,e={}){let t=gr(n,Wm);if(t.isInitialized()){let i=t.getImmediate();if(qn(e,t.getOptions()))return i;throw kn.create("already-initialized")}return t.initialize({options:e})}function u7(n,e,t){n=it(n),t7(lC,Tc[n.app.options.appId],e,t).catch(r=>dn.error(r))}function uC(n,e,t,r){n=it(n),e7(lC,Tc[n.app.options.appId],e,t,r).catch(i=>dn.error(i))}var gF="@firebase/analytics",mF="0.10.19";function d7(){vn(new Lt(Wm,(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return c7(r,i,t)},"PUBLIC")),vn(new Lt("analytics-internal",n,"PRIVATE")),$t(gF,mF),$t(gF,mF,"esm2020");function n(e){try{let t=e.getProvider(Wm).getImmediate();return{logEvent:(r,i,s)=>uC(t,r,i,s),setUserProperties:(r,i)=>u7(t,r,i)}}catch(t){throw kn.create("interop-component-reg-failed",{reason:t})}}}d7();var h7=Su.firebase,Cc=class n{app=ZI(h7);auth=x0(this.app);db=NL(this.app);analytics=wF(this.app);userSubject=new wt(null);user$=this.userSubject.asObservable();constructor(){A0(this.auth,e=>{this.userSubject.next(e)})}log(e,t=null){let r={url:window.location.href,device:window.navigator.userAgent,timestamp:new Date().toISOString(),event:e};t&&(r.data=t),console.log("Sending Event to Analytics: ",r),uC(this.analytics,e,r)}async login(){let e=new I0;try{let t=await D0(this.auth,e);return this.log("login",{email:t.user.email}),t.user}catch(t){throw console.error("Login failed",t),t}}async logout(){try{await T0(this.auth)}catch(e){throw console.error("Logout failed",e),e}}getCurrentUser(){return this.auth.currentUser}async create(e,t){try{let r=GT(this.db,e);return(await zL(r,t)).id}catch(r){throw console.error("Error creating document",r),r}}async read(e){try{let t=GT(this.db,e);return(await UL(t)).docs.map(i=>L({id:i.id},i.data()))}catch(t){throw console.error("Error reading documents",t),t}}async update(e,t,r){try{let i=Um(this.db,e,t);await HL(i,r)}catch(i){throw console.error("Error updating document",i),i}}async delete(e,t){try{let r=Um(this.db,e,t);await $L(r)}catch(r){throw console.error("Error deleting document",r),r}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};function f7(n,e){if(n&1){let t=an();Y(0,"div",19),ze("click",function(){Mt(t);let i=Ne();return Rt(i.closeMenu())}),Q()}}function p7(n,e){if(n&1){let t=an();Y(0,"div",20)(1,"button",21),ze("click",function(){Mt(t);let i=Ne();return Rt(i.onShareClick())}),Y(2,"span",7),Ce(3,"share"),Q(),Ce(4," Share "),Q(),Y(5,"button",21),ze("click",function(){Mt(t);let i=Ne();return Rt(i.onDownloadClick())}),Y(6,"span",7),Ce(7,"download"),Q(),Ce(8," Download "),Q()()}}function g7(n,e){n&1&&(Y(0,"div",22),Ot(1,"div",23),Y(2,"span"),Ce(3,"Loading PDF..."),Q()())}function m7(n,e){if(n&1){let t=an();Y(0,"pdf-viewer",24),ze("after-load-complete",function(){Mt(t);let i=Ne();return Rt(i.onPdfLoadComplete())}),Q()}if(n&2){let t=Ne();me("src",t.downloadUrl)("render-text",!0)("original-size",!1)}}function y7(n,e){if(n&1&&Ot(0,"img",25),n&2){let t=Ne();me("src",t.downloadUrl,Js)}}function v7(n,e){if(n&1&&Ot(0,"video",26),n&2){let t=Ne();me("src",t.downloadUrl,Js)}}function _7(n,e){if(n&1){let t=an();Y(0,"div",27)(1,"p"),Ce(2,"Preview not available for this file type."),Q(),Y(3,"button",28),ze("click",function(){Mt(t);let i=Ne();return Rt(i.onDownloadClick())}),Ce(4,"Download"),Q()()}}function w7(n,e){n&1&&(Y(0,"div",34),Ot(1,"div",23),Q())}function E7(n,e){if(n&1){let t=an();Ji(0),Y(1,"button",35),ze("click",function(){Mt(t);let i=Ne(2);return Rt(i.closeSigninPopup())}),Ce(2,"Cancel"),Q(),Y(3,"button",36),ze("click",function(){Mt(t);let i=Ne(2);return Rt(i.onSignin())}),Ce(4,"Sign in"),Q(),Zi()}}function b7(n,e){if(n&1&&(Y(0,"div",29)(1,"div",30)(2,"h3"),Ce(3,"Sign in required"),Q(),Y(4,"p"),Ce(5,"Please sign in with Google to download this file."),Q(),Y(6,"div",31),Nt(7,w7,2,0,"div",32)(8,E7,5,0,"ng-container",33),Q()()()),n&2){let t=Ne();fe(7),me("ngIf",t.isSigningIn),fe(),me("ngIf",!t.isSigningIn)}}function I7(n,e){n&1&&(Y(0,"div",37),Ce(1,"Link copied to clipboard"),Q())}var qm=class n{constructor(e,t){this.firestoreService=e;this.cdr=t}file=null;close=new $e;user=null;ngOnInit(){this.firestoreService.user$.subscribe(e=>{this.user=e})}onClose(){this.close.emit()}get isPdf(){return this.file?.name.endsWith(".pdf")??!1}get isImage(){return!!this.file?.name.match(/\.(jpg|jpeg|png|gif)$/i)}get isVideo(){return!!this.file?.name.match(/\.(mp4|webm)$/i)}get downloadUrl(){return this.file?.download_url??""}showSigninPopup=!1;isMenuOpen=!1;showToast=!1;loading=!0;onPdfLoadComplete(){this.loading=!1}showToastNotification(){this.showToast=!0,this.cdr.detectChanges(),setTimeout(()=>{this.showToast=!1,this.cdr.detectChanges()},3e3)}toggleMenu(){this.isMenuOpen=!this.isMenuOpen}closeMenu(){this.isMenuOpen=!1}onDownloadClick(){if(this.closeMenu(),this.user){this.firestoreService.log("download",{fileName:this.file?.name,filePath:this.file?.path});let e=document.createElement("a");e.href=this.downloadUrl,e.target="_blank",e.download=this.file?.name||"download",document.body.appendChild(e),e.click(),document.body.removeChild(e)}else this.showSigninPopup=!0}onShareClick(){if(this.closeMenu(),this.file){let e=`${window.location.origin}/open?path=${encodeURIComponent(this.file.path)}`;navigator.clipboard.writeText(e).then(()=>{this.showToastNotification()})}}closeSigninPopup(){this.showSigninPopup=!1}isSigningIn=!1;async onSignin(){this.isSigningIn=!0;try{await this.firestoreService.login(),this.closeSigninPopup(),this.onDownloadClick()}catch(e){console.error("Login failed",e)}finally{this.isSigningIn=!1}}static \u0275fac=function(t){return new(t||n)(tt(Cc),tt(ar))};static \u0275cmp=Tn({type:n,selectors:[["app-viewer"]],inputs:{file:"file"},outputs:{close:"close"},standalone:!1,decls:22,vars:10,consts:[[1,"viewer-overlay",3,"click"],[1,"viewer-content",3,"click"],[1,"viewer-header"],[1,"file-name"],[1,"actions"],[1,"menu-container"],[1,"menu-btn",3,"click"],[1,"material-icons"],["class","menu-backdrop",3,"click",4,"ngIf"],["class","dropdown-menu",4,"ngIf"],[1,"close-btn",3,"click"],[1,"viewer-body"],["class","loading-container",4,"ngIf"],["style","width: 100%; height: 100%; display: block;",3,"src","render-text","original-size","after-load-complete",4,"ngIf"],["alt","file","class","preview-image",3,"src",4,"ngIf"],["controls","","class","preview-video",3,"src",4,"ngIf"],["class","unsupported",4,"ngIf"],["class","signin-overlay",4,"ngIf"],["class","toast",4,"ngIf"],[1,"menu-backdrop",3,"click"],[1,"dropdown-menu"],[1,"menu-item",3,"click"],[1,"loading-container"],[1,"spinner"],[2,"width","100%","height","100%","display","block",3,"after-load-complete","src","render-text","original-size"],["alt","file",1,"preview-image",3,"src"],["controls","",1,"preview-video",3,"src"],[1,"unsupported"],[1,"download-link",3,"click"],[1,"signin-overlay"],[1,"signin-popup"],[1,"popup-actions"],["class","loader-container",4,"ngIf"],[4,"ngIf"],[1,"loader-container"],[1,"cancel-btn",3,"click"],[1,"signin-btn",3,"click"],[1,"toast"]],template:function(t,r){t&1&&(Y(0,"div",0),ze("click",function(){return r.onClose()}),Y(1,"div",1),ze("click",function(s){return s.stopPropagation()}),Y(2,"div",2)(3,"span",3),Ce(4),Q(),Y(5,"div",4)(6,"div",5)(7,"button",6),ze("click",function(){return r.toggleMenu()}),Y(8,"span",7),Ce(9,"more_vert"),Q()(),Nt(10,f7,1,0,"div",8)(11,p7,9,0,"div",9),Q(),Y(12,"button",10),ze("click",function(){return r.onClose()}),Ce(13,"\u2715"),Q()()(),Y(14,"div",11),Nt(15,g7,4,0,"div",12)(16,m7,1,3,"pdf-viewer",13)(17,y7,1,1,"img",14)(18,v7,1,1,"video",15)(19,_7,5,0,"div",16),Q()(),Nt(20,b7,9,2,"div",17)(21,I7,2,0,"div",18),Q()),t&2&&(fe(4),zn(r.file==null?null:r.file.name),fe(6),me("ngIf",r.isMenuOpen),fe(),me("ngIf",r.isMenuOpen),fe(4),me("ngIf",r.loading&&r.isPdf),fe(),me("ngIf",r.isPdf),fe(),me("ngIf",r.isImage),fe(),me("ngIf",r.isVideo),fe(),me("ngIf",!r.isPdf&&!r.isImage&&!r.isVideo),fe(),me("ngIf",r.showSigninPopup),fe(),me("ngIf",r.showToast))},dependencies:[eo,ZR],styles:[".viewer-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000000d9;z-index:1000;display:flex;align-items:center;justify-content:center;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]{background:#fff;width:90%;height:90%;max-width:1200px;border-radius:12px;display:flex;flex-direction:column;overflow:hidden;box-shadow:0 24px 48px #0003;animation:_ngcontent-%COMP%_slideUp .3s ease-out}@media(max-width:768px){.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:0}}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]{padding:16px 24px;background:#fff;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e0e0e0;z-index:10}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#202124;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:16px;flex:1}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]{position:relative}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .menu-btn[_ngcontent-%COMP%]{background:none;border:none;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#5f6368;transition:background-color .2s}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .menu-btn[_ngcontent-%COMP%]:hover{background-color:#0000000d;color:#202124}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .menu-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:90;cursor:default}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:48px;right:0;width:180px;background:#fff;border-radius:4px;box-shadow:0 2px 6px 2px #3c404326;z-index:100;padding:8px 0;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_fadeIn .1s ease-out}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;width:100%;padding:10px 24px;background:none;border:none;text-align:left;font-size:14px;color:#202124;cursor:pointer;font-family:inherit}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover{background-color:#f1f3f4}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px;color:#5f6368}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#5f6368;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background-color:#0000000d;color:#202124}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-body[_ngcontent-%COMP%]{flex:1;overflow:auto;background:#f8f9fa;display:flex;align-items:center;justify-content:center;padding:20px;position:relative}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-body[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%], .viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-body[_ngcontent-%COMP%]   .preview-video[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;box-shadow:0 4px 12px #0000001a;border-radius:4px}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-body[_ngcontent-%COMP%]   .unsupported[_ngcontent-%COMP%]{text-align:center;padding:40px;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-body[_ngcontent-%COMP%]   .unsupported[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;color:#5f6368;font-size:16px}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-body[_ngcontent-%COMP%]   .unsupported[_ngcontent-%COMP%]   .download-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:10px 24px;background:#1a73e8;color:#fff;text-decoration:none;border:none;border-radius:24px;font-weight:500;cursor:pointer;font-family:inherit;font-size:14px;transition:background-color .2s,transform .2s}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-body[_ngcontent-%COMP%]   .unsupported[_ngcontent-%COMP%]   .download-link[_ngcontent-%COMP%]:hover{background:#1567d3;transform:translateY(-1px)}.viewer-overlay[_ngcontent-%COMP%]   .viewer-content[_ngcontent-%COMP%]   .viewer-body[_ngcontent-%COMP%]   .unsupported[_ngcontent-%COMP%]   .download-link[_ngcontent-%COMP%]:active{transform:translateY(0)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.toast[_ngcontent-%COMP%]{position:fixed;bottom:24px;left:50%;transform:translate(-50%);background-color:#323232;color:#fff;padding:12px 24px;border-radius:4px;font-size:14px;z-index:2000;box-shadow:0 2px 5px #0003;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;color:#5f6368;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:5;background:#ffffffe6;padding:20px;border-radius:8px}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(26,115,232,.1);border-left-color:#1a73e8;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.signin-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;z-index:1100;display:flex;align-items:center;justify-content:center;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]{background:#fff;padding:24px;border-radius:8px;width:90%;max-width:400px;box-shadow:0 4px 12px #00000026;text-align:center;animation:_ngcontent-%COMP%_slideUp .2s ease-out}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;color:#202124;font-size:20px}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 24px;color:#5f6368;line-height:1.5}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   .popup-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   .popup-actions[_ngcontent-%COMP%]   .loader-container[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;padding:5px 0;position:static;transform:none;background:none}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   .popup-actions[_ngcontent-%COMP%]   .loader-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:3px solid rgba(26,115,232,.1);border-left-color:#1a73e8;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   .popup-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;font-weight:500;cursor:pointer;border:none;font-family:inherit;transition:background-color .2s}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   .popup-actions[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]{background:none;color:#1a73e8}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   .popup-actions[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]:hover{background:#1a73e80a}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   .popup-actions[_ngcontent-%COMP%]   button.signin-btn[_ngcontent-%COMP%]{background:#1a73e8;color:#fff}.signin-overlay[_ngcontent-%COMP%]   .signin-popup[_ngcontent-%COMP%]   .popup-actions[_ngcontent-%COMP%]   button.signin-btn[_ngcontent-%COMP%]:hover{background:#1567d3;box-shadow:0 1px 2px #0003}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};function T7(n,e){n&1&&(Y(0,"span",13),Ce(1,"/"),Q())}function C7(n,e){if(n&1){let t=an();Ji(0),Y(1,"span",11),ze("click",function(){let i=Mt(t),s=i.$implicit,o=i.last,a=Ne();return Rt(!o&&a.loadContents(s.path))}),Ce(2),Q(),Nt(3,T7,2,0,"span",12),Zi()}if(n&2){let t=e.$implicit,r=e.last;fe(),rf("active",r),fe(),Sl(" ",t.name," "),fe(),me("ngIf",!r)}}function S7(n,e){if(n&1){let t=an();Y(0,"div",17),ze("click",function(){let i=Mt(t).$implicit,s=Ne(2);return Rt(s.openItem(i))}),Y(1,"div",18)(2,"div",19)(3,"span",20),Ce(4),Q()(),Y(5,"div",21)(6,"div",22),Ce(7),Q()()()()}if(n&2){let t=e.$implicit,r=Ne(2);fe(4),zn(r.getIcon(t)),fe(2),me("title",t.name),fe(),zn(t.name)}}function D7(n,e){n&1&&(Y(0,"div",23)(1,"div",24),Ce(2,"\u{1F4C2}"),Q(),Y(3,"p"),Ce(4,"No files found in this directory."),Q()())}function x7(n,e){if(n&1&&(Y(0,"div",14),Nt(1,S7,8,3,"div",15)(2,D7,5,0,"div",16),Q()),n&2){let t=Ne();fe(),me("ngForOf",t.items),fe(),me("ngIf",t.items.length===0)}}function P7(n,e){n&1&&(Y(0,"div",25),Ce(1,"Loading..."),Q())}function M7(n,e){if(n&1){let t=an();Y(0,"app-viewer",26),ze("close",function(){Mt(t);let i=Ne();return Rt(i.closeViewer())}),Q()}if(n&2){let t=Ne();me("file",t.selectedFile)}}var od=class n{constructor(e,t,r){this.githubService=e;this.cdr=t;this.route=r}items=[];currentPath="";loading=!0;selectedFile=null;ngOnInit(){this.route.queryParams.subscribe(e=>{let t=e.path;t?this.handleDeepLink(decodeURIComponent(t)):this.loadContents(this.githubService.DEFAULT_PATH)})}handleDeepLink(e){let t=e.lastIndexOf("/"),r=t>0?e.substring(0,t):this.githubService.DEFAULT_PATH;this.loading=!0,this.currentPath=r,this.githubService.getContents(r).subscribe({next:i=>{this.items=i.sort((o,a)=>o.type===a.type?o.name.localeCompare(a.name):o.type==="dir"?-1:1);let s=this.items.find(o=>o.path===e);s&&(this.selectedFile=s),this.loading=!1,this.cdr.detectChanges()},error:i=>{console.error("Error fetching contents",i),alert("Error fetching contents"),this.loading=!1,this.cdr.detectChanges()}})}loadContents(e){let t=e||this.githubService.DEFAULT_PATH;this.loading=!0,this.currentPath=t,this.githubService.getContents(t).subscribe({next:r=>{this.items=r.sort((i,s)=>i.type===s.type?i.name.localeCompare(s.name):i.type==="dir"?-1:1),this.loading=!1,this.cdr.detectChanges()},error:r=>{console.error("Error fetching contents",r),alert("Error fetching contents"),this.loading=!1,this.cdr.detectChanges()}})}openItem(e){e.type==="dir"?this.loadContents(e.path):this.selectedFile=e}closeViewer(){this.selectedFile=null}get breadcrumbSegments(){let e=[],t=this.githubService.DEFAULT_PATH;if(e.push({name:"Home",path:t}),this.currentPath&&this.currentPath!==t){let r=this.currentPath.replace(t+"/","").split("/"),i=t;r.forEach(s=>{i+="/"+s,e.push({name:s,path:i})})}return e}onSearch(e){let t=e.target.value;if(!t){this.loadContents(this.currentPath);return}this.loading=!0,this.githubService.searchFiles(t).subscribe({next:r=>{this.items=r.items.map(i=>({name:i.name,path:i.path,type:"file",download_url:i.html_url.replace("github.com","raw.githubusercontent.com").replace("/blob/","/")})),this.loading=!1,this.cdr.detectChanges()},error:r=>{console.error("Error searching files",r),this.loading=!1,this.cdr.detectChanges()}})}getIcon(e){return e.type==="dir"?"\u{1F4C1}":e.name.endsWith(".pdf")?"\u{1F4C4}":e.name.match(/\.(jpg|jpeg|png|gif)$/i)?"\u{1F5BC}\uFE0F":e.name.match(/\.(mp4|webm)$/i)?"\u{1F3A5}":"\u{1F4C4}"}static \u0275fac=function(t){return new(t||n)(tt(mg),tt(ar),tt(Fr))};static \u0275cmp=Tn({type:n,selectors:[["app-home"]],standalone:!1,decls:12,vars:4,consts:[[1,"home-container"],[1,"breadcrumb-container"],[1,"breadcrumb"],[4,"ngFor","ngForOf"],[1,"search-container"],[1,"search-bar"],[1,"search-icon"],["type","text","placeholder","Search in Drive",1,"search-input",3,"keyup.enter"],["class","content-grid",4,"ngIf"],["class","loader",4,"ngIf"],[3,"file","close",4,"ngIf"],[1,"crumb",3,"click"],["class","separator",4,"ngIf"],[1,"separator"],[1,"content-grid"],["class","grid-item","tabindex","0",3,"click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["tabindex","0",1,"grid-item",3,"click"],[1,"card-content"],[1,"icon-wrapper"],[1,"icon"],[1,"info"],[1,"name",3,"title"],[1,"empty-state"],[1,"empty-icon"],[1,"loader"],[3,"close","file"]],template:function(t,r){t&1&&(Y(0,"div",0)(1,"div",1)(2,"div",2),Nt(3,C7,4,4,"ng-container",3),Q()(),Y(4,"div",4)(5,"div",5)(6,"i",6),Ce(7,"\u{1F50D}"),Q(),Y(8,"input",7),ze("keyup.enter",function(s){return r.onSearch(s)}),Q()()(),Nt(9,x7,3,2,"div",8)(10,P7,2,0,"div",9)(11,M7,1,1,"app-viewer",10),Q()),t&2&&(fe(3),me("ngForOf",r.breadcrumbSegments),fe(6),me("ngIf",r.loading==!1),fe(),me("ngIf",r.loading==!0),fe(),me("ngIf",r.selectedFile))},dependencies:[pf,eo,qm],styles:['.home-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto;min-height:100vh;background-color:#f8f9fa;font-family:Segoe UI,Roboto,Helvetica,Arial,sans-serif}@media(max-width:600px){.home-container[_ngcontent-%COMP%]{padding:16px}}.home-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]{margin-bottom:20px}.home-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{width:80%;max-width:720px;margin:0 auto;background:#fff;border:1px solid #dadce0;border-radius:24px;padding:0 16px;height:48px;display:flex;align-items:center;box-shadow:0 1px 2px #0000001a;transition:box-shadow .2s,background-color .2s}.home-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]:focus-within{background:#fff;box-shadow:0 1px 2px #0000001a,0 2px 4px #0000001a}.home-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{color:#5f6368;margin-right:12px;font-style:normal;font-size:20px}.home-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{border:none;background:transparent;flex:1;height:100%;font-size:16px;outline:none;color:#202124;width:100%}.home-container[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#5f6368}.home-container[_ngcontent-%COMP%]   .breadcrumb-container[_ngcontent-%COMP%]{padding:12px 0}.home-container[_ngcontent-%COMP%]   .breadcrumb-container[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;font-size:16px;color:#5f6368;cursor:pointer}.home-container[_ngcontent-%COMP%]   .breadcrumb-container[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]   .crumb[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 8px;border-radius:4px;transition:background-color .2s,color .2s}.home-container[_ngcontent-%COMP%]   .breadcrumb-container[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]   .crumb[_ngcontent-%COMP%]:not(.active){cursor:pointer;color:#1a73e8;font-weight:500}.home-container[_ngcontent-%COMP%]   .breadcrumb-container[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]   .crumb[_ngcontent-%COMP%]:not(.active):hover{background-color:#1a73e814;text-decoration:none}.home-container[_ngcontent-%COMP%]   .breadcrumb-container[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]   .crumb.active[_ngcontent-%COMP%]{color:#202124;cursor:default;font-weight:600}.home-container[_ngcontent-%COMP%]   .breadcrumb-container[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:0 4px;color:#dadce0;font-size:14px}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:20px;padding-bottom:40px}@media(max-width:600px){.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:12px}}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]{background:#fff;border:1px solid #dadce0;border-radius:12px;overflow:hidden;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1);position:relative;outline:none}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]:hover, .home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]:focus{border-color:transparent;box-shadow:0 1px 2px #3c40434d,0 2px 6px 2px #3c404326;transform:translateY(-2px)}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]:hover   .icon-wrapper[_ngcontent-%COMP%], .home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]:focus   .icon-wrapper[_ngcontent-%COMP%]{transform:scale(1.1)}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column;align-items:center;text-align:center;height:100%}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:64px;height:64px;display:flex;align-items:center;justify-content:center;background-color:#f1f3f4;border-radius:50%;margin-bottom:16px;transition:transform .2s}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:32px;line-height:1}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{width:100%}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#202124;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%}.home-container[_ngcontent-%COMP%]   .content-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{font-size:12px;color:#5f6368}.home-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;color:#5f6368;text-align:center;background:#fff;border-radius:12px;border:1px dashed #dadce0}.home-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px;opacity:.5}.home-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.home-container[_ngcontent-%COMP%]   .loader[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#5f6368;font-size:16px;display:flex;align-items:center;justify-content:center}.home-container[_ngcontent-%COMP%]   .loader[_ngcontent-%COMP%]:before{content:"";width:20px;height:20px;border:2px solid #dadce0;border-top-color:#1a73e8;border-radius:50%;margin-right:10px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}']})};var R7=[{path:"",component:od},{path:"open",component:od},{path:"**",redirectTo:""}],Km=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=jt({type:n});static \u0275inj=xt({imports:[gg.forRoot(R7),gg]})};function N7(n,e){if(n&1&&Ot(0,"img",10),n&2){let t=Ne();me("src",t.user==null?null:t.user.photoURL,Js)("alt",t.user==null?null:t.user.displayName)}}function O7(n,e){if(n&1&&(Y(0,"span"),Ce(1),Q()),n&2){let t=Ne();fe(),zn(t.userInitial)}}function k7(n,e){if(n&1){let t=an();Y(0,"div",11),ze("click",function(){Mt(t);let i=Ne();return Rt(i.closeDropdown())}),Q()}}function L7(n,e){if(n&1&&Ot(0,"img",21),n&2){let t=Ne(2);me("src",t.user==null?null:t.user.photoURL,Js)("alt",t.user==null?null:t.user.displayName)}}function F7(n,e){if(n&1&&(Y(0,"span"),Ce(1),Q()),n&2){let t=Ne(2);fe(),zn(t.userInitial)}}function V7(n,e){n&1&&(Y(0,"div",22),Ot(1,"div",23),Q())}function j7(n,e){if(n&1){let t=an();Y(0,"button",26),ze("click",function(){Mt(t);let i=Ne(3);return Rt(i.onSignin())}),Ce(1,"Sign in"),Q()}}function B7(n,e){if(n&1){let t=an();Y(0,"button",27),ze("click",function(){Mt(t);let i=Ne(3);return Rt(i.onSignout())}),Ce(1,"Sign out"),Q()}}function U7(n,e){if(n&1&&(Ji(0),Nt(1,j7,2,0,"button",24)(2,B7,2,0,"button",25),Zi()),n&2){let t=Ne(2);fe(),me("ngIf",!t.user),fe(),me("ngIf",t.user)}}function H7(n,e){if(n&1&&(Y(0,"div",12)(1,"div",13)(2,"div",14),Nt(3,L7,1,2,"img",15)(4,F7,2,1,"span",7),Q(),Y(5,"div",16)(6,"span",17),Ce(7),Q(),Y(8,"span",18),Ce(9),Q()()(),Y(10,"div",19),Nt(11,V7,2,0,"div",20)(12,U7,3,2,"ng-container",7),Q()()),n&2){let t=Ne();fe(3),me("ngIf",t.user==null?null:t.user.photoURL),fe(),me("ngIf",!(t.user!=null&&t.user.photoURL)),fe(3),zn((t.user==null?null:t.user.displayName)||"Guest"),fe(2),zn((t.user==null?null:t.user.email)||"Not signed in"),fe(2),me("ngIf",t.isLoading),fe(),me("ngIf",!t.isLoading)}}var Ym=class n{constructor(e,t){this.firestoreService=e;this.cdr=t}isDropdownOpen=!1;user=null;userSub=null;ngOnInit(){this.userSub=this.firestoreService.user$.subscribe(e=>{this.user=e,this.cdr.detectChanges()})}ngOnDestroy(){this.userSub&&this.userSub.unsubscribe()}toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}closeDropdown(){this.isDropdownOpen=!1}isLoading=!1;async onSignin(){this.isLoading=!0;try{await this.firestoreService.login(),this.closeDropdown()}catch(e){console.error("Login failed",e)}finally{this.isLoading=!1}}async onSignout(){this.isLoading=!0;try{await this.firestoreService.logout(),this.closeDropdown()}catch(e){console.error("Logout failed",e)}finally{this.isLoading=!1}}get userInitial(){return this.user?.displayName?this.user.displayName.charAt(0).toUpperCase():"G"}static \u0275fac=function(t){return new(t||n)(tt(Cc),tt(ar))};static \u0275cmp=Tn({type:n,selectors:[["app-header"]],standalone:!1,decls:11,vars:4,consts:[[1,"app-header"],[1,"logo-container"],["src","https://upload.wikimedia.org/wikipedia/commons/d/da/Google_Drive_logo.png","alt","Logo",1,"logo"],[1,"app-name"],[1,"user-profile"],[1,"avatar",3,"click"],["class","avatar-img",3,"src","alt",4,"ngIf"],[4,"ngIf"],["class","dropdown-backdrop",3,"click",4,"ngIf"],["class","dropdown-menu",4,"ngIf"],[1,"avatar-img",3,"src","alt"],[1,"dropdown-backdrop",3,"click"],[1,"dropdown-menu"],[1,"user-info"],[1,"avatar-large"],["class","avatar-img-large",3,"src","alt",4,"ngIf"],[1,"details"],[1,"name"],[1,"email"],[1,"actions"],["class","loader-container",4,"ngIf"],[1,"avatar-img-large",3,"src","alt"],[1,"loader-container"],[1,"spinner"],["class","signin-btn",3,"click",4,"ngIf"],["class","signout-btn",3,"click",4,"ngIf"],[1,"signin-btn",3,"click"],[1,"signout-btn",3,"click"]],template:function(t,r){t&1&&(Y(0,"header",0)(1,"div",1),Ot(2,"img",2),Y(3,"span",3),Ce(4,"Docs"),Q()(),Y(5,"div",4)(6,"div",5),ze("click",function(){return r.toggleDropdown()}),Nt(7,N7,1,2,"img",6)(8,O7,2,1,"span",7),Q(),Nt(9,k7,1,0,"div",8)(10,H7,13,6,"div",9),Q()()),t&2&&(fe(7),me("ngIf",r.user==null?null:r.user.photoURL),fe(),me("ngIf",!(r.user!=null&&r.user.photoURL)),fe(),me("ngIf",r.isDropdownOpen),fe(),me("ngIf",r.isDropdownOpen))},dependencies:[eo],styles:[".app-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background-color:#fff;border-bottom:1px solid #dadce0;font-family:Google Sans,Roboto,RobotoDraft,Helvetica,Arial,sans-serif;position:sticky;top:0;z-index:100}.app-header[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;min-width:230px;flex-shrink:0}.app-header[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:40px;width:40px}.app-header[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{font-size:22px;color:#5f6368;font-weight:400}@media(max-width:600px){.app-header[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]{min-width:auto}.app-header[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{display:none}}.app-header[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{flex:1;max-width:720px;background:#f1f3f4;border-radius:8px;padding:0 12px;height:46px;display:flex;align-items:center;transition:background .1s ease-in,width .1s ease-out,box-shadow .1s ease-in;margin:0 16px}.app-header[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]:focus-within{background:#fff;box-shadow:0 1px 1px #4145494d,0 1px 3px 1px #41454926}.app-header[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{color:#5f6368;margin-right:10px;font-style:normal;font-size:20px}.app-header[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{border:none;background:transparent;flex:1;height:100%;font-size:16px;outline:none;color:#3c4043;width:100%}.app-header[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#5f6368}@media(max-width:600px){.app-header[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{margin:0 8px;height:40px}}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]{min-width:48px;display:flex;justify-content:flex-end;flex-shrink:0;position:relative}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:32px;height:32px;background-color:#8e24aa;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;cursor:pointer;transition:transform .2s;overflow:hidden}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   .avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:90;cursor:default}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:48px;right:0;width:300px;background:#fff;border-radius:16px;box-shadow:0 4px 8px 3px #00000026,0 1px 3px #0000004d;z-index:100;padding:20px;display:flex;flex-direction:column;align-items:center;animation:fadeIn .2s ease-out}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .avatar-large[_ngcontent-%COMP%]{width:80px;height:80px;background-color:#8e24aa;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:40px;margin-bottom:12px;overflow:hidden}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .avatar-large[_ngcontent-%COMP%]   .avatar-img-large[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{text-align:center}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:block;font-size:16px;font-weight:500;color:#3c4043;margin-bottom:4px}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{display:block;font-size:14px;color:#5f6368}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{width:100%}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .loader-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:10px 0}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .loader-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:3px solid rgba(26,115,232,.1);border-left-color:#1a73e8;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .signin-btn[_ngcontent-%COMP%], .app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .signout-btn[_ngcontent-%COMP%]{width:100%;padding:10px 24px;background:#fff;color:#1a73e8;border:1px solid #dadce0;border-radius:4px;font-weight:500;cursor:pointer;font-family:inherit;transition:background-color .2s}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .signin-btn[_ngcontent-%COMP%]:hover, .app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .signout-btn[_ngcontent-%COMP%]:hover{background-color:#1a73e80a;border-color:#1a73e8}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .signout-btn[_ngcontent-%COMP%]{color:#3c4043}.app-header[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .signout-btn[_ngcontent-%COMP%]:hover{background-color:#f1f3f4;border-color:#dadce0}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};var Qm=class n{title=qi("docs-vvsk-in");static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Tn({type:n,selectors:[["app-root"]],standalone:!1,decls:2,vars:0,template:function(t,r){t&1&&Ot(0,"app-header")(1,"router-outlet")},dependencies:[bu,Ym],encapsulation:2})};var Xm=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=jt({type:n,bootstrap:[Qm]});static \u0275inj=xt({providers:[Uv()],imports:[Cw,Km,Ow,eN]})};Tw().bootstrapModule(Xm,{}).catch(n=>console.error(n));
